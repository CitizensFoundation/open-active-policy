"use strict";const nativeShadow=!(window.ShadyDOM&&window.ShadyDOM.inUse);let nativeCssVariables_,cssBuild;function calcCssVariables(e){nativeCssVariables_=(!e||!e.shimcssproperties)&&(nativeShadow||!(navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)||!window.CSS||!CSS.supports||!CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&void 0!==window.ShadyCSS.cssBuild&&(cssBuild=window.ShadyCSS.cssBuild);const disableRuntime=!(!window.ShadyCSS||!window.ShadyCSS.disableRuntime);window.ShadyCSS&&void 0!==window.ShadyCSS.nativeCss?nativeCssVariables_=window.ShadyCSS.nativeCss:window.ShadyCSS?(calcCssVariables(window.ShadyCSS),window.ShadyCSS=void 0):calcCssVariables(window.WebComponents&&window.WebComponents.flags);const nativeCssVariables=nativeCssVariables_;var styleSettings={nativeShadow:nativeShadow,get cssBuild(){return cssBuild},disableRuntime:disableRuntime,nativeCssVariables:nativeCssVariables};class StyleNode{constructor(){this.start=0,this.end=0,this.previous=null,this.parent=null,this.rules=null,this.parsedCssText="",this.cssText="",this.atRule=!1,this.type=0,this.keyframesName="",this.selector="",this.parsedSelector=""}}function parse(e){return parseCss(lex(e=clean(e)),e)}function clean(e){return e.replace(RX.comments,"").replace(RX.port,"")}function lex(e){let t=new StyleNode;t.start=0,t.end=e.length;let i=t;for(let r=0,n=e.length;r<n;r++)if(e[r]===OPEN_BRACE){i.rules||(i.rules=[]);let e=i,t=e.rules[e.rules.length-1]||null;(i=new StyleNode).start=r+1,i.parent=e,i.previous=t,e.rules.push(i)}else e[r]===CLOSE_BRACE&&(i.end=r+1,i=i.parent||t);return t}function parseCss(e,t){let i=t.substring(e.start,e.end-1);if(e.parsedCssText=e.cssText=i.trim(),e.parent){let r=e.previous?e.previous.end:e.parent.start;i=(i=(i=_expandUnicodeEscapes(i=t.substring(r,e.start-1))).replace(RX.multipleSpaces," ")).substring(i.lastIndexOf(";")+1);let n=e.parsedSelector=e.selector=i.trim();e.atRule=0===n.indexOf(AT_START),e.atRule?0===n.indexOf(MEDIA_START)?e.type=types.MEDIA_RULE:n.match(RX.keyframesRule)&&(e.type=types.KEYFRAMES_RULE,e.keyframesName=e.selector.split(RX.multipleSpaces).pop()):0===n.indexOf(VAR_START)?e.type=types.MIXIN_RULE:e.type=types.STYLE_RULE}let r=e.rules;if(r)for(let e,i=0,n=r.length;i<n&&(e=r[i]);i++)parseCss(e,t);return e}function _expandUnicodeEscapes(e){return e.replace(/\\([0-9a-f]{1,6})\s/gi,function(){let e=arguments[1],t=6-e.length;for(;t--;)e="0"+e;return"\\"+e})}function stringify(e,t,i=""){let r="";if(e.cssText||e.rules){let i=e.rules;if(i&&!_hasMixinRules(i))for(let e,n=0,a=i.length;n<a&&(e=i[n]);n++)r=stringify(e,t,r);else(r=(r=t?e.cssText:removeCustomProps(e.cssText)).trim())&&(r="  "+r+"\n")}return r&&(e.selector&&(i+=e.selector+" "+OPEN_BRACE+"\n"),i+=r,e.selector&&(i+=CLOSE_BRACE+"\n\n")),i}function _hasMixinRules(e){let t=e[0];return!!t&&!!t.selector&&0===t.selector.indexOf(VAR_START)}function removeCustomProps(e){return removeCustomPropApply(e=removeCustomPropAssignment(e))}function removeCustomPropAssignment(e){return e.replace(RX.customProp,"").replace(RX.mixinProp,"")}function removeCustomPropApply(e){return e.replace(RX.mixinApply,"").replace(RX.varApply,"")}const types={STYLE_RULE:1,KEYFRAMES_RULE:7,MEDIA_RULE:4,MIXIN_RULE:1e3},OPEN_BRACE="{",CLOSE_BRACE="}",RX={comments:/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,port:/@import[^;]*;/gim,customProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,mixinProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,mixinApply:/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,varApply:/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,keyframesRule:/^@[^\s]*keyframes/,multipleSpaces:/\s+/g},VAR_START="--",MEDIA_START="@media",AT_START="@";var cssParse={StyleNode:StyleNode,parse:parse,stringify:stringify,removeCustomPropAssignment:removeCustomPropAssignment,types:types};const VAR_ASSIGN=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,MIXIN_MATCH=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,VAR_CONSUMED=/(--[\w-]+)\s*([:,;)]|$)/gi,ANIMATION_MATCH=/(animation\s*:)|(animation-name\s*:)/,MEDIA_MATCH=/@media\s(.*)/,IS_VAR=/^--/,BRACKETED=/\{[^}]*\}/g,HOST_PREFIX="(?:^|[^.#[:])",HOST_SUFFIX="($|[.:[\\s>+~])";var commonRegex={VAR_ASSIGN:VAR_ASSIGN,MIXIN_MATCH:MIXIN_MATCH,VAR_CONSUMED:VAR_CONSUMED,ANIMATION_MATCH:ANIMATION_MATCH,MEDIA_MATCH:MEDIA_MATCH,IS_VAR:IS_VAR,BRACKETED:BRACKETED,HOST_PREFIX:HOST_PREFIX,HOST_SUFFIX:HOST_SUFFIX};const styleTextSet=new Set,scopingAttribute="shady-unscoped";function processUnscopedStyle(e){const t=e.textContent;if(!styleTextSet.has(t)){styleTextSet.add(t);const i=e.cloneNode(!0);document.head.appendChild(i)}}function isUnscopedStyle(e){return e.hasAttribute(scopingAttribute)}var unscopedStyleHandler={scopingAttribute:scopingAttribute,processUnscopedStyle:processUnscopedStyle,isUnscopedStyle:isUnscopedStyle};function toCssText(e,t){return e?("string"==typeof e&&(e=parse(e)),t&&forEachRule(e,t),stringify(e,nativeCssVariables)):""}function rulesForStyle(e){return!e.__cssRules&&e.textContent&&(e.__cssRules=parse(e.textContent)),e.__cssRules||null}function isKeyframesSelector(e){return!!e.parent&&e.parent.type===types.KEYFRAMES_RULE}function forEachRule(e,t,i,r){if(!e)return;let n=!1,a=e.type;if(r&&a===types.MEDIA_RULE){let t=e.selector.match(MEDIA_MATCH);t&&(window.matchMedia(t[1]).matches||(n=!0))}a===types.STYLE_RULE?t(e):i&&a===types.KEYFRAMES_RULE?i(e):a===types.MIXIN_RULE&&(n=!0);let o=e.rules;if(o&&!n)for(let e,n=0,a=o.length;n<a&&(e=o[n]);n++)forEachRule(e,t,i,r)}function applyCss(e,t,i,r){let n=createScopeStyle(e,t);return applyStyle(n,i,r),n}function createScopeStyle(e,t){let i=document.createElement("style");return t&&i.setAttribute("scope",t),i.textContent=e,i}let lastHeadApplyNode=null;function applyStylePlaceHolder(e){let t=document.createComment(" Shady DOM styles for "+e+" "),i=lastHeadApplyNode?lastHeadApplyNode.nextSibling:null,r=document.head;return r.insertBefore(t,i||r.firstChild),lastHeadApplyNode=t,t}function applyStyle(e,t,i){t=t||document.head;let r=i&&i.nextSibling||t.firstChild;if(t.insertBefore(e,r),lastHeadApplyNode){e.compareDocumentPosition(lastHeadApplyNode)===Node.DOCUMENT_POSITION_PRECEDING&&(lastHeadApplyNode=e)}else lastHeadApplyNode=e}function isTargetedBuild(e){return nativeShadow?"shadow"===e:"shady"===e}function findMatchingParen(e,t){let i=0;for(let r=t,n=e.length;r<n;r++)if("("===e[r])i++;else if(")"===e[r]&&0==--i)return r;return-1}function processVariableAndFallback(e,t){let i=e.indexOf("var(");if(-1===i)return t(e,"","","");let r=findMatchingParen(e,i+3),n=e.substring(i+4,r),a=e.substring(0,i),o=processVariableAndFallback(e.substring(r+1),t),s=n.indexOf(",");return-1===s?t(a,n.trim(),"",o):t(a,n.substring(0,s).trim(),n.substring(s+1).trim(),o)}function setElementClassRaw(e,t){nativeShadow?e.setAttribute("class",t):window.ShadyDOM.nativeMethods.setAttribute.call(e,"class",t)}const wrap=window.ShadyDOM&&window.ShadyDOM.wrap||(e=>e);function getIsExtends(e){let t=e.localName,i="",r="";return t?-1<t.indexOf("-")?i=t:(r=t,i=e.getAttribute&&e.getAttribute("is")||""):(i=e.is,r=e.extends),{is:i,typeExtension:r}}function gatherStyleText(e){const t=[],i=e.querySelectorAll("style");for(let e=0;e<i.length;e++){const r=i[e];isUnscopedStyle(r)?nativeShadow||(processUnscopedStyle(r),r.parentNode.removeChild(r)):(t.push(r.textContent),r.parentNode.removeChild(r))}return t.join("").trim()}function splitSelectorList(e){const t=[];let i="";for(let r=0;0<=r&&r<e.length;r++)if("("===e[r]){const t=findMatchingParen(e,r);i+=e.slice(r,t+1),r=t}else","===e[r]?(t.push(i),i=""):i+=e[r];return i&&t.push(i),t}const CSS_BUILD_ATTR="css-build";function getCssBuild(e){if(void 0!==cssBuild)return cssBuild;if(void 0===e.__cssBuild){const t=e.getAttribute(CSS_BUILD_ATTR);if(t)e.__cssBuild=t;else{const t=getBuildComment(e);""!==t&&removeBuildComment(e),e.__cssBuild=t}}return e.__cssBuild||""}function elementHasBuiltCss(e){return""!==getCssBuild(e)}function getBuildComment(e){const t="template"===e.localName?e.content.firstChild:e.firstChild;if(t instanceof Comment){const e=t.textContent.trim().split(":");if(e[0]===CSS_BUILD_ATTR)return e[1]}return""}function isOptimalCssBuild(e=""){return!(""===e||!nativeCssVariables)&&(nativeShadow?"shadow"===e:"shady"===e)}function removeBuildComment(e){const t="template"===e.localName?e.content.firstChild:e.firstChild;t.parentNode.removeChild(t)}var styleUtil={toCssText:toCssText,rulesForStyle:rulesForStyle,isKeyframesSelector:isKeyframesSelector,forEachRule:forEachRule,applyCss:applyCss,createScopeStyle:createScopeStyle,applyStylePlaceHolder:applyStylePlaceHolder,applyStyle:applyStyle,isTargetedBuild:isTargetedBuild,findMatchingParen:findMatchingParen,processVariableAndFallback:processVariableAndFallback,setElementClassRaw:setElementClassRaw,wrap:wrap,getIsExtends:getIsExtends,gatherStyleText:gatherStyleText,splitSelectorList:splitSelectorList,getCssBuild:getCssBuild,elementHasBuiltCss:elementHasBuiltCss,getBuildComment:getBuildComment,isOptimalCssBuild:isOptimalCssBuild};function updateNativeProperties(e,t){for(let i in t)null===i?e.style.removeProperty(i):e.style.setProperty(i,t[i])}function getComputedStyleValue(e,t){const i=window.getComputedStyle(e).getPropertyValue(t);return i?i.trim():""}function detectMixin(e){const t=MIXIN_MATCH.test(e)||VAR_ASSIGN.test(e);return MIXIN_MATCH.lastIndex=0,VAR_ASSIGN.lastIndex=0,t}var commonUtils={updateNativeProperties:updateNativeProperties,getComputedStyleValue:getComputedStyleValue,detectMixin:detectMixin};const APPLY_NAME_CLEAN=/;\s*/m,INITIAL_INHERIT=/^\s*(initial)|(inherit)\s*$/,IMPORTANT=/\s*!important/,MIXIN_VAR_SEP="_-_";let PropertyEntry,DependantsEntry,MixinMapEntry;class MixinMap{constructor(){this._map={}}set(e,t){e=e.trim(),this._map[e]={properties:t,dependants:{}}}get(e){return e=e.trim(),this._map[e]||null}}let invalidCallback=null;class ApplyShim{constructor(){this._currentElement=null,this._measureElement=null,this._map=new MixinMap}detectMixin(e){return detectMixin(e)}gatherStyles(e){const t=gatherStyleText(e.content);if(t){const i=document.createElement("style");return i.textContent=t,e.content.insertBefore(i,e.content.firstChild),i}return null}transformTemplate(e,t){void 0===e._gatheredStyle&&(e._gatheredStyle=this.gatherStyles(e));const i=e._gatheredStyle;return i?this.transformStyle(i,t):null}transformStyle(e,t=""){let i=rulesForStyle(e);return this.transformRules(i,t),e.textContent=toCssText(i),i}transformCustomStyle(e){let t=rulesForStyle(e);return forEachRule(t,e=>{":root"===e.selector&&(e.selector="html"),this.transformRule(e)}),e.textContent=toCssText(t),t}transformRules(e,t){this._currentElement=t,forEachRule(e,e=>{this.transformRule(e)}),this._currentElement=null}transformRule(e){e.cssText=this.transformCssText(e.parsedCssText,e),":root"===e.selector&&(e.selector=":host > *")}transformCssText(e,t){return e=e.replace(VAR_ASSIGN,(e,i,r,n)=>this._produceCssProperties(e,i,r,n,t)),this._consumeCssProperties(e,t)}_getInitialValueForProperty(e){return this._measureElement||(this._measureElement=document.createElement("meta"),this._measureElement.setAttribute("apply-shim-measure",""),this._measureElement.style.all="initial",document.head.appendChild(this._measureElement)),window.getComputedStyle(this._measureElement).getPropertyValue(e)}_fallbacksFromPreviousRules(e){let t=e;for(;t.parent;)t=t.parent;const i={};let r=!1;return forEachRule(t,t=>{(r=r||t===e)||t.selector===e.selector&&Object.assign(i,this._cssTextToMap(t.parsedCssText))}),i}_consumeCssProperties(e,t){let i=null;for(;i=MIXIN_MATCH.exec(e);){let r=i[0],n=i[1],a=i.index,o=a+r.indexOf("@apply"),s=a+r.length,l=e.slice(0,o),c=e.slice(s),h=t?this._fallbacksFromPreviousRules(t):{};Object.assign(h,this._cssTextToMap(l));let u=this._atApplyToCssProperties(n,h);e=`${l}${u}${c}`,MIXIN_MATCH.lastIndex=a+u.length}return e}_atApplyToCssProperties(e,t){e=e.replace(APPLY_NAME_CLEAN,"");let i=[],r=this._map.get(e);if(r||(this._map.set(e,{}),r=this._map.get(e)),r){let n,a,o;this._currentElement&&(r.dependants[this._currentElement]=!0);const s=r.properties;for(n in s)o=t&&t[n],a=[n,": var(",e,MIXIN_VAR_SEP,n],o&&a.push(",",o.replace(IMPORTANT,"")),a.push(")"),IMPORTANT.test(s[n])&&a.push(" !important"),i.push(a.join(""))}return i.join("; ")}_replaceInitialOrInherit(e,t){let i=INITIAL_INHERIT.exec(t);return i&&(t=i[1]?this._getInitialValueForProperty(e):"apply-shim-inherit"),t}_cssTextToMap(e,t=!1){let i,r,n=e.split(";"),a={};for(let e,o,s=0;s<n.length;s++)(e=n[s])&&1<(o=e.split(":")).length&&(i=o[0].trim(),r=o.slice(1).join(":"),t&&(r=this._replaceInitialOrInherit(i,r)),a[i]=r);return a}_invalidateMixinEntry(e){if(invalidCallback)for(let t in e.dependants)t!==this._currentElement&&invalidCallback(t)}_produceCssProperties(e,t,i,r,n){if(i&&processVariableAndFallback(i,(e,t)=>{t&&this._map.get(t)&&(r=`@apply ${t};`)}),!r)return e;let a=this._consumeCssProperties(""+r,n),o=e.slice(0,e.indexOf("--")),s=this._cssTextToMap(a,!0),l=s,c=this._map.get(t),h=c&&c.properties;h?l=Object.assign(Object.create(h),s):this._map.set(t,l);let u,d,p=[],m=!1;for(u in l)void 0===(d=s[u])&&(d="initial"),!h||u in h||(m=!0),p.push(`${t}${MIXIN_VAR_SEP}${u}: ${d}`);return m&&this._invalidateMixinEntry(c),c&&(c.properties=l),i&&(o=`${e};${o}`),`${o}${p.join("; ")};`}}ApplyShim.prototype.detectMixin=ApplyShim.prototype.detectMixin,ApplyShim.prototype.transformStyle=ApplyShim.prototype.transformStyle,ApplyShim.prototype.transformCustomStyle=ApplyShim.prototype.transformCustomStyle,ApplyShim.prototype.transformRules=ApplyShim.prototype.transformRules,ApplyShim.prototype.transformRule=ApplyShim.prototype.transformRule,ApplyShim.prototype.transformTemplate=ApplyShim.prototype.transformTemplate,ApplyShim.prototype._separator=MIXIN_VAR_SEP,Object.defineProperty(ApplyShim.prototype,"invalidCallback",{get:()=>invalidCallback,set(e){invalidCallback=e}});var applyShim={default:ApplyShim};const templateMap={};var templateMap$1={default:templateMap};const CURRENT_VERSION="_applyShimCurrentVersion",NEXT_VERSION="_applyShimNextVersion",VALIDATING_VERSION="_applyShimValidatingVersion",promise=Promise.resolve();function invalidate(e){let t=templateMap[e];t&&invalidateTemplate(t)}function invalidateTemplate(e){e[CURRENT_VERSION]=e[CURRENT_VERSION]||0,e[VALIDATING_VERSION]=e[VALIDATING_VERSION]||0,e[NEXT_VERSION]=(e[NEXT_VERSION]||0)+1}function isValid(e){let t=templateMap[e];return!t||templateIsValid(t)}function templateIsValid(e){return e[CURRENT_VERSION]===e[NEXT_VERSION]}function isValidating(e){let t=templateMap[e];return!!t&&templateIsValidating(t)}function templateIsValidating(e){return!templateIsValid(e)&&e[VALIDATING_VERSION]===e[NEXT_VERSION]}function startValidating(e){startValidatingTemplate(templateMap[e])}function startValidatingTemplate(e){e[VALIDATING_VERSION]=e[NEXT_VERSION],e._validating||(e._validating=!0,promise.then(function(){e[CURRENT_VERSION]=e[NEXT_VERSION],e._validating=!1}))}function elementsAreInvalid(){for(let e in templateMap){if(!templateIsValid(templateMap[e]))return!0}return!1}var applyShimUtils={invalidate:invalidate,invalidateTemplate:invalidateTemplate,isValid:isValid,templateIsValid:templateIsValid,isValidating:isValidating,templateIsValidating:templateIsValidating,startValidating:startValidating,startValidatingTemplate:startValidatingTemplate,elementsAreInvalid:elementsAreInvalid};let resolveFn,readyPromise=null,whenReady=window.HTMLImports&&window.HTMLImports.whenReady||null;function documentWait(e){requestAnimationFrame(function(){whenReady?whenReady(e):(readyPromise||(readyPromise=new Promise(e=>{resolveFn=e}),"complete"===document.readyState?resolveFn():document.addEventListener("readystatechange",()=>{"complete"===document.readyState&&resolveFn()})),readyPromise.then(function(){e&&e()}))})}var documentWait$1={default:documentWait};let CustomStyleProvider;const SEEN_MARKER="__seenByShadyCSS",CACHED_STYLE="__shadyCSSCachedStyle";let transformFn=null,validateFn=null;class CustomStyleInterface{constructor(){this.customStyles=[],this.enqueued=!1,documentWait(()=>{window.ShadyCSS.flushCustomStyles&&window.ShadyCSS.flushCustomStyles()})}enqueueDocumentValidation(){!this.enqueued&&validateFn&&(this.enqueued=!0,documentWait(validateFn))}addCustomStyle(e){e[SEEN_MARKER]||(e[SEEN_MARKER]=!0,this.customStyles.push(e),this.enqueueDocumentValidation())}getStyleForCustomStyle(e){if(e[CACHED_STYLE])return e[CACHED_STYLE];let t;return t=e.getStyle?e.getStyle():e}processStyles(){const e=this.customStyles;for(let t=0;t<e.length;t++){const i=e[t];if(i[CACHED_STYLE])continue;const r=this.getStyleForCustomStyle(i);if(r){const e=r.__appliedElement||r;transformFn&&transformFn(e),i[CACHED_STYLE]=e}}return e}}CustomStyleInterface.prototype.addCustomStyle=CustomStyleInterface.prototype.addCustomStyle,CustomStyleInterface.prototype.getStyleForCustomStyle=CustomStyleInterface.prototype.getStyleForCustomStyle,CustomStyleInterface.prototype.processStyles=CustomStyleInterface.prototype.processStyles,Object.defineProperties(CustomStyleInterface.prototype,{transformCallback:{get:()=>transformFn,set(e){transformFn=e}},validateCallback:{get:()=>validateFn,set(e){let t=!1;validateFn||(t=!0),validateFn=e,t&&this.enqueueDocumentValidation()}}});const CustomStyleInterfaceInterface={};var customStyleInterface={CustomStyleProvider:CustomStyleProvider,default:CustomStyleInterface,CustomStyleInterfaceInterface:CustomStyleInterfaceInterface};const applyShim$1=new ApplyShim;class ApplyShimInterface{constructor(){this.customStyleInterface=null,applyShim$1.invalidCallback=invalidate}ensure(){this.customStyleInterface||window.ShadyCSS.CustomStyleInterface&&(this.customStyleInterface=window.ShadyCSS.CustomStyleInterface,this.customStyleInterface.transformCallback=(e=>{applyShim$1.transformCustomStyle(e)}),this.customStyleInterface.validateCallback=(()=>{requestAnimationFrame(()=>{this.customStyleInterface.enqueued&&this.flushCustomStyles()})}))}prepareTemplate(e,t){if(this.ensure(),elementHasBuiltCss(e))return;templateMap[t]=e;let i=applyShim$1.transformTemplate(e,t);e._styleAst=i}flushCustomStyles(){if(this.ensure(),!this.customStyleInterface)return;let e=this.customStyleInterface.processStyles();if(this.customStyleInterface.enqueued){for(let t=0;t<e.length;t++){let i=e[t],r=this.customStyleInterface.getStyleForCustomStyle(i);r&&applyShim$1.transformCustomStyle(r)}this.customStyleInterface.enqueued=!1}}styleSubtree(e,t){if(this.ensure(),t&&updateNativeProperties(e,t),e.shadowRoot){this.styleElement(e);let t=e.shadowRoot.children||e.shadowRoot.childNodes;for(let e=0;e<t.length;e++)this.styleSubtree(t[e])}else{let t=e.children||e.childNodes;for(let e=0;e<t.length;e++)this.styleSubtree(t[e])}}styleElement(e){this.ensure();let{is:t}=getIsExtends(e),i=templateMap[t];if((!i||!elementHasBuiltCss(i))&&i&&!templateIsValid(i)){templateIsValidating(i)||(this.prepareTemplate(i,t),startValidatingTemplate(i));let r=e.shadowRoot;if(r){let e=r.querySelector("style");e&&(e.__cssRules=i._styleAst,e.textContent=toCssText(i._styleAst))}}}styleDocument(e){this.ensure(),this.styleSubtree(document.body,e)}}if(!window.ShadyCSS||!window.ShadyCSS.ScopingShim){const e=new ApplyShimInterface;let t=window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface;window.ShadyCSS={prepareTemplate(t,i,r){e.flushCustomStyles(),e.prepareTemplate(t,i)},prepareTemplateStyles(e,t,i){window.ShadyCSS.prepareTemplate(e,t,i)},prepareTemplateDom(e,t){},styleSubtree(t,i){e.flushCustomStyles(),e.styleSubtree(t,i)},styleElement(t){e.flushCustomStyles(),e.styleElement(t)},styleDocument(t){e.flushCustomStyles(),e.styleDocument(t)},getComputedStyleValue:(e,t)=>getComputedStyleValue(e,t),flushCustomStyles(){e.flushCustomStyles()},nativeCss:nativeCssVariables,nativeShadow:nativeShadow,cssBuild:cssBuild,disableRuntime:disableRuntime},t&&(window.ShadyCSS.CustomStyleInterface=t)}window.ShadyCSS.ApplyShim=applyShim$1,window.JSCompiler_renameProperty=function(e,t){return e};let workingURL,resolveDoc,CSS_URL_RX=/(url\()([^)]*)(\))/g,ABS_URL=/(^\/)|(^#)|(^[\w-\d]*:)/;function resolveUrl(e,t){if(e&&ABS_URL.test(e))return e;if(void 0===workingURL){workingURL=!1;try{const e=new URL("b","http://a");e.pathname="c%20d",workingURL="http://a/c%20d"===e.href}catch(e){}}return t||(t=document.baseURI||window.location.href),workingURL?new URL(e,t).href:(resolveDoc||((resolveDoc=document.implementation.createHTMLDocument("temp")).base=resolveDoc.createElement("base"),resolveDoc.head.appendChild(resolveDoc.base),resolveDoc.anchor=resolveDoc.createElement("a"),resolveDoc.body.appendChild(resolveDoc.anchor)),resolveDoc.base.href=t,resolveDoc.anchor.href=e,resolveDoc.anchor.href||e)}function resolveCss(e,t){return e.replace(CSS_URL_RX,function(e,i,r,n){return i+"'"+resolveUrl(r.replace(/["']/g,""),t)+"'"+n})}function pathFromUrl(e){return e.substring(0,e.lastIndexOf("/")+1)}var resolveUrl$1={resolveUrl:resolveUrl,resolveCss:resolveCss,pathFromUrl:pathFromUrl};const useShadow=!window.ShadyDOM,useNativeCSSProperties=!(window.ShadyCSS&&!window.ShadyCSS.nativeCss),useNativeCustomElements=!window.customElements.polyfillWrapFlushCallback;let rootPath=pathFromUrl(document.baseURI||window.location.href);const setRootPath=function(e){rootPath=e};let sanitizeDOMValue=window.Polymer&&window.Polymer.sanitizeDOMValue||void 0;const setSanitizeDOMValue=function(e){sanitizeDOMValue=e};let passiveTouchGestures=!1;const setPassiveTouchGestures=function(e){passiveTouchGestures=e};let strictTemplatePolicy=!1;const setStrictTemplatePolicy=function(e){strictTemplatePolicy=e};let allowTemplateFromDomModule=!1;const setAllowTemplateFromDomModule=function(e){allowTemplateFromDomModule=e};let legacyOptimizations=!1;const setLegacyOptimizations=function(e){legacyOptimizations=e};let syncInitialRender=!1;const setSyncInitialRender=function(e){syncInitialRender=e};var settings={useShadow:useShadow,useNativeCSSProperties:useNativeCSSProperties,useNativeCustomElements:useNativeCustomElements,get rootPath(){return rootPath},setRootPath:setRootPath,get sanitizeDOMValue(){return sanitizeDOMValue},setSanitizeDOMValue:setSanitizeDOMValue,get passiveTouchGestures(){return passiveTouchGestures},setPassiveTouchGestures:setPassiveTouchGestures,get strictTemplatePolicy(){return strictTemplatePolicy},setStrictTemplatePolicy:setStrictTemplatePolicy,get allowTemplateFromDomModule(){return allowTemplateFromDomModule},setAllowTemplateFromDomModule:setAllowTemplateFromDomModule,get legacyOptimizations(){return legacyOptimizations},setLegacyOptimizations:setLegacyOptimizations,get syncInitialRender(){return syncInitialRender},setSyncInitialRender:setSyncInitialRender};let dedupeId=0;function MixinFunction(){}MixinFunction.prototype.__mixinApplications,MixinFunction.prototype.__mixinSet;const dedupingMixin=function(e){let t=e.__mixinApplications;t||(t=new WeakMap,e.__mixinApplications=t);let i=dedupeId++;return function(r){let n=r.__mixinSet;if(n&&n[i])return r;let a=t,o=a.get(r);o||(o=e(r),a.set(r,o));let s=Object.create(o.__mixinSet||n||null);return s[i]=!0,o.__mixinSet=s,o}};var mixin={dedupingMixin:dedupingMixin};let modules={},lcModules={};function setModule(e,t){modules[e]=lcModules[e.toLowerCase()]=t}function findModule(e){return modules[e]||lcModules[e.toLowerCase()]}function styleOutsideTemplateCheck(e){e.querySelector("style")&&console.warn("dom-module %s has style outside template",e.id)}class DomModule extends HTMLElement{static get observedAttributes(){return["id"]}static import(e,t){if(e){let i=findModule(e);return i&&t?i.querySelector(t):i}return null}attributeChangedCallback(e,t,i,r){t!==i&&this.register()}get assetpath(){if(!this.__assetpath){const e=window.HTMLImports&&HTMLImports.importForElement?HTMLImports.importForElement(this)||document:this.ownerDocument,t=resolveUrl(this.getAttribute("assetpath")||"",e.baseURI);this.__assetpath=pathFromUrl(t)}return this.__assetpath}register(e){if(e=e||this.id){if(strictTemplatePolicy&&void 0!==findModule(e))throw setModule(e,null),new Error(`strictTemplatePolicy: dom-module ${e} re-registered`);this.id=e,setModule(e,this),styleOutsideTemplateCheck(this)}}}DomModule.prototype.modules=modules,customElements.define("dom-module",DomModule);var domModule={DomModule:DomModule};const MODULE_STYLE_LINK_SELECTOR="link[rel=import][type~=css]",INCLUDE_ATTR="include",SHADY_UNSCOPED_ATTR="shady-unscoped";function importModule(e){return DomModule.import(e)}function styleForImport(e){const t=resolveCss((e.body?e.body:e).textContent,e.baseURI),i=document.createElement("style");return i.textContent=t,i}let templateWithAssetPath;function stylesFromModules(e){const t=e.trim().split(/\s+/),i=[];for(let e=0;e<t.length;e++)i.push(...stylesFromModule(t[e]));return i}function stylesFromModule(e){const t=importModule(e);if(!t)return console.warn("Could not find style data in module named",e),[];if(void 0===t._styles){const e=[..._stylesFromModuleImports(t)],i=t.querySelector("template");i&&e.push(...stylesFromTemplate(i,t.assetpath)),t._styles=e}return t._styles}function stylesFromTemplate(e,t){if(!e._styles){const i=[],r=e.content.querySelectorAll("style");for(let e=0;e<r.length;e++){let n=r[e],a=n.getAttribute(INCLUDE_ATTR);a&&i.push(...stylesFromModules(a).filter(function(e,t,i){return i.indexOf(e)===t})),t&&(n.textContent=resolveCss(n.textContent,t)),i.push(n)}e._styles=i}return e._styles}function stylesFromModuleImports(e){let t=importModule(e);return t?_stylesFromModuleImports(t):[]}function _stylesFromModuleImports(e){const t=[],i=e.querySelectorAll(MODULE_STYLE_LINK_SELECTOR);for(let e,r=0;r<i.length;r++)if((e=i[r]).import){const i=e.import,r=e.hasAttribute(SHADY_UNSCOPED_ATTR);if(r&&!i._unscopedStyle){const e=styleForImport(i);e.setAttribute(SHADY_UNSCOPED_ATTR,""),i._unscopedStyle=e}else i._style||(i._style=styleForImport(i));t.push(r?i._unscopedStyle:i._style)}return t}function cssFromModules(e){let t=e.trim().split(/\s+/),i="";for(let e=0;e<t.length;e++)i+=cssFromModule(t[e]);return i}function cssFromModule(e){let t=importModule(e);if(t&&void 0===t._cssText){let e=_cssFromModuleImports(t),i=t.querySelector("template");i&&(e+=cssFromTemplate(i,t.assetpath)),t._cssText=e||null}return t||console.warn("Could not find style data in module named",e),t&&t._cssText||""}function cssFromTemplate(e,t){let i="";const r=stylesFromTemplate(e,t);for(let e,t=0;t<r.length;t++)(e=r[t]).parentNode&&e.parentNode.removeChild(e),i+=e.textContent;return i}function cssFromModuleImports(e){let t=importModule(e);return t?_cssFromModuleImports(t):""}function _cssFromModuleImports(e){let t="",i=_stylesFromModuleImports(e);for(let e=0;e<i.length;e++)t+=i[e].textContent;return t}var styleGather={stylesFromModules:stylesFromModules,stylesFromModule:stylesFromModule,stylesFromTemplate:stylesFromTemplate,stylesFromModuleImports:stylesFromModuleImports,cssFromModules:cssFromModules,cssFromModule:cssFromModule,cssFromTemplate:cssFromTemplate,cssFromModuleImports:cssFromModuleImports};const wrap$1=window.ShadyDOM&&window.ShadyDOM.noPatch&&window.ShadyDOM.wrap?window.ShadyDOM.wrap:e=>e;var wrap$2={wrap:wrap$1};function isPath(e){return 0<=e.indexOf(".")}function root(e){let t=e.indexOf(".");return-1===t?e:e.slice(0,t)}function isAncestor(e,t){return 0===e.indexOf(t+".")}function isDescendant(e,t){return 0===t.indexOf(e+".")}function translate(e,t,i){return t+i.slice(e.length)}function matches(e,t){return e===t||isAncestor(e,t)||isDescendant(e,t)}function normalize(e){if(Array.isArray(e)){let t=[];for(let i,r=0;r<e.length;r++){i=e[r].toString().split(".");for(let e=0;e<i.length;e++)t.push(i[e])}return t.join(".")}return e}function split(e){return Array.isArray(e)?normalize(e).split("."):e.toString().split(".")}function get(e,t,i){let r=e,n=split(t);for(let e=0;e<n.length;e++){if(!r)return;r=r[n[e]]}return i&&(i.path=n.join(".")),r}function set(e,t,i){let r=e,n=split(t),a=n[n.length-1];if(1<n.length){for(let e,t=0;t<n.length-1;t++)if(!(r=r[e=n[t]]))return;r[a]=i}else r[t]=i;return n.join(".")}const isDeep=isPath;var path={isPath:isPath,root:root,isAncestor:isAncestor,isDescendant:isDescendant,translate:translate,matches:matches,normalize:normalize,split:split,get:get,set:set,isDeep:isDeep};const caseMap={},DASH_TO_CAMEL=/-[a-z]/g,CAMEL_TO_DASH=/([A-Z])/g;function dashToCamelCase(e){return caseMap[e]||(caseMap[e]=0>e.indexOf("-")?e:e.replace(DASH_TO_CAMEL,e=>e[1].toUpperCase()))}function camelToDashCase(e){return caseMap[e]||(caseMap[e]=e.replace(CAMEL_TO_DASH,"-$1").toLowerCase())}var caseMap$1={dashToCamelCase:dashToCamelCase,camelToDashCase:camelToDashCase};let microtaskCurrHandle=0,microtaskLastHandle=0,microtaskCallbacks=[],microtaskNodeContent=0,microtaskNode=document.createTextNode("");function microtaskFlush(){const e=microtaskCallbacks.length;for(let t,i=0;i<e;i++)if(t=microtaskCallbacks[i])try{t()}catch(e){setTimeout(()=>{throw e})}microtaskCallbacks.splice(0,e),microtaskLastHandle+=e}new window.MutationObserver(microtaskFlush).observe(microtaskNode,{characterData:!0});const timeOut={after:e=>({run:t=>window.setTimeout(t,e),cancel(e){window.clearTimeout(e)}}),run:(e,t)=>window.setTimeout(e,t),cancel(e){window.clearTimeout(e)}},animationFrame={run:e=>window.requestAnimationFrame(e),cancel(e){window.cancelAnimationFrame(e)}},idlePeriod={run:e=>window.requestIdleCallback?window.requestIdleCallback(e):window.setTimeout(e,16),cancel(e){window.cancelIdleCallback?window.cancelIdleCallback(e):window.clearTimeout(e)}},microTask={run:e=>(microtaskNode.textContent=microtaskNodeContent++,microtaskCallbacks.push(e),microtaskCurrHandle++),cancel(e){const t=e-microtaskLastHandle;if(0<=t){if(!microtaskCallbacks[t])throw new Error("invalid async handle: "+e);microtaskCallbacks[t]=null}}};var async={timeOut:timeOut,animationFrame:animationFrame,idlePeriod:idlePeriod,microTask:microTask};const microtask=microTask,PropertiesChanged=dedupingMixin(e=>{return class extends e{static createProperties(e){const t=this.prototype;for(let i in e)i in t||t._createPropertyAccessor(i)}static attributeNameForProperty(e){return e.toLowerCase()}static typeForProperty(e){}_createPropertyAccessor(e,t){this._addPropertyToAttributeMap(e),this.hasOwnProperty("__dataHasAccessor")||(this.__dataHasAccessor=Object.assign({},this.__dataHasAccessor)),this.__dataHasAccessor[e]||(this.__dataHasAccessor[e]=!0,this._definePropertyAccessor(e,t))}_addPropertyToAttributeMap(e){if(this.hasOwnProperty("__dataAttributes")||(this.__dataAttributes=Object.assign({},this.__dataAttributes)),!this.__dataAttributes[e]){const t=this.constructor.attributeNameForProperty(e);this.__dataAttributes[t]=e}}_definePropertyAccessor(e,t){Object.defineProperty(this,e,{get(){return this._getProperty(e)},set:t?function(){}:function(t){this._setProperty(e,t)}})}constructor(){super(),this.__dataEnabled=!1,this.__dataReady=!1,this.__dataInvalid=!1,this.__data={},this.__dataPending=null,this.__dataOld=null,this.__dataInstanceProps=null,this.__serializing=!1,this._initializeProperties()}ready(){this.__dataReady=!0,this._flushProperties()}_initializeProperties(){for(let e in this.__dataHasAccessor)this.hasOwnProperty(e)&&(this.__dataInstanceProps=this.__dataInstanceProps||{},this.__dataInstanceProps[e]=this[e],delete this[e])}_initializeInstanceProperties(e){Object.assign(this,e)}_setProperty(e,t){this._setPendingProperty(e,t)&&this._invalidateProperties()}_getProperty(e){return this.__data[e]}_setPendingProperty(e,t,i){let r=this.__data[e],n=this._shouldPropertyChange(e,t,r);return n&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),!this.__dataOld||e in this.__dataOld||(this.__dataOld[e]=r),this.__data[e]=t,this.__dataPending[e]=t),n}_invalidateProperties(){!this.__dataInvalid&&this.__dataReady&&(this.__dataInvalid=!0,microtask.run(()=>{this.__dataInvalid&&(this.__dataInvalid=!1,this._flushProperties())}))}_enableProperties(){this.__dataEnabled||(this.__dataEnabled=!0,this.__dataInstanceProps&&(this._initializeInstanceProperties(this.__dataInstanceProps),this.__dataInstanceProps=null),this.ready())}_flushProperties(){const e=this.__data,t=this.__dataPending,i=this.__dataOld;this._shouldPropertiesChange(e,t,i)&&(this.__dataPending=null,this.__dataOld=null,this._propertiesChanged(e,t,i))}_shouldPropertiesChange(e,t,i){return!!t}_propertiesChanged(e,t,i){}_shouldPropertyChange(e,t,i){return i!==t&&(i==i||t==t)}attributeChangedCallback(e,t,i,r){t!==i&&this._attributeToProperty(e,i),super.attributeChangedCallback&&super.attributeChangedCallback(e,t,i,r)}_attributeToProperty(e,t,i){if(!this.__serializing){const r=this.__dataAttributes,n=r&&r[e]||e;this[n]=this._deserializeValue(t,i||this.constructor.typeForProperty(n))}}_propertyToAttribute(e,t,i){this.__serializing=!0,i=3>arguments.length?this[e]:i,this._valueToNodeAttribute(this,i,t||this.constructor.attributeNameForProperty(e)),this.__serializing=!1}_valueToNodeAttribute(e,t,i){const r=this._serializeValue(t);void 0===r?e.removeAttribute(i):("class"!==i&&"name"!==i&&"slot"!==i||(e=wrap$1(e)),e.setAttribute(i,r))}_serializeValue(e){switch(typeof e){case"boolean":return e?"":void 0;default:return null!=e?e.toString():void 0}}_deserializeValue(e,t){switch(t){case Boolean:return null!==e;case Number:return+e;default:return e}}}});var propertiesChanged={PropertiesChanged:PropertiesChanged};const nativeProperties={};let proto=HTMLElement.prototype;for(;proto;){let e=Object.getOwnPropertyNames(proto);for(let t=0;t<e.length;t++)nativeProperties[e[t]]=!0;proto=Object.getPrototypeOf(proto)}function saveAccessorValue(e,t){if(!nativeProperties[t]){let i=e[t];void 0!==i&&(e.__data?e._setPendingProperty(t,i):(e.__dataProto?e.hasOwnProperty(JSCompiler_renameProperty("__dataProto",e))||(e.__dataProto=Object.create(e.__dataProto)):e.__dataProto={},e.__dataProto[t]=i))}}const PropertyAccessors=dedupingMixin(e=>{const t=PropertiesChanged(e);return class extends t{static createPropertiesForAttributes(){let e=this.observedAttributes;for(let t=0;t<e.length;t++)this.prototype._createPropertyAccessor(dashToCamelCase(e[t]))}static attributeNameForProperty(e){return camelToDashCase(e)}_initializeProperties(){this.__dataProto&&(this._initializeProtoProperties(this.__dataProto),this.__dataProto=null),super._initializeProperties()}_initializeProtoProperties(e){for(let t in e)this._setProperty(t,e[t])}_ensureAttribute(e,t){const i=this;i.hasAttribute(e)||this._valueToNodeAttribute(i,t,e)}_serializeValue(e){switch(typeof e){case"object":if(e instanceof Date)return e.toString();if(e)try{return JSON.stringify(e)}catch(e){return""}default:return super._serializeValue(e)}}_deserializeValue(e,t){let i;switch(t){case Object:try{i=JSON.parse(e)}catch(t){i=e}break;case Array:try{i=JSON.parse(e)}catch(t){i=null,console.warn(`Polymer::Attributes: couldn't decode Array as JSON: ${e}`)}break;case Date:i=isNaN(e)?e+"":+e,i=new Date(i);break;default:i=super._deserializeValue(e,t)}return i}_definePropertyAccessor(e,t){saveAccessorValue(this,e),super._definePropertyAccessor(e,t)}_hasAccessor(e){return this.__dataHasAccessor&&this.__dataHasAccessor[e]}_isPropertyPending(e){return!!(this.__dataPending&&e in this.__dataPending)}}});var propertyAccessors={PropertyAccessors:PropertyAccessors};const walker=document.createTreeWalker(document,NodeFilter.SHOW_ALL,null,!1),templateExtensions={"dom-if":!0,"dom-repeat":!0};function wrapTemplateExtension(e){let t=e.getAttribute("is");if(t&&templateExtensions[t]){let i=e;for(i.removeAttribute("is"),e=i.ownerDocument.createElement(t),i.parentNode.replaceChild(e,i),e.appendChild(i);i.attributes.length;)e.setAttribute(i.attributes[0].name,i.attributes[0].value),i.removeAttribute(i.attributes[0].name)}return e}function findTemplateNode(e,t){let i=t.parentInfo&&findTemplateNode(e,t.parentInfo);if(!i)return e;walker.currentNode=i;for(let e=walker.firstChild(),i=0;e;e=walker.nextSibling())if(t.parentIndex===i++)return e}function applyIdToMap(e,t,i,r){r.id&&(t[r.id]=i)}function applyEventListener(e,t,i){if(i.events&&i.events.length)for(let r,n=0,a=i.events;n<a.length&&(r=a[n]);n++)e._addMethodEventListenerToNode(t,r.name,r.value,e)}function applyTemplateContent(e,t,i){i.templateInfo&&(t._templateInfo=i.templateInfo)}function createNodeEventHandler(e,t,i){e=e._methodHost||e;return function(t){e[i]?e[i](t,t.detail):console.warn("listener method `"+i+"` not defined")}}const TemplateStamp=dedupingMixin(e=>{return class extends e{static _parseTemplate(e,t){if(!e._templateInfo){let i=e._templateInfo={};i.nodeInfoList=[],i.stripWhiteSpace=t&&t.stripWhiteSpace||e.hasAttribute("strip-whitespace"),this._parseTemplateContent(e,i,{parent:null})}return e._templateInfo}static _parseTemplateContent(e,t,i){return this._parseTemplateNode(e.content,t,i)}static _parseTemplateNode(e,t,i){let r,n=e;return"template"!=n.localName||n.hasAttribute("preserve-content")?"slot"===n.localName&&(t.hasInsertionPoint=!0):r=this._parseTemplateNestedTemplate(n,t,i)||r,walker.currentNode=n,walker.firstChild()&&(r=this._parseTemplateChildNodes(n,t,i)||r),n.hasAttributes&&n.hasAttributes()&&(r=this._parseTemplateNodeAttributes(n,t,i)||r),r}static _parseTemplateChildNodes(e,t,i){if("script"!==e.localName&&"style"!==e.localName){walker.currentNode=e;for(let r,n=walker.firstChild(),a=0;n;n=r){if("template"==n.localName&&(n=wrapTemplateExtension(n)),walker.currentNode=n,r=walker.nextSibling(),n.nodeType===Node.TEXT_NODE){let i=r;for(;i&&i.nodeType===Node.TEXT_NODE;)n.textContent+=i.textContent,r=walker.nextSibling(),e.removeChild(i),i=r;if(t.stripWhiteSpace&&!n.textContent.trim()){e.removeChild(n);continue}}let o={parentIndex:a,parentInfo:i};this._parseTemplateNode(n,t,o)&&(o.infoIndex=t.nodeInfoList.push(o)-1),walker.currentNode=n,walker.parentNode()&&a++}}}static _parseTemplateNestedTemplate(e,t,i){let r=this._parseTemplate(e,t);return(r.content=e.content.ownerDocument.createDocumentFragment()).appendChild(e.content),i.templateInfo=r,!0}static _parseTemplateNodeAttributes(e,t,i){let r=!1,n=Array.from(e.attributes);for(let a,o=n.length-1;a=n[o];o--)r=this._parseTemplateNodeAttribute(e,t,i,a.name,a.value)||r;return r}static _parseTemplateNodeAttribute(e,t,i,r,n){return"on-"===r.slice(0,3)?(e.removeAttribute(r),i.events=i.events||[],i.events.push({name:r.slice(3),value:n}),!0):"id"===r&&(i.id=n,!0)}static _contentForTemplate(e){let t=e._templateInfo;return t&&t.content||e.content}_stampTemplate(e){e&&!e.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(e);let t=this.constructor._parseTemplate(e),i=t.nodeInfoList,r=t.content||e.content,n=document.importNode(r,!0);n.__noInsertionPoint=!t.hasInsertionPoint;let a=n.nodeList=Array(i.length);n.$={};for(let e,t,r=0,o=i.length;r<o&&(e=i[r]);r++)t=a[r]=findTemplateNode(n,e),applyIdToMap(this,n.$,t,e),applyTemplateContent(this,t,e),applyEventListener(this,t,e);return n=n}_addMethodEventListenerToNode(e,t,i,r){let n=createNodeEventHandler(r=r||e,t,i);return this._addEventListenerToNode(e,t,n),n}_addEventListenerToNode(e,t,i){e.addEventListener(t,i)}_removeEventListenerFromNode(e,t,i){e.removeEventListener(t,i)}}});var templateStamp={TemplateStamp:TemplateStamp};let dedupeId$1=0;const TYPES={COMPUTE:"__computeEffects",REFLECT:"__reflectEffects",NOTIFY:"__notifyEffects",PROPAGATE:"__propagateEffects",OBSERVE:"__observeEffects",READ_ONLY:"__readOnly"},capitalAttributeRegex=/[A-Z]/;let DataTrigger,DataEffect;function ensureOwnEffectMap(e,t){let i=e[t];if(i){if(!e.hasOwnProperty(t)){i=e[t]=Object.create(e[t]);for(let e in i){let t=i[e],r=i[e]=Array(t.length);for(let e=0;e<t.length;e++)r[e]=t[e]}}}else i=e[t]={};return i}function runEffects(e,t,i,r,n,a){if(t){let o=!1,s=dedupeId$1++;for(let l in i)runEffectsForProperty(e,t,s,l,i,r,n,a)&&(o=!0);return o}return!1}function runEffectsForProperty(e,t,i,r,n,a,o,s){let l=!1,c=t[o?root(r):r];if(c)for(let t,h=0,u=c.length;h<u&&(t=c[h]);h++)t.info&&t.info.lastRun===i||o&&!pathMatchesTrigger(r,t.trigger)||(t.info&&(t.info.lastRun=i),t.fn(e,r,n,a,t.info,o,s),l=!0);return l}function pathMatchesTrigger(e,t){if(t){let i=t.name;return i==e||!(!t.structured||!isAncestor(i,e))||!(!t.wildcard||!isDescendant(i,e))}return!0}function runObserverEffect(e,t,i,r,n){let a="string"==typeof n.method?e[n.method]:n.method,o=n.property;a?a.call(e,e.__data[o],r[o]):n.dynamicFn||console.warn("observer method `"+n.method+"` not defined")}function runNotifyEffects(e,t,i,r,n){let a,o,s=e[TYPES.NOTIFY],l=dedupeId$1++;for(let o in t)t[o]&&(s&&runEffectsForProperty(e,s,l,o,i,r,n)?a=!0:n&&notifyPath(e,o,i)&&(a=!0));a&&(o=e.__dataHost)&&o._invalidateProperties&&o._invalidateProperties()}function notifyPath(e,t,i){let r=root(t);if(r!==t){return dispatchNotifyEvent(e,camelToDashCase(r)+"-changed",i[t],t),!0}return!1}function dispatchNotifyEvent(e,t,i,r){let n={value:i,queueProperty:!0};r&&(n.path=r),wrap$1(e).dispatchEvent(new CustomEvent(t,{detail:n}))}function runNotifyEffect(e,t,i,r,n,a){let o=(a?root(t):t)!=t?t:null,s=o?get(e,o):e.__data[t];o&&void 0===s&&(s=i[t]),dispatchNotifyEvent(e,n.eventName,s,o)}function handleNotification(e,t,i,r,n){let a,o=e.detail,s=o&&o.path;s?(r=translate(i,r,s),a=o&&o.value):a=e.currentTarget[i],a=n?!a:a,t[TYPES.READ_ONLY]&&t[TYPES.READ_ONLY][r]||!t._setPendingPropertyOrPath(r,a,!0,!!s)||o&&o.queueProperty||t._invalidateProperties()}function runReflectEffect(e,t,i,r,n){let a=e.__data[t];sanitizeDOMValue&&(a=sanitizeDOMValue(a,n.attrName,"attribute",e)),e._propertyToAttribute(t,n.attrName,a)}function runComputedEffects(e,t,i,r){let n=e[TYPES.COMPUTE];if(n){let a=t;for(;runEffects(e,n,a,i,r);)Object.assign(i,e.__dataOld),Object.assign(t,e.__dataPending),a=e.__dataPending,e.__dataPending=null}}function runComputedEffect(e,t,i,r,n){let a=runMethodEffect(e,t,i,r,n),o=n.methodInfo;e.__dataHasAccessor&&e.__dataHasAccessor[o]?e._setPendingProperty(o,a,!0):e[o]=a}function computeLinkedPaths(e,t,i){let r=e.__dataLinkedPaths;if(r){let n;for(let a in r){let o=r[a];isDescendant(a,t)?(n=translate(a,o,t),e._setPendingPropertyOrPath(n,i,!0,!0)):isDescendant(o,t)&&(n=translate(o,a,t),e._setPendingPropertyOrPath(n,i,!0,!0))}}}function addBinding(e,t,i,r,n,a,o){i.bindings=i.bindings||[];let s={kind:r,target:n,parts:a,literal:o,isCompound:1!==a.length};if(i.bindings.push(s),shouldAddListener(s)){let{event:e,negate:t}=s.parts[0];s.listenerEvent=e||camelToDashCase(n)+"-changed",s.listenerNegate=t}let l=t.nodeInfoList.length;for(let i,r=0;r<s.parts.length;r++)(i=s.parts[r]).compoundIndex=r,addEffectForBindingPart(e,t,s,i,l)}function addEffectForBindingPart(e,t,i,r,n){if(!r.literal)if("attribute"===i.kind&&"-"===i.target[0])console.warn("Cannot set attribute "+i.target+' because "-" is not a valid attribute starting character');else{let a=r.dependencies,o={index:n,binding:i,part:r,evaluator:e};for(let i,r=0;r<a.length;r++)"string"==typeof(i=a[r])&&((i=parseArg(i)).wildcard=!0),e._addTemplatePropertyEffect(t,i.rootProperty,{fn:runBindingEffect,info:o,trigger:i})}}function runBindingEffect(e,t,i,r,n,a,o){let s=o[n.index],l=n.binding,c=n.part;if(a&&c.source&&t.length>c.source.length&&"property"==l.kind&&!l.isCompound&&s.__isPropertyEffectsClient&&s.__dataHasAccessor&&s.__dataHasAccessor[l.target]){let r=i[t];t=translate(c.source,l.target,t),s._setPendingPropertyOrPath(t,r,!1,!0)&&e._enqueueClient(s)}else{applyBindingValue(e,s,l,c,n.evaluator._evaluateBinding(e,c,t,i,r,a))}}function applyBindingValue(e,t,i,r,n){if(n=computeBindingValue(t,n,i,r),sanitizeDOMValue&&(n=sanitizeDOMValue(n,i.target,i.kind,t)),"attribute"==i.kind)e._valueToNodeAttribute(t,n,i.target);else{let r=i.target;t.__isPropertyEffectsClient&&t.__dataHasAccessor&&t.__dataHasAccessor[r]?t[TYPES.READ_ONLY]&&t[TYPES.READ_ONLY][r]||t._setPendingProperty(r,n)&&e._enqueueClient(t):e._setUnmanagedPropertyToNode(t,r,n)}}function computeBindingValue(e,t,i,r){if(i.isCompound){let n=e.__dataCompoundStorage[i.target];n[r.compoundIndex]=t,t=n.join("")}return"attribute"!==i.kind&&("textContent"!==i.target&&("value"!==i.target||"input"!==e.localName&&"textarea"!==e.localName)||(t=void 0==t?"":t)),t}function shouldAddListener(e){return!!e.target&&"attribute"!=e.kind&&"text"!=e.kind&&!e.isCompound&&"{"===e.parts[0].mode}function setupBindings(e,t){let{nodeList:i,nodeInfoList:r}=t;if(r.length)for(let t=0;t<r.length;t++){let n=r[t],a=i[t],o=n.bindings;if(o)for(let t,i=0;i<o.length;i++)setupCompoundStorage(a,t=o[i]),addNotifyListener(a,e,t);a.__dataHost=e}}function setupCompoundStorage(e,t){if(t.isCompound){let i=e.__dataCompoundStorage||(e.__dataCompoundStorage={}),r=t.parts,n=Array(r.length);for(let e=0;e<r.length;e++)n[e]=r[e].literal;let a=t.target;i[a]=n,t.literal&&"property"==t.kind&&(e[a]=t.literal)}}function addNotifyListener(e,t,i){if(i.listenerEvent){let r=i.parts[0];e.addEventListener(i.listenerEvent,function(e){handleNotification(e,t,i.target,r.source,r.negate)})}}function createMethodEffect(e,t,i,r,n,a){a=t.static||a&&("object"!=typeof a||a[t.methodName]);let o={methodName:t.methodName,args:t.args,methodInfo:n,dynamicFn:a};for(let n,a=0;a<t.args.length&&(n=t.args[a]);a++)n.literal||e._addPropertyEffect(n.rootProperty,i,{fn:r,info:o,trigger:n});a&&e._addPropertyEffect(t.methodName,i,{fn:r,info:o})}function runMethodEffect(e,t,i,r,n){let a=e._methodHost||e,o=a[n.methodName];if(o){let r=e._marshalArgs(n.args,t,i);return o.apply(a,r)}n.dynamicFn||console.warn("method `"+n.methodName+"` not defined")}const emptyArray=[],IDENT="(?:[a-zA-Z_$][\\w.:$\\-*]*)",NUMBER="(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)",SQUOTE_STRING="(?:'(?:[^'\\\\]|\\\\.)*')",DQUOTE_STRING='(?:"(?:[^"\\\\]|\\\\.)*")',STRING="(?:"+SQUOTE_STRING+"|"+DQUOTE_STRING+")",ARGUMENT="(?:("+IDENT+"|"+NUMBER+"|"+STRING+")\\s*)",ARGUMENTS="(?:"+ARGUMENT+"(?:,\\s*"+ARGUMENT+")*)",ARGUMENT_LIST="(?:\\(\\s*(?:"+ARGUMENTS+"?)\\)\\s*)",BINDING="("+IDENT+"\\s*"+ARGUMENT_LIST+"?)",OPEN_BRACKET="(\\[\\[|{{)\\s*",CLOSE_BRACKET="(?:]]|}})",NEGATE="(?:(!)\\s*)?",EXPRESSION=OPEN_BRACKET+NEGATE+BINDING+"(?:]]|}})",bindingRegex=new RegExp(EXPRESSION,"g");function literalFromParts(e){let t="";for(let i,r=0;r<e.length;r++)t+=(i=e[r].literal)||"";return t}function parseMethod(e){let t=e.match(/([^\s]+?)\(([\s\S]*)\)/);if(t){let e={methodName:t[1],static:!0,args:emptyArray};if(t[2].trim()){return parseArgs(t[2].replace(/\\,/g,"&comma;").split(","),e)}return e}return null}function parseArgs(e,t){return t.args=e.map(function(e){let i=parseArg(e);return i.literal||(t.static=!1),i},this),t}function parseArg(e){let t=e.trim().replace(/&comma;/g,",").replace(/\\(.)/g,"$1"),i={name:t,value:"",literal:!1},r=t[0];switch("-"===r&&(r=t[1]),"0"<=r&&"9">=r&&(r="#"),r){case"'":case'"':i.value=t.slice(1,-1),i.literal=!0;break;case"#":i.value=+t,i.literal=!0}return i.literal||(i.rootProperty=root(t),i.structured=isPath(t),i.structured&&(i.wildcard=".*"==t.slice(-2),i.wildcard&&(i.name=t.slice(0,-2)))),i}function getArgValue(e,t,i){let r=get(e,i);return void 0===r&&(r=t[i]),r}function notifySplices(e,t,i,r){e.notifyPath(i+".splices",{indexSplices:r}),e.notifyPath(i+".length",t.length)}function notifySplice(e,t,i,r,n,a){notifySplices(e,t,i,[{index:r,addedCount:n,removed:a,object:t,type:"splice"}])}function upper(e){return e[0].toUpperCase()+e.substring(1)}const PropertyEffects=dedupingMixin(e=>{const t=TemplateStamp(PropertyAccessors(e));return class extends t{constructor(){super(),this.__isPropertyEffectsClient=!0,this.__dataCounter=0,this.__dataClientsReady,this.__dataPendingClients,this.__dataToNotify,this.__dataLinkedPaths,this.__dataHasPaths,this.__dataCompoundStorage,this.__dataHost,this.__dataTemp,this.__dataClientsInitialized,this.__data,this.__dataPending,this.__dataOld,this.__computeEffects,this.__reflectEffects,this.__notifyEffects,this.__propagateEffects,this.__observeEffects,this.__readOnly,this.__templateInfo}get PROPERTY_EFFECT_TYPES(){return TYPES}_initializeProperties(){super._initializeProperties(),hostStack.registerHost(this),this.__dataClientsReady=!1,this.__dataPendingClients=null,this.__dataToNotify=null,this.__dataLinkedPaths=null,this.__dataHasPaths=!1,this.__dataCompoundStorage=this.__dataCompoundStorage||null,this.__dataHost=this.__dataHost||null,this.__dataTemp={},this.__dataClientsInitialized=!1}_initializeProtoProperties(e){this.__data=Object.create(e),this.__dataPending=Object.create(e),this.__dataOld={}}_initializeInstanceProperties(e){let t=this[TYPES.READ_ONLY];for(let i in e)t&&t[i]||(this.__dataPending=this.__dataPending||{},this.__dataOld=this.__dataOld||{},this.__data[i]=this.__dataPending[i]=e[i])}_addPropertyEffect(e,t,i){this._createPropertyAccessor(e,t==TYPES.READ_ONLY);let r=ensureOwnEffectMap(this,t)[e];r||(r=this[t][e]=[]),r.push(i)}_removePropertyEffect(e,t,i){let r=ensureOwnEffectMap(this,t)[e],n=r.indexOf(i);0<=n&&r.splice(n,1)}_hasPropertyEffect(e,t){let i=this[t];return!(!i||!i[e])}_hasReadOnlyEffect(e){return this._hasPropertyEffect(e,TYPES.READ_ONLY)}_hasNotifyEffect(e){return this._hasPropertyEffect(e,TYPES.NOTIFY)}_hasReflectEffect(e){return this._hasPropertyEffect(e,TYPES.REFLECT)}_hasComputedEffect(e){return this._hasPropertyEffect(e,TYPES.COMPUTE)}_setPendingPropertyOrPath(e,t,i,r){if(r||root(Array.isArray(e)?e[0]:e)!==e){if(!r){let i=get(this,e);if(!(e=set(this,e,t))||!super._shouldPropertyChange(e,t,i))return!1}if(this.__dataHasPaths=!0,this._setPendingProperty(e,t,i))return computeLinkedPaths(this,e,t),!0}else{if(this.__dataHasAccessor&&this.__dataHasAccessor[e])return this._setPendingProperty(e,t,i);this[e]=t}return!1}_setUnmanagedPropertyToNode(e,t,i){i===e[t]&&"object"!=typeof i||(e[t]=i)}_setPendingProperty(e,t,i){let r=this.__dataHasPaths&&isPath(e),n=r?this.__dataTemp:this.__data;return!!this._shouldPropertyChange(e,t,n[e])&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),e in this.__dataOld||(this.__dataOld[e]=this.__data[e]),r?this.__dataTemp[e]=t:this.__data[e]=t,this.__dataPending[e]=t,(r||this[TYPES.NOTIFY]&&this[TYPES.NOTIFY][e])&&(this.__dataToNotify=this.__dataToNotify||{},this.__dataToNotify[e]=i),!0)}_setProperty(e,t){this._setPendingProperty(e,t,!0)&&this._invalidateProperties()}_invalidateProperties(){this.__dataReady&&this._flushProperties()}_enqueueClient(e){this.__dataPendingClients=this.__dataPendingClients||[],e!==this&&this.__dataPendingClients.push(e)}_flushProperties(){this.__dataCounter++,super._flushProperties(),this.__dataCounter--}_flushClients(){this.__dataClientsReady?this.__enableOrFlushClients():(this.__dataClientsReady=!0,this._readyClients(),this.__dataReady=!0)}__enableOrFlushClients(){let e=this.__dataPendingClients;if(e){this.__dataPendingClients=null;for(let t,i=0;i<e.length;i++)(t=e[i]).__dataEnabled?t.__dataPending&&t._flushProperties():t._enableProperties()}}_readyClients(){this.__enableOrFlushClients()}setProperties(e,t){for(let i in e)!t&&this[TYPES.READ_ONLY]&&this[TYPES.READ_ONLY][i]||this._setPendingPropertyOrPath(i,e[i],!0);this._invalidateProperties()}ready(){this._flushProperties(),this.__dataClientsReady||this._flushClients(),this.__dataPending&&this._flushProperties()}_propertiesChanged(e,t,i){let r=this.__dataHasPaths;this.__dataHasPaths=!1,runComputedEffects(this,t,i,r);let n=this.__dataToNotify;this.__dataToNotify=null,this._propagatePropertyChanges(t,i,r),this._flushClients(),runEffects(this,this[TYPES.REFLECT],t,i,r),runEffects(this,this[TYPES.OBSERVE],t,i,r),n&&runNotifyEffects(this,n,t,i,r),1==this.__dataCounter&&(this.__dataTemp={})}_propagatePropertyChanges(e,t,i){this[TYPES.PROPAGATE]&&runEffects(this,this[TYPES.PROPAGATE],e,t,i);let r=this.__templateInfo;for(;r;)runEffects(this,r.propertyEffects,e,t,i,r.nodeList),r=r.nextTemplateInfo}linkPaths(e,t){e=normalize(e),t=normalize(t),this.__dataLinkedPaths=this.__dataLinkedPaths||{},this.__dataLinkedPaths[e]=t}unlinkPaths(e){e=normalize(e),this.__dataLinkedPaths&&delete this.__dataLinkedPaths[e]}notifySplices(e,t){let i={path:""};notifySplices(this,get(this,e,i),i.path,t)}get(e,t){return get(t||this,e)}set(e,t,i){i?set(i,e,t):this[TYPES.READ_ONLY]&&this[TYPES.READ_ONLY][e]||this._setPendingPropertyOrPath(e,t,!0)&&this._invalidateProperties()}push(e,...t){let i={path:""},r=get(this,e,i),n=r.length,a=r.push(...t);return t.length&&notifySplice(this,r,i.path,n,t.length,[]),a}pop(e){let t={path:""},i=get(this,e,t),r=!!i.length,n=i.pop();return r&&notifySplice(this,i,t.path,i.length,0,[n]),n}splice(e,t,i,...r){let n,a={path:""},o=get(this,e,a);return 0>t?t=o.length-Math.floor(-t):t&&(t=Math.floor(t)),n=2===arguments.length?o.splice(t):o.splice(t,i,...r),(r.length||n.length)&&notifySplice(this,o,a.path,t,r.length,n),n}shift(e){let t={path:""},i=get(this,e,t),r=!!i.length,n=i.shift();return r&&notifySplice(this,i,t.path,0,0,[n]),n}unshift(e,...t){let i={path:""},r=get(this,e,i),n=r.unshift(...t);return t.length&&notifySplice(this,r,i.path,0,t.length,[]),n}notifyPath(e,t){let i;if(1==arguments.length){let r={path:""};t=get(this,e,r),i=r.path}else i=Array.isArray(e)?normalize(e):e;this._setPendingPropertyOrPath(i,t,!0,!0)&&this._invalidateProperties()}_createReadOnlyProperty(e,t){this._addPropertyEffect(e,TYPES.READ_ONLY),t&&(this["_set"+upper(e)]=function(t){this._setProperty(e,t)})}_createPropertyObserver(e,t,i){let r={property:e,method:t,dynamicFn:!!i};this._addPropertyEffect(e,TYPES.OBSERVE,{fn:runObserverEffect,info:r,trigger:{name:e}}),i&&this._addPropertyEffect(t,TYPES.OBSERVE,{fn:runObserverEffect,info:r,trigger:{name:t}})}_createMethodObserver(e,t){let i=parseMethod(e);if(!i)throw new Error("Malformed observer expression '"+e+"'");createMethodEffect(this,i,TYPES.OBSERVE,runMethodEffect,null,t)}_createNotifyingProperty(e){this._addPropertyEffect(e,TYPES.NOTIFY,{fn:runNotifyEffect,info:{eventName:camelToDashCase(e)+"-changed",property:e}})}_createReflectedProperty(e){let t=this.constructor.attributeNameForProperty(e);"-"===t[0]?console.warn("Property "+e+" cannot be reflected to attribute "+t+' because "-" is not a valid starting attribute name. Use a lowercase first letter for the property instead.'):this._addPropertyEffect(e,TYPES.REFLECT,{fn:runReflectEffect,info:{attrName:t}})}_createComputedProperty(e,t,i){let r=parseMethod(t);if(!r)throw new Error("Malformed computed expression '"+t+"'");createMethodEffect(this,r,TYPES.COMPUTE,runComputedEffect,e,i)}_marshalArgs(e,t,i){const r=this.__data,n=[];for(let a=0,o=e.length;a<o;a++){let{name:o,structured:s,wildcard:l,value:c,literal:h}=e[a];if(!h)if(l){const e=isDescendant(o,t),n=getArgValue(r,i,e?t:o);c={path:e?t:o,value:n,base:e?get(r,o):n}}else c=s?getArgValue(r,i,o):r[o];n[a]=c}return n}static addPropertyEffect(e,t,i){this.prototype._addPropertyEffect(e,t,i)}static createPropertyObserver(e,t,i){this.prototype._createPropertyObserver(e,t,i)}static createMethodObserver(e,t){this.prototype._createMethodObserver(e,t)}static createNotifyingProperty(e){this.prototype._createNotifyingProperty(e)}static createReadOnlyProperty(e,t){this.prototype._createReadOnlyProperty(e,t)}static createReflectedProperty(e){this.prototype._createReflectedProperty(e)}static createComputedProperty(e,t,i){this.prototype._createComputedProperty(e,t,i)}static bindTemplate(e){return this.prototype._bindTemplate(e)}_bindTemplate(e,t){let i=this.constructor._parseTemplate(e),r=this.__templateInfo==i;if(!r)for(let e in i.propertyEffects)this._createPropertyAccessor(e);if(t&&((i=Object.create(i)).wasPreBound=r,!r&&this.__templateInfo)){let e=this.__templateInfoLast||this.__templateInfo;return this.__templateInfoLast=e.nextTemplateInfo=i,i.previousTemplateInfo=e,i}return this.__templateInfo=i}static _addTemplatePropertyEffect(e,t,i){(e.hostProps=e.hostProps||{})[t]=!0;let r=e.propertyEffects=e.propertyEffects||{};(r[t]=r[t]||[]).push(i)}_stampTemplate(e){hostStack.beginHosting(this);let t=super._stampTemplate(e);hostStack.endHosting(this);let i=this._bindTemplate(e,!0);if(i.nodeList=t.nodeList,!i.wasPreBound){let e=i.childNodes=[];for(let i=t.firstChild;i;i=i.nextSibling)e.push(i)}return t.templateInfo=i,setupBindings(this,i),this.__dataReady&&runEffects(this,i.propertyEffects,this.__data,null,!1,i.nodeList),t}_removeBoundDom(e){let t=e.templateInfo;t.previousTemplateInfo&&(t.previousTemplateInfo.nextTemplateInfo=t.nextTemplateInfo),t.nextTemplateInfo&&(t.nextTemplateInfo.previousTemplateInfo=t.previousTemplateInfo),this.__templateInfoLast==t&&(this.__templateInfoLast=t.previousTemplateInfo),t.previousTemplateInfo=t.nextTemplateInfo=null;let i=t.childNodes;for(let e,t=0;t<i.length;t++)(e=i[t]).parentNode.removeChild(e)}static _parseTemplateNode(e,t,i){let r=super._parseTemplateNode(e,t,i);if(e.nodeType===Node.TEXT_NODE){let n=this._parseBindings(e.textContent,t);n&&(e.textContent=literalFromParts(n)||" ",addBinding(this,t,i,"text","textContent",n),r=!0)}return r}static _parseTemplateNodeAttribute(e,t,i,r,n){let a=this._parseBindings(n,t);if(a){let n=r,o="property";capitalAttributeRegex.test(r)?o="attribute":"$"==r[r.length-1]&&(r=r.slice(0,-1),o="attribute");let s=literalFromParts(a);return s&&"attribute"==o&&("class"==r&&e.hasAttribute("class")&&(s+=" "+e.getAttribute(r)),e.setAttribute(r,s)),"input"===e.localName&&"value"===n&&e.setAttribute(n,""),e.removeAttribute(n),"property"===o&&(r=dashToCamelCase(r)),addBinding(this,t,i,o,r,a,s),!0}return super._parseTemplateNodeAttribute(e,t,i,r,n)}static _parseTemplateNestedTemplate(e,t,i){let r=super._parseTemplateNestedTemplate(e,t,i),n=i.templateInfo.hostProps;for(let e in n)addBinding(this,t,i,"property","_host_"+e,[{mode:"{",source:e,dependencies:[e]}]);return r}static _parseBindings(e,t){let i,r=[],n=0;for(;null!==(i=bindingRegex.exec(e));){i.index>n&&r.push({literal:e.slice(n,i.index)});let a=i[1][0],o=!!i[2],s=i[3].trim(),l=!1,c="",h=-1;"{"==a&&0<(h=s.indexOf("::"))&&(c=s.substring(h+2),s=s.substring(0,h),l=!0);let u=parseMethod(s),d=[];if(u){let{args:e,methodName:i}=u;for(let t,i=0;i<e.length;i++)(t=e[i]).literal||d.push(t);let r=t.dynamicFns;(r&&r[i]||u.static)&&(d.push(i),u.dynamicFn=!0)}else d.push(s);r.push({source:s,mode:a,negate:o,customEvent:l,signature:u,dependencies:d,event:c}),n=bindingRegex.lastIndex}if(n&&n<e.length){let t=e.substring(n);t&&r.push({literal:t})}return r.length?r:null}static _evaluateBinding(e,t,i,r,n,a){let o;return o=t.signature?runMethodEffect(e,i,r,n,t.signature):i!=t.source?get(e,t.source):a&&isPath(i)?get(e,i):e.__data[i],t.negate&&(o=!o),o}}});class HostStack{constructor(){this.stack=[]}registerHost(e){if(this.stack.length){this.stack[this.stack.length-1]._enqueueClient(e)}}beginHosting(e){this.stack.push(e)}endHosting(e){let t=this.stack.length;t&&this.stack[t-1]==e&&this.stack.pop()}}const hostStack=new HostStack;var propertyEffects={PropertyEffects:PropertyEffects};let instanceCount=0;function incrementInstanceCount(){instanceCount++}const registrations=[];function _regLog(e){console.log("["+e.is+"]: registered")}function register(e){registrations.push(e)}function dumpRegistrations(){registrations.forEach(_regLog)}var telemetry={get instanceCount(){return instanceCount},incrementInstanceCount:incrementInstanceCount,registrations:registrations,register:register,dumpRegistrations:dumpRegistrations};function normalizeProperties(e){const t={};for(let i in e){const r=e[i];t[i]="function"==typeof r?{type:r}:r}return t}const PropertiesMixin=dedupingMixin(e=>{const t=PropertiesChanged(e);function i(e){const t=Object.getPrototypeOf(e);return t.prototype instanceof n?t:null}function r(e){if(!e.hasOwnProperty(JSCompiler_renameProperty("__ownProperties",e))){let t=null;if(e.hasOwnProperty(JSCompiler_renameProperty("properties",e))){const i=e.properties;i&&(t=normalizeProperties(i))}e.__ownProperties=t}return e.__ownProperties}class n extends t{static get observedAttributes(){if(!this.hasOwnProperty("__observedAttributes")){register(this.prototype);const e=this._properties;this.__observedAttributes=e?Object.keys(e).map(e=>this.attributeNameForProperty(e)):[]}return this.__observedAttributes}static finalize(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__finalized",this))){const e=i(this);e&&e.finalize(),this.__finalized=!0,this._finalizeClass()}}static _finalizeClass(){const e=r(this);e&&this.createProperties(e)}static get _properties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__properties",this))){const e=i(this);this.__properties=Object.assign({},e&&e._properties,r(this))}return this.__properties}static typeForProperty(e){const t=this._properties[e];return t&&t.type}_initializeProperties(){incrementInstanceCount(),this.constructor.finalize(),super._initializeProperties()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._enableProperties()}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback()}}return n});var propertiesMixin={PropertiesMixin:PropertiesMixin};const bundledImportMeta={...import.meta,url:new URL("../../node_modules/%40polymer/polymer/lib/mixins/element-mixin.js",import.meta.url).href},version="3.2.0",builtCSS=window.ShadyCSS&&window.ShadyCSS.cssBuild,ElementMixin=dedupingMixin(e=>{const t=PropertiesMixin(PropertyEffects(e));return class extends t{static get polymerElementVersion(){return version}static _finalizeClass(){super._finalizeClass();const e=((t=this).hasOwnProperty(JSCompiler_renameProperty("__ownObservers",t))||(t.__ownObservers=t.hasOwnProperty(JSCompiler_renameProperty("observers",t))?t.observers:null),t.__ownObservers);var t;e&&this.createObservers(e,this._properties),this._prepareTemplate()}static _prepareTemplate(){let e=this.template;e&&("string"==typeof e?(console.error("template getter must return HTMLTemplateElement"),e=null):legacyOptimizations||(e=e.cloneNode(!0))),this.prototype._template=e}static createProperties(e){for(let a in e)t=this.prototype,i=a,r=e[a],n=e,r.computed&&(r.readOnly=!0),r.computed&&(t._hasReadOnlyEffect(i)?console.warn(`Cannot redefine computed property '${i}'.`):t._createComputedProperty(i,r.computed,n)),r.readOnly&&!t._hasReadOnlyEffect(i)?t._createReadOnlyProperty(i,!r.computed):!1===r.readOnly&&t._hasReadOnlyEffect(i)&&console.warn(`Cannot make readOnly property '${i}' non-readOnly.`),r.reflectToAttribute&&!t._hasReflectEffect(i)?t._createReflectedProperty(i):!1===r.reflectToAttribute&&t._hasReflectEffect(i)&&console.warn(`Cannot make reflected property '${i}' non-reflected.`),r.notify&&!t._hasNotifyEffect(i)?t._createNotifyingProperty(i):!1===r.notify&&t._hasNotifyEffect(i)&&console.warn(`Cannot make notify property '${i}' non-notify.`),r.observer&&t._createPropertyObserver(i,r.observer,n[r.observer]),t._addPropertyToAttributeMap(i);var t,i,r,n}static createObservers(e,t){const i=this.prototype;for(let r=0;r<e.length;r++)i._createMethodObserver(e[r],t)}static get template(){return this.hasOwnProperty(JSCompiler_renameProperty("_template",this))||(this._template=this.prototype.hasOwnProperty(JSCompiler_renameProperty("_template",this.prototype))?this.prototype._template:function(e){let t=null;if(e&&(!strictTemplatePolicy||allowTemplateFromDomModule)&&(t=DomModule.import(e,"template"),strictTemplatePolicy&&!t))throw new Error(`strictTemplatePolicy: expecting dom-module or null template for ${e}`);return t}(this.is)||Object.getPrototypeOf(this.prototype).constructor.template),this._template}static set template(e){this._template=e}static get importPath(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_importPath",this))){const e=this.importMeta;if(e)this._importPath=pathFromUrl(e.url);else{const e=DomModule.import(this.is);this._importPath=e&&e.assetpath||Object.getPrototypeOf(this.prototype).constructor.importPath}}return this._importPath}constructor(){super(),this._template,this._importPath,this.rootPath,this.importPath,this.root,this.$}_initializeProperties(){this.constructor.finalize(),this.constructor._finalizeTemplate(this.localName),super._initializeProperties(),this.rootPath=rootPath,this.importPath=this.constructor.importPath;let e=function(e){if(!e.hasOwnProperty(JSCompiler_renameProperty("__propertyDefaults",e))){e.__propertyDefaults=null;let t=e._properties;for(let i in t){let r=t[i];"value"in r&&(e.__propertyDefaults=e.__propertyDefaults||{},e.__propertyDefaults[i]=r)}}return e.__propertyDefaults}(this.constructor);if(e)for(let t in e){let i=e[t];if(!this.hasOwnProperty(t)){let e="function"==typeof i.value?i.value.call(this):i.value;this._hasAccessor(t)?this._setPendingProperty(t,e,!0):this[t]=e}}}static _processStyleText(e,t){return resolveCss(e,t)}static _finalizeTemplate(e){const t=this.prototype._template;if(t&&!t.__polymerFinalized){t.__polymerFinalized=!0;const i=this.importPath;!function(e,t,i,r){if(!builtCSS){const n=t.content.querySelectorAll("style"),a=stylesFromTemplate(t),o=stylesFromModuleImports(i),s=t.content.firstElementChild;for(let i,n=0;n<o.length;n++)(i=o[n]).textContent=e._processStyleText(i.textContent,r),t.content.insertBefore(i,s);let l=0;for(let t=0;t<a.length;t++){let i=a[t],o=n[l];o!==i?(i=i.cloneNode(!0),o.parentNode.insertBefore(i,o)):l++,i.textContent=e._processStyleText(i.textContent,r)}}window.ShadyCSS&&window.ShadyCSS.prepareTemplate(t,i)}(this,t,e,i?resolveUrl(i):""),this.prototype._bindTemplate(t)}}connectedCallback(){window.ShadyCSS&&this._template&&window.ShadyCSS.styleElement(this),super.connectedCallback()}ready(){this._template&&(this.root=this._stampTemplate(this._template),this.$=this.root.$),super.ready()}_readyClients(){this._template&&(this.root=this._attachDom(this.root)),super._readyClients()}_attachDom(e){const t=wrap$1(this);if(t.attachShadow)return e?(t.shadowRoot||t.attachShadow({mode:"open"}),t.shadowRoot.appendChild(e),syncInitialRender&&window.ShadyDOM&&ShadyDOM.flushInitial(t.shadowRoot),t.shadowRoot):null;throw new Error("ShadowDOM not available. PolymerElement can create dom as children instead of in ShadowDOM by setting `this.root = this;` before `ready`.")}updateStyles(e){window.ShadyCSS&&window.ShadyCSS.styleSubtree(this,e)}resolveUrl(e,t){return!t&&this.importPath&&(t=resolveUrl(this.importPath)),resolveUrl(e,t)}static _parseTemplateContent(e,t,i){return t.dynamicFns=t.dynamicFns||this._properties,super._parseTemplateContent(e,t,i)}static _addTemplatePropertyEffect(e,t,i){return!legacyOptimizations||t in this._properties||console.warn(`Property '${t}' used in template but not declared in 'properties'; `+"attribute will not be observed."),super._addTemplatePropertyEffect(e,t,i)}}}),updateStyles=function(e){window.ShadyCSS&&window.ShadyCSS.styleDocument(e)};var elementMixin={version:version,ElementMixin:ElementMixin,updateStyles:updateStyles};class Debouncer{constructor(){this._asyncModule=null,this._callback=null,this._timer=null}setConfig(e,t){this._asyncModule=e,this._callback=t,this._timer=this._asyncModule.run(()=>{this._timer=null,debouncerQueue.delete(this),this._callback()})}cancel(){this.isActive()&&(this._cancelAsync(),debouncerQueue.delete(this))}_cancelAsync(){this.isActive()&&(this._asyncModule.cancel(this._timer),this._timer=null)}flush(){this.isActive()&&(this.cancel(),this._callback())}isActive(){return null!=this._timer}static debounce(e,t,i){return e instanceof Debouncer?e._cancelAsync():e=new Debouncer,e.setConfig(t,i),e}}let debouncerQueue=new Set;const enqueueDebouncer=function(e){debouncerQueue.add(e)},flushDebouncers=function(){const e=!!debouncerQueue.size;return debouncerQueue.forEach(e=>{try{e.flush()}catch(e){setTimeout(()=>{throw e})}}),e};var debounce={Debouncer:Debouncer,enqueueDebouncer:enqueueDebouncer,flushDebouncers:flushDebouncers};let HAS_NATIVE_TA="string"==typeof document.head.style.touchAction,GESTURE_KEY="__polymerGestures",HANDLED_OBJ="__polymerGesturesHandled",TOUCH_ACTION="__polymerGesturesTouchAction",TAP_DISTANCE=25,TRACK_DISTANCE=5,TRACK_LENGTH=2,MOUSE_TIMEOUT=2500,MOUSE_EVENTS=["mousedown","mousemove","mouseup","click"],MOUSE_WHICH_TO_BUTTONS=[0,1,4,2],MOUSE_HAS_BUTTONS=function(){try{return 1===new MouseEvent("test",{buttons:1}).buttons}catch(e){return!1}}();function isMouseEvent(e){return-1<MOUSE_EVENTS.indexOf(e)}let SUPPORTS_PASSIVE=!1;function PASSIVE_TOUCH(e){if(!isMouseEvent(e)&&"touchend"!==e)return HAS_NATIVE_TA&&SUPPORTS_PASSIVE&&passiveTouchGestures?{passive:!0}:void 0}!function(){try{let e=Object.defineProperty({},"passive",{get(){SUPPORTS_PASSIVE=!0}});window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){}}();let IS_TOUCH_ONLY=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/);const clickedLabels=[],labellable={button:!0,input:!0,keygen:!0,meter:!0,output:!0,textarea:!0,progress:!0,select:!0},canBeDisabled={button:!0,command:!0,fieldset:!0,input:!0,keygen:!0,optgroup:!0,option:!0,select:!0,textarea:!0};function canBeLabelled(e){return labellable[e.localName]||!1}function matchingLabels(e){let t=Array.prototype.slice.call(e.labels||[]);if(!t.length){t=[];let i=e.getRootNode();if(e.id){let r=i.querySelectorAll(`label[for = ${e.id}]`);for(let e=0;e<r.length;e++)t.push(r[e])}}return t}let mouseCanceller=function(e){let t=e.sourceCapabilities;if((!t||t.firesTouchEvents)&&(e[HANDLED_OBJ]={skip:!0},"click"===e.type)){let t=!1,i=getComposedPath(e);for(let e=0;e<i.length;e++){if(i[e].nodeType===Node.ELEMENT_NODE)if("label"===i[e].localName)clickedLabels.push(i[e]);else if(canBeLabelled(i[e])){let r=matchingLabels(i[e]);for(let e=0;e<r.length;e++)t=t||-1<clickedLabels.indexOf(r[e])}if(i[e]===POINTERSTATE.mouse.target)return}if(t)return;e.preventDefault(),e.stopPropagation()}};function setupTeardownMouseCanceller(e){let t=IS_TOUCH_ONLY?["click"]:MOUSE_EVENTS;for(let i,r=0;r<t.length;r++)i=t[r],e?(clickedLabels.length=0,document.addEventListener(i,mouseCanceller,!0)):document.removeEventListener(i,mouseCanceller,!0)}function ignoreMouse(e){POINTERSTATE.mouse.mouseIgnoreJob||setupTeardownMouseCanceller(!0);POINTERSTATE.mouse.target=getComposedPath(e)[0],POINTERSTATE.mouse.mouseIgnoreJob=Debouncer.debounce(POINTERSTATE.mouse.mouseIgnoreJob,timeOut.after(MOUSE_TIMEOUT),function(){setupTeardownMouseCanceller(),POINTERSTATE.mouse.target=null,POINTERSTATE.mouse.mouseIgnoreJob=null})}function hasLeftMouseButton(e){let t=e.type;if(!isMouseEvent(t))return!1;if("mousemove"===t){let t=void 0===e.buttons?1:e.buttons;return e instanceof window.MouseEvent&&!MOUSE_HAS_BUTTONS&&(t=MOUSE_WHICH_TO_BUTTONS[e.which]||0),!!(1&t)}return 0===(void 0===e.button?0:e.button)}function isSyntheticClick(e){if("click"===e.type){if(0===e.detail)return!0;let t=_findOriginalTarget(e);if(!t.nodeType||t.nodeType!==Node.ELEMENT_NODE)return!0;let i=t.getBoundingClientRect(),r=e.pageX,n=e.pageY;return!(r>=i.left&&r<=i.right&&n>=i.top&&n<=i.bottom)}return!1}let POINTERSTATE={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:!1}};function firstTouchAction(e){let t="auto",i=getComposedPath(e);for(let e,r=0;r<i.length;r++)if((e=i[r])[TOUCH_ACTION]){t=e[TOUCH_ACTION];break}return t}function trackDocument(e,t,i){e.movefn=t,e.upfn=i,document.addEventListener("mousemove",t),document.addEventListener("mouseup",i)}function untrackDocument(e){document.removeEventListener("mousemove",e.movefn),document.removeEventListener("mouseup",e.upfn),e.movefn=null,e.upfn=null}document.addEventListener("touchend",ignoreMouse,!!SUPPORTS_PASSIVE&&{passive:!0});const getComposedPath=window.ShadyDOM&&window.ShadyDOM.noPatch?window.ShadyDOM.composedPath:e=>e.composedPath&&e.composedPath()||[],gestures={},recognizers=[];function deepTargetFind(e,t){let i=document.elementFromPoint(e,t),r=i;for(;r&&r.shadowRoot&&!window.ShadyDOM;){if(r===(r=r.shadowRoot.elementFromPoint(e,t)))break;r&&(i=r)}return i}function _findOriginalTarget(e){const t=getComposedPath(e);return 0<t.length?t[0]:e.target}function _handleNative(e){let t,i=e.type,r=e.currentTarget[GESTURE_KEY];if(!r)return;let n=r[i];if(n){if(!e[HANDLED_OBJ]&&(e[HANDLED_OBJ]={},"touch"===i.slice(0,5))){let t=(e=e).changedTouches[0];if("touchstart"===i&&1===e.touches.length&&(POINTERSTATE.touch.id=t.identifier),POINTERSTATE.touch.id!==t.identifier)return;HAS_NATIVE_TA||"touchstart"!==i&&"touchmove"!==i||_handleTouchAction(e)}if(!(t=e[HANDLED_OBJ]).skip){for(let i,r=0;r<recognizers.length;r++)n[(i=recognizers[r]).name]&&!t[i.name]&&i.flow&&-1<i.flow.start.indexOf(e.type)&&i.reset&&i.reset();for(let r,a=0;a<recognizers.length;a++)n[(r=recognizers[a]).name]&&!t[r.name]&&(t[r.name]=!0,r[i](e))}}}function _handleTouchAction(e){let t=e.changedTouches[0],i=e.type;if("touchstart"===i)POINTERSTATE.touch.x=t.clientX,POINTERSTATE.touch.y=t.clientY,POINTERSTATE.touch.scrollDecided=!1;else if("touchmove"===i){if(POINTERSTATE.touch.scrollDecided)return;POINTERSTATE.touch.scrollDecided=!0;let i=firstTouchAction(e),r=!1,n=Math.abs(POINTERSTATE.touch.x-t.clientX),a=Math.abs(POINTERSTATE.touch.y-t.clientY);e.cancelable&&("none"===i?r=!0:"pan-x"===i?r=a>n:"pan-y"===i&&(r=n>a)),r?e.preventDefault():prevent("track")}}function addListener(e,t,i){return!!gestures[t]&&(_add(e,t,i),!0)}function removeListener(e,t,i){return!!gestures[t]&&(_remove(e,t,i),!0)}function _add(e,t,i){let r=gestures[t],n=r.deps,a=r.name,o=e[GESTURE_KEY];o||(e[GESTURE_KEY]=o={});for(let t,i,r=0;r<n.length;r++)t=n[r],IS_TOUCH_ONLY&&isMouseEvent(t)&&"click"!==t||((i=o[t])||(o[t]=i={_count:0}),0===i._count&&e.addEventListener(t,_handleNative,PASSIVE_TOUCH(t)),i[a]=(i[a]||0)+1,i._count=(i._count||0)+1);e.addEventListener(t,i),r.touchAction&&setTouchAction(e,r.touchAction)}function _remove(e,t,i){let r=gestures[t],n=r.deps,a=r.name,o=e[GESTURE_KEY];if(o)for(let t,i,r=0;r<n.length;r++)(i=o[t=n[r]])&&i[a]&&(i[a]=(i[a]||1)-1,i._count=(i._count||1)-1,0===i._count&&e.removeEventListener(t,_handleNative,PASSIVE_TOUCH(t)));e.removeEventListener(t,i)}function register$1(e){recognizers.push(e);for(let t=0;t<e.emits.length;t++)gestures[e.emits[t]]=e}function _findRecognizerByEvent(e){for(let t,i=0;i<recognizers.length;i++){t=recognizers[i];for(let i,r=0;r<t.emits.length;r++)if((i=t.emits[r])===e)return t}return null}function setTouchAction(e,t){HAS_NATIVE_TA&&e instanceof HTMLElement&&microTask.run(()=>{e.style.touchAction=t}),e[TOUCH_ACTION]=t}function _fire(e,t,i){let r=new Event(t,{bubbles:!0,cancelable:!0,composed:!0});if(r.detail=i,wrap$1(e).dispatchEvent(r),r.defaultPrevented){let e=i.preventer||i.sourceEvent;e&&e.preventDefault&&e.preventDefault()}}function prevent(e){let t=_findRecognizerByEvent(e);t.info&&(t.info.prevent=!0)}function resetMouseCanceller(){POINTERSTATE.mouse.mouseIgnoreJob&&POINTERSTATE.mouse.mouseIgnoreJob.flush()}function downupFire(e,t,i,r){t&&_fire(t,e,{x:i.clientX,y:i.clientY,sourceEvent:i,preventer:r,prevent:function(e){return prevent(e)}})}function trackHasMovedEnough(e,t,i){if(e.prevent)return!1;if(e.started)return!0;let r=Math.abs(e.x-t),n=Math.abs(e.y-i);return r>=TRACK_DISTANCE||n>=TRACK_DISTANCE}function trackFire(e,t,i){if(!t)return;let r,n=e.moves[e.moves.length-2],a=e.moves[e.moves.length-1],o=a.x-e.x,s=a.y-e.y,l=0;n&&(r=a.x-n.x,l=a.y-n.y),_fire(t,"track",{state:e.state,x:i.clientX,y:i.clientY,dx:o,dy:s,ddx:r,ddy:l,sourceEvent:i,hover:function(){return deepTargetFind(i.clientX,i.clientY)}})}function trackForward(e,t,i){let r=Math.abs(t.clientX-e.x),n=Math.abs(t.clientY-e.y),a=_findOriginalTarget(i||t);!a||canBeDisabled[a.localName]&&a.hasAttribute("disabled")||(isNaN(r)||isNaN(n)||r<=TAP_DISTANCE&&n<=TAP_DISTANCE||isSyntheticClick(t))&&(e.prevent||_fire(a,"tap",{x:t.clientX,y:t.clientY,sourceEvent:t,preventer:i}))}register$1({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset:function(){untrackDocument(this.info)},mousedown:function(e){if(!hasLeftMouseButton(e))return;let t=_findOriginalTarget(e),i=this;trackDocument(this.info,function(e){hasLeftMouseButton(e)||(downupFire("up",t,e),untrackDocument(i.info))},function(e){hasLeftMouseButton(e)&&downupFire("up",t,e),untrackDocument(i.info)}),downupFire("down",t,e)},touchstart:function(e){downupFire("down",_findOriginalTarget(e),e.changedTouches[0],e)},touchend:function(e){downupFire("up",_findOriginalTarget(e),e.changedTouches[0],e)}}),register$1({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:!1,moves:[],addMove:function(e){this.moves.length>TRACK_LENGTH&&this.moves.shift(),this.moves.push(e)},movefn:null,upfn:null,prevent:!1},reset:function(){this.info.state="start",this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,this.info.prevent=!1,untrackDocument(this.info)},mousedown:function(e){if(!hasLeftMouseButton(e))return;let t=_findOriginalTarget(e),i=this,r=function(e){let r=e.clientX,n=e.clientY;trackHasMovedEnough(i.info,r,n)&&(i.info.state=i.info.started?"mouseup"===e.type?"end":"track":"start","start"===i.info.state&&prevent("tap"),i.info.addMove({x:r,y:n}),hasLeftMouseButton(e)||(i.info.state="end",untrackDocument(i.info)),t&&trackFire(i.info,t,e),i.info.started=!0)};trackDocument(this.info,r,function(e){i.info.started&&r(e),untrackDocument(i.info)}),this.info.x=e.clientX,this.info.y=e.clientY},touchstart:function(e){let t=e.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchmove:function(e){let t=_findOriginalTarget(e),i=e.changedTouches[0],r=i.clientX,n=i.clientY;trackHasMovedEnough(this.info,r,n)&&("start"===this.info.state&&prevent("tap"),this.info.addMove({x:r,y:n}),trackFire(this.info,t,i),this.info.state="track",this.info.started=!0)},touchend:function(e){let t=_findOriginalTarget(e),i=e.changedTouches[0];this.info.started&&(this.info.state="end",this.info.addMove({x:i.clientX,y:i.clientY}),trackFire(this.info,t,i))}}),register$1({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:!1},reset:function(){this.info.x=NaN,this.info.y=NaN,this.info.prevent=!1},mousedown:function(e){hasLeftMouseButton(e)&&(this.info.x=e.clientX,this.info.y=e.clientY)},click:function(e){hasLeftMouseButton(e)&&trackForward(this.info,e)},touchstart:function(e){const t=e.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchend:function(e){trackForward(this.info,e.changedTouches[0],e)}});const findOriginalTarget=_findOriginalTarget,add=addListener,remove=removeListener;var gestures$1={gestures:gestures,recognizers:recognizers,deepTargetFind:deepTargetFind,addListener:addListener,removeListener:removeListener,register:register$1,setTouchAction:setTouchAction,prevent:prevent,resetMouseCanceller:resetMouseCanceller,findOriginalTarget:findOriginalTarget,add:add,remove:remove};const GestureEventListeners=dedupingMixin(e=>{return class extends e{_addEventListenerToNode(e,t,i){addListener(e,t,i)||super._addEventListenerToNode(e,t,i)}_removeEventListenerFromNode(e,t,i){removeListener(e,t,i)||super._removeEventListenerFromNode(e,t,i)}}});var gestureEventListeners={GestureEventListeners:GestureEventListeners};const HOST_DIR=/:host\(:dir\((ltr|rtl)\)\)/g,HOST_DIR_REPLACMENT=':host([dir="$1"])',EL_DIR=/([\s\w-#\.\[\]\*]*):dir\((ltr|rtl)\)/g,EL_DIR_REPLACMENT=':host([dir="$2"]) $1',DIR_CHECK=/:dir\((?:ltr|rtl)\)/,SHIM_SHADOW=!(!window.ShadyDOM||!window.ShadyDOM.inUse),DIR_INSTANCES=[];let observer=null,DOCUMENT_DIR="";function getRTL(){DOCUMENT_DIR=document.documentElement.getAttribute("dir")}function setRTL(e){if(!e.__autoDirOptOut){e.setAttribute("dir",DOCUMENT_DIR)}}function updateDirection(){getRTL(),DOCUMENT_DIR=document.documentElement.getAttribute("dir");for(let e=0;e<DIR_INSTANCES.length;e++)setRTL(DIR_INSTANCES[e])}function takeRecords(){observer&&observer.takeRecords().length&&updateDirection()}const DirMixin=dedupingMixin(e=>{SHIM_SHADOW||observer||(getRTL(),(observer=new MutationObserver(updateDirection)).observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]}));const t=PropertyAccessors(e);class i extends t{static _processStyleText(e,t){return e=super._processStyleText(e,t),!SHIM_SHADOW&&DIR_CHECK.test(e)&&(e=this._replaceDirInCssText(e),this.__activateDir=!0),e}static _replaceDirInCssText(e){let t=e;return t=(t=t.replace(HOST_DIR,HOST_DIR_REPLACMENT)).replace(EL_DIR,EL_DIR_REPLACMENT)}constructor(){super(),this.__autoDirOptOut=!1}ready(){super.ready(),this.__autoDirOptOut=this.hasAttribute("dir")}connectedCallback(){t.prototype.connectedCallback&&super.connectedCallback(),this.constructor.__activateDir&&(takeRecords(),DIR_INSTANCES.push(this),setRTL(this))}disconnectedCallback(){if(t.prototype.disconnectedCallback&&super.disconnectedCallback(),this.constructor.__activateDir){const e=DIR_INSTANCES.indexOf(this);-1<e&&DIR_INSTANCES.splice(e,1)}}}return i.__activateDir=!1,i});var dirMixin={DirMixin:DirMixin};let scheduled=!1,beforeRenderQueue=[],afterRenderQueue=[];function schedule(){scheduled=!0,requestAnimationFrame(function(){scheduled=!1,flushQueue(beforeRenderQueue),setTimeout(function(){runQueue(afterRenderQueue)})})}function flushQueue(e){for(;e.length;)callMethod(e.shift())}function runQueue(e){for(let t=0,i=e.length;t<i;t++)callMethod(e.shift())}function callMethod(e){const t=e[0],i=e[1],r=e[2];try{i.apply(t,r)}catch(e){setTimeout(()=>{throw e})}}function flush(){for(;beforeRenderQueue.length||afterRenderQueue.length;)flushQueue(beforeRenderQueue),flushQueue(afterRenderQueue);scheduled=!1}function beforeNextRender(e,t,i){scheduled||schedule(),beforeRenderQueue.push([e,t,i])}function afterNextRender(e,t,i){scheduled||schedule(),afterRenderQueue.push([e,t,i])}var renderStatus={flush:flush,beforeNextRender:beforeNextRender,afterNextRender:afterNextRender};function resolve(){document.body.removeAttribute("unresolved")}function newSplice(e,t,i){return{index:e,removed:t,addedCount:i}}"interactive"===document.readyState||"complete"===document.readyState?resolve():window.addEventListener("DOMContentLoaded",resolve);const EDIT_LEAVE=0,EDIT_UPDATE=1,EDIT_ADD=2,EDIT_DELETE=3;function calcEditDistances(e,t,i,r,n,a){let o=a-n+1,s=i-t+1,l=Array(o);for(let e=0;e<o;e++)l[e]=Array(s),l[e][0]=e;for(let e=0;e<s;e++)l[0][e]=e;for(let i=1;i<o;i++)for(let a=1;a<s;a++)if(equals(e[t+a-1],r[n+i-1]))l[i][a]=l[i-1][a-1];else{let e=l[i-1][a]+1,t=l[i][a-1]+1;l[i][a]=e<t?e:t}return l}function spliceOperationsFromEditDistances(e){let t=e.length-1,i=e[0].length-1,r=e[t][i],n=[];for(;0<t||0<i;){if(0==t){n.push(EDIT_ADD),i--;continue}if(0==i){n.push(EDIT_DELETE),t--;continue}let a,o=e[t-1][i-1],s=e[t-1][i],l=e[t][i-1];(a=s<l?s<o?s:o:l<o?l:o)==o?(o==r?n.push(EDIT_LEAVE):(n.push(EDIT_UPDATE),r=o),t--,i--):a==s?(n.push(EDIT_DELETE),t--,r=s):(n.push(EDIT_ADD),i--,r=l)}return n.reverse(),n}function calcSplices(e,t,i,r,n,a){let o,s=0,l=0,c=Math.min(i-t,a-n);if(0==t&&0==n&&(s=sharedPrefix(e,r,c)),i==e.length&&a==r.length&&(l=sharedSuffix(e,r,c-s)),n+=s,a-=l,0==(i-=l)-(t+=s)&&0==a-n)return[];if(t==i){for(o=newSplice(t,[],0);n<a;)o.removed.push(r[n++]);return[o]}if(n==a)return[newSplice(t,[],i-t)];let h=spliceOperationsFromEditDistances(calcEditDistances(e,t,i,r,n,a));o=void 0;let u=[],d=t,p=n;for(let e=0;e<h.length;e++)switch(h[e]){case EDIT_LEAVE:o&&(u.push(o),o=void 0),d++,p++;break;case EDIT_UPDATE:o||(o=newSplice(d,[],0)),o.addedCount++,d++,o.removed.push(r[p]),p++;break;case EDIT_ADD:o||(o=newSplice(d,[],0)),o.addedCount++,d++;break;case EDIT_DELETE:o||(o=newSplice(d,[],0)),o.removed.push(r[p]),p++}return o&&u.push(o),u}function sharedPrefix(e,t,i){for(let r=0;r<i;r++)if(!equals(e[r],t[r]))return r;return i}function sharedSuffix(e,t,i){let r=e.length,n=t.length,a=0;for(;a<i&&equals(e[--r],t[--n]);)a++;return a}function calculateSplices(e,t){return calcSplices(e,0,e.length,t,0,t.length)}function equals(e,t){return e===t}var arraySplice={calculateSplices:calculateSplices};function isSlot(e){return"slot"===e.localName}let FlattenedNodesObserver=class{static getFlattenedNodes(e){const t=wrap$1(e);return isSlot(e)?(e=e,t.assignedNodes({flatten:!0})):Array.from(t.childNodes).map(e=>isSlot(e)?wrap$1(e=e).assignedNodes({flatten:!0}):[e]).reduce((e,t)=>e.concat(t),[])}constructor(e,t){this._shadyChildrenObserver=null,this._nativeChildrenObserver=null,this._connected=!1,this._target=e,this.callback=t,this._effectiveNodes=[],this._observer=null,this._scheduled=!1,this._boundSchedule=(()=>{this._schedule()}),this.connect(),this._schedule()}connect(){isSlot(this._target)?this._listenSlots([this._target]):wrap$1(this._target).children&&(this._listenSlots(wrap$1(this._target).children),window.ShadyDOM?this._shadyChildrenObserver=ShadyDOM.observeChildren(this._target,e=>{this._processMutations(e)}):(this._nativeChildrenObserver=new MutationObserver(e=>{this._processMutations(e)}),this._nativeChildrenObserver.observe(this._target,{childList:!0}))),this._connected=!0}disconnect(){isSlot(this._target)?this._unlistenSlots([this._target]):wrap$1(this._target).children&&(this._unlistenSlots(wrap$1(this._target).children),window.ShadyDOM&&this._shadyChildrenObserver?(ShadyDOM.unobserveChildren(this._shadyChildrenObserver),this._shadyChildrenObserver=null):this._nativeChildrenObserver&&(this._nativeChildrenObserver.disconnect(),this._nativeChildrenObserver=null)),this._connected=!1}_schedule(){this._scheduled||(this._scheduled=!0,microTask.run(()=>this.flush()))}_processMutations(e){this._processSlotMutations(e),this.flush()}_processSlotMutations(e){if(e)for(let t,i=0;i<e.length;i++)(t=e[i]).addedNodes&&this._listenSlots(t.addedNodes),t.removedNodes&&this._unlistenSlots(t.removedNodes)}flush(){if(!this._connected)return!1;window.ShadyDOM&&ShadyDOM.flush(),this._nativeChildrenObserver?this._processSlotMutations(this._nativeChildrenObserver.takeRecords()):this._shadyChildrenObserver&&this._processSlotMutations(this._shadyChildrenObserver.takeRecords()),this._scheduled=!1;let e={target:this._target,addedNodes:[],removedNodes:[]},t=this.constructor.getFlattenedNodes(this._target),i=calculateSplices(t,this._effectiveNodes);for(let t,r=0;r<i.length&&(t=i[r]);r++)for(let i,r=0;r<t.removed.length&&(i=t.removed[r]);r++)e.removedNodes.push(i);for(let r,n=0;n<i.length&&(r=i[n]);n++)for(let i=r.index;i<r.index+r.addedCount;i++)e.addedNodes.push(t[i]);this._effectiveNodes=t;let r=!1;return(e.addedNodes.length||e.removedNodes.length)&&(r=!0,this.callback.call(this._target,e)),r}_listenSlots(e){for(let t,i=0;i<e.length;i++)isSlot(t=e[i])&&t.addEventListener("slotchange",this._boundSchedule)}_unlistenSlots(e){for(let t,i=0;i<e.length;i++)isSlot(t=e[i])&&t.removeEventListener("slotchange",this._boundSchedule)}};var flattenedNodesObserver={FlattenedNodesObserver:FlattenedNodesObserver};const flush$1=function(){let e,t;do{e=window.ShadyDOM&&ShadyDOM.flush(),window.ShadyCSS&&window.ShadyCSS.ScopingShim&&window.ShadyCSS.ScopingShim.flush(),t=flushDebouncers()}while(e||t)};var flush$2={flush:flush$1,enqueueDebouncer:enqueueDebouncer};const p=Element.prototype,normalizedMatchesSelector=p.matches||p.matchesSelector||p.mozMatchesSelector||p.msMatchesSelector||p.oMatchesSelector||p.webkitMatchesSelector,matchesSelector=function(e,t){return normalizedMatchesSelector.call(e,t)};class DomApiNative{constructor(e){this.node=e}observeNodes(e){return new FlattenedNodesObserver(this.node,e)}unobserveNodes(e){e.disconnect()}notifyObserver(){}deepContains(e){if(wrap$1(this.node).contains(e))return!0;let t=e,i=e.ownerDocument;for(;t&&t!==i&&t!==this.node;)t=wrap$1(t).parentNode||wrap$1(t).host;return t===this.node}getOwnerRoot(){return wrap$1(this.node).getRootNode()}getDistributedNodes(){return"slot"===this.node.localName?wrap$1(this.node).assignedNodes({flatten:!0}):[]}getDestinationInsertionPoints(){let e=[],t=wrap$1(this.node).assignedSlot;for(;t;)e.push(t),t=wrap$1(t).assignedSlot;return e}importNode(e,t){let i=this.node instanceof Document?this.node:this.node.ownerDocument;return wrap$1(i).importNode(e,t)}getEffectiveChildNodes(){return FlattenedNodesObserver.getFlattenedNodes(this.node)}queryDistributedElements(e){let t=this.getEffectiveChildNodes(),i=[];for(let r,n=0,a=t.length;n<a&&(r=t[n]);n++)r.nodeType===Node.ELEMENT_NODE&&matchesSelector(r,e)&&i.push(r);return i}get activeElement(){let e=this.node;return void 0!==e._activeElement?e._activeElement:e.activeElement}}function forwardMethods(e,t){for(let i,r=0;r<t.length;r++)e[i=t[r]]=function(){return this.node[i].apply(this.node,arguments)}}function forwardReadOnlyProperties(e,t){for(let i,r=0;r<t.length;r++)i=t[r],Object.defineProperty(e,i,{get:function(){return this.node[i]},configurable:!0})}function forwardProperties(e,t){for(let i,r=0;r<t.length;r++)i=t[r],Object.defineProperty(e,i,{get:function(){return this.node[i]},set:function(e){this.node[i]=e},configurable:!0})}class EventApi{constructor(e){this.event=e}get rootTarget(){return this.path[0]}get localTarget(){return this.event.target}get path(){return this.event.composedPath()}}DomApiNative.prototype.cloneNode,DomApiNative.prototype.appendChild,DomApiNative.prototype.insertBefore,DomApiNative.prototype.removeChild,DomApiNative.prototype.replaceChild,DomApiNative.prototype.setAttribute,DomApiNative.prototype.removeAttribute,DomApiNative.prototype.querySelector,DomApiNative.prototype.querySelectorAll,DomApiNative.prototype.parentNode,DomApiNative.prototype.firstChild,DomApiNative.prototype.lastChild,DomApiNative.prototype.nextSibling,DomApiNative.prototype.previousSibling,DomApiNative.prototype.firstElementChild,DomApiNative.prototype.lastElementChild,DomApiNative.prototype.nextElementSibling,DomApiNative.prototype.previousElementSibling,DomApiNative.prototype.childNodes,DomApiNative.prototype.children,DomApiNative.prototype.classList,DomApiNative.prototype.textContent,DomApiNative.prototype.innerHTML;let DomApiImpl=DomApiNative;if(window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.noPatch&&window.ShadyDOM.Wrapper){class e extends window.ShadyDOM.Wrapper{}Object.getOwnPropertyNames(DomApiNative.prototype).forEach(t=>{"activeElement"!=t&&(e.prototype[t]=DomApiNative.prototype[t])}),forwardReadOnlyProperties(e.prototype,["classList"]),DomApiImpl=e,Object.defineProperties(EventApi.prototype,{localTarget:{get(){return this.event.currentTarget},configurable:!0},path:{get(){return window.ShadyDOM.composedPath(this.event)},configurable:!0}})}else forwardMethods(DomApiNative.prototype,["cloneNode","appendChild","insertBefore","removeChild","replaceChild","setAttribute","removeAttribute","querySelector","querySelectorAll"]),forwardReadOnlyProperties(DomApiNative.prototype,["parentNode","firstChild","lastChild","nextSibling","previousSibling","firstElementChild","lastElementChild","nextElementSibling","previousElementSibling","childNodes","children","classList"]),forwardProperties(DomApiNative.prototype,["textContent","innerHTML"]);const DomApi=DomApiImpl,dom=function(e){if((e=e||document)instanceof DomApiImpl)return e;if(e instanceof EventApi)return e;let t=e.__domApi;return t||(t=e instanceof Event?new EventApi(e):new DomApiImpl(e),e.__domApi=t),t};var polymer_dom={matchesSelector:matchesSelector,EventApi:EventApi,DomApi:DomApi,dom:dom,flush:flush$1,addDebouncer:enqueueDebouncer};const bundledImportMeta$1={...import.meta,url:new URL("../../node_modules/%40polymer/polymer/lib/legacy/legacy-element-mixin.js",import.meta.url).href};let styleInterface=window.ShadyCSS;const LegacyElementMixin=dedupingMixin(e=>{const t=DirMixin(GestureEventListeners(ElementMixin(e))),i={x:"pan-x",y:"pan-y",none:"none",all:"auto"};class r extends t{constructor(){super(),this.isAttached,this.__boundListeners,this._debouncers}static get importMeta(){return this.prototype.importMeta}created(){}connectedCallback(){super.connectedCallback(),this.isAttached=!0,this.attached()}attached(){}disconnectedCallback(){super.disconnectedCallback(),this.isAttached=!1,this.detached()}detached(){}attributeChangedCallback(e,t,i,r){t!==i&&(super.attributeChangedCallback(e,t,i,r),this.attributeChanged(e,t,i))}attributeChanged(e,t,i){}_initializeProperties(){let e=Object.getPrototypeOf(this);e.hasOwnProperty("__hasRegisterFinished")||(this._registered(),e.__hasRegisterFinished=!0),super._initializeProperties(),this.root=this,this.created(),this._applyListeners()}_registered(){}ready(){this._ensureAttributes(),super.ready()}_ensureAttributes(){}_applyListeners(){}serialize(e){return this._serializeValue(e)}deserialize(e,t){return this._deserializeValue(e,t)}reflectPropertyToAttribute(e,t,i){this._propertyToAttribute(e,t,i)}serializeValueToAttribute(e,t,i){this._valueToNodeAttribute(i||this,e,t)}extend(e,t){if(!e||!t)return e||t;let i=Object.getOwnPropertyNames(t);for(let r,n,a=0;a<i.length&&(r=i[a]);a++)(n=Object.getOwnPropertyDescriptor(t,r))&&Object.defineProperty(e,r,n);return e}mixin(e,t){for(let i in t)e[i]=t[i];return e}chainObject(e,t){return e&&t&&e!==t&&(e.__proto__=t),e}instanceTemplate(e){let t=this.constructor._contentForTemplate(e);return document.importNode(t,!0)}fire(e,t,i){i=i||{},t=null===t||void 0===t?{}:t;let r=new Event(e,{bubbles:void 0===i.bubbles||i.bubbles,cancelable:!!i.cancelable,composed:void 0===i.composed||i.composed});r.detail=t;let n=i.node||this;return wrap$1(n).dispatchEvent(r),r}listen(e,t,i){e=e||this;let r=this.__boundListeners||(this.__boundListeners=new WeakMap),n=r.get(e);n||(n={},r.set(e,n));let a=t+i;n[a]||(n[a]=this._addMethodEventListenerToNode(e,t,i,this))}unlisten(e,t,i){e=e||this;let r=this.__boundListeners&&this.__boundListeners.get(e),n=t+i,a=r&&r[n];a&&(this._removeEventListenerFromNode(e,t,a),r[n]=null)}setScrollDirection(e,t){setTouchAction(t||this,i[e]||"auto")}$$(e){return this.root.querySelector(e)}get domHost(){let e=wrap$1(this).getRootNode();return e instanceof DocumentFragment?e.host:e}distributeContent(){const e=dom(this);window.ShadyDOM&&e.shadowRoot&&ShadyDOM.flush()}getEffectiveChildNodes(){return dom(this).getEffectiveChildNodes()}queryDistributedElements(e){return dom(this).queryDistributedElements(e)}getEffectiveChildren(){return this.getEffectiveChildNodes().filter(function(e){return e.nodeType===Node.ELEMENT_NODE})}getEffectiveTextContent(){let e=this.getEffectiveChildNodes(),t=[];for(let i,r=0;i=e[r];r++)i.nodeType!==Node.COMMENT_NODE&&t.push(i.textContent);return t.join("")}queryEffectiveChildren(e){let t=this.queryDistributedElements(e);return t&&t[0]}queryAllEffectiveChildren(e){return this.queryDistributedElements(e)}getContentChildNodes(e){let t=this.root.querySelector(e||"slot");return t?dom(t).getDistributedNodes():[]}getContentChildren(e){return this.getContentChildNodes(e).filter(function(e){return e.nodeType===Node.ELEMENT_NODE})}isLightDescendant(e){return this!==e&&wrap$1(this).contains(e)&&wrap$1(this).getRootNode()===wrap$1(e).getRootNode()}isLocalDescendant(e){return this.root===wrap$1(e).getRootNode()}scopeSubtree(e,t){}getComputedStyleValue(e){return styleInterface.getComputedStyleValue(this,e)}debounce(e,t,i){return this._debouncers=this._debouncers||{},this._debouncers[e]=Debouncer.debounce(this._debouncers[e],0<i?timeOut.after(i):microTask,t.bind(this))}isDebouncerActive(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];return!(!t||!t.isActive())}flushDebouncer(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];t&&t.flush()}cancelDebouncer(e){this._debouncers=this._debouncers||{};let t=this._debouncers[e];t&&t.cancel()}async(e,t){return 0<t?timeOut.run(e.bind(this),t):~microTask.run(e.bind(this))}cancelAsync(e){0>e?microTask.cancel(~e):timeOut.cancel(e)}create(e,t){let i=document.createElement(e);if(t)if(i.setProperties)i.setProperties(t);else for(let e in t)i[e]=t[e];return i}elementMatches(e,t){return matchesSelector(t||this,e)}toggleAttribute(e,t){let i=this;return 3===arguments.length&&(i=arguments[2]),1==arguments.length&&(t=!i.hasAttribute(e)),t?(wrap$1(i).setAttribute(e,""),!0):(wrap$1(i).removeAttribute(e),!1)}toggleClass(e,t,i){i=i||this,1==arguments.length&&(t=!i.classList.contains(e)),t?i.classList.add(e):i.classList.remove(e)}transform(e,t){(t=t||this).style.webkitTransform=e,t.style.transform=e}translate3d(e,t,i,r){r=r||this,this.transform("translate3d("+e+","+t+","+i+")",r)}arrayDelete(e,t){let i;if(Array.isArray(e)){if(0<=(i=e.indexOf(t)))return e.splice(i,1)}else{if(0<=(i=get(this,e).indexOf(t)))return this.splice(e,i,1)}return null}_logger(e,t){switch(Array.isArray(t)&&1===t.length&&Array.isArray(t[0])&&(t=t[0]),e){case"log":case"warn":case"error":console[e](...t)}}_log(...e){this._logger("log",e)}_warn(...e){this._logger("warn",e)}_error(...e){this._logger("error",e)}_logf(e,...t){return["[%s::%s]",this.is,e,...t]}}return r.prototype.is="",r});var legacyElementMixin={LegacyElementMixin:LegacyElementMixin};const lifecycleProps={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,listeners:!0,hostAttributes:!0},excludeOnInfo={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,behaviors:!0,_noAccessors:!0},excludeOnBehaviors=Object.assign({listeners:!0,hostAttributes:!0,properties:!0,observers:!0},excludeOnInfo);function copyProperties(e,t,i){const r=e._noAccessors,n=Object.getOwnPropertyNames(e);for(let a,o=0;o<n.length;o++)if(!((a=n[o])in i))if(r)t[a]=e[a];else{let i=Object.getOwnPropertyDescriptor(e,a);i&&(i.configurable=!0,Object.defineProperty(t,a,i))}}function mixinBehaviors(e,t){return GenerateClassFromInfo({},LegacyElementMixin(t),e)}function applyBehaviors(e,t,i){for(let r=0;r<t.length;r++)applyInfo(e,t[r],i,excludeOnBehaviors)}function applyInfo(e,t,i,r){copyProperties(t,e,r);for(let e in lifecycleProps)t[e]&&(i[e]=i[e]||[],i[e].push(t[e]))}function flattenBehaviors(e,t,i){t=t||[];for(let r,n=e.length-1;0<=n;n--)(r=e[n])?Array.isArray(r)?flattenBehaviors(r,t):0>t.indexOf(r)&&(!i||0>i.indexOf(r))&&t.unshift(r):console.warn("behavior is null, check for missing or 404 import");return t}function mergeProperties(e,t){for(const i in t){const r=e[i],n=t[i];e[i]=!("value"in n)&&r&&"value"in r?Object.assign({value:r.value},n):n}}function GenerateClassFromInfo(e,t,i){let r;const n={};class a extends t{static _finalizeClass(){if(this.hasOwnProperty(JSCompiler_renameProperty("generatedFrom",this))){if(r)for(let e,t=0;t<r.length;t++)(e=r[t]).properties&&this.createProperties(e.properties),e.observers&&this.createObservers(e.observers,e.properties);e.properties&&this.createProperties(e.properties),e.observers&&this.createObservers(e.observers,e.properties),this._prepareTemplate()}else super._finalizeClass()}static get properties(){const t={};if(r)for(let e=0;e<r.length;e++)mergeProperties(t,r[e].properties);return mergeProperties(t,e.properties),t}static get observers(){let t=[];if(r)for(let e,i=0;i<r.length;i++)(e=r[i]).observers&&(t=t.concat(e.observers));return e.observers&&(t=t.concat(e.observers)),t}created(){super.created();const e=n.created;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}_registered(){const e=a.prototype;if(!e.hasOwnProperty("__hasRegisterFinished")){e.__hasRegisterFinished=!0,super._registered(),legacyOptimizations&&o(e);const t=Object.getPrototypeOf(this);let i=n.beforeRegister;if(i)for(let e=0;e<i.length;e++)i[e].call(t);if(i=n.registered)for(let e=0;e<i.length;e++)i[e].call(t)}}_applyListeners(){super._applyListeners();const e=n.listeners;if(e)for(let t=0;t<e.length;t++){const i=e[t];if(i)for(let e in i)this._addMethodEventListenerToNode(this,e,i[e])}}_ensureAttributes(){const e=n.hostAttributes;if(e)for(let t=e.length-1;0<=t;t--){const i=e[t];for(let e in i)this._ensureAttribute(e,i[e])}super._ensureAttributes()}ready(){super.ready();let e=n.ready;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}attached(){super.attached();let e=n.attached;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}detached(){super.detached();let e=n.detached;if(e)for(let t=0;t<e.length;t++)e[t].call(this)}attributeChanged(e,t,i){super.attributeChanged();let r=n.attributeChanged;if(r)for(let n=0;n<r.length;n++)r[n].call(this,e,t,i)}}if(i){Array.isArray(i)||(i=[i]);let e=t.prototype.behaviors;r=flattenBehaviors(i,null,e),a.prototype.behaviors=e?e.concat(i):r}const o=t=>{r&&applyBehaviors(t,r,n),applyInfo(t,e,n,excludeOnInfo)};return legacyOptimizations||o(a.prototype),a.generatedFrom=e,a}const Class=function(e,t){e||console.warn("Polymer.Class requires `info` argument");let i=t?t(LegacyElementMixin(HTMLElement)):LegacyElementMixin(HTMLElement);return(i=GenerateClassFromInfo(e,i,e.behaviors)).is=i.prototype.is=e.is,i};var _class={mixinBehaviors:mixinBehaviors,Class:Class};const Polymer=function(e){let t;return t="function"==typeof e?e:Polymer.Class(e),customElements.define(t.is,t),t};Polymer.Class=Class;var polymerFn={Polymer:Polymer};function mutablePropertyChange(e,t,i,r,n){let a;n&&(a="object"==typeof i&&null!==i)&&(r=e.__dataTemp[t]);let o=r!==i&&(r==r||i==i);return a&&o&&(e.__dataTemp[t]=i),o}const MutableData=dedupingMixin(e=>{return class extends e{_shouldPropertyChange(e,t,i){return mutablePropertyChange(this,e,t,i,!0)}}}),OptionalMutableData=dedupingMixin(e=>{return class extends e{static get properties(){return{mutableData:Boolean}}_shouldPropertyChange(e,t,i){return mutablePropertyChange(this,e,t,i,this.mutableData)}}});MutableData._mutablePropertyChange=mutablePropertyChange;var mutableData={MutableData:MutableData,OptionalMutableData:OptionalMutableData};let newInstance=null;function HTMLTemplateElementExtension(){return newInstance}HTMLTemplateElementExtension.prototype=Object.create(HTMLTemplateElement.prototype,{constructor:{value:HTMLTemplateElementExtension,writable:!0}});const DataTemplate=PropertyEffects(HTMLTemplateElementExtension),MutableDataTemplate=MutableData(DataTemplate);function upgradeTemplate(e,t){newInstance=e,Object.setPrototypeOf(e,t.prototype),new t,newInstance=null}const templateInstanceBase=PropertyEffects(class{});class TemplateInstanceBase extends templateInstanceBase{constructor(e){super(),this._configureProperties(e),this.root=this._stampTemplate(this.__dataHost);let t=this.children=[];for(let e=this.root.firstChild;e;e=e.nextSibling)t.push(e),e.__templatizeInstance=this;this.__templatizeOwner&&this.__templatizeOwner.__hideTemplateChildren__&&this._showHideChildren(!0);let i=this.__templatizeOptions;(e&&i.instanceProps||!i.instanceProps)&&this._enableProperties()}_configureProperties(e){if(this.__templatizeOptions.forwardHostProp)for(let e in this.__hostProps)this._setPendingProperty(e,this.__dataHost["_host_"+e]);for(let t in e)this._setPendingProperty(t,e[t])}forwardHostProp(e,t){this._setPendingPropertyOrPath(e,t,!1,!0)&&this.__dataHost._enqueueClient(this)}_addEventListenerToNode(e,t,i){if(this._methodHost&&this.__templatizeOptions.parentModel)this._methodHost._addEventListenerToNode(e,t,e=>{e.model=this,i(e)});else{let r=this.__dataHost.__dataHost;r&&r._addEventListenerToNode(e,t,i)}}_showHideChildren(e){let t=this.children;for(let i,r=0;r<t.length;r++){if(!!e!=!!(i=t[r]).__hideTemplateChildren__)if(i.nodeType===Node.TEXT_NODE)e?(i.__polymerTextContent__=i.textContent,i.textContent=""):i.textContent=i.__polymerTextContent__;else if("slot"===i.localName)if(e)i.__polymerReplaced__=document.createComment("hidden-slot"),wrap$1(wrap$1(i).parentNode).replaceChild(i.__polymerReplaced__,i);else{const e=i.__polymerReplaced__;e&&wrap$1(wrap$1(e).parentNode).replaceChild(i,e)}else i.style&&(e?(i.__polymerDisplay__=i.style.display,i.style.display="none"):i.style.display=i.__polymerDisplay__);i.__hideTemplateChildren__=e,i._showHideChildren&&i._showHideChildren(e)}}_setUnmanagedPropertyToNode(e,t,i){e.__hideTemplateChildren__&&e.nodeType==Node.TEXT_NODE&&"textContent"==t?e.__polymerTextContent__=i:super._setUnmanagedPropertyToNode(e,t,i)}get parentModel(){let e=this.__parentModel;if(!e){let t;e=this;do{e=e.__dataHost.__dataHost}while((t=e.__templatizeOptions)&&!t.parentModel);this.__parentModel=e}return e}dispatchEvent(e){return!0}}TemplateInstanceBase.prototype.__dataHost,TemplateInstanceBase.prototype.__templatizeOptions,TemplateInstanceBase.prototype._methodHost,TemplateInstanceBase.prototype.__templatizeOwner,TemplateInstanceBase.prototype.__hostProps;const MutableTemplateInstanceBase=MutableData(TemplateInstanceBase);function findMethodHost(e){let t=e.__dataHost;return t&&t._methodHost||t}function createTemplatizerClass(e,t,i){let r=i.mutableData?MutableTemplateInstanceBase:TemplateInstanceBase;templatize.mixin&&(r=templatize.mixin(r));let n=class extends r{};return n.prototype.__templatizeOptions=i,n.prototype._bindTemplate(e),addNotifyEffects(n,e,t,i),n}function addPropagateEffects(e,t,i){let r=i.forwardHostProp;if(r){let n=t.templatizeTemplateClass;if(!n){let e=i.mutableData?MutableDataTemplate:DataTemplate;n=t.templatizeTemplateClass=class extends e{};let a=t.hostProps;for(let e in a)n.prototype._addPropertyEffect("_host_"+e,n.prototype.PROPERTY_EFFECT_TYPES.PROPAGATE,{fn:createForwardHostPropEffect(e,r)}),n.prototype._createNotifyingProperty("_host_"+e)}upgradeTemplate(e,n),e.__dataProto&&Object.assign(e.__data,e.__dataProto),e.__dataTemp={},e.__dataPending=null,e.__dataOld=null,e._enableProperties()}}function createForwardHostPropEffect(e,t){return function(e,i,r){t.call(e.__templatizeOwner,i.substring("_host_".length),r[i])}}function addNotifyEffects(e,t,i,r){let n=i.hostProps||{};for(let t in r.instanceProps){delete n[t];let i=r.notifyInstanceProp;i&&e.prototype._addPropertyEffect(t,e.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:createNotifyInstancePropEffect(t,i)})}if(r.forwardHostProp&&t.__dataHost)for(let t in n)e.prototype._addPropertyEffect(t,e.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:createNotifyHostPropEffect()})}function createNotifyInstancePropEffect(e,t){return function(e,i,r){t.call(e.__templatizeOwner,e,i,r[i])}}function createNotifyHostPropEffect(){return function(e,t,i){e.__dataHost._setPendingPropertyOrPath("_host_"+t,i[t],!0,!0)}}function templatize(e,t,i){if(strictTemplatePolicy&&!findMethodHost(e))throw new Error("strictTemplatePolicy: template owner not trusted");if(i=i||{},e.__templatizeOwner)throw new Error("A <template> can only be templatized once");e.__templatizeOwner=t;let r=(t?t.constructor:TemplateInstanceBase)._parseTemplate(e),n=r.templatizeInstanceClass;n||(n=createTemplatizerClass(e,r,i),r.templatizeInstanceClass=n),addPropagateEffects(e,r,i);let a=class extends n{};return a.prototype._methodHost=findMethodHost(e),a.prototype.__dataHost=e,a.prototype.__templatizeOwner=t,a.prototype.__hostProps=r.hostProps,a=a}function modelForElement(e,t){let i;for(;t;)if(i=t.__templatizeInstance){if(i.__dataHost==e)return i;t=i.__dataHost}else t=wrap$1(t).parentNode;return null}var templatize$1={templatize:templatize,modelForElement:modelForElement,TemplateInstanceBase:TemplateInstanceBase};let TemplatizerUser;const Templatizer={templatize(e,t){this._templatizerTemplate=e,this.ctor=templatize(e,this,{mutableData:!!t,parentModel:this._parentModel,instanceProps:this._instanceProps,forwardHostProp:this._forwardHostPropV2,notifyInstanceProp:this._notifyInstancePropV2})},stamp(e){return new this.ctor(e)},modelForElement(e){return modelForElement(this._templatizerTemplate,e)}};var templatizerBehavior={Templatizer:Templatizer};const domBindBase=GestureEventListeners(OptionalMutableData(PropertyEffects(HTMLElement)));class DomBind extends domBindBase{static get observedAttributes(){return["mutable-data"]}constructor(){if(super(),strictTemplatePolicy)throw new Error("strictTemplatePolicy: dom-bind not allowed");this.root=null,this.$=null,this.__children=null}attributeChangedCallback(){this.mutableData=!0}connectedCallback(){this.style.display="none",this.render()}disconnectedCallback(){this.__removeChildren()}__insertChildren(){wrap$1(wrap$1(this).parentNode).insertBefore(this.root,this)}__removeChildren(){if(this.__children)for(let e=0;e<this.__children.length;e++)this.root.appendChild(this.__children[e])}render(){let e;if(!this.__children){if(!(e=e||this.querySelector("template"))){let t=new MutationObserver(()=>{if(!(e=this.querySelector("template")))throw new Error("dom-bind requires a <template> child");t.disconnect(),this.render()});return void t.observe(this,{childList:!0})}this.root=this._stampTemplate(e),this.$=this.root.$,this.__children=[];for(let e=this.root.firstChild;e;e=e.nextSibling)this.__children[this.__children.length]=e;this._enableProperties()}this.__insertChildren(),this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}}customElements.define("dom-bind",DomBind);var domBind={DomBind:DomBind};class LiteralString{constructor(e){this.value=e.toString()}toString(){return this.value}}function literalValue(e){if(e instanceof LiteralString)return e.value;throw new Error(`non-literal value passed to Polymer's htmlLiteral function: ${e}`)}function htmlValue(e){if(e instanceof HTMLTemplateElement)return e.innerHTML;if(e instanceof LiteralString)return literalValue(e);throw new Error(`non-template value passed to Polymer's html function: ${e}`)}const html=function(e,...t){const i=document.createElement("template");return i.innerHTML=t.reduce((t,i,r)=>t+htmlValue(i)+e[r+1],e[0]),i},htmlLiteral=function(e,...t){return new LiteralString(t.reduce((t,i,r)=>t+literalValue(i)+e[r+1],e[0]))};var htmlTag={html:html,htmlLiteral:htmlLiteral};const PolymerElement=ElementMixin(HTMLElement);var polymerElement={version:version,PolymerElement:PolymerElement,html:html};const domRepeatBase=OptionalMutableData(PolymerElement);class DomRepeat extends domRepeatBase{static get is(){return"dom-repeat"}static get template(){return null}static get properties(){return{items:{type:Array},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},itemsIndexAs:{type:String,value:"itemsIndex"},sort:{type:Function,observer:"__sortChanged"},filter:{type:Function,observer:"__filterChanged"},observe:{type:String,observer:"__observeChanged"},delay:Number,renderedItemCount:{type:Number,notify:!0,readOnly:!0},initialCount:{type:Number,observer:"__initializeChunking"},targetFramerate:{type:Number,value:20},_targetFrameTime:{type:Number,computed:"__computeFrameTime(targetFramerate)"}}}static get observers(){return["__itemsChanged(items.*)"]}constructor(){super(),this.__instances=[],this.__limit=1/0,this.__pool=[],this.__renderDebouncer=null,this.__itemsIdxToInstIdx={},this.__chunkCount=null,this.__lastChunkTime=null,this.__sortFn=null,this.__filterFn=null,this.__observePaths=null,this.__ctor=null,this.__isDetached=!0,this.template=null}disconnectedCallback(){super.disconnectedCallback(),this.__isDetached=!0;for(let e=0;e<this.__instances.length;e++)this.__detachInstance(e)}connectedCallback(){if(super.connectedCallback(),this.style.display="none",this.__isDetached){this.__isDetached=!1;let e=wrap$1(wrap$1(this).parentNode);for(let t=0;t<this.__instances.length;t++)this.__attachInstance(t,e)}}__ensureTemplatized(){if(!this.__ctor){let e=this.template=this.querySelector("template");if(!e){let e=new MutationObserver(()=>{if(!this.querySelector("template"))throw new Error("dom-repeat requires a <template> child");e.disconnect(),this.__render()});return e.observe(this,{childList:!0}),!1}let t={};t[this.as]=!0,t[this.indexAs]=!0,t[this.itemsIndexAs]=!0,this.__ctor=templatize(e,this,{mutableData:this.mutableData,parentModel:!0,instanceProps:t,forwardHostProp:function(e,t){let i=this.__instances;for(let r,n=0;n<i.length&&(r=i[n]);n++)r.forwardHostProp(e,t)},notifyInstanceProp:function(e,t,i){if(matches(this.as,t)){let r=e[this.itemsIndexAs];t==this.as&&(this.items[r]=i);let n=translate(this.as,`${JSCompiler_renameProperty("items",this)}.${r}`,t);this.notifyPath(n,i)}}})}return!0}__getMethodHost(){return this.__dataHost._methodHost||this.__dataHost}__functionFromPropertyValue(e){if("string"==typeof e){let t=e,i=this.__getMethodHost();return function(){return i[t].apply(i,arguments)}}return e}__sortChanged(e){this.__sortFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__filterChanged(e){this.__filterFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__computeFrameTime(e){return Math.ceil(1e3/e)}__initializeChunking(){this.initialCount&&(this.__limit=this.initialCount,this.__chunkCount=this.initialCount,this.__lastChunkTime=performance.now())}__tryRenderChunk(){this.items&&this.__limit<this.items.length&&this.__debounceRender(this.__requestRenderChunk)}__requestRenderChunk(){requestAnimationFrame(()=>this.__renderChunk())}__renderChunk(){let e=performance.now(),t=this._targetFrameTime/(e-this.__lastChunkTime);this.__chunkCount=Math.round(this.__chunkCount*t)||1,this.__limit+=this.__chunkCount,this.__lastChunkTime=e,this.__debounceRender(this.__render)}__observeChanged(){this.__observePaths=this.observe&&this.observe.replace(".*",".").split(" ")}__itemsChanged(e){this.items&&!Array.isArray(this.items)&&console.warn("dom-repeat expected array for `items`, found",this.items),this.__handleItemPath(e.path,e.value)||(this.__initializeChunking(),this.__debounceRender(this.__render))}__handleObservedPaths(e){if(this.__sortFn||this.__filterFn)if(e){if(this.__observePaths){let t=this.__observePaths;for(let i=0;i<t.length;i++)0===e.indexOf(t[i])&&this.__debounceRender(this.__render,this.delay)}}else this.__debounceRender(this.__render,this.delay)}__debounceRender(e,t=0){this.__renderDebouncer=Debouncer.debounce(this.__renderDebouncer,0<t?timeOut.after(t):microTask,e.bind(this)),enqueueDebouncer(this.__renderDebouncer)}render(){this.__debounceRender(this.__render),flush$1()}__render(){this.__ensureTemplatized()&&(this.__applyFullRefresh(),this.__pool.length=0,this._setRenderedItemCount(this.__instances.length),this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0})),this.__tryRenderChunk())}__applyFullRefresh(){let e=this.items||[],t=Array(e.length);for(let i=0;i<e.length;i++)t[i]=i;this.__filterFn&&(t=t.filter((t,i,r)=>this.__filterFn(e[t],i,r))),this.__sortFn&&t.sort((t,i)=>this.__sortFn(e[t],e[i]));const i=this.__itemsIdxToInstIdx={};let r=0;const n=Math.min(t.length,this.__limit);for(;r<n;r++){let n=this.__instances[r],a=t[r],o=e[a];i[a]=r,n?(n._setPendingProperty(this.as,o),n._setPendingProperty(this.indexAs,r),n._setPendingProperty(this.itemsIndexAs,a),n._flushProperties()):this.__insertInstance(o,r,a)}for(let e=this.__instances.length-1;e>=r;e--)this.__detachAndRemoveInstance(e)}__detachInstance(e){let t=this.__instances[e];const i=wrap$1(t.root);for(let e,r=0;r<t.children.length;r++)e=t.children[r],i.appendChild(e);return t}__attachInstance(e,t){let i=this.__instances[e];t.insertBefore(i.root,this)}__detachAndRemoveInstance(e){let t=this.__detachInstance(e);t&&this.__pool.push(t),this.__instances.splice(e,1)}__stampInstance(e,t,i){let r={};return r[this.as]=e,r[this.indexAs]=t,r[this.itemsIndexAs]=i,new this.__ctor(r)}__insertInstance(e,t,i){let r=this.__pool.pop();r?(r._setPendingProperty(this.as,e),r._setPendingProperty(this.indexAs,t),r._setPendingProperty(this.itemsIndexAs,i),r._flushProperties()):r=this.__stampInstance(e,t,i);let n=this.__instances[t+1],a=n?n.children[0]:this;return wrap$1(wrap$1(this).parentNode).insertBefore(r.root,a),this.__instances[t]=r,r}_showHideChildren(e){for(let t=0;t<this.__instances.length;t++)this.__instances[t]._showHideChildren(e)}__handleItemPath(e,t){let i=e.slice(6),r=i.indexOf("."),n=0>r?i:i.substring(0,r);if(n==parseInt(n,10)){let e=0>r?"":i.substring(r+1);this.__handleObservedPaths(e);let a=this.__itemsIdxToInstIdx[n],o=this.__instances[a];if(o){let i=this.as+(e?"."+e:"");o._setPendingPropertyOrPath(i,t,!1,!0),o._flushProperties()}return!0}}itemForElement(e){let t=this.modelForElement(e);return t&&t[this.as]}indexForElement(e){let t=this.modelForElement(e);return t&&t[this.indexAs]}modelForElement(e){return modelForElement(this.template,e)}}customElements.define(DomRepeat.is,DomRepeat);var domRepeat={DomRepeat:DomRepeat};class DomIf extends PolymerElement{static get is(){return"dom-if"}static get template(){return null}static get properties(){return{if:{type:Boolean,observer:"__debounceRender"},restamp:{type:Boolean,observer:"__debounceRender"}}}constructor(){super(),this.__renderDebouncer=null,this.__invalidProps=null,this.__instance=null,this._lastIf=!1,this.__ctor=null,this.__hideTemplateChildren__=!1}__debounceRender(){this.__renderDebouncer=Debouncer.debounce(this.__renderDebouncer,microTask,()=>this.__render()),enqueueDebouncer(this.__renderDebouncer)}disconnectedCallback(){super.disconnectedCallback();const e=wrap$1(this).parentNode;e&&(e.nodeType!=Node.DOCUMENT_FRAGMENT_NODE||wrap$1(e).host)||this.__teardownInstance()}connectedCallback(){super.connectedCallback(),this.style.display="none",this.if&&this.__debounceRender()}render(){flush$1()}__render(){if(this.if){if(!this.__ensureInstance())return;this._showHideChildren()}else this.restamp&&this.__teardownInstance();!this.restamp&&this.__instance&&this._showHideChildren(),this.if!=this._lastIf&&(this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0})),this._lastIf=this.if)}__ensureInstance(){let e=wrap$1(this).parentNode;if(e){if(!this.__ctor){let e=wrap$1(this).querySelector("template");if(!e){let e=new MutationObserver(()=>{if(!wrap$1(this).querySelector("template"))throw new Error("dom-if requires a <template> child");e.disconnect(),this.__render()});return e.observe(this,{childList:!0}),!1}this.__ctor=templatize(e,this,{mutableData:!0,forwardHostProp:function(e,t){this.__instance&&(this.if?this.__instance.forwardHostProp(e,t):(this.__invalidProps=this.__invalidProps||Object.create(null),this.__invalidProps[root(e)]=!0))}})}if(this.__instance){this.__syncHostProperties();let t=this.__instance.children;if(t&&t.length){if(wrap$1(this).previousSibling!==t[t.length-1])for(let i,r=0;r<t.length&&(i=t[r]);r++)wrap$1(e).insertBefore(i,this)}}else this.__instance=new this.__ctor,wrap$1(e).insertBefore(this.__instance.root,this)}return!0}__syncHostProperties(){let e=this.__invalidProps;if(e){for(let t in e)this.__instance._setPendingProperty(t,this.__dataHost[t]);this.__invalidProps=null,this.__instance._flushProperties()}}__teardownInstance(){if(this.__instance){let e=this.__instance.children;if(e&&e.length){let t=wrap$1(e[0]).parentNode;if(t){t=wrap$1(t);for(let i,r=0;r<e.length&&(i=e[r]);r++)t.removeChild(i)}}this.__instance=null,this.__invalidProps=null}}_showHideChildren(){let e=this.__hideTemplateChildren__||!this.if;this.__instance&&this.__instance._showHideChildren(e)}}customElements.define(DomIf.is,DomIf);var domIf={DomIf:DomIf};let ArraySelectorMixin=dedupingMixin(e=>{let t=ElementMixin(e);return class extends t{static get properties(){return{items:{type:Array},multi:{type:Boolean,value:!1},selected:{type:Object,notify:!0},selectedItem:{type:Object,notify:!0},toggle:{type:Boolean,value:!1}}}static get observers(){return["__updateSelection(multi, items.*)"]}constructor(){super(),this.__lastItems=null,this.__lastMulti=null,this.__selectedMap=null}__updateSelection(e,t){let i=t.path;if(i==JSCompiler_renameProperty("items",this)){let i=t.base||[],r=this.__lastItems;if(e!==this.__lastMulti&&this.clearSelection(),r){let e=calculateSplices(i,r);this.__applySplices(e)}this.__lastItems=i,this.__lastMulti=e}else if(`${JSCompiler_renameProperty("items",this)}.splices`==t.path)this.__applySplices(t.value.indexSplices);else{let e=i.slice(`${JSCompiler_renameProperty("items",this)}.`.length),t=parseInt(e,10);0>e.indexOf(".")&&e==t&&this.__deselectChangedIdx(t)}}__applySplices(e){let t=this.__selectedMap;for(let i,r=0;r<e.length;r++){i=e[r],t.forEach((e,r)=>{e<i.index||(e>=i.index+i.removed.length?t.set(r,e+i.addedCount-i.removed.length):t.set(r,-1))});for(let e,r=0;r<i.addedCount;r++)e=i.index+r,t.has(this.items[e])&&t.set(this.items[e],e)}this.__updateLinks();let i=0;t.forEach((e,r)=>{0>e?(this.multi?this.splice(JSCompiler_renameProperty("selected",this),i,1):this.selected=this.selectedItem=null,t.delete(r)):i++})}__updateLinks(){if(this.__dataLinkedPaths={},this.multi){let e=0;this.__selectedMap.forEach(t=>{0<=t&&this.linkPaths(`${JSCompiler_renameProperty("items",this)}.${t}`,`${JSCompiler_renameProperty("selected",this)}.${e++}`)})}else this.__selectedMap.forEach(e=>{this.linkPaths(JSCompiler_renameProperty("selected",this),`${JSCompiler_renameProperty("items",this)}.${e}`),this.linkPaths(JSCompiler_renameProperty("selectedItem",this),`${JSCompiler_renameProperty("items",this)}.${e}`)})}clearSelection(){this.__dataLinkedPaths={},this.__selectedMap=new Map,this.selected=this.multi?[]:null,this.selectedItem=null}isSelected(e){return this.__selectedMap.has(e)}isIndexSelected(e){return this.isSelected(this.items[e])}__deselectChangedIdx(e){let t=this.__selectedIndexForItemIndex(e);if(0<=t){let e=0;this.__selectedMap.forEach((i,r)=>{t==e++&&this.deselect(r)})}}__selectedIndexForItemIndex(e){let t=this.__dataLinkedPaths[`${JSCompiler_renameProperty("items",this)}.${e}`];if(t)return parseInt(t.slice(`${JSCompiler_renameProperty("selected",this)}.`.length),10)}deselect(e){let t=this.__selectedMap.get(e);if(0<=t){let i;this.__selectedMap.delete(e),this.multi&&(i=this.__selectedIndexForItemIndex(t)),this.__updateLinks(),this.multi?this.splice(JSCompiler_renameProperty("selected",this),i,1):this.selected=this.selectedItem=null}}deselectIndex(e){this.deselect(this.items[e])}select(e){this.selectIndex(this.items.indexOf(e))}selectIndex(e){let t=this.items[e];this.isSelected(t)?this.toggle&&this.deselectIndex(e):(this.multi||this.__selectedMap.clear(),this.__selectedMap.set(t,e),this.__updateLinks(),this.multi?this.push(JSCompiler_renameProperty("selected",this),t):this.selected=this.selectedItem=t)}}}),baseArraySelector=ArraySelectorMixin(PolymerElement);class ArraySelector extends baseArraySelector{static get is(){return"array-selector"}static get template(){return null}}customElements.define(ArraySelector.is,ArraySelector);var arraySelector={ArraySelectorMixin:ArraySelectorMixin,ArraySelector:ArraySelector};const customStyleInterface$1=new CustomStyleInterface;window.ShadyCSS||(window.ShadyCSS={prepareTemplate(e,t,i){},prepareTemplateDom(e,t){},prepareTemplateStyles(e,t,i){},styleSubtree(e,t){customStyleInterface$1.processStyles(),updateNativeProperties(e,t)},styleElement(e){customStyleInterface$1.processStyles()},styleDocument(e){customStyleInterface$1.processStyles(),updateNativeProperties(document.body,e)},getComputedStyleValue:(e,t)=>getComputedStyleValue(e,t),flushCustomStyles(){},nativeCss:nativeCssVariables,nativeShadow:nativeShadow,cssBuild:cssBuild,disableRuntime:disableRuntime}),window.ShadyCSS.CustomStyleInterface=customStyleInterface$1;const attr="include",CustomStyleInterface$1=window.ShadyCSS.CustomStyleInterface;class CustomStyle extends HTMLElement{constructor(){super(),this._style=null,CustomStyleInterface$1.addCustomStyle(this)}getStyle(){if(this._style)return this._style;const e=this.querySelector("style");if(!e)return null;this._style=e;const t=e.getAttribute(attr);return t&&(e.removeAttribute(attr),e.textContent=cssFromModules(t)+e.textContent),this.ownerDocument!==window.document&&window.document.head.appendChild(this),this._style}}window.customElements.define("custom-style",CustomStyle);var customStyle={CustomStyle:CustomStyle};let mutablePropertyChange$1;mutablePropertyChange$1=MutableData._mutablePropertyChange;const MutableDataBehavior={_shouldPropertyChange(e,t,i){return mutablePropertyChange$1(this,e,t,i,!0)}},OptionalMutableDataBehavior={properties:{mutableData:Boolean},_shouldPropertyChange(e,t,i){return mutablePropertyChange$1(this,e,t,i,this.mutableData)}};var mutableDataBehavior={MutableDataBehavior:MutableDataBehavior,OptionalMutableDataBehavior:OptionalMutableDataBehavior};const Base=LegacyElementMixin(HTMLElement).prototype;var polymerLegacy={Base:Base,Polymer:Polymer,html:html};const template=html`
<custom-style>
  <style is="custom-style">
    [hidden] {
      display: none !important;
    }
  </style>
</custom-style>
<custom-style>
  <style is="custom-style">
    html {

      --layout: {
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;
      };

      --layout-inline: {
        display: -ms-inline-flexbox;
        display: -webkit-inline-flex;
        display: inline-flex;
      };

      --layout-horizontal: {
        @apply --layout;

        -ms-flex-direction: row;
        -webkit-flex-direction: row;
        flex-direction: row;
      };

      --layout-horizontal-reverse: {
        @apply --layout;

        -ms-flex-direction: row-reverse;
        -webkit-flex-direction: row-reverse;
        flex-direction: row-reverse;
      };

      --layout-vertical: {
        @apply --layout;

        -ms-flex-direction: column;
        -webkit-flex-direction: column;
        flex-direction: column;
      };

      --layout-vertical-reverse: {
        @apply --layout;

        -ms-flex-direction: column-reverse;
        -webkit-flex-direction: column-reverse;
        flex-direction: column-reverse;
      };

      --layout-wrap: {
        -ms-flex-wrap: wrap;
        -webkit-flex-wrap: wrap;
        flex-wrap: wrap;
      };

      --layout-wrap-reverse: {
        -ms-flex-wrap: wrap-reverse;
        -webkit-flex-wrap: wrap-reverse;
        flex-wrap: wrap-reverse;
      };

      --layout-flex-auto: {
        -ms-flex: 1 1 auto;
        -webkit-flex: 1 1 auto;
        flex: 1 1 auto;
      };

      --layout-flex-none: {
        -ms-flex: none;
        -webkit-flex: none;
        flex: none;
      };

      --layout-flex: {
        -ms-flex: 1 1 0.000000001px;
        -webkit-flex: 1;
        flex: 1;
        -webkit-flex-basis: 0.000000001px;
        flex-basis: 0.000000001px;
      };

      --layout-flex-2: {
        -ms-flex: 2;
        -webkit-flex: 2;
        flex: 2;
      };

      --layout-flex-3: {
        -ms-flex: 3;
        -webkit-flex: 3;
        flex: 3;
      };

      --layout-flex-4: {
        -ms-flex: 4;
        -webkit-flex: 4;
        flex: 4;
      };

      --layout-flex-5: {
        -ms-flex: 5;
        -webkit-flex: 5;
        flex: 5;
      };

      --layout-flex-6: {
        -ms-flex: 6;
        -webkit-flex: 6;
        flex: 6;
      };

      --layout-flex-7: {
        -ms-flex: 7;
        -webkit-flex: 7;
        flex: 7;
      };

      --layout-flex-8: {
        -ms-flex: 8;
        -webkit-flex: 8;
        flex: 8;
      };

      --layout-flex-9: {
        -ms-flex: 9;
        -webkit-flex: 9;
        flex: 9;
      };

      --layout-flex-10: {
        -ms-flex: 10;
        -webkit-flex: 10;
        flex: 10;
      };

      --layout-flex-11: {
        -ms-flex: 11;
        -webkit-flex: 11;
        flex: 11;
      };

      --layout-flex-12: {
        -ms-flex: 12;
        -webkit-flex: 12;
        flex: 12;
      };

      /* alignment in cross axis */

      --layout-start: {
        -ms-flex-align: start;
        -webkit-align-items: flex-start;
        align-items: flex-start;
      };

      --layout-center: {
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
      };

      --layout-end: {
        -ms-flex-align: end;
        -webkit-align-items: flex-end;
        align-items: flex-end;
      };

      --layout-baseline: {
        -ms-flex-align: baseline;
        -webkit-align-items: baseline;
        align-items: baseline;
      };

      /* alignment in main axis */

      --layout-start-justified: {
        -ms-flex-pack: start;
        -webkit-justify-content: flex-start;
        justify-content: flex-start;
      };

      --layout-center-justified: {
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
      };

      --layout-end-justified: {
        -ms-flex-pack: end;
        -webkit-justify-content: flex-end;
        justify-content: flex-end;
      };

      --layout-around-justified: {
        -ms-flex-pack: distribute;
        -webkit-justify-content: space-around;
        justify-content: space-around;
      };

      --layout-justified: {
        -ms-flex-pack: justify;
        -webkit-justify-content: space-between;
        justify-content: space-between;
      };

      --layout-center-center: {
        @apply --layout-center;
        @apply --layout-center-justified;
      };

      /* self alignment */

      --layout-self-start: {
        -ms-align-self: flex-start;
        -webkit-align-self: flex-start;
        align-self: flex-start;
      };

      --layout-self-center: {
        -ms-align-self: center;
        -webkit-align-self: center;
        align-self: center;
      };

      --layout-self-end: {
        -ms-align-self: flex-end;
        -webkit-align-self: flex-end;
        align-self: flex-end;
      };

      --layout-self-stretch: {
        -ms-align-self: stretch;
        -webkit-align-self: stretch;
        align-self: stretch;
      };

      --layout-self-baseline: {
        -ms-align-self: baseline;
        -webkit-align-self: baseline;
        align-self: baseline;
      };

      /* multi-line alignment in main axis */

      --layout-start-aligned: {
        -ms-flex-line-pack: start;  /* IE10 */
        -ms-align-content: flex-start;
        -webkit-align-content: flex-start;
        align-content: flex-start;
      };

      --layout-end-aligned: {
        -ms-flex-line-pack: end;  /* IE10 */
        -ms-align-content: flex-end;
        -webkit-align-content: flex-end;
        align-content: flex-end;
      };

      --layout-center-aligned: {
        -ms-flex-line-pack: center;  /* IE10 */
        -ms-align-content: center;
        -webkit-align-content: center;
        align-content: center;
      };

      --layout-between-aligned: {
        -ms-flex-line-pack: justify;  /* IE10 */
        -ms-align-content: space-between;
        -webkit-align-content: space-between;
        align-content: space-between;
      };

      --layout-around-aligned: {
        -ms-flex-line-pack: distribute;  /* IE10 */
        -ms-align-content: space-around;
        -webkit-align-content: space-around;
        align-content: space-around;
      };

      /*******************************
                Other Layout
      *******************************/

      --layout-block: {
        display: block;
      };

      --layout-invisible: {
        visibility: hidden !important;
      };

      --layout-relative: {
        position: relative;
      };

      --layout-fit: {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      };

      --layout-scroll: {
        -webkit-overflow-scrolling: touch;
        overflow: auto;
      };

      --layout-fullbleed: {
        margin: 0;
        height: 100vh;
      };

      /* fixed position */

      --layout-fixed-top: {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
      };

      --layout-fixed-right: {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
      };

      --layout-fixed-bottom: {
        position: fixed;
        right: 0;
        bottom: 0;
        left: 0;
      };

      --layout-fixed-left: {
        position: fixed;
        top: 0;
        bottom: 0;
        left: 0;
      };

    }
  </style>
</custom-style>`;template.setAttribute("style","display: none;"),document.head.appendChild(template.content);var style=document.createElement("style");style.textContent="[hidden] { display: none !important; }",document.head.appendChild(style),Polymer({_template:html`
    <style>
      :host {
        position: fixed;
        top: -120px;
        right: 0;
        bottom: -120px;
        left: 0;

        visibility: hidden;

        transition-property: visibility;
      }

      :host([opened]) {
        visibility: visible;
      }

      :host([persistent]) {
        width: var(--app-drawer-width, 256px);
      }

      :host([persistent][position=left]) {
        right: auto;
      }

      :host([persistent][position=right]) {
        left: auto;
      }

      #contentContainer {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;

        width: var(--app-drawer-width, 256px);
        padding: 120px 0;

        transition-property: -webkit-transform;
        transition-property: transform;
        -webkit-transform: translate3d(-100%, 0, 0);
        transform: translate3d(-100%, 0, 0);

        background-color: #FFF;

        @apply --app-drawer-content-container;
      }

      #contentContainer[persistent] {
        width: 100%;
      }

      #contentContainer[position=right] {
        right: 0;
        left: auto;

        -webkit-transform: translate3d(100%, 0, 0);
        transform: translate3d(100%, 0, 0);
      }

      #contentContainer[swipe-open]::after {
        position: fixed;
        top: 0;
        bottom: 0;
        left: 100%;

        visibility: visible;

        width: 20px;

        content: '';
      }

      #contentContainer[swipe-open][position=right]::after {
        right: 100%;
        left: auto;
      }

      #contentContainer[opened] {
        -webkit-transform: translate3d(0, 0, 0);
        transform: translate3d(0, 0, 0);
      }

      #scrim {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;

        transition-property: opacity;
        -webkit-transform: translateZ(0);
        transform:  translateZ(0);

        opacity: 0;
        background: var(--app-drawer-scrim-background, rgba(0, 0, 0, 0.5));
      }

      #scrim.visible {
        opacity: 1;
      }

      :host([no-transition]) #contentContainer {
        transition-property: none;
      }
    </style>

    <div id="scrim" on-click="close"></div>

    <!-- HACK(keanulee): Bind attributes here (in addition to :host) for styling to workaround Safari
    bug. https://bugs.webkit.org/show_bug.cgi?id=170762 -->
    <div id="contentContainer" opened\$="[[opened]]" persistent\$="[[persistent]]" position\$="[[position]]" swipe-open\$="[[swipeOpen]]">
      <slot></slot>
    </div>
`,is:"app-drawer",properties:{opened:{type:Boolean,value:!1,notify:!0,reflectToAttribute:!0},persistent:{type:Boolean,value:!1,reflectToAttribute:!0},transitionDuration:{type:Number,value:200},align:{type:String,value:"left"},position:{type:String,readOnly:!0,reflectToAttribute:!0},swipeOpen:{type:Boolean,value:!1,reflectToAttribute:!0},noFocusTrap:{type:Boolean,value:!1},disableSwipe:{type:Boolean,value:!1}},observers:["resetLayout(position, isAttached)","_resetPosition(align, isAttached)","_styleTransitionDuration(transitionDuration)","_openedPersistentChanged(opened, persistent)"],_translateOffset:0,_trackDetails:null,_drawerState:0,_boundEscKeydownHandler:null,_firstTabStop:null,_lastTabStop:null,attached:function(){afterNextRender(this,function(){this._boundEscKeydownHandler=this._escKeydownHandler.bind(this),this.addEventListener("keydown",this._tabKeydownHandler.bind(this)),this.listen(this,"track","_track"),this.setScrollDirection("y")}),this.fire("app-reset-layout")},detached:function(){document.removeEventListener("keydown",this._boundEscKeydownHandler)},open:function(){this.opened=!0},close:function(){this.opened=!1},toggle:function(){this.opened=!this.opened},getWidth:function(){return this._savedWidth||this.$.contentContainer.offsetWidth},_isRTL:function(){return"rtl"===window.getComputedStyle(this).direction},_resetPosition:function(){switch(this.align){case"start":return void this._setPosition(this._isRTL()?"right":"left");case"end":return void this._setPosition(this._isRTL()?"left":"right")}this._setPosition(this.align)},_escKeydownHandler:function(e){27===e.keyCode&&(e.preventDefault(),this.close())},_track:function(e){if(!this.persistent&&!this.disableSwipe)switch(e.preventDefault(),e.detail.state){case"start":this._trackStart(e);break;case"track":this._trackMove(e);break;case"end":this._trackEnd(e)}},_trackStart:function(e){this._drawerState=this._DRAWER_STATE.TRACKING;var t=this.$.contentContainer.getBoundingClientRect();this._savedWidth=t.width,"left"===this.position?this._translateOffset=t.left:this._translateOffset=t.right-window.innerWidth,this._trackDetails=[],this._styleTransitionDuration(0),this.style.visibility="visible"},_trackMove:function(e){this._translateDrawer(e.detail.dx+this._translateOffset),this._trackDetails.push({dx:e.detail.dx,timeStamp:Date.now()})},_trackEnd:function(e){var t=e.detail.dx+this._translateOffset,i=this.getWidth(),r="left"===this.position?0<=t||t<=-i:0>=t||t>=i;if(!r){var n=this._trackDetails;if(this._trackDetails=null,this._flingDrawer(e,n),this._drawerState===this._DRAWER_STATE.FLINGING)return}var a=i/2;e.detail.dx<-a?this.opened="right"===this.position:e.detail.dx>a&&(this.opened="left"===this.position),r?this.debounce("_resetDrawerState",this._resetDrawerState):this.debounce("_resetDrawerState",this._resetDrawerState,this.transitionDuration),this._styleTransitionDuration(this.transitionDuration),this._resetDrawerTranslate(),this.style.visibility=""},_calculateVelocity:function(e,t){for(var i,r=Date.now(),n=r-100,a=0,o=t.length-1;a<=o;){var s=a+o>>1,l=t[s];l.timeStamp>=n?(i=l,o=s-1):a=s+1}return i?(e.detail.dx-i.dx)/(r-i.timeStamp||1):0},_flingDrawer:function(e,t){var i=this._calculateVelocity(e,t);if(!(Math.abs(i)<this._MIN_FLING_THRESHOLD)){this._drawerState=this._DRAWER_STATE.FLINGING;var r,n=e.detail.dx+this._translateOffset,a=this.getWidth(),o="left"===this.position,s=0<i;r=!s&&o?-(n+a):s&&!o?a-n:-n,s?(i=Math.max(i,this._MIN_TRANSITION_VELOCITY),this.opened="left"===this.position):(i=Math.min(i,-this._MIN_TRANSITION_VELOCITY),this.opened="right"===this.position);var l=this._FLING_INITIAL_SLOPE*r/i;this._styleTransitionDuration(l),this._styleTransitionTimingFunction(this._FLING_TIMING_FUNCTION),this._resetDrawerTranslate(),this.debounce("_resetDrawerState",this._resetDrawerState,l)}},_styleTransitionDuration:function(e){this.style.transitionDuration=e+"ms",this.$.contentContainer.style.transitionDuration=e+"ms",this.$.scrim.style.transitionDuration=e+"ms"},_styleTransitionTimingFunction:function(e){this.$.contentContainer.style.transitionTimingFunction=e,this.$.scrim.style.transitionTimingFunction=e},_translateDrawer:function(e){var t=this.getWidth();"left"===this.position?(e=Math.max(-t,Math.min(e,0)),this.$.scrim.style.opacity=1+e/t):(e=Math.max(0,Math.min(e,t)),this.$.scrim.style.opacity=1-e/t),this.translate3d(e+"px","0","0",this.$.contentContainer)},_resetDrawerTranslate:function(){this.$.scrim.style.opacity="",this.transform("",this.$.contentContainer)},_resetDrawerState:function(){var e=this._drawerState;e===this._DRAWER_STATE.FLINGING&&(this._styleTransitionDuration(this.transitionDuration),this._styleTransitionTimingFunction(""),this.style.visibility=""),this._savedWidth=null,this.opened?this._drawerState=this.persistent?this._DRAWER_STATE.OPENED_PERSISTENT:this._DRAWER_STATE.OPENED:this._drawerState=this._DRAWER_STATE.CLOSED,e!==this._drawerState&&(this._drawerState===this._DRAWER_STATE.OPENED?(this._setKeyboardFocusTrap(),document.addEventListener("keydown",this._boundEscKeydownHandler),document.body.style.overflow="hidden"):(document.removeEventListener("keydown",this._boundEscKeydownHandler),document.body.style.overflow=""),e!==this._DRAWER_STATE.INIT&&this.fire("app-drawer-transitioned"))},resetLayout:function(){this.fire("app-reset-layout")},_setKeyboardFocusTrap:function(){if(!this.noFocusTrap){var e=['a[href]:not([tabindex="-1"])','area[href]:not([tabindex="-1"])','input:not([disabled]):not([tabindex="-1"])','select:not([disabled]):not([tabindex="-1"])','textarea:not([disabled]):not([tabindex="-1"])','button:not([disabled]):not([tabindex="-1"])','iframe:not([tabindex="-1"])','[tabindex]:not([tabindex="-1"])','[contentEditable=true]:not([tabindex="-1"])'].join(","),t=dom(this).querySelectorAll(e);0<t.length?(this._firstTabStop=t[0],this._lastTabStop=t[t.length-1]):(this._firstTabStop=null,this._lastTabStop=null);var i=this.getAttribute("tabindex");i&&-1<parseInt(i,10)?this.focus():this._firstTabStop&&this._firstTabStop.focus()}},_tabKeydownHandler:function(e){if(!this.noFocusTrap){this._drawerState===this._DRAWER_STATE.OPENED&&9===e.keyCode&&(e.shiftKey?this._firstTabStop&&dom(e).localTarget===this._firstTabStop&&(e.preventDefault(),this._lastTabStop.focus()):this._lastTabStop&&dom(e).localTarget===this._lastTabStop&&(e.preventDefault(),this._firstTabStop.focus()))}},_openedPersistentChanged:function(e,t){this.toggleClass("visible",e&&!t,this.$.scrim),this.debounce("_resetDrawerState",this._resetDrawerState,this.transitionDuration)},_MIN_FLING_THRESHOLD:.2,_MIN_TRANSITION_VELOCITY:1.2,_FLING_TIMING_FUNCTION:"cubic-bezier(0.667, 1, 0.667, 1)",_FLING_INITIAL_SLOPE:1.5,_DRAWER_STATE:{INIT:0,OPENED:1,OPENED_PERSISTENT:2,CLOSED:3,TRACKING:4,FLINGING:5}});var ORPHANS=new Set;const IronResizableBehavior={properties:{_parentResizable:{type:Object,observer:"_parentResizableChanged"},_notifyingDescendant:{type:Boolean,value:!1}},listeners:{"iron-request-resize-notifications":"_onIronRequestResizeNotifications"},created:function(){this._interestedResizables=[],this._boundNotifyResize=this.notifyResize.bind(this),this._boundOnDescendantIronResize=this._onDescendantIronResize.bind(this)},attached:function(){this._requestResizeNotifications()},detached:function(){this._parentResizable?this._parentResizable.stopResizeNotificationsFor(this):(ORPHANS.delete(this),window.removeEventListener("resize",this._boundNotifyResize)),this._parentResizable=null},notifyResize:function(){this.isAttached&&(this._interestedResizables.forEach(function(e){this.resizerShouldNotify(e)&&this._notifyDescendant(e)},this),this._fireResize())},assignParentResizable:function(e){this._parentResizable&&this._parentResizable.stopResizeNotificationsFor(this),this._parentResizable=e,e&&-1===e._interestedResizables.indexOf(this)&&(e._interestedResizables.push(this),e._subscribeIronResize(this))},stopResizeNotificationsFor:function(e){var t=this._interestedResizables.indexOf(e);-1<t&&(this._interestedResizables.splice(t,1),this._unsubscribeIronResize(e))},_subscribeIronResize:function(e){e.addEventListener("iron-resize",this._boundOnDescendantIronResize)},_unsubscribeIronResize:function(e){e.removeEventListener("iron-resize",this._boundOnDescendantIronResize)},resizerShouldNotify:function(e){return!0},_onDescendantIronResize:function(e){this._notifyingDescendant?e.stopPropagation():useShadow||this._fireResize()},_fireResize:function(){this.fire("iron-resize",null,{node:this,bubbles:!1})},_onIronRequestResizeNotifications:function(e){var t=dom(e).rootTarget;t!==this&&(t.assignParentResizable(this),this._notifyDescendant(t),e.stopPropagation())},_parentResizableChanged:function(e){e&&window.removeEventListener("resize",this._boundNotifyResize)},_notifyDescendant:function(e){this.isAttached&&(this._notifyingDescendant=!0,e.notifyResize(),this._notifyingDescendant=!1)},_requestResizeNotifications:function(){if(this.isAttached)if("loading"===document.readyState){var e=this._requestResizeNotifications.bind(this);document.addEventListener("readystatechange",function t(){document.removeEventListener("readystatechange",t),e()})}else this._findParent(),this._parentResizable?this._parentResizable._interestedResizables.forEach(function(e){e!==this&&e._findParent()},this):(ORPHANS.forEach(function(e){e!==this&&e._findParent()},this),window.addEventListener("resize",this._boundNotifyResize),this.notifyResize())},_findParent:function(){this.assignParentResizable(null),this.fire("iron-request-resize-notifications",null,{node:this,bubbles:!0,cancelable:!0}),this._parentResizable?ORPHANS.delete(this):ORPHANS.add(this)}};var ironResizableBehavior={IronResizableBehavior:IronResizableBehavior};const AppLayoutBehavior=[IronResizableBehavior,{listeners:{"app-reset-layout":"_appResetLayoutHandler","iron-resize":"resetLayout"},attached:function(){this.fire("app-reset-layout")},_appResetLayoutHandler:function(e){dom(e).path[0]!==this&&(this.resetLayout(),e.stopPropagation())},_updateLayoutStates:function(){console.error("unimplemented")},resetLayout:function(){var e=this._updateLayoutStates.bind(this);this._layoutDebouncer=Debouncer.debounce(this._layoutDebouncer,animationFrame,e),enqueueDebouncer(this._layoutDebouncer),this._notifyDescendantResize()},_notifyLayoutChanged:function(){var e=this;requestAnimationFrame(function(){e.fire("app-reset-layout")})},_notifyDescendantResize:function(){this.isAttached&&this._interestedResizables.forEach(function(e){this.resizerShouldNotify(e)&&this._notifyDescendant(e)},this)}}];var appLayoutBehavior={AppLayoutBehavior:AppLayoutBehavior};const IronScrollTargetBehavior={properties:{scrollTarget:{type:HTMLElement,value:function(){return this._defaultScrollTarget}}},observers:["_scrollTargetChanged(scrollTarget, isAttached)"],_shouldHaveListener:!0,_scrollTargetChanged:function(e,t){if(this._oldScrollTarget&&(this._toggleScrollListener(!1,this._oldScrollTarget),this._oldScrollTarget=null),t)if("document"===e)this.scrollTarget=this._doc;else if("string"==typeof e){var i=this.domHost;this.scrollTarget=i&&i.$?i.$[e]:dom(this.ownerDocument).querySelector("#"+e)}else this._isValidScrollTarget()&&(this._oldScrollTarget=e,this._toggleScrollListener(this._shouldHaveListener,e))},_scrollHandler:function(){},get _defaultScrollTarget(){return this._doc},get _doc(){return this.ownerDocument.documentElement},get _scrollTop(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.pageYOffset:this.scrollTarget.scrollTop:0},get _scrollLeft(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.pageXOffset:this.scrollTarget.scrollLeft:0},set _scrollTop(e){this.scrollTarget===this._doc?window.scrollTo(window.pageXOffset,e):this._isValidScrollTarget()&&(this.scrollTarget.scrollTop=e)},set _scrollLeft(e){this.scrollTarget===this._doc?window.scrollTo(e,window.pageYOffset):this._isValidScrollTarget()&&(this.scrollTarget.scrollLeft=e)},scroll:function(e,t){var i;"object"==typeof e?(i=e.left,t=e.top):i=e,i=i||0,t=t||0,this.scrollTarget===this._doc?window.scrollTo(i,t):this._isValidScrollTarget()&&(this.scrollTarget.scrollLeft=i,this.scrollTarget.scrollTop=t)},get _scrollTargetWidth(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.innerWidth:this.scrollTarget.offsetWidth:0},get _scrollTargetHeight(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.innerHeight:this.scrollTarget.offsetHeight:0},_isValidScrollTarget:function(){return this.scrollTarget instanceof HTMLElement},_toggleScrollListener:function(e,t){var i=t===this._doc?window:t;e?this._boundScrollHandler||(this._boundScrollHandler=this._scrollHandler.bind(this),i.addEventListener("scroll",this._boundScrollHandler)):this._boundScrollHandler&&(i.removeEventListener("scroll",this._boundScrollHandler),this._boundScrollHandler=null)},toggleScrollListener:function(e){this._shouldHaveListener=e,this._toggleScrollListener(e,this.scrollTarget)}};var ironScrollTargetBehavior={IronScrollTargetBehavior:IronScrollTargetBehavior};const _scrollEffects={};let _scrollTimer=null;const scrollTimingFunction=function(e,t,i,r){return-i*(e/=r)*(e-2)+t},registerEffect=function(e,t){if(null!=_scrollEffects[e])throw new Error("effect `"+e+"` is already registered.");_scrollEffects[e]=t},queryAllRoot=function(e,t){for(var i=[t],r=[];0<i.length;){var n=i.shift();r.push.apply(r,n.querySelectorAll(e));for(var a=0;n.children[a];a++)n.children[a].shadowRoot&&i.push(n.children[a].shadowRoot)}return r},scroll=function(e){e=e||{};var t=document.documentElement,i=e.target||t,r="scrollBehavior"in i.style&&i.scroll,n=e.top||0,a=e.left||0,o=i===t?window.scrollTo:function(e,t){i.scrollLeft=e,i.scrollTop=t};if("smooth"===e.behavior)if(r)i.scroll(e);else{var s=scrollTimingFunction,l=Date.now(),c=i===t?window.pageYOffset:i.scrollTop,h=i===t?window.pageXOffset:i.scrollLeft,u=n-c,d=a-h;(function e(){var t=Date.now()-l;t<300?(o(s(t,h,d,300),s(t,c,u,300)),requestAnimationFrame(e)):o(a,n)}).bind(this)()}else if("silent"===e.behavior){var p=queryAllRoot("app-header",document.body);p.forEach(function(e){e.setAttribute("silent-scroll","")}),_scrollTimer&&window.cancelAnimationFrame(_scrollTimer),_scrollTimer=window.requestAnimationFrame(function(){p.forEach(function(e){e.removeAttribute("silent-scroll")}),_scrollTimer=null}),o(a,n)}else o(a,n)};var helpers={_scrollEffects:_scrollEffects,get _scrollTimer(){return _scrollTimer},scrollTimingFunction:scrollTimingFunction,registerEffect:registerEffect,queryAllRoot:queryAllRoot,scroll:scroll};const AppScrollEffectsBehavior=[IronScrollTargetBehavior,{properties:{effects:{type:String},effectsConfig:{type:Object,value:function(){return{}}},disabled:{type:Boolean,reflectToAttribute:!0,value:!1},threshold:{type:Number,value:0},thresholdTriggered:{type:Boolean,notify:!0,readOnly:!0,reflectToAttribute:!0}},observers:["_effectsChanged(effects, effectsConfig, isAttached)"],_updateScrollState:function(e){},isOnScreen:function(){return!1},isContentBelow:function(){return!1},_effectsRunFn:null,_effects:null,get _clampedScrollTop(){return Math.max(0,this._scrollTop)},attached:function(){this._scrollStateChanged()},detached:function(){this._tearDownEffects()},createEffect:function(e,t){var i=_scrollEffects[e];if(!i)throw new ReferenceError(this._getUndefinedMsg(e));var r=this._boundEffect(i,t||{});return r.setUp(),r},_effectsChanged:function(e,t,i){this._tearDownEffects(),e&&i&&(e.split(" ").forEach(function(e){var i;""!==e&&((i=_scrollEffects[e])?this._effects.push(this._boundEffect(i,t[e])):console.warn(this._getUndefinedMsg(e)))},this),this._setUpEffect())},_layoutIfDirty:function(){return this.offsetWidth},_boundEffect:function(e,t){t=t||{};var i=parseFloat(t.startsAt||0),r=parseFloat(t.endsAt||1),n=r-i,a=function(){},o=0===i&&1===r?e.run:function(t,r){e.run.call(this,Math.max(0,(t-i)/n),r)};return{setUp:e.setUp?e.setUp.bind(this,t):a,run:e.run?o.bind(this):a,tearDown:e.tearDown?e.tearDown.bind(this):a}},_setUpEffect:function(){this.isAttached&&this._effects&&(this._effectsRunFn=[],this._effects.forEach(function(e){!1!==e.setUp()&&this._effectsRunFn.push(e.run)},this))},_tearDownEffects:function(){this._effects&&this._effects.forEach(function(e){e.tearDown()}),this._effectsRunFn=[],this._effects=[]},_runEffects:function(e,t){this._effectsRunFn&&this._effectsRunFn.forEach(function(i){i(e,t)})},_scrollHandler:function(){this._scrollStateChanged()},_scrollStateChanged:function(){if(!this.disabled){var e=this._clampedScrollTop;this._updateScrollState(e),0<this.threshold&&this._setThresholdTriggered(e>=this.threshold)}},_getDOMRef:function(e){console.warn("_getDOMRef","`"+e+"` is undefined")},_getUndefinedMsg:function(e){return"Scroll effect `"+e+"` is undefined. Did you forget to import app-layout/app-scroll-effects/effects/"+e+".html ?"}}];var appScrollEffectsBehavior={AppScrollEffectsBehavior:AppScrollEffectsBehavior};if(Polymer({_template:html`
    <style>
      :host {
        position: relative;
        display: block;
        transition-timing-function: linear;
        transition-property: -webkit-transform;
        transition-property: transform;
      }

      :host::before {
        position: absolute;
        right: 0px;
        bottom: -5px;
        left: 0px;
        width: 100%;
        height: 5px;
        content: "";
        transition: opacity 0.4s;
        pointer-events: none;
        opacity: 0;
        box-shadow: inset 0px 5px 6px -3px rgba(0, 0, 0, 0.4);
        will-change: opacity;
        @apply --app-header-shadow;
      }

      :host([shadow])::before {
        opacity: 1;
      }

      #background {
        @apply --layout-fit;
        overflow: hidden;
      }

      #backgroundFrontLayer,
      #backgroundRearLayer {
        @apply --layout-fit;
        height: 100%;
        pointer-events: none;
        background-size: cover;
      }

      #backgroundFrontLayer {
        @apply --app-header-background-front-layer;
      }

      #backgroundRearLayer {
        opacity: 0;
        @apply --app-header-background-rear-layer;
      }

      #contentContainer {
        position: relative;
        width: 100%;
        height: 100%;
      }

      :host([disabled]),
      :host([disabled])::after,
      :host([disabled]) #backgroundFrontLayer,
      :host([disabled]) #backgroundRearLayer,
      /* Silent scrolling should not run CSS transitions */
      :host([silent-scroll]),
      :host([silent-scroll])::after,
      :host([silent-scroll]) #backgroundFrontLayer,
      :host([silent-scroll]) #backgroundRearLayer {
        transition: none !important;
      }

      :host([disabled]) ::slotted(app-toolbar:first-of-type),
      :host([disabled]) ::slotted([sticky]),
      /* Silent scrolling should not run CSS transitions */
      :host([silent-scroll]) ::slotted(app-toolbar:first-of-type),
      :host([silent-scroll]) ::slotted([sticky]) {
        transition: none !important;
      }

    </style>
    <div id="contentContainer">
      <slot id="slot"></slot>
    </div>
`,is:"app-header",behaviors:[AppScrollEffectsBehavior,AppLayoutBehavior],properties:{condenses:{type:Boolean,value:!1},fixed:{type:Boolean,value:!1},reveals:{type:Boolean,value:!1},shadow:{type:Boolean,reflectToAttribute:!0,value:!1}},observers:["_configChanged(isAttached, condenses, fixed)"],_height:0,_dHeight:0,_stickyElTop:0,_stickyElRef:null,_top:0,_progress:0,_wasScrollingDown:!1,_initScrollTop:0,_initTimestamp:0,_lastTimestamp:0,_lastScrollTop:0,get _maxHeaderTop(){return this.fixed?this._dHeight:this._height+5},get _stickyEl(){if(this._stickyElRef)return this._stickyElRef;for(var e,t=dom(this.$.slot).getDistributedNodes(),i=0;e=t[i];i++)if(e.nodeType===Node.ELEMENT_NODE){if(e.hasAttribute("sticky")){this._stickyElRef=e;break}this._stickyElRef||(this._stickyElRef=e)}return this._stickyElRef},_configChanged:function(){this.resetLayout(),this._notifyLayoutChanged()},_updateLayoutStates:function(){if(0!==this.offsetWidth||0!==this.offsetHeight){var e=this._clampedScrollTop,t=0===this._height||0===e,i=this.disabled;this._height=this.offsetHeight,this._stickyElRef=null,this.disabled=!0,t||this._updateScrollState(0,!0),this._mayMove()?this._dHeight=this._stickyEl?this._height-this._stickyEl.offsetHeight:0:this._dHeight=0,this._stickyElTop=this._stickyEl?this._stickyEl.offsetTop:0,this._setUpEffect(),t?this._updateScrollState(e,!0):(this._updateScrollState(this._lastScrollTop,!0),this._layoutIfDirty()),this.disabled=i}},_updateScrollState:function(e,t){if(0!==this._height){var i=0,r=0,n=this._top,a=(this._lastScrollTop,this._maxHeaderTop),o=e-this._lastScrollTop,s=Math.abs(o),l=e>this._lastScrollTop,c=performance.now();if(this._mayMove()&&(r=this._clamp(this.reveals?n+o:e,0,a)),e>=this._dHeight&&(r=this.condenses&&!this.fixed?Math.max(this._dHeight,r):r,this.style.transitionDuration="0ms"),this.reveals&&!this.disabled&&100>s&&((300<c-this._initTimestamp||this._wasScrollingDown!==l)&&(this._initScrollTop=e,this._initTimestamp=c),e>=a))if(30<Math.abs(this._initScrollTop-e)||10<s){l&&e>=a?r=a:!l&&e>=this._dHeight&&(r=this.condenses&&!this.fixed?this._dHeight:0);var h=o/(c-this._lastTimestamp);this.style.transitionDuration=this._clamp((r-n)/h,0,300)+"ms"}else r=this._top;i=0===this._dHeight?0<e?1:0:r/this._dHeight,t||(this._lastScrollTop=e,this._top=r,this._wasScrollingDown=l,this._lastTimestamp=c),(t||i!==this._progress||n!==r||0===e)&&(this._progress=i,this._runEffects(i,r),this._transformHeader(r))}},_mayMove:function(){return this.condenses||!this.fixed},willCondense:function(){return 0<this._dHeight&&this.condenses},isOnScreen:function(){return 0!==this._height&&this._top<this._height},isContentBelow:function(){return 0===this._top?0<this._clampedScrollTop:0<=this._clampedScrollTop-this._maxHeaderTop},_transformHeader:function(e){this.translate3d(0,-e+"px",0),this._stickyEl&&this.translate3d(0,this.condenses&&e>=this._stickyElTop?Math.min(e,this._dHeight)-this._stickyElTop+"px":0,0,this._stickyEl)},_clamp:function(e,t,i){return Math.min(i,Math.max(t,e))},_ensureBgContainers:function(){this._bgContainer||(this._bgContainer=document.createElement("div"),this._bgContainer.id="background",this._bgRear=document.createElement("div"),this._bgRear.id="backgroundRearLayer",this._bgContainer.appendChild(this._bgRear),this._bgFront=document.createElement("div"),this._bgFront.id="backgroundFrontLayer",this._bgContainer.appendChild(this._bgFront),dom(this.root).insertBefore(this._bgContainer,this.$.contentContainer))},_getDOMRef:function(e){switch(e){case"backgroundFrontLayer":return this._ensureBgContainers(),this._bgFront;case"backgroundRearLayer":return this._ensureBgContainers(),this._bgRear;case"background":return this._ensureBgContainers(),this._bgContainer;case"mainTitle":return dom(this).querySelector("[main-title]");case"condensedTitle":return dom(this).querySelector("[condensed-title]")}return null},getScrollState:function(){return{progress:this._progress,top:this._top}}}),registerEffect("waterfall",{run:function(){this.shadow=this.isOnScreen()&&this.isContentBelow()}}),!window.polymerSkipLoadingFontRoboto){const e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.crossOrigin="anonymous",e.href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,300,300italic,400italic,500,500italic,700,700italic",document.head.appendChild(e)}const IronA11yAnnouncer=Polymer({_template:html`
    <style>
      :host {
        display: inline-block;
        position: fixed;
        clip: rect(0px,0px,0px,0px);
      }
    </style>
    <div aria-live$="[[mode]]">[[_text]]</div>
`,is:"iron-a11y-announcer",properties:{mode:{type:String,value:"polite"},_text:{type:String,value:""}},created:function(){IronA11yAnnouncer.instance||(IronA11yAnnouncer.instance=this),document.body.addEventListener("iron-announce",this._onIronAnnounce.bind(this))},announce:function(e){this._text="",this.async(function(){this._text=e},100)},_onIronAnnounce:function(e){e.detail&&e.detail.text&&this.announce(e.detail.text)}});IronA11yAnnouncer.instance=null,IronA11yAnnouncer.requestAvailability=function(){IronA11yAnnouncer.instance||(IronA11yAnnouncer.instance=document.createElement("iron-a11y-announcer")),document.body.appendChild(IronA11yAnnouncer.instance)};var ironA11yAnnouncer={IronA11yAnnouncer:IronA11yAnnouncer},KEY_IDENTIFIER={"U+0008":"backspace","U+0009":"tab","U+001B":"esc","U+0020":"space","U+007F":"del"},KEY_CODE={8:"backspace",9:"tab",13:"enter",27:"esc",33:"pageup",34:"pagedown",35:"end",36:"home",32:"space",37:"left",38:"up",39:"right",40:"down",46:"del",106:"*"},MODIFIER_KEYS={shift:"shiftKey",ctrl:"ctrlKey",alt:"altKey",meta:"metaKey"},KEY_CHAR=/[a-z0-9*]/,IDENT_CHAR=/U\+/,ARROW_KEY=/^arrow/,SPACE_KEY=/^space(bar)?/,ESC_KEY=/^escape$/;function transformKey(e,t){var i="";if(e){var r=e.toLowerCase();" "===r||SPACE_KEY.test(r)?i="space":ESC_KEY.test(r)?i="esc":1==r.length?t&&!KEY_CHAR.test(r)||(i=r):i=ARROW_KEY.test(r)?r.replace("arrow",""):"multiply"==r?"*":r}return i}function transformKeyIdentifier(e){var t="";return e&&(e in KEY_IDENTIFIER?t=KEY_IDENTIFIER[e]:IDENT_CHAR.test(e)?(e=parseInt(e.replace("U+","0x"),16),t=String.fromCharCode(e).toLowerCase()):t=e.toLowerCase()),t}function transformKeyCode(e){var t="";return+e&&(t=65<=e&&90>=e?String.fromCharCode(32+e):112<=e&&123>=e?"f"+(e-112+1):48<=e&&57>=e?e-48+"":96<=e&&105>=e?e-96+"":KEY_CODE[e]),t}function normalizedKeyForEvent(e,t){return e.key?transformKey(e.key,t):e.detail&&e.detail.key?transformKey(e.detail.key,t):transformKeyIdentifier(e.keyIdentifier)||transformKeyCode(e.keyCode)||""}function keyComboMatchesEvent(e,t){return normalizedKeyForEvent(t,e.hasModifiers)===e.key&&(!e.hasModifiers||!!t.shiftKey==!!e.shiftKey&&!!t.ctrlKey==!!e.ctrlKey&&!!t.altKey==!!e.altKey&&!!t.metaKey==!!e.metaKey)}function parseKeyComboString(e){return 1===e.length?{combo:e,key:e,event:"keydown"}:e.split("+").reduce(function(e,t){var i=t.split(":"),r=i[0],n=i[1];return r in MODIFIER_KEYS?(e[MODIFIER_KEYS[r]]=!0,e.hasModifiers=!0):(e.key=r,e.event=n||"keydown"),e},{combo:e.split(":").shift()})}function parseEventString(e){return e.trim().split(" ").map(function(e){return parseKeyComboString(e)})}const IronA11yKeysBehavior={properties:{keyEventTarget:{type:Object,value:function(){return this}},stopKeyboardEventPropagation:{type:Boolean,value:!1},_boundKeyHandlers:{type:Array,value:function(){return[]}},_imperativeKeyBindings:{type:Object,value:function(){return{}}}},observers:["_resetKeyEventListeners(keyEventTarget, _boundKeyHandlers)"],keyBindings:{},registered:function(){this._prepKeyBindings()},attached:function(){this._listenKeyEventListeners()},detached:function(){this._unlistenKeyEventListeners()},addOwnKeyBinding:function(e,t){this._imperativeKeyBindings[e]=t,this._prepKeyBindings(),this._resetKeyEventListeners()},removeOwnKeyBindings:function(){this._imperativeKeyBindings={},this._prepKeyBindings(),this._resetKeyEventListeners()},keyboardEventMatchesKeys:function(e,t){for(var i=parseEventString(t),r=0;r<i.length;++r)if(keyComboMatchesEvent(i[r],e))return!0;return!1},_collectKeyBindings:function(){var e=this.behaviors.map(function(e){return e.keyBindings});return-1===e.indexOf(this.keyBindings)&&e.push(this.keyBindings),e},_prepKeyBindings:function(){for(var e in this._keyBindings={},this._collectKeyBindings().forEach(function(e){for(var t in e)this._addKeyBinding(t,e[t])},this),this._imperativeKeyBindings)this._addKeyBinding(e,this._imperativeKeyBindings[e]);for(var t in this._keyBindings)this._keyBindings[t].sort(function(e,t){var i=e[0].hasModifiers;return i===t[0].hasModifiers?0:i?-1:1})},_addKeyBinding:function(e,t){parseEventString(e).forEach(function(e){this._keyBindings[e.event]=this._keyBindings[e.event]||[],this._keyBindings[e.event].push([e,t])},this)},_resetKeyEventListeners:function(){this._unlistenKeyEventListeners(),this.isAttached&&this._listenKeyEventListeners()},_listenKeyEventListeners:function(){this.keyEventTarget&&Object.keys(this._keyBindings).forEach(function(e){var t=this._keyBindings[e],i=this._onKeyBindingEvent.bind(this,t);this._boundKeyHandlers.push([this.keyEventTarget,e,i]),this.keyEventTarget.addEventListener(e,i)},this)},_unlistenKeyEventListeners:function(){for(var e,t,i,r;this._boundKeyHandlers.length;)t=(e=this._boundKeyHandlers.pop())[0],i=e[1],r=e[2],t.removeEventListener(i,r)},_onKeyBindingEvent:function(e,t){if(this.stopKeyboardEventPropagation&&t.stopPropagation(),!t.defaultPrevented)for(var i=0;i<e.length;i++){var r=e[i][0],n=e[i][1];if(keyComboMatchesEvent(r,t)&&(this._triggerKeyHandler(r,n,t),t.defaultPrevented))return}},_triggerKeyHandler:function(e,t,i){var r=Object.create(e);r.keyboardEvent=i;var n=new CustomEvent(e.event,{detail:r,cancelable:!0});this[t].call(this,n),n.defaultPrevented&&i.preventDefault()}};var ironA11yKeysBehavior={IronA11yKeysBehavior:IronA11yKeysBehavior};const IronControlState={properties:{focused:{type:Boolean,value:!1,notify:!0,readOnly:!0,reflectToAttribute:!0},disabled:{type:Boolean,value:!1,notify:!0,observer:"_disabledChanged",reflectToAttribute:!0},_oldTabIndex:{type:String},_boundFocusBlurHandler:{type:Function,value:function(){return this._focusBlurHandler.bind(this)}}},observers:["_changedControlState(focused, disabled)"],ready:function(){this.addEventListener("focus",this._boundFocusBlurHandler,!0),this.addEventListener("blur",this._boundFocusBlurHandler,!0)},_focusBlurHandler:function(e){this._setFocused("focus"===e.type)},_disabledChanged:function(e,t){this.setAttribute("aria-disabled",e?"true":"false"),this.style.pointerEvents=e?"none":"",e?(this._oldTabIndex=this.getAttribute("tabindex"),this._setFocused(!1),this.tabIndex=-1,this.blur()):void 0!==this._oldTabIndex&&(null===this._oldTabIndex?this.removeAttribute("tabindex"):this.setAttribute("tabindex",this._oldTabIndex))},_changedControlState:function(){this._controlStateChanged&&this._controlStateChanged()}};var ironControlState={IronControlState:IronControlState};class IronMeta{constructor(e){IronMeta[" "](e),this.type=e&&e.type||"default",this.key=e&&e.key,e&&"value"in e&&(this.value=e.value)}get value(){var e=this.type,t=this.key;if(e&&t)return IronMeta.types[e]&&IronMeta.types[e][t]}set value(e){var t=this.type,i=this.key;t&&i&&(t=IronMeta.types[t]=IronMeta.types[t]||{},null==e?delete t[i]:t[i]=e)}get list(){if(this.type){var e=IronMeta.types[this.type];return e?Object.keys(e).map(function(e){return metaDatas[this.type][e]},this):[]}}byKey(e){return this.key=e,this.value}}IronMeta[" "]=function(){},IronMeta.types={};var metaDatas=IronMeta.types;Polymer({is:"iron-meta",properties:{type:{type:String,value:"default"},key:{type:String},value:{type:String,notify:!0},self:{type:Boolean,observer:"_selfChanged"},__meta:{type:Boolean,computed:"__computeMeta(type, key, value)"}},hostAttributes:{hidden:!0},__computeMeta:function(e,t,i){var r=new IronMeta({type:e,key:t});return void 0!==i&&i!==r.value?r.value=i:this.value!==r.value&&(this.value=r.value),r},get list(){return this.__meta&&this.__meta.list},_selfChanged:function(e){e&&(this.value=this)},byKey:function(e){return new IronMeta({type:this.type,key:e}).value}});var ironMeta={IronMeta:IronMeta};let IronValidatableBehaviorMeta=null;const IronValidatableBehavior={properties:{validator:{type:String},invalid:{notify:!0,reflectToAttribute:!0,type:Boolean,value:!1,observer:"_invalidChanged"}},registered:function(){IronValidatableBehaviorMeta=new IronMeta({type:"validator"})},_invalidChanged:function(){this.invalid?this.setAttribute("aria-invalid","true"):this.removeAttribute("aria-invalid")},get _validator(){return IronValidatableBehaviorMeta&&IronValidatableBehaviorMeta.byKey(this.validator)},hasValidator:function(){return null!=this._validator},validate:function(e){return void 0===e&&void 0!==this.value?this.invalid=!this._getValidity(this.value):this.invalid=!this._getValidity(e),!this.invalid},_getValidity:function(e){return!this.hasValidator()||this._validator.validate(e)}};var ironValidatableBehavior={get IronValidatableBehaviorMeta(){return IronValidatableBehaviorMeta},IronValidatableBehavior:IronValidatableBehavior};Polymer({_template:html`
    <style>
      :host {
        display: inline-block;
        position: relative;
        width: 400px;
        border: 1px solid;
        padding: 2px;
        -moz-appearance: textarea;
        -webkit-appearance: textarea;
        overflow: hidden;
      }

      .mirror-text {
        visibility: hidden;
        word-wrap: break-word;
        @apply --iron-autogrow-textarea;
      }

      .fit {
        @apply --layout-fit;
      }

      textarea {
        position: relative;
        outline: none;
        border: none;
        resize: none;
        background: inherit;
        color: inherit;
        /* see comments in template */
        width: 100%;
        height: 100%;
        font-size: inherit;
        font-family: inherit;
        line-height: inherit;
        text-align: inherit;
        @apply --iron-autogrow-textarea;
      }

      textarea::-webkit-input-placeholder {
        @apply --iron-autogrow-textarea-placeholder;
      }

      textarea:-moz-placeholder {
        @apply --iron-autogrow-textarea-placeholder;
      }

      textarea::-moz-placeholder {
        @apply --iron-autogrow-textarea-placeholder;
      }

      textarea:-ms-input-placeholder {
        @apply --iron-autogrow-textarea-placeholder;
      }
    </style>

    <!-- the mirror sizes the input/textarea so it grows with typing -->
    <!-- use &#160; instead &nbsp; of to allow this element to be used in XHTML -->
    <div id="mirror" class="mirror-text" aria-hidden="true">&nbsp;</div>

    <!-- size the input/textarea with a div, because the textarea has intrinsic size in ff -->
    <div class="textarea-container fit">
      <textarea id="textarea" name\$="[[name]]" aria-label\$="[[label]]" autocomplete\$="[[autocomplete]]" autofocus\$="[[autofocus]]" inputmode\$="[[inputmode]]" placeholder\$="[[placeholder]]" readonly\$="[[readonly]]" required\$="[[required]]" disabled\$="[[disabled]]" rows\$="[[rows]]" minlength\$="[[minlength]]" maxlength\$="[[maxlength]]"></textarea>
    </div>
`,is:"iron-autogrow-textarea",behaviors:[IronValidatableBehavior,IronControlState],properties:{value:{observer:"_valueChanged",type:String,notify:!0},bindValue:{observer:"_bindValueChanged",type:String,notify:!0},rows:{type:Number,value:1,observer:"_updateCached"},maxRows:{type:Number,value:0,observer:"_updateCached"},autocomplete:{type:String,value:"off"},autofocus:{type:Boolean,value:!1},inputmode:{type:String},placeholder:{type:String},readonly:{type:String},required:{type:Boolean},minlength:{type:Number},maxlength:{type:Number},label:{type:String}},listeners:{input:"_onInput"},get textarea(){return this.$.textarea},get selectionStart(){return this.$.textarea.selectionStart},get selectionEnd(){return this.$.textarea.selectionEnd},set selectionStart(e){this.$.textarea.selectionStart=e},set selectionEnd(e){this.$.textarea.selectionEnd=e},attached:function(){navigator.userAgent.match(/iP(?:[oa]d|hone)/)&&(this.$.textarea.style.marginLeft="-3px")},validate:function(){var e=this.$.textarea.validity.valid;return e&&(this.required&&""===this.value?e=!1:this.hasValidator()&&(e=IronValidatableBehavior.validate.call(this,this.value))),this.invalid=!e,this.fire("iron-input-validate"),e},_bindValueChanged:function(e){this.value=e},_valueChanged:function(e){var t=this.textarea;t&&(t.value!==e&&(t.value=e||0===e?e:""),this.bindValue=e,this.$.mirror.innerHTML=this._valueForMirror(),this.fire("bind-value-changed",{value:this.bindValue}))},_onInput:function(e){var t=dom(e).path;this.value=t?t[0].value:e.target.value},_constrain:function(e){var t;for(e=e||[""],t=0<this.maxRows&&e.length>this.maxRows?e.slice(0,this.maxRows):e.slice(0);0<this.rows&&t.length<this.rows;)t.push("");return t.join("<br/>")+"&#160;"},_valueForMirror:function(){var e=this.textarea;if(e)return this.tokens=e&&e.value?e.value.replace(/&/gm,"&amp;").replace(/"/gm,"&quot;").replace(/'/gm,"&#39;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").split("\n"):[""],this._constrain(this.tokens)},_updateCached:function(){this.$.mirror.innerHTML=this._constrain(this.tokens)}});const IronButtonStateImpl={properties:{pressed:{type:Boolean,readOnly:!0,value:!1,reflectToAttribute:!0,observer:"_pressedChanged"},toggles:{type:Boolean,value:!1,reflectToAttribute:!0},active:{type:Boolean,value:!1,notify:!0,reflectToAttribute:!0},pointerDown:{type:Boolean,readOnly:!0,value:!1},receivedFocusFromKeyboard:{type:Boolean,readOnly:!0},ariaActiveAttribute:{type:String,value:"aria-pressed",observer:"_ariaActiveAttributeChanged"}},listeners:{down:"_downHandler",up:"_upHandler",tap:"_tapHandler"},observers:["_focusChanged(focused)","_activeChanged(active, ariaActiveAttribute)"],keyBindings:{"enter:keydown":"_asyncClick","space:keydown":"_spaceKeyDownHandler","space:keyup":"_spaceKeyUpHandler"},_mouseEventRe:/^mouse/,_tapHandler:function(){this.toggles?this._userActivate(!this.active):this.active=!1},_focusChanged:function(e){this._detectKeyboardFocus(e),e||this._setPressed(!1)},_detectKeyboardFocus:function(e){this._setReceivedFocusFromKeyboard(!this.pointerDown&&e)},_userActivate:function(e){this.active!==e&&(this.active=e,this.fire("change"))},_downHandler:function(e){this._setPointerDown(!0),this._setPressed(!0),this._setReceivedFocusFromKeyboard(!1)},_upHandler:function(){this._setPointerDown(!1),this._setPressed(!1)},_spaceKeyDownHandler:function(e){var t=e.detail.keyboardEvent,i=dom(t).localTarget;this.isLightDescendant(i)||(t.preventDefault(),t.stopImmediatePropagation(),this._setPressed(!0))},_spaceKeyUpHandler:function(e){var t=e.detail.keyboardEvent,i=dom(t).localTarget;this.isLightDescendant(i)||(this.pressed&&this._asyncClick(),this._setPressed(!1))},_asyncClick:function(){this.async(function(){this.click()},1)},_pressedChanged:function(e){this._changedButtonState()},_ariaActiveAttributeChanged:function(e,t){t&&t!=e&&this.hasAttribute(t)&&this.removeAttribute(t)},_activeChanged:function(e,t){this.toggles?this.setAttribute(this.ariaActiveAttribute,e?"true":"false"):this.removeAttribute(this.ariaActiveAttribute),this._changedButtonState()},_controlStateChanged:function(){this.disabled?this._setPressed(!1):this._changedButtonState()},_changedButtonState:function(){this._buttonStateChanged&&this._buttonStateChanged()}},IronButtonState=[IronA11yKeysBehavior,IronButtonStateImpl];var ironButtonState={IronButtonStateImpl:IronButtonStateImpl,IronButtonState:IronButtonState};const IronFormElementBehavior={properties:{name:{type:String},value:{notify:!0,type:String},required:{type:Boolean,value:!1}},attached:function(){},detached:function(){}};var ironFormElementBehavior={IronFormElementBehavior:IronFormElementBehavior};const IronCheckedElementBehaviorImpl={properties:{checked:{type:Boolean,value:!1,reflectToAttribute:!0,notify:!0,observer:"_checkedChanged"},toggles:{type:Boolean,value:!0,reflectToAttribute:!0},value:{type:String,value:"on",observer:"_valueChanged"}},observers:["_requiredChanged(required)"],created:function(){this._hasIronCheckedElementBehavior=!0},_getValidity:function(e){return this.disabled||!this.required||this.checked},_requiredChanged:function(){this.required?this.setAttribute("aria-required","true"):this.removeAttribute("aria-required")},_checkedChanged:function(){this.active=this.checked,this.fire("iron-change")},_valueChanged:function(){void 0!==this.value&&null!==this.value||(this.value="on")}},IronCheckedElementBehavior=[IronFormElementBehavior,IronValidatableBehavior,IronCheckedElementBehaviorImpl];var ironCheckedElementBehavior={IronCheckedElementBehaviorImpl:IronCheckedElementBehaviorImpl,IronCheckedElementBehavior:IronCheckedElementBehavior};const IronFitBehavior={properties:{sizingTarget:{type:Object,value:function(){return this}},fitInto:{type:Object,value:window},noOverlap:{type:Boolean},positionTarget:{type:Element},horizontalAlign:{type:String},verticalAlign:{type:String},dynamicAlign:{type:Boolean},horizontalOffset:{type:Number,value:0,notify:!0},verticalOffset:{type:Number,value:0,notify:!0},autoFitOnAttach:{type:Boolean,value:!1},_fitInfo:{type:Object}},get _fitWidth(){return this.fitInto===window?this.fitInto.innerWidth:this.fitInto.getBoundingClientRect().width},get _fitHeight(){return this.fitInto===window?this.fitInto.innerHeight:this.fitInto.getBoundingClientRect().height},get _fitLeft(){return this.fitInto===window?0:this.fitInto.getBoundingClientRect().left},get _fitTop(){return this.fitInto===window?0:this.fitInto.getBoundingClientRect().top},get _defaultPositionTarget(){var e=dom(this).parentNode;return e&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(e=e.host),e},get _localeHorizontalAlign(){if(this._isRTL){if("right"===this.horizontalAlign)return"left";if("left"===this.horizontalAlign)return"right"}return this.horizontalAlign},get __shouldPosition(){return(this.horizontalAlign||this.verticalAlign)&&this.positionTarget},attached:function(){void 0===this._isRTL&&(this._isRTL="rtl"==window.getComputedStyle(this).direction),this.positionTarget=this.positionTarget||this._defaultPositionTarget,this.autoFitOnAttach&&("none"===window.getComputedStyle(this).display?setTimeout(function(){this.fit()}.bind(this)):(window.ShadyDOM&&ShadyDOM.flush(),this.fit()))},detached:function(){this.__deferredFit&&(clearTimeout(this.__deferredFit),this.__deferredFit=null)},fit:function(){this.position(),this.constrain(),this.center()},_discoverInfo:function(){if(!this._fitInfo){var e=window.getComputedStyle(this),t=window.getComputedStyle(this.sizingTarget);this._fitInfo={inlineStyle:{top:this.style.top||"",left:this.style.left||"",position:this.style.position||""},sizerInlineStyle:{maxWidth:this.sizingTarget.style.maxWidth||"",maxHeight:this.sizingTarget.style.maxHeight||"",boxSizing:this.sizingTarget.style.boxSizing||""},positionedBy:{vertically:"auto"!==e.top?"top":"auto"!==e.bottom?"bottom":null,horizontally:"auto"!==e.left?"left":"auto"!==e.right?"right":null},sizedBy:{height:"none"!==t.maxHeight,width:"none"!==t.maxWidth,minWidth:parseInt(t.minWidth,10)||0,minHeight:parseInt(t.minHeight,10)||0},margin:{top:parseInt(e.marginTop,10)||0,right:parseInt(e.marginRight,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0}}}},resetFit:function(){var e=this._fitInfo||{};for(var t in e.sizerInlineStyle)this.sizingTarget.style[t]=e.sizerInlineStyle[t];for(var t in e.inlineStyle)this.style[t]=e.inlineStyle[t];this._fitInfo=null},refit:function(){var e=this.sizingTarget.scrollLeft,t=this.sizingTarget.scrollTop;this.resetFit(),this.fit(),this.sizingTarget.scrollLeft=e,this.sizingTarget.scrollTop=t},position:function(){if(this.__shouldPosition){this._discoverInfo(),this.style.position="fixed",this.sizingTarget.style.boxSizing="border-box",this.style.left="0px",this.style.top="0px";var e=this.getBoundingClientRect(),t=this.__getNormalizedRect(this.positionTarget),i=this.__getNormalizedRect(this.fitInto),r=this._fitInfo.margin,n={width:e.width+r.left+r.right,height:e.height+r.top+r.bottom},a=this.__getPosition(this._localeHorizontalAlign,this.verticalAlign,n,e,t,i),o=a.left+r.left,s=a.top+r.top,l=Math.min(i.right-r.right,o+e.width),c=Math.min(i.bottom-r.bottom,s+e.height);o=Math.max(i.left+r.left,Math.min(o,l-this._fitInfo.sizedBy.minWidth)),s=Math.max(i.top+r.top,Math.min(s,c-this._fitInfo.sizedBy.minHeight)),this.sizingTarget.style.maxWidth=Math.max(l-o,this._fitInfo.sizedBy.minWidth)+"px",this.sizingTarget.style.maxHeight=Math.max(c-s,this._fitInfo.sizedBy.minHeight)+"px",this.style.left=o-e.left+"px",this.style.top=s-e.top+"px"}},constrain:function(){if(!this.__shouldPosition){this._discoverInfo();var e=this._fitInfo;e.positionedBy.vertically||(this.style.position="fixed",this.style.top="0px"),e.positionedBy.horizontally||(this.style.position="fixed",this.style.left="0px"),this.sizingTarget.style.boxSizing="border-box";var t=this.getBoundingClientRect();e.sizedBy.height||this.__sizeDimension(t,e.positionedBy.vertically,"top","bottom","Height"),e.sizedBy.width||this.__sizeDimension(t,e.positionedBy.horizontally,"left","right","Width")}},_sizeDimension:function(e,t,i,r,n){this.__sizeDimension(e,t,i,r,n)},__sizeDimension:function(e,t,i,r,n){var a=this._fitInfo,o=this.__getNormalizedRect(this.fitInto),s="Width"===n?o.width:o.height,l=t===r,c=l?s-e[r]:e[i],h=a.margin[l?i:r],u="offset"+n,d=this[u]-this.sizingTarget[u];this.sizingTarget.style["max"+n]=s-h-c-d+"px"},center:function(){if(!this.__shouldPosition){this._discoverInfo();var e=this._fitInfo.positionedBy;if(!e.vertically||!e.horizontally){this.style.position="fixed",e.vertically||(this.style.top="0px"),e.horizontally||(this.style.left="0px");var t=this.getBoundingClientRect(),i=this.__getNormalizedRect(this.fitInto);if(!e.vertically){var r=i.top-t.top+(i.height-t.height)/2;this.style.top=r+"px"}if(!e.horizontally){var n=i.left-t.left+(i.width-t.width)/2;this.style.left=n+"px"}}}},__getNormalizedRect:function(e){return e===document.documentElement||e===window?{top:0,left:0,width:window.innerWidth,height:window.innerHeight,right:window.innerWidth,bottom:window.innerHeight}:e.getBoundingClientRect()},__getOffscreenArea:function(e,t,i){var r=Math.min(0,e.top)+Math.min(0,i.bottom-(e.top+t.height)),n=Math.min(0,e.left)+Math.min(0,i.right-(e.left+t.width));return Math.abs(r)*t.width+Math.abs(n)*t.height},__getPosition:function(e,t,i,r,n,a){var o=[{verticalAlign:"top",horizontalAlign:"left",top:n.top+this.verticalOffset,left:n.left+this.horizontalOffset},{verticalAlign:"top",horizontalAlign:"right",top:n.top+this.verticalOffset,left:n.right-i.width-this.horizontalOffset},{verticalAlign:"bottom",horizontalAlign:"left",top:n.bottom-i.height-this.verticalOffset,left:n.left+this.horizontalOffset},{verticalAlign:"bottom",horizontalAlign:"right",top:n.bottom-i.height-this.verticalOffset,left:n.right-i.width-this.horizontalOffset}];if(this.noOverlap){for(var s,l=0,c=o.length;l<c;l++){for(var h in s={},o[l])s[h]=o[l][h];o.push(s)}o[0].top=o[1].top+=n.height,o[2].top=o[3].top-=n.height,o[4].left=o[6].left+=n.width,o[5].left=o[7].left-=n.width}t="auto"===t?null:t,(e="auto"===e?null:e)&&"center"!==e||(o.push({verticalAlign:"top",horizontalAlign:"center",top:n.top+this.verticalOffset+(this.noOverlap?n.height:0),left:n.left-r.width/2+n.width/2+this.horizontalOffset}),o.push({verticalAlign:"bottom",horizontalAlign:"center",top:n.bottom-i.height-this.verticalOffset-(this.noOverlap?n.height:0),left:n.left-r.width/2+n.width/2+this.horizontalOffset})),t&&"middle"!==t||(o.push({verticalAlign:"middle",horizontalAlign:"left",top:n.top-r.height/2+n.height/2+this.verticalOffset,left:n.left+this.horizontalOffset+(this.noOverlap?n.width:0)}),o.push({verticalAlign:"middle",horizontalAlign:"right",top:n.top-r.height/2+n.height/2+this.verticalOffset,left:n.right-i.width-this.horizontalOffset-(this.noOverlap?n.width:0)})),"middle"===t&&"center"===e&&o.push({verticalAlign:"middle",horizontalAlign:"center",top:n.top-r.height/2+n.height/2+this.verticalOffset,left:n.left-r.width/2+n.width/2+this.horizontalOffset});var u;for(l=0;l<o.length;l++){var d=o[l],p=d.verticalAlign===t,m=d.horizontalAlign===e;if(!this.dynamicAlign&&!this.noOverlap&&p&&m){u=d;break}var f=(!t||p)&&(!e||m);if(this.dynamicAlign||f){if(d.offscreenArea=this.__getOffscreenArea(d,i,a),0===d.offscreenArea&&f){u=d;break}u=u||d;var g=d.offscreenArea-u.offscreenArea;(0>g||0===g&&(p||m))&&(u=d)}}return u}};var ironFitBehavior={IronFitBehavior:IronFitBehavior},p$1=Element.prototype,matches$1=p$1.matches||p$1.matchesSelector||p$1.mozMatchesSelector||p$1.msMatchesSelector||p$1.oMatchesSelector||p$1.webkitMatchesSelector;const IronFocusablesHelper={getTabbableNodes:function(e){var t=[];return this._collectTabbableNodes(e,t)?this._sortByTabIndex(t):t},isFocusable:function(e){return matches$1.call(e,"input, select, textarea, button, object")?matches$1.call(e,":not([disabled])"):matches$1.call(e,"a[href], area[href], iframe, [tabindex], [contentEditable]")},isTabbable:function(e){return this.isFocusable(e)&&matches$1.call(e,':not([tabindex="-1"])')&&this._isVisible(e)},_normalizedTabIndex:function(e){return this.isFocusable(e)?+(e.getAttribute("tabindex")||0):-1},_collectTabbableNodes:function(e,t){if(e.nodeType!==Node.ELEMENT_NODE||!this._isVisible(e))return!1;var i,r=e,n=this._normalizedTabIndex(r),a=0<n;0<=n&&t.push(r),i="content"===r.localName||"slot"===r.localName?dom(r).getDistributedNodes():dom(r.root||r).children;for(var o=0;o<i.length;o++)a=this._collectTabbableNodes(i[o],t)||a;return a},_isVisible:function(e){var t=e.style;return"hidden"!==t.visibility&&"none"!==t.display&&("hidden"!==(t=window.getComputedStyle(e)).visibility&&"none"!==t.display)},_sortByTabIndex:function(e){var t=e.length;if(2>t)return e;var i=Math.ceil(t/2),r=this._sortByTabIndex(e.slice(0,i)),n=this._sortByTabIndex(e.slice(i));return this._mergeSortByTabIndex(r,n)},_mergeSortByTabIndex:function(e,t){for(var i=[];0<e.length&&0<t.length;)this._hasLowerTabOrder(e[0],t[0])?i.push(t.shift()):i.push(e.shift());return i.concat(e,t)},_hasLowerTabOrder:function(e,t){var i=Math.max(e.tabIndex,0),r=Math.max(t.tabIndex,0);return 0===i||0===r?r>i:i>r}};var ironFocusablesHelper={IronFocusablesHelper:IronFocusablesHelper};Polymer({_template:html`
    <style>
      :host {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: var(--iron-overlay-backdrop-background-color, #000);
        opacity: 0;
        transition: opacity 0.2s;
        pointer-events: none;
        @apply --iron-overlay-backdrop;
      }

      :host(.opened) {
        opacity: var(--iron-overlay-backdrop-opacity, 0.6);
        pointer-events: auto;
        @apply --iron-overlay-backdrop-opened;
      }
    </style>

    <slot></slot>
`,is:"iron-overlay-backdrop",properties:{opened:{reflectToAttribute:!0,type:Boolean,value:!1,observer:"_openedChanged"}},listeners:{transitionend:"_onTransitionend"},created:function(){this.__openedRaf=null},attached:function(){this.opened&&this._openedChanged(this.opened)},prepare:function(){this.opened&&!this.parentNode&&dom(document.body).appendChild(this)},open:function(){this.opened=!0},close:function(){this.opened=!1},complete:function(){this.opened||this.parentNode!==document.body||dom(this.parentNode).removeChild(this)},_onTransitionend:function(e){e&&e.target===this&&this.complete()},_openedChanged:function(e){if(e)this.prepare();else{var t=window.getComputedStyle(this);"0s"!==t.transitionDuration&&0!=t.opacity||this.complete()}this.isAttached&&(this.__openedRaf&&(window.cancelAnimationFrame(this.__openedRaf),this.__openedRaf=null),this.scrollTop=this.scrollTop,this.__openedRaf=window.requestAnimationFrame(function(){this.__openedRaf=null,this.toggleClass("opened",this.opened)}.bind(this)))}});const IronOverlayManagerClass=function(){this._overlays=[],this._minimumZ=101,this._backdropElement=null,add(document.documentElement,"tap",function(){}),document.addEventListener("tap",this._onCaptureClick.bind(this),!0),document.addEventListener("focus",this._onCaptureFocus.bind(this),!0),document.addEventListener("keydown",this._onCaptureKeyDown.bind(this),!0)};IronOverlayManagerClass.prototype={constructor:IronOverlayManagerClass,get backdropElement(){return this._backdropElement||(this._backdropElement=document.createElement("iron-overlay-backdrop")),this._backdropElement},get deepActiveElement(){var e=document.activeElement;for(e&&!1!=e instanceof Element||(e=document.body);e.root&&dom(e.root).activeElement;)e=dom(e.root).activeElement;return e},_bringOverlayAtIndexToFront:function(e){var t=this._overlays[e];if(t){var i=this._overlays.length-1,r=this._overlays[i];if(r&&this._shouldBeBehindOverlay(t,r)&&i--,!(e>=i)){var n=Math.max(this.currentOverlayZ(),this._minimumZ);for(this._getZ(t)<=n&&this._applyOverlayZ(t,n);e<i;)this._overlays[e]=this._overlays[e+1],e++;this._overlays[i]=t}}},addOrRemoveOverlay:function(e){e.opened?this.addOverlay(e):this.removeOverlay(e)},addOverlay:function(e){var t=this._overlays.indexOf(e);if(0<=t)return this._bringOverlayAtIndexToFront(t),void this.trackBackdrop();var i=this._overlays.length,r=this._overlays[i-1],n=Math.max(this._getZ(r),this._minimumZ),a=this._getZ(e);if(r&&this._shouldBeBehindOverlay(e,r)){this._applyOverlayZ(r,n),i--;var o=this._overlays[i-1];n=Math.max(this._getZ(o),this._minimumZ)}a<=n&&this._applyOverlayZ(e,n),this._overlays.splice(i,0,e),this.trackBackdrop()},removeOverlay:function(e){var t=this._overlays.indexOf(e);-1!==t&&(this._overlays.splice(t,1),this.trackBackdrop())},currentOverlay:function(){var e=this._overlays.length-1;return this._overlays[e]},currentOverlayZ:function(){return this._getZ(this.currentOverlay())},ensureMinimumZ:function(e){this._minimumZ=Math.max(this._minimumZ,e)},focusOverlay:function(){var e=this.currentOverlay();e&&e._applyFocus()},trackBackdrop:function(){var e=this._overlayWithBackdrop();(e||this._backdropElement)&&(this.backdropElement.style.zIndex=this._getZ(e)-1,this.backdropElement.opened=!!e,this.backdropElement.prepare())},getBackdrops:function(){for(var e=[],t=0;t<this._overlays.length;t++)this._overlays[t].withBackdrop&&e.push(this._overlays[t]);return e},backdropZ:function(){return this._getZ(this._overlayWithBackdrop())-1},_overlayWithBackdrop:function(){for(var e=this._overlays.length-1;0<=e;e--)if(this._overlays[e].withBackdrop)return this._overlays[e]},_getZ:function(e){var t=this._minimumZ;if(e){var i=+(e.style.zIndex||window.getComputedStyle(e).zIndex);i==i&&(t=i)}return t},_setZ:function(e,t){e.style.zIndex=t},_applyOverlayZ:function(e,t){this._setZ(e,t+2)},_overlayInPath:function(e){e=e||[];for(var t=0;t<e.length;t++)if(e[t]._manager===this)return e[t]},_onCaptureClick:function(e){var t=this._overlays.length-1;if(-1!==t)for(var i,r=dom(e).path;(i=this._overlays[t])&&this._overlayInPath(r)!==i&&(i._onCaptureClick(e),i.allowClickThrough);)t--},_onCaptureFocus:function(e){var t=this.currentOverlay();t&&t._onCaptureFocus(e)},_onCaptureKeyDown:function(e){var t=this.currentOverlay();t&&(IronA11yKeysBehavior.keyboardEventMatchesKeys(e,"esc")?t._onCaptureEsc(e):IronA11yKeysBehavior.keyboardEventMatchesKeys(e,"tab")&&t._onCaptureTab(e))},_shouldBeBehindOverlay:function(e,t){return!e.alwaysOnTop&&t.alwaysOnTop}};const IronOverlayManager=new IronOverlayManagerClass;var _boundScrollHandler,currentLockingElement,ironOverlayManager={IronOverlayManagerClass:IronOverlayManagerClass,IronOverlayManager:IronOverlayManager},lastTouchPosition={pageX:0,pageY:0},lastRootTarget=null,lastScrollableNodes=[],scrollEvents=["wheel","mousewheel","DOMMouseScroll","touchstart","touchmove"];function elementIsScrollLocked(e){var t,i=currentLockingElement;return void 0!==i&&(!!_hasCachedLockedElement(e)||!_hasCachedUnlockedElement(e)&&((t=!!i&&i!==e&&!_composedTreeContains(i,e))?_lockedElementCache.push(e):_unlockedElementCache.push(e),t))}function pushScrollLock(e){0<=_lockingElements.indexOf(e)||(0===_lockingElements.length&&_lockScrollInteractions(),_lockingElements.push(e),currentLockingElement=_lockingElements[_lockingElements.length-1],_lockedElementCache=[],_unlockedElementCache=[])}function removeScrollLock(e){var t=_lockingElements.indexOf(e);-1!==t&&(_lockingElements.splice(t,1),currentLockingElement=_lockingElements[_lockingElements.length-1],_lockedElementCache=[],_unlockedElementCache=[],0===_lockingElements.length&&_unlockScrollInteractions())}const _lockingElements=[];let _lockedElementCache=null,_unlockedElementCache=null;function _hasCachedLockedElement(e){return-1<_lockedElementCache.indexOf(e)}function _hasCachedUnlockedElement(e){return-1<_unlockedElementCache.indexOf(e)}function _composedTreeContains(e,t){var i,r,n,a;if(e.contains(t))return!0;for(i=dom(e).querySelectorAll("content,slot"),n=0;n<i.length;++n)for(r=dom(i[n]).getDistributedNodes(),a=0;a<r.length;++a)if(r[a].nodeType===Node.ELEMENT_NODE&&_composedTreeContains(r[a],t))return!0;return!1}function _scrollInteractionHandler(e){if(e.cancelable&&_shouldPreventScrolling(e)&&e.preventDefault(),e.targetTouches){var t=e.targetTouches[0];lastTouchPosition.pageX=t.pageX,lastTouchPosition.pageY=t.pageY}}function _lockScrollInteractions(){_boundScrollHandler=_boundScrollHandler||_scrollInteractionHandler.bind(void 0);for(var e=0,t=scrollEvents.length;e<t;e++)document.addEventListener(scrollEvents[e],_boundScrollHandler,{capture:!0,passive:!1})}function _unlockScrollInteractions(){for(var e=0,t=scrollEvents.length;e<t;e++)document.removeEventListener(scrollEvents[e],_boundScrollHandler,{capture:!0,passive:!1})}function _shouldPreventScrolling(e){var t=dom(e).rootTarget;if("touchmove"!==e.type&&lastRootTarget!==t&&(lastRootTarget=t,lastScrollableNodes=_getScrollableNodes(dom(e).path)),!lastScrollableNodes.length)return!0;if("touchstart"===e.type)return!1;var i=_getScrollInfo(e);return!_getScrollingNode(lastScrollableNodes,i.deltaX,i.deltaY)}function _getScrollableNodes(e){for(var t=[],i=e.indexOf(currentLockingElement),r=0;r<=i;r++)if(e[r].nodeType===Node.ELEMENT_NODE){var n=e[r],a=n.style;"scroll"!==a.overflow&&"auto"!==a.overflow&&(a=window.getComputedStyle(n)),"scroll"!==a.overflow&&"auto"!==a.overflow||t.push(n)}return t}function _getScrollingNode(e,t,i){if(t||i)for(var r=Math.abs(i)>=Math.abs(t),n=0;n<e.length;n++){var a=e[n];if(r?0>i?0<a.scrollTop:a.scrollTop<a.scrollHeight-a.clientHeight:0>t?0<a.scrollLeft:a.scrollLeft<a.scrollWidth-a.clientWidth)return a}}function _getScrollInfo(e){var t={deltaX:e.deltaX,deltaY:e.deltaY};if("deltaX"in e);else if("wheelDeltaX"in e&&"wheelDeltaY"in e)t.deltaX=-e.wheelDeltaX,t.deltaY=-e.wheelDeltaY;else if("wheelDelta"in e)t.deltaX=0,t.deltaY=-e.wheelDelta;else if("axis"in e)t.deltaX=1===e.axis?e.detail:0,t.deltaY=2===e.axis?e.detail:0;else if(e.targetTouches){var i=e.targetTouches[0];t.deltaX=lastTouchPosition.pageX-i.pageX,t.deltaY=lastTouchPosition.pageY-i.pageY}return t}var ironScrollManager={get currentLockingElement(){return currentLockingElement},elementIsScrollLocked:elementIsScrollLocked,pushScrollLock:pushScrollLock,removeScrollLock:removeScrollLock,_lockingElements:_lockingElements,get _lockedElementCache(){return _lockedElementCache},get _unlockedElementCache(){return _unlockedElementCache},_hasCachedLockedElement:_hasCachedLockedElement,_hasCachedUnlockedElement:_hasCachedUnlockedElement,_composedTreeContains:_composedTreeContains,_scrollInteractionHandler:_scrollInteractionHandler,get _boundScrollHandler(){return _boundScrollHandler},_lockScrollInteractions:_lockScrollInteractions,_unlockScrollInteractions:_unlockScrollInteractions,_shouldPreventScrolling:_shouldPreventScrolling,_getScrollableNodes:_getScrollableNodes,_getScrollingNode:_getScrollingNode,_getScrollInfo:_getScrollInfo};const IronOverlayBehaviorImpl={properties:{opened:{observer:"_openedChanged",type:Boolean,value:!1,notify:!0},canceled:{observer:"_canceledChanged",readOnly:!0,type:Boolean,value:!1},withBackdrop:{observer:"_withBackdropChanged",type:Boolean},noAutoFocus:{type:Boolean,value:!1},noCancelOnEscKey:{type:Boolean,value:!1},noCancelOnOutsideClick:{type:Boolean,value:!1},closingReason:{type:Object},restoreFocusOnClose:{type:Boolean,value:!1},allowClickThrough:{type:Boolean},alwaysOnTop:{type:Boolean},scrollAction:{type:String},_manager:{type:Object,value:IronOverlayManager},_focusedChild:{type:Object}},listeners:{"iron-resize":"_onIronResize"},observers:["__updateScrollObservers(isAttached, opened, scrollAction)"],get backdropElement(){return this._manager.backdropElement},get _focusNode(){return this._focusedChild||dom(this).querySelector("[autofocus]")||this},get _focusableNodes(){return IronFocusablesHelper.getTabbableNodes(this)},ready:function(){this.__isAnimating=!1,this.__shouldRemoveTabIndex=!1,this.__firstFocusableNode=this.__lastFocusableNode=null,this.__rafs={},this.__restoreFocusNode=null,this.__scrollTop=this.__scrollLeft=null,this.__onCaptureScroll=this.__onCaptureScroll.bind(this),this.__rootNodes=null,this._ensureSetup()},attached:function(){this.opened&&this._openedChanged(this.opened),this._observer=dom(this).observeNodes(this._onNodesChange)},detached:function(){for(var e in dom(this).unobserveNodes(this._observer),this._observer=null,this.__rafs)null!==this.__rafs[e]&&cancelAnimationFrame(this.__rafs[e]);this.__rafs={},this._manager.removeOverlay(this),this.__isAnimating&&(this.opened?this._finishRenderOpened():(this._applyFocus(),this._finishRenderClosed()))},toggle:function(){this._setCanceled(!1),this.opened=!this.opened},open:function(){this._setCanceled(!1),this.opened=!0},close:function(){this._setCanceled(!1),this.opened=!1},cancel:function(e){this.fire("iron-overlay-canceled",e,{cancelable:!0}).defaultPrevented||(this._setCanceled(!0),this.opened=!1)},invalidateTabbables:function(){this.__firstFocusableNode=this.__lastFocusableNode=null},_ensureSetup:function(){this._overlaySetup||(this._overlaySetup=!0,this.style.outline="none",this.style.display="none")},_openedChanged:function(e){e?this.removeAttribute("aria-hidden"):this.setAttribute("aria-hidden","true"),this.isAttached&&(this.__isAnimating=!0,this.__deraf("__openedChanged",this.__openedChanged))},_canceledChanged:function(){this.closingReason=this.closingReason||{},this.closingReason.canceled=this.canceled},_withBackdropChanged:function(){this.withBackdrop&&!this.hasAttribute("tabindex")?(this.setAttribute("tabindex","-1"),this.__shouldRemoveTabIndex=!0):this.__shouldRemoveTabIndex&&(this.removeAttribute("tabindex"),this.__shouldRemoveTabIndex=!1),this.opened&&this.isAttached&&this._manager.trackBackdrop()},_prepareRenderOpened:function(){this.__restoreFocusNode=this._manager.deepActiveElement,this._preparePositioning(),this.refit(),this._finishPositioning(),this.noAutoFocus&&document.activeElement===this._focusNode&&(this._focusNode.blur(),this.__restoreFocusNode.focus())},_renderOpened:function(){this._finishRenderOpened()},_renderClosed:function(){this._finishRenderClosed()},_finishRenderOpened:function(){this.notifyResize(),this.__isAnimating=!1,this.fire("iron-overlay-opened")},_finishRenderClosed:function(){this.style.display="none",this.style.zIndex="",this.notifyResize(),this.__isAnimating=!1,this.fire("iron-overlay-closed",this.closingReason)},_preparePositioning:function(){this.style.transition=this.style.webkitTransition="none",this.style.transform=this.style.webkitTransform="none",this.style.display=""},_finishPositioning:function(){this.style.display="none",this.scrollTop=this.scrollTop,this.style.transition=this.style.webkitTransition="",this.style.transform=this.style.webkitTransform="",this.style.display="",this.scrollTop=this.scrollTop},_applyFocus:function(){if(this.opened)this.noAutoFocus||this._focusNode.focus();else{if(this.restoreFocusOnClose&&this.__restoreFocusNode){var e=this._manager.deepActiveElement;(e===document.body||dom(this).deepContains(e))&&this.__restoreFocusNode.focus()}this.__restoreFocusNode=null,this._focusNode.blur(),this._focusedChild=null}},_onCaptureClick:function(e){this.noCancelOnOutsideClick||this.cancel(e)},_onCaptureFocus:function(e){if(this.withBackdrop){var t=dom(e).path;-1===t.indexOf(this)?(e.stopPropagation(),this._applyFocus()):this._focusedChild=t[0]}},_onCaptureEsc:function(e){this.noCancelOnEscKey||this.cancel(e)},_onCaptureTab:function(e){if(this.withBackdrop){this.__ensureFirstLastFocusables();var t=e.shiftKey,i=t?this.__firstFocusableNode:this.__lastFocusableNode,r=t?this.__lastFocusableNode:this.__firstFocusableNode,n=!1;if(i===r)n=!0;else{var a=this._manager.deepActiveElement;n=a===i||a===this}n&&(e.preventDefault(),this._focusedChild=r,this._applyFocus())}},_onIronResize:function(){this.opened&&!this.__isAnimating&&this.__deraf("refit",this.refit)},_onNodesChange:function(){this.opened&&!this.__isAnimating&&(this.invalidateTabbables(),this.notifyResize())},__ensureFirstLastFocusables:function(){var e=this._focusableNodes;this.__firstFocusableNode=e[0],this.__lastFocusableNode=e[e.length-1]},__openedChanged:function(){this.opened?(this._prepareRenderOpened(),this._manager.addOverlay(this),this._applyFocus(),this._renderOpened()):(this._manager.removeOverlay(this),this._applyFocus(),this._renderClosed())},__deraf:function(e,t){var i=this.__rafs;null!==i[e]&&cancelAnimationFrame(i[e]),i[e]=requestAnimationFrame(function(){i[e]=null,t.call(this)}.bind(this))},__updateScrollObservers:function(e,t,i){e&&t&&this.__isValidScrollAction(i)?("lock"===i&&(this.__saveScrollPosition(),pushScrollLock(this)),this.__addScrollListeners()):(removeScrollLock(this),this.__removeScrollListeners())},__addScrollListeners:function(){if(!this.__rootNodes){if(this.__rootNodes=[],useShadow)for(var e=this;e;)e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host&&this.__rootNodes.push(e),e=e.host||e.assignedSlot||e.parentNode;this.__rootNodes.push(document)}this.__rootNodes.forEach(function(e){e.addEventListener("scroll",this.__onCaptureScroll,{capture:!0,passive:!0})},this)},__removeScrollListeners:function(){this.__rootNodes&&this.__rootNodes.forEach(function(e){e.removeEventListener("scroll",this.__onCaptureScroll,{capture:!0,passive:!0})},this),this.isAttached||(this.__rootNodes=null)},__isValidScrollAction:function(e){return"lock"===e||"refit"===e||"cancel"===e},__onCaptureScroll:function(e){if(!(this.__isAnimating||0<=dom(e).path.indexOf(this)))switch(this.scrollAction){case"lock":this.__restoreScrollPosition();break;case"refit":this.__deraf("refit",this.refit);break;case"cancel":this.cancel(e)}},__saveScrollPosition:function(){document.scrollingElement?(this.__scrollTop=document.scrollingElement.scrollTop,this.__scrollLeft=document.scrollingElement.scrollLeft):(this.__scrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this.__scrollLeft=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft))},__restoreScrollPosition:function(){document.scrollingElement?(document.scrollingElement.scrollTop=this.__scrollTop,document.scrollingElement.scrollLeft=this.__scrollLeft):(document.documentElement.scrollTop=document.body.scrollTop=this.__scrollTop,document.documentElement.scrollLeft=document.body.scrollLeft=this.__scrollLeft)}},IronOverlayBehavior=[IronFitBehavior,IronResizableBehavior,IronOverlayBehaviorImpl];var ironOverlayBehavior={IronOverlayBehaviorImpl:IronOverlayBehaviorImpl,IronOverlayBehavior:IronOverlayBehavior};const NeonAnimatableBehavior={properties:{animationConfig:{type:Object},entryAnimation:{observer:"_entryAnimationChanged",type:String},exitAnimation:{observer:"_exitAnimationChanged",type:String}},_entryAnimationChanged:function(){this.animationConfig=this.animationConfig||{},this.animationConfig.entry=[{name:this.entryAnimation,node:this}]},_exitAnimationChanged:function(){this.animationConfig=this.animationConfig||{},this.animationConfig.exit=[{name:this.exitAnimation,node:this}]},_copyProperties:function(e,t){for(var i in t)e[i]=t[i]},_cloneConfig:function(e){var t={isClone:!0};return this._copyProperties(t,e),t},_getAnimationConfigRecursive:function(e,t,i){var r;if(this.animationConfig)if(this.animationConfig.value&&"function"==typeof this.animationConfig.value)this._warn(this._logf("playAnimation","Please put 'animationConfig' inside of your components 'properties' object instead of outside of it."));else if(r=e?this.animationConfig[e]:this.animationConfig,Array.isArray(r)||(r=[r]),r)for(var n,a=0;n=r[a];a++)if(n.animatable)n.animatable._getAnimationConfigRecursive(n.type||e,t,i);else if(n.id){var o=t[n.id];o?(o.isClone||(t[n.id]=this._cloneConfig(o),o=t[n.id]),this._copyProperties(o,n)):t[n.id]=n}else i.push(n)},getAnimationConfig:function(e){var t={},i=[];for(var r in this._getAnimationConfigRecursive(e,t,i),t)i.push(t[r]);return i}};var neonAnimatableBehavior={NeonAnimatableBehavior:NeonAnimatableBehavior};const NeonAnimationRunnerBehaviorImpl={_configureAnimations:function(e){var t=[],i=[];if(0<e.length)for(let t,r,n=0;t=e[n];n++)if((r=document.createElement(t.name)).isNeonAnimation){let e=null;r.configure||(r.configure=function(e){return null}),e=r.configure(t),i.push({result:e,config:t,neonAnimation:r})}else console.warn(this.is+":",t.name,"not found!");for(var r=0;r<i.length;r++){let e=i[r].result,n=i[r].config,a=i[r].neonAnimation;try{"function"!=typeof e.cancel&&(e=document.timeline.play(e))}catch(t){e=null,console.warn("Couldnt play","(",n.name,").",t)}e&&t.push({neonAnimation:a,config:n,animation:e})}return t},_shouldComplete:function(e){for(var t=!0,i=0;i<e.length;i++)if("finished"!=e[i].animation.playState){t=!1;break}return t},_complete:function(e){for(var t=0;t<e.length;t++)e[t].neonAnimation.complete(e[t].config);for(t=0;t<e.length;t++)e[t].animation.cancel()},playAnimation:function(e,t){var i=this.getAnimationConfig(e);if(i){this._active=this._active||{},this._active[e]&&(this._complete(this._active[e]),delete this._active[e]);var r=this._configureAnimations(i);if(0!=r.length){this._active[e]=r;for(var n=0;n<r.length;n++)r[n].animation.onfinish=function(){this._shouldComplete(r)&&(this._complete(r),delete this._active[e],this.fire("neon-animation-finish",t,{bubbles:!1}))}.bind(this)}else this.fire("neon-animation-finish",t,{bubbles:!1})}},cancelAnimation:function(){for(var e in this._active){var t=this._active[e];for(var i in t)t[i].animation.cancel()}this._active={}}},NeonAnimationRunnerBehavior=[NeonAnimatableBehavior,NeonAnimationRunnerBehaviorImpl];var neonAnimationRunnerBehavior={NeonAnimationRunnerBehaviorImpl:NeonAnimationRunnerBehaviorImpl,NeonAnimationRunnerBehavior:NeonAnimationRunnerBehavior};Polymer({_template:html`
    <style>
      :host {
        position: fixed;
      }

      #contentWrapper ::slotted(*) {
        overflow: auto;
      }

      #contentWrapper.animating ::slotted(*) {
        overflow: hidden;
        pointer-events: none;
      }
    </style>

    <div id="contentWrapper">
      <slot id="content" name="dropdown-content"></slot>
    </div>
`,is:"iron-dropdown",behaviors:[IronControlState,IronA11yKeysBehavior,IronOverlayBehavior,NeonAnimationRunnerBehavior],properties:{horizontalAlign:{type:String,value:"left",reflectToAttribute:!0},verticalAlign:{type:String,value:"top",reflectToAttribute:!0},openAnimationConfig:{type:Object},closeAnimationConfig:{type:Object},focusTarget:{type:Object},noAnimations:{type:Boolean,value:!1},allowOutsideScroll:{type:Boolean,value:!1,observer:"_allowOutsideScrollChanged"}},listeners:{"neon-animation-finish":"_onNeonAnimationFinish"},observers:["_updateOverlayPosition(positionTarget, verticalAlign, horizontalAlign, verticalOffset, horizontalOffset)"],get containedElement(){for(var e=dom(this.$.content).getDistributedNodes(),t=0,i=e.length;t<i;t++)if(e[t].nodeType===Node.ELEMENT_NODE)return e[t]},ready:function(){this.scrollAction||(this.scrollAction=this.allowOutsideScroll?"refit":"lock"),this._readied=!0},attached:function(){this.sizingTarget&&this.sizingTarget!==this||(this.sizingTarget=this.containedElement||this)},detached:function(){this.cancelAnimation()},_openedChanged:function(){this.opened&&this.disabled?this.cancel():(this.cancelAnimation(),this._updateAnimationConfig(),IronOverlayBehaviorImpl._openedChanged.apply(this,arguments))},_renderOpened:function(){!this.noAnimations&&this.animationConfig.open?(this.$.contentWrapper.classList.add("animating"),this.playAnimation("open")):IronOverlayBehaviorImpl._renderOpened.apply(this,arguments)},_renderClosed:function(){!this.noAnimations&&this.animationConfig.close?(this.$.contentWrapper.classList.add("animating"),this.playAnimation("close")):IronOverlayBehaviorImpl._renderClosed.apply(this,arguments)},_onNeonAnimationFinish:function(){this.$.contentWrapper.classList.remove("animating"),this.opened?this._finishRenderOpened():this._finishRenderClosed()},_updateAnimationConfig:function(){for(var e=this.containedElement,t=[].concat(this.openAnimationConfig||[]).concat(this.closeAnimationConfig||[]),i=0;i<t.length;i++)t[i].node=e;this.animationConfig={open:this.openAnimationConfig,close:this.closeAnimationConfig}},_updateOverlayPosition:function(){this.isAttached&&this.notifyResize()},_allowOutsideScrollChanged:function(e){this._readied&&(e?this.scrollAction&&"lock"!==this.scrollAction||(this.scrollAction="refit"):this.scrollAction="lock")},_applyFocus:function(){var e=this.focusTarget||this.containedElement;e&&this.opened&&!this.noAutoFocus?e.focus():IronOverlayBehaviorImpl._applyFocus.apply(this,arguments)}}),Polymer({_template:html`
    <style>
      :host {
        @apply --layout-inline;
        @apply --layout-center-center;
        position: relative;

        vertical-align: middle;

        fill: var(--iron-icon-fill-color, currentcolor);
        stroke: var(--iron-icon-stroke-color, none);

        width: var(--iron-icon-width, 24px);
        height: var(--iron-icon-height, 24px);
        @apply --iron-icon;
      }

      :host([hidden]) {
        display: none;
      }
    </style>
`,is:"iron-icon",properties:{icon:{type:String},theme:{type:String},src:{type:String},_meta:{value:Base.create("iron-meta",{type:"iconset"})}},observers:["_updateIcon(_meta, isAttached)","_updateIcon(theme, isAttached)","_srcChanged(src, isAttached)","_iconChanged(icon, isAttached)"],_DEFAULT_ICONSET:"icons",_iconChanged:function(e){var t=(e||"").split(":");this._iconName=t.pop(),this._iconsetName=t.pop()||this._DEFAULT_ICONSET,this._updateIcon()},_srcChanged:function(e){this._updateIcon()},_usesIconset:function(){return this.icon||!this.src},_updateIcon:function(){this._usesIconset()?(this._img&&this._img.parentNode&&dom(this.root).removeChild(this._img),""===this._iconName?this._iconset&&this._iconset.removeIcon(this):this._iconsetName&&this._meta&&(this._iconset=this._meta.byKey(this._iconsetName),this._iconset?(this._iconset.applyIcon(this,this._iconName,this.theme),this.unlisten(window,"iron-iconset-added","_updateIcon")):this.listen(window,"iron-iconset-added","_updateIcon"))):(this._iconset&&this._iconset.removeIcon(this),this._img||(this._img=document.createElement("img"),this._img.style.width="100%",this._img.style.height="100%",this._img.draggable=!1),this._img.src=this.src,dom(this.root).appendChild(this._img))}}),Polymer({is:"iron-iconset-svg",properties:{name:{type:String,observer:"_nameChanged"},size:{type:Number,value:24},rtlMirroring:{type:Boolean,value:!1},useGlobalRtlAttribute:{type:Boolean,value:!1}},created:function(){this._meta=new IronMeta({type:"iconset",key:null,value:null})},attached:function(){this.style.display="none"},getIconNames:function(){return this._icons=this._createIconMap(),Object.keys(this._icons).map(function(e){return this.name+":"+e},this)},applyIcon:function(e,t){this.removeIcon(e);var i=this._cloneIcon(t,this.rtlMirroring&&this._targetIsRTL(e));if(i){var r=dom(e.root||e);return r.insertBefore(i,r.childNodes[0]),e._svgIcon=i}return null},removeIcon:function(e){e._svgIcon&&(dom(e.root||e).removeChild(e._svgIcon),e._svgIcon=null)},_targetIsRTL:function(e){if(null==this.__targetIsRTL)if(this.useGlobalRtlAttribute){var t=document.body&&document.body.hasAttribute("dir")?document.body:document.documentElement;this.__targetIsRTL="rtl"===t.getAttribute("dir")}else e&&e.nodeType!==Node.ELEMENT_NODE&&(e=e.host),this.__targetIsRTL=e&&"rtl"===window.getComputedStyle(e).direction;return this.__targetIsRTL},_nameChanged:function(){this._meta.value=null,this._meta.key=this.name,this._meta.value=this,this.async(function(){this.fire("iron-iconset-added",this,{node:window})})},_createIconMap:function(){var e=Object.create(null);return dom(this).querySelectorAll("[id]").forEach(function(t){e[t.id]=t}),e},_cloneIcon:function(e,t){return this._icons=this._icons||this._createIconMap(),this._prepareSvgClone(this._icons[e],this.size,t)},_prepareSvgClone:function(e,t,i){if(e){var r=e.cloneNode(!0),n=document.createElementNS("http://www.w3.org/2000/svg","svg"),a=r.getAttribute("viewBox")||"0 0 "+t+" "+t,o="pointer-events: none; display: block; width: 100%; height: 100%;";return i&&r.hasAttribute("mirror-in-rtl")&&(o+="-webkit-transform:scale(-1,1);transform:scale(-1,1);transform-origin:center;"),n.setAttribute("viewBox",a),n.setAttribute("preserveAspectRatio","xMidYMid meet"),n.setAttribute("focusable","false"),n.style.cssText=o,n.appendChild(r).removeAttribute("id"),n}return null}}),Polymer({_template:html`
    <style>
      :host {
        display: inline-block;
        overflow: hidden;
        position: relative;
      }

      #baseURIAnchor {
        display: none;
      }

      #sizedImgDiv {
        position: absolute;
        top: 0px;
        right: 0px;
        bottom: 0px;
        left: 0px;

        display: none;
      }

      #img {
        display: block;
        width: var(--iron-image-width, auto);
        height: var(--iron-image-height, auto);
      }

      :host([sizing]) #sizedImgDiv {
        display: block;
      }

      :host([sizing]) #img {
        display: none;
      }

      #placeholder {
        position: absolute;
        top: 0px;
        right: 0px;
        bottom: 0px;
        left: 0px;

        background-color: inherit;
        opacity: 1;

        @apply --iron-image-placeholder;
      }

      #placeholder.faded-out {
        transition: opacity 0.5s linear;
        opacity: 0;
      }
    </style>

    <a id="baseURIAnchor" href="#"></a>
    <div id="sizedImgDiv" role="img" hidden\$="[[_computeImgDivHidden(sizing)]]" aria-hidden\$="[[_computeImgDivARIAHidden(alt)]]" aria-label\$="[[_computeImgDivARIALabel(alt, src)]]"></div>
    <img id="img" alt\$="[[alt]]" hidden\$="[[_computeImgHidden(sizing)]]" crossorigin\$="[[crossorigin]]" on-load="_imgOnLoad" on-error="_imgOnError">
    <div id="placeholder" hidden\$="[[_computePlaceholderHidden(preload, fade, loading, loaded)]]" class\$="[[_computePlaceholderClassName(preload, fade, loading, loaded)]]"></div>
`,is:"iron-image",properties:{src:{type:String,value:""},alt:{type:String,value:null},crossorigin:{type:String,value:null},preventLoad:{type:Boolean,value:!1},sizing:{type:String,value:null,reflectToAttribute:!0},position:{type:String,value:"center"},preload:{type:Boolean,value:!1},placeholder:{type:String,value:null,observer:"_placeholderChanged"},fade:{type:Boolean,value:!1},loaded:{notify:!0,readOnly:!0,type:Boolean,value:!1},loading:{notify:!0,readOnly:!0,type:Boolean,value:!1},error:{notify:!0,readOnly:!0,type:Boolean,value:!1},width:{observer:"_widthChanged",type:Number,value:null},height:{observer:"_heightChanged",type:Number,value:null}},observers:["_transformChanged(sizing, position)","_loadStateObserver(src, preventLoad)"],created:function(){this._resolvedSrc=""},_imgOnLoad:function(){this.$.img.src===this._resolveSrc(this.src)&&(this._setLoading(!1),this._setLoaded(!0),this._setError(!1))},_imgOnError:function(){this.$.img.src===this._resolveSrc(this.src)&&(this.$.img.removeAttribute("src"),this.$.sizedImgDiv.style.backgroundImage="",this._setLoading(!1),this._setLoaded(!1),this._setError(!0))},_computePlaceholderHidden:function(){return!this.preload||!this.fade&&!this.loading&&this.loaded},_computePlaceholderClassName:function(){return this.preload&&this.fade&&!this.loading&&this.loaded?"faded-out":""},_computeImgDivHidden:function(){return!this.sizing},_computeImgDivARIAHidden:function(){return""===this.alt?"true":void 0},_computeImgDivARIALabel:function(){return null!==this.alt?this.alt:""===this.src?"":this._resolveSrc(this.src).replace(/[?|#].*/g,"").split("/").pop()},_computeImgHidden:function(){return!!this.sizing},_widthChanged:function(){this.style.width=isNaN(this.width)?this.width:this.width+"px"},_heightChanged:function(){this.style.height=isNaN(this.height)?this.height:this.height+"px"},_loadStateObserver:function(e,t){var i=this._resolveSrc(e);i!==this._resolvedSrc&&(this._resolvedSrc="",this.$.img.removeAttribute("src"),this.$.sizedImgDiv.style.backgroundImage="",""===e||t?(this._setLoading(!1),this._setLoaded(!1),this._setError(!1)):(this._resolvedSrc=i,this.$.img.src=this._resolvedSrc,this.$.sizedImgDiv.style.backgroundImage='url("'+this._resolvedSrc+'")',this._setLoading(!0),this._setLoaded(!1),this._setError(!1)))},_placeholderChanged:function(){this.$.placeholder.style.backgroundImage=this.placeholder?'url("'+this.placeholder+'")':""},_transformChanged:function(){var e=this.$.sizedImgDiv.style,t=this.$.placeholder.style;e.backgroundSize=t.backgroundSize=this.sizing,e.backgroundPosition=t.backgroundPosition=this.sizing?this.position:"",e.backgroundRepeat=t.backgroundRepeat=this.sizing?"no-repeat":""},_resolveSrc:function(e){var t=resolveUrl(e,this.$.baseURIAnchor.href);return"/"===t[0]&&(t=(location.origin||location.protocol+"//"+location.host)+t),t}}),Polymer({_template:html`
    <style>
      :host {
        display: inline-block;
      }
    </style>
    <slot id="content"></slot>
`,is:"iron-input",behaviors:[IronValidatableBehavior],properties:{bindValue:{type:String,value:""},value:{type:String,computed:"_computeValue(bindValue)"},allowedPattern:{type:String},autoValidate:{type:Boolean,value:!1},_inputElement:Object},observers:["_bindValueChanged(bindValue, _inputElement)"],listeners:{input:"_onInput",keypress:"_onKeypress"},created:function(){IronA11yAnnouncer.requestAvailability(),this._previousValidInput="",this._patternAlreadyChecked=!1},attached:function(){this._observer=dom(this).observeNodes(function(e){this._initSlottedInput()}.bind(this))},detached:function(){this._observer&&(dom(this).unobserveNodes(this._observer),this._observer=null)},get inputElement(){return this._inputElement},_initSlottedInput:function(){this._inputElement=this.getEffectiveChildren()[0],this.inputElement&&this.inputElement.value&&(this.bindValue=this.inputElement.value),this.fire("iron-input-ready")},get _patternRegExp(){var e;if(this.allowedPattern)e=new RegExp(this.allowedPattern);else switch(this.inputElement.type){case"number":e=/[0-9.,e-]/}return e},_bindValueChanged:function(e,t){t&&(void 0===e?t.value=null:e!==t.value&&(this.inputElement.value=e),this.autoValidate&&this.validate(),this.fire("bind-value-changed",{value:e}))},_onInput:function(){this.allowedPattern&&!this._patternAlreadyChecked&&(this._checkPatternValidity()||(this._announceInvalidCharacter("Invalid string of characters not entered."),this.inputElement.value=this._previousValidInput));this.bindValue=this._previousValidInput=this.inputElement.value,this._patternAlreadyChecked=!1},_isPrintable:function(e){var t=8==e.keyCode||9==e.keyCode||13==e.keyCode||27==e.keyCode,i=19==e.keyCode||20==e.keyCode||45==e.keyCode||46==e.keyCode||144==e.keyCode||145==e.keyCode||32<e.keyCode&&41>e.keyCode||111<e.keyCode&&124>e.keyCode;return!(t||0==e.charCode&&i)},_onKeypress:function(e){if(this.allowedPattern||"number"===this.inputElement.type){var t=this._patternRegExp;if(t&&!(e.metaKey||e.ctrlKey||e.altKey)){this._patternAlreadyChecked=!0;var i=String.fromCharCode(e.charCode);this._isPrintable(e)&&!t.test(i)&&(e.preventDefault(),this._announceInvalidCharacter("Invalid character "+i+" not entered."))}}},_checkPatternValidity:function(){var e=this._patternRegExp;if(!e)return!0;for(var t=0;t<this.inputElement.value.length;t++)if(!e.test(this.inputElement.value[t]))return!1;return!0},validate:function(){if(!this.inputElement)return this.invalid=!1,!0;var e=this.inputElement.checkValidity();return e&&(this.required&&""===this.bindValue?e=!1:this.hasValidator()&&(e=IronValidatableBehavior.validate.call(this,this.bindValue))),this.invalid=!e,this.fire("iron-input-validate"),e},_announceInvalidCharacter:function(e){this.fire("iron-announce",{text:e})},_computeValue:function(e){return e}});class IronSelection{constructor(e){this.selection=[],this.selectCallback=e}get(){return this.multi?this.selection.slice():this.selection[0]}clear(e){this.selection.slice().forEach(function(t){(!e||0>e.indexOf(t))&&this.setItemSelected(t,!1)},this)}isSelected(e){return 0<=this.selection.indexOf(e)}setItemSelected(e,t){if(null!=e&&t!==this.isSelected(e)){if(t)this.selection.push(e);else{var i=this.selection.indexOf(e);0<=i&&this.selection.splice(i,1)}this.selectCallback&&this.selectCallback(e,t)}}select(e){this.multi?this.toggle(e):this.get()!==e&&(this.setItemSelected(this.get(),!1),this.setItemSelected(e,!0))}toggle(e){this.setItemSelected(e,!this.isSelected(e))}}var ironSelection={IronSelection:IronSelection};const IronSelectableBehavior={properties:{attrForSelected:{type:String,value:null},selected:{type:String,notify:!0},selectedItem:{type:Object,readOnly:!0,notify:!0},activateEvent:{type:String,value:"tap",observer:"_activateEventChanged"},selectable:String,selectedClass:{type:String,value:"iron-selected"},selectedAttribute:{type:String,value:null},fallbackSelection:{type:String,value:null},items:{type:Array,readOnly:!0,notify:!0,value:function(){return[]}},_excludedLocalNames:{type:Object,value:function(){return{template:1,"dom-bind":1,"dom-if":1,"dom-repeat":1}}}},observers:["_updateAttrForSelected(attrForSelected)","_updateSelected(selected)","_checkFallback(fallbackSelection)"],created:function(){this._bindFilterItem=this._filterItem.bind(this),this._selection=new IronSelection(this._applySelection.bind(this))},attached:function(){this._observer=this._observeItems(this),this._addListener(this.activateEvent)},detached:function(){this._observer&&dom(this).unobserveNodes(this._observer),this._removeListener(this.activateEvent)},indexOf:function(e){return this.items?this.items.indexOf(e):-1},select:function(e){this.selected=e},selectPrevious:function(){var e=this.items.length,t=e-1;void 0!==this.selected&&(t=(+this._valueToIndex(this.selected)-1+e)%e),this.selected=this._indexToValue(t)},selectNext:function(){var e=0;void 0!==this.selected&&(e=(+this._valueToIndex(this.selected)+1)%this.items.length),this.selected=this._indexToValue(e)},selectIndex:function(e){this.select(this._indexToValue(e))},forceSynchronousItemUpdate:function(){this._observer&&"function"==typeof this._observer.flush?this._observer.flush():this._updateItems()},get _shouldUpdateSelection(){return null!=this.selected},_checkFallback:function(){this._updateSelected()},_addListener:function(e){this.listen(this,e,"_activateHandler")},_removeListener:function(e){this.unlisten(this,e,"_activateHandler")},_activateEventChanged:function(e,t){this._removeListener(t),this._addListener(e)},_updateItems:function(){var e=dom(this).queryDistributedElements(this.selectable||"*");e=Array.prototype.filter.call(e,this._bindFilterItem),this._setItems(e)},_updateAttrForSelected:function(){this.selectedItem&&(this.selected=this._valueForItem(this.selectedItem))},_updateSelected:function(){this._selectSelected(this.selected)},_selectSelected:function(e){if(this.items){var t=this._valueToItem(this.selected);t?this._selection.select(t):this._selection.clear(),this.fallbackSelection&&this.items.length&&void 0===this._selection.get()&&(this.selected=this.fallbackSelection)}},_filterItem:function(e){return!this._excludedLocalNames[e.localName]},_valueToItem:function(e){return null==e?null:this.items[this._valueToIndex(e)]},_valueToIndex:function(e){if(!this.attrForSelected)return+e;for(var t,i=0;t=this.items[i];i++)if(this._valueForItem(t)==e)return i},_indexToValue:function(e){if(!this.attrForSelected)return e;var t=this.items[e];return t?this._valueForItem(t):void 0},_valueForItem:function(e){if(!e)return null;if(!this.attrForSelected){var t=this.indexOf(e);return-1===t?null:t}var i=e[dashToCamelCase(this.attrForSelected)];return void 0!=i?i:e.getAttribute(this.attrForSelected)},_applySelection:function(e,t){this.selectedClass&&this.toggleClass(this.selectedClass,t,e),this.selectedAttribute&&this.toggleAttribute(this.selectedAttribute,t,e),this._selectionChange(),this.fire("iron-"+(t?"select":"deselect"),{item:e})},_selectionChange:function(){this._setSelectedItem(this._selection.get())},_observeItems:function(e){return dom(e).observeNodes(function(e){this._updateItems(),this._updateSelected(),this.fire("iron-items-changed",e,{bubbles:!1,cancelable:!1})})},_activateHandler:function(e){for(var t=e.target,i=this.items;t&&t!=this;){var r=i.indexOf(t);if(0<=r){var n=this._indexToValue(r);return void this._itemActivate(n,t)}t=t.parentNode}},_itemActivate:function(e,t){this.fire("iron-activate",{selected:e,item:t},{cancelable:!0}).defaultPrevented||this.select(e)}};var ironSelectable={IronSelectableBehavior:IronSelectableBehavior};const IronMultiSelectableBehaviorImpl={properties:{multi:{type:Boolean,value:!1,observer:"multiChanged"},selectedValues:{type:Array,notify:!0,value:function(){return[]}},selectedItems:{type:Array,readOnly:!0,notify:!0,value:function(){return[]}}},observers:["_updateSelected(selectedValues.splices)"],select:function(e){this.multi?this._toggleSelected(e):this.selected=e},multiChanged:function(e){this._selection.multi=e,this._updateSelected()},get _shouldUpdateSelection(){return null!=this.selected||null!=this.selectedValues&&this.selectedValues.length},_updateAttrForSelected:function(){this.multi?this.selectedItems&&0<this.selectedItems.length&&(this.selectedValues=this.selectedItems.map(function(e){return this._indexToValue(this.indexOf(e))},this).filter(function(e){return null!=e},this)):IronSelectableBehavior._updateAttrForSelected.apply(this)},_updateSelected:function(){this.multi?this._selectMulti(this.selectedValues):this._selectSelected(this.selected)},_selectMulti:function(e){e=e||[];var t=(this._valuesToItems(e)||[]).filter(function(e){return null!==e&&void 0!==e});this._selection.clear(t);for(var i=0;i<t.length;i++)this._selection.setItemSelected(t[i],!0);this.fallbackSelection&&!this._selection.get().length&&(this._valueToItem(this.fallbackSelection)&&this.select(this.fallbackSelection))},_selectionChange:function(){var e=this._selection.get();this.multi?(this._setSelectedItems(e),this._setSelectedItem(e.length?e[0]:null)):null!==e&&void 0!==e?(this._setSelectedItems([e]),this._setSelectedItem(e)):(this._setSelectedItems([]),this._setSelectedItem(null))},_toggleSelected:function(e){var t=this.selectedValues.indexOf(e);0>t?this.push("selectedValues",e):this.splice("selectedValues",t,1)},_valuesToItems:function(e){return null==e?null:e.map(function(e){return this._valueToItem(e)},this)}},IronMultiSelectableBehavior=[IronSelectableBehavior,IronMultiSelectableBehaviorImpl];var ironMultiSelectable={IronMultiSelectableBehaviorImpl:IronMultiSelectableBehaviorImpl,IronMultiSelectableBehavior:IronMultiSelectableBehavior};const IronMenuBehaviorImpl={properties:{focusedItem:{observer:"_focusedItemChanged",readOnly:!0,type:Object},attrForItemTitle:{type:String},disabled:{type:Boolean,value:!1,observer:"_disabledChanged"}},_MODIFIER_KEYS:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Hyper","Meta","NumLock","OS","ScrollLock","Shift","Super","Symbol","SymbolLock"],_SEARCH_RESET_TIMEOUT_MS:1e3,_previousTabIndex:0,hostAttributes:{role:"menu"},observers:["_updateMultiselectable(multi)"],listeners:{focus:"_onFocus",keydown:"_onKeydown","iron-items-changed":"_onIronItemsChanged"},keyBindings:{up:"_onUpKey",down:"_onDownKey",esc:"_onEscKey","shift+tab:keydown":"_onShiftTabDown"},attached:function(){this._resetTabindices()},select:function(e){this._defaultFocusAsync&&(this.cancelAsync(this._defaultFocusAsync),this._defaultFocusAsync=null);var t=this._valueToItem(e);t&&t.hasAttribute("disabled")||(this._setFocusedItem(t),IronMultiSelectableBehaviorImpl.select.apply(this,arguments))},_resetTabindices:function(){var e=this.multi?this.selectedItems&&this.selectedItems[0]:this.selectedItem;this.items.forEach(function(t){t.setAttribute("tabindex",t===e?"0":"-1"),t.setAttribute("aria-selected",this._selection.isSelected(t))},this)},_updateMultiselectable:function(e){e?this.setAttribute("aria-multiselectable","true"):this.removeAttribute("aria-multiselectable")},_focusWithKeyboardEvent:function(e){if(-1===this._MODIFIER_KEYS.indexOf(e.key)){this.cancelDebouncer("_clearSearchText");for(var t,i=this._searchText||"",r=(i+=(e.key&&1==e.key.length?e.key:String.fromCharCode(e.keyCode)).toLocaleLowerCase()).length,n=0;t=this.items[n];n++)if(!t.hasAttribute("disabled")){var a=this.attrForItemTitle||"textContent",o=(t[a]||t.getAttribute(a)||"").trim();if(!(o.length<r)&&o.slice(0,r).toLocaleLowerCase()==i){this._setFocusedItem(t);break}}this._searchText=i,this.debounce("_clearSearchText",this._clearSearchText,this._SEARCH_RESET_TIMEOUT_MS)}},_clearSearchText:function(){this._searchText=""},_focusPrevious:function(){for(var e,t=this.items.length,i=+this.indexOf(this.focusedItem),r=1;r<t+1;r++)if(!(e=this.items[(i-r+t)%t]).hasAttribute("disabled")){var n=dom(e).getOwnerRoot()||document;if(this._setFocusedItem(e),dom(n).activeElement==e)return}},_focusNext:function(){for(var e,t=this.items.length,i=+this.indexOf(this.focusedItem),r=1;r<t+1;r++)if(!(e=this.items[(i+r)%t]).hasAttribute("disabled")){var n=dom(e).getOwnerRoot()||document;if(this._setFocusedItem(e),dom(n).activeElement==e)return}},_applySelection:function(e,t){t?e.setAttribute("aria-selected","true"):e.setAttribute("aria-selected","false"),IronSelectableBehavior._applySelection.apply(this,arguments)},_focusedItemChanged:function(e,t){t&&t.setAttribute("tabindex","-1"),!e||e.hasAttribute("disabled")||this.disabled||(e.setAttribute("tabindex","0"),e.focus())},_onIronItemsChanged:function(e){e.detail.addedNodes.length&&this._resetTabindices()},_onShiftTabDown:function(e){var t=this.getAttribute("tabindex");IronMenuBehaviorImpl._shiftTabPressed=!0,this._setFocusedItem(null),this.setAttribute("tabindex","-1"),this.async(function(){this.setAttribute("tabindex",t),IronMenuBehaviorImpl._shiftTabPressed=!1},1)},_onFocus:function(e){if(!IronMenuBehaviorImpl._shiftTabPressed){var t=dom(e).rootTarget;(t===this||void 0===t.tabIndex||this.isLightDescendant(t))&&(this._defaultFocusAsync=this.async(function(){var e=this.multi?this.selectedItems&&this.selectedItems[0]:this.selectedItem;this._setFocusedItem(null),e?this._setFocusedItem(e):this.items[0]&&this._focusNext()}))}},_onUpKey:function(e){this._focusPrevious(),e.detail.keyboardEvent.preventDefault()},_onDownKey:function(e){this._focusNext(),e.detail.keyboardEvent.preventDefault()},_onEscKey:function(e){var t=this.focusedItem;t&&t.blur()},_onKeydown:function(e){this.keyboardEventMatchesKeys(e,"up down esc")||this._focusWithKeyboardEvent(e),e.stopPropagation()},_activateHandler:function(e){IronSelectableBehavior._activateHandler.call(this,e),e.stopPropagation()},_disabledChanged:function(e){e?(this._previousTabIndex=this.hasAttribute("tabindex")?this.tabIndex:0,this.removeAttribute("tabindex")):this.hasAttribute("tabindex")||this.setAttribute("tabindex",this._previousTabIndex)},_shiftTabPressed:!1},IronMenuBehavior=[IronMultiSelectableBehavior,IronA11yKeysBehavior,IronMenuBehaviorImpl];var ironMenuBehavior={IronMenuBehaviorImpl:IronMenuBehaviorImpl,IronMenuBehavior:IronMenuBehavior};const IronMenubarBehaviorImpl={hostAttributes:{role:"menubar"},keyBindings:{left:"_onLeftKey",right:"_onRightKey"},_onUpKey:function(e){this.focusedItem.click(),e.detail.keyboardEvent.preventDefault()},_onDownKey:function(e){this.focusedItem.click(),e.detail.keyboardEvent.preventDefault()},get _isRTL(){return"rtl"===window.getComputedStyle(this).direction},_onLeftKey:function(e){this._isRTL?this._focusNext():this._focusPrevious(),e.detail.keyboardEvent.preventDefault()},_onRightKey:function(e){this._isRTL?this._focusPrevious():this._focusNext(),e.detail.keyboardEvent.preventDefault()},_onKeydown:function(e){this.keyboardEventMatchesKeys(e,"up down left right esc")||this._focusWithKeyboardEvent(e)}},IronMenubarBehavior=[IronMenuBehavior,IronMenubarBehaviorImpl];var ironMenubarBehavior={IronMenubarBehaviorImpl:IronMenubarBehaviorImpl,IronMenubarBehavior:IronMenubarBehavior};const IronRangeBehavior={properties:{value:{type:Number,value:0,notify:!0,reflectToAttribute:!0},min:{type:Number,value:0,notify:!0},max:{type:Number,value:100,notify:!0},step:{type:Number,value:1,notify:!0},ratio:{type:Number,value:0,readOnly:!0,notify:!0}},observers:["_update(value, min, max, step)"],_calcRatio:function(e){return(this._clampValue(e)-this.min)/(this.max-this.min)},_clampValue:function(e){return Math.min(this.max,Math.max(this.min,this._calcStep(e)))},_calcStep:function(e){if(e=parseFloat(e),!this.step)return e;var t=Math.round((e-this.min)/this.step);return 1>this.step?t/(1/this.step)+this.min:t*this.step+this.min},_validateValue:function(){var e=this._clampValue(this.value);return this.value=this.oldValue=isNaN(e)?this.oldValue:e,this.value!==e},_update:function(){this._validateValue(),this._setRatio(100*this._calcRatio(this.value))}};var ironRangeBehavior={IronRangeBehavior:IronRangeBehavior};const NeonAnimationBehavior={properties:{animationTiming:{type:Object,value:function(){return{duration:500,easing:"cubic-bezier(0.4, 0, 0.2, 1)",fill:"both"}}}},isNeonAnimation:!0,created:function(){document.body.animate||console.warn("No web animations detected. This element will not function without a web animations polyfill.")},timingFromConfig:function(e){if(e.timing)for(var t in e.timing)this.animationTiming[t]=e.timing[t];return this.animationTiming},setPrefixedProperty:function(e,t,i){for(var r,n={transform:["webkitTransform"],transformOrigin:["mozTransformOrigin","webkitTransformOrigin"]}[t],a=0;r=n[a];a++)e.style[r]=i;e.style[t]=i},complete:function(e){}};var neonAnimationBehavior={NeonAnimationBehavior:NeonAnimationBehavior};Polymer({is:"fade-in-animation",behaviors:[NeonAnimationBehavior],configure:function(e){var t=e.node;return this._effect=new KeyframeEffect(t,[{opacity:"0"},{opacity:"1"}],this.timingFromConfig(e)),this._effect}}),Polymer({is:"fade-out-animation",behaviors:[NeonAnimationBehavior],configure:function(e){var t=e.node;return this._effect=new KeyframeEffect(t,[{opacity:"1"},{opacity:"0"}],this.timingFromConfig(e)),this._effect}});var Utility={distance:function(e,t,i,r){var n=e-i,a=t-r;return Math.sqrt(n*n+a*a)},now:window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now};function ElementMetrics(e){this.element=e,this.width=this.boundingRect.width,this.height=this.boundingRect.height,this.size=Math.max(this.width,this.height)}function Ripple(e){this.element=e,this.color=window.getComputedStyle(e).color,this.wave=document.createElement("div"),this.waveContainer=document.createElement("div"),this.wave.style.backgroundColor=this.color,this.wave.classList.add("wave"),this.waveContainer.classList.add("wave-container"),dom(this.waveContainer).appendChild(this.wave),this.resetInteractionState()}ElementMetrics.prototype={get boundingRect(){return this.element.getBoundingClientRect()},furthestCornerDistanceFrom:function(e,t){var i=Utility.distance(e,t,0,0),r=Utility.distance(e,t,this.width,0),n=Utility.distance(e,t,0,this.height),a=Utility.distance(e,t,this.width,this.height);return Math.max(i,r,n,a)}},Ripple.MAX_RADIUS=300,Ripple.prototype={get recenters(){return this.element.recenters},get center(){return this.element.center},get mouseDownElapsed(){var e;return this.mouseDownStart?(e=Utility.now()-this.mouseDownStart,this.mouseUpStart&&(e-=this.mouseUpElapsed),e):0},get mouseUpElapsed(){return this.mouseUpStart?Utility.now()-this.mouseUpStart:0},get mouseDownElapsedSeconds(){return this.mouseDownElapsed/1e3},get mouseUpElapsedSeconds(){return this.mouseUpElapsed/1e3},get mouseInteractionSeconds(){return this.mouseDownElapsedSeconds+this.mouseUpElapsedSeconds},get initialOpacity(){return this.element.initialOpacity},get opacityDecayVelocity(){return this.element.opacityDecayVelocity},get radius(){var e=this.containerMetrics.width*this.containerMetrics.width,t=this.containerMetrics.height*this.containerMetrics.height,i=1.1*Math.min(Math.sqrt(e+t),Ripple.MAX_RADIUS)+5,r=1.1-i/Ripple.MAX_RADIUS*.2,n=this.mouseInteractionSeconds/r,a=i*(1-Math.pow(80,-n));return Math.abs(a)},get opacity(){return this.mouseUpStart?Math.max(0,this.initialOpacity-this.mouseUpElapsedSeconds*this.opacityDecayVelocity):this.initialOpacity},get outerOpacity(){var e=.3*this.mouseUpElapsedSeconds,t=this.opacity;return Math.max(0,Math.min(e,t))},get isOpacityFullyDecayed(){return.01>this.opacity&&this.radius>=Math.min(this.maxRadius,Ripple.MAX_RADIUS)},get isRestingAtMaxRadius(){return this.opacity>=this.initialOpacity&&this.radius>=Math.min(this.maxRadius,Ripple.MAX_RADIUS)},get isAnimationComplete(){return this.mouseUpStart?this.isOpacityFullyDecayed:this.isRestingAtMaxRadius},get translationFraction(){return Math.min(1,this.radius/this.containerMetrics.size*2/Math.sqrt(2))},get xNow(){return this.xEnd?this.xStart+this.translationFraction*(this.xEnd-this.xStart):this.xStart},get yNow(){return this.yEnd?this.yStart+this.translationFraction*(this.yEnd-this.yStart):this.yStart},get isMouseDown(){return this.mouseDownStart&&!this.mouseUpStart},resetInteractionState:function(){this.maxRadius=0,this.mouseDownStart=0,this.mouseUpStart=0,this.xStart=0,this.yStart=0,this.xEnd=0,this.yEnd=0,this.slideDistance=0,this.containerMetrics=new ElementMetrics(this.element)},draw:function(){var e,t,i;this.wave.style.opacity=this.opacity,e=this.radius/(this.containerMetrics.size/2),t=this.xNow-this.containerMetrics.width/2,i=this.yNow-this.containerMetrics.height/2,this.waveContainer.style.webkitTransform="translate("+t+"px, "+i+"px)",this.waveContainer.style.transform="translate3d("+t+"px, "+i+"px, 0)",this.wave.style.webkitTransform="scale("+e+","+e+")",this.wave.style.transform="scale3d("+e+","+e+",1)"},downAction:function(e){var t=this.containerMetrics.width/2,i=this.containerMetrics.height/2;this.resetInteractionState(),this.mouseDownStart=Utility.now(),this.center?(this.xStart=t,this.yStart=i,this.slideDistance=Utility.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)):(this.xStart=e?e.detail.x-this.containerMetrics.boundingRect.left:this.containerMetrics.width/2,this.yStart=e?e.detail.y-this.containerMetrics.boundingRect.top:this.containerMetrics.height/2),this.recenters&&(this.xEnd=t,this.yEnd=i,this.slideDistance=Utility.distance(this.xStart,this.yStart,this.xEnd,this.yEnd)),this.maxRadius=this.containerMetrics.furthestCornerDistanceFrom(this.xStart,this.yStart),this.waveContainer.style.top=(this.containerMetrics.height-this.containerMetrics.size)/2+"px",this.waveContainer.style.left=(this.containerMetrics.width-this.containerMetrics.size)/2+"px",this.waveContainer.style.width=this.containerMetrics.size+"px",this.waveContainer.style.height=this.containerMetrics.size+"px"},upAction:function(e){this.isMouseDown&&(this.mouseUpStart=Utility.now())},remove:function(){dom(this.waveContainer.parentNode).removeChild(this.waveContainer)}},Polymer({_template:html`
    <style>
      :host {
        display: block;
        position: absolute;
        border-radius: inherit;
        overflow: hidden;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;

        /* See PolymerElements/paper-behaviors/issues/34. On non-Chrome browsers,
         * creating a node (with a position:absolute) in the middle of an event
         * handler "interrupts" that event handler (which happens when the
         * ripple is created on demand) */
        pointer-events: none;
      }

      :host([animating]) {
        /* This resolves a rendering issue in Chrome (as of 40) where the
           ripple is not properly clipped by its parent (which may have
           rounded corners). See: http://jsbin.com/temexa/4

           Note: We only apply this style conditionally. Otherwise, the browser
           will create a new compositing layer for every ripple element on the
           page, and that would be bad. */
        -webkit-transform: translate(0, 0);
        transform: translate3d(0, 0, 0);
      }

      #background,
      #waves,
      .wave-container,
      .wave {
        pointer-events: none;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      #background,
      .wave {
        opacity: 0;
      }

      #waves,
      .wave {
        overflow: hidden;
      }

      .wave-container,
      .wave {
        border-radius: 50%;
      }

      :host(.circle) #background,
      :host(.circle) #waves {
        border-radius: 50%;
      }

      :host(.circle) .wave-container {
        overflow: hidden;
      }
    </style>

    <div id="background"></div>
    <div id="waves"></div>
`,is:"paper-ripple",behaviors:[IronA11yKeysBehavior],properties:{initialOpacity:{type:Number,value:.25},opacityDecayVelocity:{type:Number,value:.8},recenters:{type:Boolean,value:!1},center:{type:Boolean,value:!1},ripples:{type:Array,value:function(){return[]}},animating:{type:Boolean,readOnly:!0,reflectToAttribute:!0,value:!1},holdDown:{type:Boolean,value:!1,observer:"_holdDownChanged"},noink:{type:Boolean,value:!1},_animating:{type:Boolean},_boundAnimate:{type:Function,value:function(){return this.animate.bind(this)}}},get target(){return this.keyEventTarget},keyBindings:{"enter:keydown":"_onEnterKeydown","space:keydown":"_onSpaceKeydown","space:keyup":"_onSpaceKeyup"},attached:function(){11==this.parentNode.nodeType?this.keyEventTarget=dom(this).getOwnerRoot().host:this.keyEventTarget=this.parentNode;var e=this.keyEventTarget;this.listen(e,"up","uiUpAction"),this.listen(e,"down","uiDownAction")},detached:function(){this.unlisten(this.keyEventTarget,"up","uiUpAction"),this.unlisten(this.keyEventTarget,"down","uiDownAction"),this.keyEventTarget=null},get shouldKeepAnimating(){for(var e=0;e<this.ripples.length;++e)if(!this.ripples[e].isAnimationComplete)return!0;return!1},simulatedRipple:function(){this.downAction(null),this.async(function(){this.upAction()},1)},uiDownAction:function(e){this.noink||this.downAction(e)},downAction:function(e){this.holdDown&&0<this.ripples.length||(this.addRipple().downAction(e),this._animating||(this._animating=!0,this.animate()))},uiUpAction:function(e){this.noink||this.upAction(e)},upAction:function(e){this.holdDown||(this.ripples.forEach(function(t){t.upAction(e)}),this._animating=!0,this.animate())},onAnimationComplete:function(){this._animating=!1,this.$.background.style.backgroundColor=null,this.fire("transitionend")},addRipple:function(){var e=new Ripple(this);return dom(this.$.waves).appendChild(e.waveContainer),this.$.background.style.backgroundColor=e.color,this.ripples.push(e),this._setAnimating(!0),e},removeRipple:function(e){var t=this.ripples.indexOf(e);0>t||(this.ripples.splice(t,1),e.remove(),this.ripples.length||this._setAnimating(!1))},animate:function(){if(this._animating){var e,t;for(e=0;e<this.ripples.length;++e)(t=this.ripples[e]).draw(),this.$.background.style.opacity=t.outerOpacity,t.isOpacityFullyDecayed&&!t.isRestingAtMaxRadius&&this.removeRipple(t);this.shouldKeepAnimating||0!==this.ripples.length?window.requestAnimationFrame(this._boundAnimate):this.onAnimationComplete()}},animateRipple:function(){return this.animate()},_onEnterKeydown:function(){this.uiDownAction(),this.async(this.uiUpAction,1)},_onSpaceKeydown:function(){this.uiDownAction()},_onSpaceKeyup:function(){this.uiUpAction()},_holdDownChanged:function(e,t){void 0!==t&&(e?this.downAction():this.upAction())}});const PaperRippleBehavior={properties:{noink:{type:Boolean,observer:"_noinkChanged"},_rippleContainer:{type:Object}},_buttonStateChanged:function(){this.focused&&this.ensureRipple()},_downHandler:function(e){IronButtonStateImpl._downHandler.call(this,e),this.pressed&&this.ensureRipple(e)},ensureRipple:function(e){if(!this.hasRipple()){this._ripple=this._createRipple(),this._ripple.noink=this.noink;var t=this._rippleContainer||this.root;if(t&&dom(t).appendChild(this._ripple),e){var i=dom(this._rippleContainer||this),r=dom(e).rootTarget;i.deepContains(r)&&this._ripple.uiDownAction(e)}}},getRipple:function(){return this.ensureRipple(),this._ripple},hasRipple:function(){return!!this._ripple},_createRipple:function(){return document.createElement("paper-ripple")},_noinkChanged:function(e){this.hasRipple()&&(this._ripple.noink=e)}};var paperRippleBehavior={PaperRippleBehavior:PaperRippleBehavior};const PaperButtonBehaviorImpl={properties:{elevation:{type:Number,reflectToAttribute:!0,readOnly:!0}},observers:["_calculateElevation(focused, disabled, active, pressed, receivedFocusFromKeyboard)","_computeKeyboardClass(receivedFocusFromKeyboard)"],hostAttributes:{role:"button",tabindex:"0",animated:!0},_calculateElevation:function(){var e=1;this.disabled?e=0:this.active||this.pressed?e=4:this.receivedFocusFromKeyboard&&(e=3),this._setElevation(e)},_computeKeyboardClass:function(e){this.toggleClass("keyboard-focus",e)},_spaceKeyDownHandler:function(e){IronButtonStateImpl._spaceKeyDownHandler.call(this,e),this.hasRipple()&&1>this.getRipple().ripples.length&&this._ripple.uiDownAction()},_spaceKeyUpHandler:function(e){IronButtonStateImpl._spaceKeyUpHandler.call(this,e),this.hasRipple()&&this._ripple.uiUpAction()}},PaperButtonBehavior=[IronButtonState,IronControlState,PaperRippleBehavior,PaperButtonBehaviorImpl];var paperButtonBehavior={PaperButtonBehaviorImpl:PaperButtonBehaviorImpl,PaperButtonBehavior:PaperButtonBehavior};const PaperInkyFocusBehaviorImpl={observers:["_focusedChanged(receivedFocusFromKeyboard)"],_focusedChanged:function(e){e&&this.ensureRipple(),this.hasRipple()&&(this._ripple.holdDown=e)},_createRipple:function(){var e=PaperRippleBehavior._createRipple();return e.id="ink",e.setAttribute("center",""),e.classList.add("circle"),e}},PaperInkyFocusBehavior=[IronButtonState,IronControlState,PaperRippleBehavior,PaperInkyFocusBehaviorImpl];var paperInkyFocusBehavior={PaperInkyFocusBehaviorImpl:PaperInkyFocusBehaviorImpl,PaperInkyFocusBehavior:PaperInkyFocusBehavior};const PaperCheckedElementBehaviorImpl={_checkedChanged:function(){IronCheckedElementBehaviorImpl._checkedChanged.call(this),this.hasRipple()&&(this.checked?this._ripple.setAttribute("checked",""):this._ripple.removeAttribute("checked"))},_buttonStateChanged:function(){PaperRippleBehavior._buttonStateChanged.call(this),this.disabled||this.isAttached&&(this.checked=this.active)}},PaperCheckedElementBehavior=[PaperInkyFocusBehavior,IronCheckedElementBehavior,PaperCheckedElementBehaviorImpl];var paperCheckedElementBehavior={PaperCheckedElementBehaviorImpl:PaperCheckedElementBehaviorImpl,PaperCheckedElementBehavior:PaperCheckedElementBehavior};const template$1=html`
<custom-style>
  <style is="custom-style">
    html {

      --shadow-transition: {
        transition: box-shadow 0.28s cubic-bezier(0.4, 0, 0.2, 1);
      };

      --shadow-none: {
        box-shadow: none;
      };

      /* from http://codepen.io/shyndman/pen/c5394ddf2e8b2a5c9185904b57421cdb */

      --shadow-elevation-2dp: {
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
                    0 1px 5px 0 rgba(0, 0, 0, 0.12),
                    0 3px 1px -2px rgba(0, 0, 0, 0.2);
      };

      --shadow-elevation-3dp: {
        box-shadow: 0 3px 4px 0 rgba(0, 0, 0, 0.14),
                    0 1px 8px 0 rgba(0, 0, 0, 0.12),
                    0 3px 3px -2px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-4dp: {
        box-shadow: 0 4px 5px 0 rgba(0, 0, 0, 0.14),
                    0 1px 10px 0 rgba(0, 0, 0, 0.12),
                    0 2px 4px -1px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-6dp: {
        box-shadow: 0 6px 10px 0 rgba(0, 0, 0, 0.14),
                    0 1px 18px 0 rgba(0, 0, 0, 0.12),
                    0 3px 5px -1px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-8dp: {
        box-shadow: 0 8px 10px 1px rgba(0, 0, 0, 0.14),
                    0 3px 14px 2px rgba(0, 0, 0, 0.12),
                    0 5px 5px -3px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-12dp: {
        box-shadow: 0 12px 16px 1px rgba(0, 0, 0, 0.14),
                    0 4px 22px 3px rgba(0, 0, 0, 0.12),
                    0 6px 7px -4px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-16dp: {
        box-shadow: 0 16px 24px 2px rgba(0, 0, 0, 0.14),
                    0  6px 30px 5px rgba(0, 0, 0, 0.12),
                    0  8px 10px -5px rgba(0, 0, 0, 0.4);
      };

      --shadow-elevation-24dp: {
        box-shadow: 0 24px 38px 3px rgba(0, 0, 0, 0.14),
                    0 9px 46px 8px rgba(0, 0, 0, 0.12),
                    0 11px 15px -7px rgba(0, 0, 0, 0.4);
      };
    }
  </style>
</custom-style>`;template$1.setAttribute("style","display: none;"),document.head.appendChild(template$1.content);const template$2=html`
<dom-module id="paper-material-styles">
  <template>
    <style>
      html {
        --paper-material: {
          display: block;
          position: relative;
        };
        --paper-material-elevation-1: {
          @apply --shadow-elevation-2dp;
        };
        --paper-material-elevation-2: {
          @apply --shadow-elevation-4dp;
        };
        --paper-material-elevation-3: {
          @apply --shadow-elevation-6dp;
        };
        --paper-material-elevation-4: {
          @apply --shadow-elevation-8dp;
        };
        --paper-material-elevation-5: {
          @apply --shadow-elevation-16dp;
        };
      }
      .paper-material {
        @apply --paper-material;
      }
      .paper-material[elevation="1"] {
        @apply --paper-material-elevation-1;
      }
      .paper-material[elevation="2"] {
        @apply --paper-material-elevation-2;
      }
      .paper-material[elevation="3"] {
        @apply --paper-material-elevation-3;
      }
      .paper-material[elevation="4"] {
        @apply --paper-material-elevation-4;
      }
      .paper-material[elevation="5"] {
        @apply --paper-material-elevation-5;
      }

      /* Duplicate the styles because of https://github.com/webcomponents/shadycss/issues/193 */
      :host {
        --paper-material: {
          display: block;
          position: relative;
        };
        --paper-material-elevation-1: {
          @apply --shadow-elevation-2dp;
        };
        --paper-material-elevation-2: {
          @apply --shadow-elevation-4dp;
        };
        --paper-material-elevation-3: {
          @apply --shadow-elevation-6dp;
        };
        --paper-material-elevation-4: {
          @apply --shadow-elevation-8dp;
        };
        --paper-material-elevation-5: {
          @apply --shadow-elevation-16dp;
        };
      }
      :host(.paper-material) {
        @apply --paper-material;
      }
      :host(.paper-material[elevation="1"]) {
        @apply --paper-material-elevation-1;
      }
      :host(.paper-material[elevation="2"]) {
        @apply --paper-material-elevation-2;
      }
      :host(.paper-material[elevation="3"]) {
        @apply --paper-material-elevation-3;
      }
      :host(.paper-material[elevation="4"]) {
        @apply --paper-material-elevation-4;
      }
      :host(.paper-material[elevation="5"]) {
        @apply --paper-material-elevation-5;
      }
    </style>
  </template>
</dom-module>`;template$2.setAttribute("style","display: none;"),document.head.appendChild(template$2.content);const template$3=html`
  <style include="paper-material-styles">
    /* Need to specify the same specificity as the styles imported from paper-material. */
    :host {
      @apply --layout-inline;
      @apply --layout-center-center;
      position: relative;
      box-sizing: border-box;
      min-width: 5.14em;
      margin: 0 0.29em;
      background: transparent;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
      -webkit-tap-highlight-color: transparent;
      font: inherit;
      text-transform: uppercase;
      outline-width: 0;
      border-radius: 3px;
      -moz-user-select: none;
      -ms-user-select: none;
      -webkit-user-select: none;
      user-select: none;
      cursor: pointer;
      z-index: 0;
      padding: 0.7em 0.57em;

      @apply --paper-font-common-base;
      @apply --paper-button;
    }

    :host([elevation="1"]) {
      @apply --paper-material-elevation-1;
    }

    :host([elevation="2"]) {
      @apply --paper-material-elevation-2;
    }

    :host([elevation="3"]) {
      @apply --paper-material-elevation-3;
    }

    :host([elevation="4"]) {
      @apply --paper-material-elevation-4;
    }

    :host([elevation="5"]) {
      @apply --paper-material-elevation-5;
    }

    :host([hidden]) {
      display: none !important;
    }

    :host([raised].keyboard-focus) {
      font-weight: bold;
      @apply --paper-button-raised-keyboard-focus;
    }

    :host(:not([raised]).keyboard-focus) {
      font-weight: bold;
      @apply --paper-button-flat-keyboard-focus;
    }

    :host([disabled]) {
      background: none;
      color: #a8a8a8;
      cursor: auto;
      pointer-events: none;

      @apply --paper-button-disabled;
    }

    :host([disabled][raised]) {
      background: #eaeaea;
    }


    :host([animated]) {
      @apply --shadow-transition;
    }

    paper-ripple {
      color: var(--paper-button-ink-color);
    }
  </style>

  <slot></slot>`;template$3.setAttribute("strip-whitespace",""),Polymer({_template:template$3,is:"paper-button",behaviors:[PaperButtonBehavior],properties:{raised:{type:Boolean,reflectToAttribute:!0,value:!1,observer:"_calculateElevation"}},_calculateElevation:function(){this.raised?PaperButtonBehaviorImpl._calculateElevation.apply(this):this._setElevation(0)}});const PaperDialogBehaviorImpl={hostAttributes:{role:"dialog",tabindex:"-1"},properties:{modal:{type:Boolean,value:!1},__readied:{type:Boolean,value:!1}},observers:["_modalChanged(modal, __readied)"],listeners:{tap:"_onDialogClick"},ready:function(){this.__prevNoCancelOnOutsideClick=this.noCancelOnOutsideClick,this.__prevNoCancelOnEscKey=this.noCancelOnEscKey,this.__prevWithBackdrop=this.withBackdrop,this.__readied=!0},_modalChanged:function(e,t){t&&(e?(this.__prevNoCancelOnOutsideClick=this.noCancelOnOutsideClick,this.__prevNoCancelOnEscKey=this.noCancelOnEscKey,this.__prevWithBackdrop=this.withBackdrop,this.noCancelOnOutsideClick=!0,this.noCancelOnEscKey=!0,this.withBackdrop=!0):(this.noCancelOnOutsideClick=this.noCancelOnOutsideClick&&this.__prevNoCancelOnOutsideClick,this.noCancelOnEscKey=this.noCancelOnEscKey&&this.__prevNoCancelOnEscKey,this.withBackdrop=this.withBackdrop&&this.__prevWithBackdrop))},_updateClosingReasonConfirmed:function(e){this.closingReason=this.closingReason||{},this.closingReason.confirmed=e},_onDialogClick:function(e){for(var t,i=dom(e).path,r=0,n=i.indexOf(this);r<n;r++)if((t=i[r]).hasAttribute&&(t.hasAttribute("dialog-dismiss")||t.hasAttribute("dialog-confirm"))){this._updateClosingReasonConfirmed(t.hasAttribute("dialog-confirm")),this.close(),e.stopPropagation();break}}},PaperDialogBehavior=[IronOverlayBehavior,PaperDialogBehaviorImpl];var paperDialogBehavior={PaperDialogBehaviorImpl:PaperDialogBehaviorImpl,PaperDialogBehavior:PaperDialogBehavior};const template$4=html`
<custom-style>
  <style is="custom-style">
    html {

      /* Material Design color palette for Google products */

      --google-red-100: #f4c7c3;
      --google-red-300: #e67c73;
      --google-red-500: #db4437;
      --google-red-700: #c53929;

      --google-blue-100: #c6dafc;
      --google-blue-300: #7baaf7;
      --google-blue-500: #4285f4;
      --google-blue-700: #3367d6;

      --google-green-100: #b7e1cd;
      --google-green-300: #57bb8a;
      --google-green-500: #0f9d58;
      --google-green-700: #0b8043;

      --google-yellow-100: #fce8b2;
      --google-yellow-300: #f7cb4d;
      --google-yellow-500: #f4b400;
      --google-yellow-700: #f09300;

      --google-grey-100: #f5f5f5;
      --google-grey-300: #e0e0e0;
      --google-grey-500: #9e9e9e;
      --google-grey-700: #616161;

      /* Material Design color palette from online spec document */

      --paper-red-50: #ffebee;
      --paper-red-100: #ffcdd2;
      --paper-red-200: #ef9a9a;
      --paper-red-300: #e57373;
      --paper-red-400: #ef5350;
      --paper-red-500: #f44336;
      --paper-red-600: #e53935;
      --paper-red-700: #d32f2f;
      --paper-red-800: #c62828;
      --paper-red-900: #b71c1c;
      --paper-red-a100: #ff8a80;
      --paper-red-a200: #ff5252;
      --paper-red-a400: #ff1744;
      --paper-red-a700: #d50000;

      --paper-pink-50: #fce4ec;
      --paper-pink-100: #f8bbd0;
      --paper-pink-200: #f48fb1;
      --paper-pink-300: #f06292;
      --paper-pink-400: #ec407a;
      --paper-pink-500: #e91e63;
      --paper-pink-600: #d81b60;
      --paper-pink-700: #c2185b;
      --paper-pink-800: #ad1457;
      --paper-pink-900: #880e4f;
      --paper-pink-a100: #ff80ab;
      --paper-pink-a200: #ff4081;
      --paper-pink-a400: #f50057;
      --paper-pink-a700: #c51162;

      --paper-purple-50: #f3e5f5;
      --paper-purple-100: #e1bee7;
      --paper-purple-200: #ce93d8;
      --paper-purple-300: #ba68c8;
      --paper-purple-400: #ab47bc;
      --paper-purple-500: #9c27b0;
      --paper-purple-600: #8e24aa;
      --paper-purple-700: #7b1fa2;
      --paper-purple-800: #6a1b9a;
      --paper-purple-900: #4a148c;
      --paper-purple-a100: #ea80fc;
      --paper-purple-a200: #e040fb;
      --paper-purple-a400: #d500f9;
      --paper-purple-a700: #aa00ff;

      --paper-deep-purple-50: #ede7f6;
      --paper-deep-purple-100: #d1c4e9;
      --paper-deep-purple-200: #b39ddb;
      --paper-deep-purple-300: #9575cd;
      --paper-deep-purple-400: #7e57c2;
      --paper-deep-purple-500: #673ab7;
      --paper-deep-purple-600: #5e35b1;
      --paper-deep-purple-700: #512da8;
      --paper-deep-purple-800: #4527a0;
      --paper-deep-purple-900: #311b92;
      --paper-deep-purple-a100: #b388ff;
      --paper-deep-purple-a200: #7c4dff;
      --paper-deep-purple-a400: #651fff;
      --paper-deep-purple-a700: #6200ea;

      --paper-indigo-50: #e8eaf6;
      --paper-indigo-100: #c5cae9;
      --paper-indigo-200: #9fa8da;
      --paper-indigo-300: #7986cb;
      --paper-indigo-400: #5c6bc0;
      --paper-indigo-500: #3f51b5;
      --paper-indigo-600: #3949ab;
      --paper-indigo-700: #303f9f;
      --paper-indigo-800: #283593;
      --paper-indigo-900: #1a237e;
      --paper-indigo-a100: #8c9eff;
      --paper-indigo-a200: #536dfe;
      --paper-indigo-a400: #3d5afe;
      --paper-indigo-a700: #304ffe;

      --paper-blue-50: #e3f2fd;
      --paper-blue-100: #bbdefb;
      --paper-blue-200: #90caf9;
      --paper-blue-300: #64b5f6;
      --paper-blue-400: #42a5f5;
      --paper-blue-500: #2196f3;
      --paper-blue-600: #1e88e5;
      --paper-blue-700: #1976d2;
      --paper-blue-800: #1565c0;
      --paper-blue-900: #0d47a1;
      --paper-blue-a100: #82b1ff;
      --paper-blue-a200: #448aff;
      --paper-blue-a400: #2979ff;
      --paper-blue-a700: #2962ff;

      --paper-light-blue-50: #e1f5fe;
      --paper-light-blue-100: #b3e5fc;
      --paper-light-blue-200: #81d4fa;
      --paper-light-blue-300: #4fc3f7;
      --paper-light-blue-400: #29b6f6;
      --paper-light-blue-500: #03a9f4;
      --paper-light-blue-600: #039be5;
      --paper-light-blue-700: #0288d1;
      --paper-light-blue-800: #0277bd;
      --paper-light-blue-900: #01579b;
      --paper-light-blue-a100: #80d8ff;
      --paper-light-blue-a200: #40c4ff;
      --paper-light-blue-a400: #00b0ff;
      --paper-light-blue-a700: #0091ea;

      --paper-cyan-50: #e0f7fa;
      --paper-cyan-100: #b2ebf2;
      --paper-cyan-200: #80deea;
      --paper-cyan-300: #4dd0e1;
      --paper-cyan-400: #26c6da;
      --paper-cyan-500: #00bcd4;
      --paper-cyan-600: #00acc1;
      --paper-cyan-700: #0097a7;
      --paper-cyan-800: #00838f;
      --paper-cyan-900: #006064;
      --paper-cyan-a100: #84ffff;
      --paper-cyan-a200: #18ffff;
      --paper-cyan-a400: #00e5ff;
      --paper-cyan-a700: #00b8d4;

      --paper-teal-50: #e0f2f1;
      --paper-teal-100: #b2dfdb;
      --paper-teal-200: #80cbc4;
      --paper-teal-300: #4db6ac;
      --paper-teal-400: #26a69a;
      --paper-teal-500: #009688;
      --paper-teal-600: #00897b;
      --paper-teal-700: #00796b;
      --paper-teal-800: #00695c;
      --paper-teal-900: #004d40;
      --paper-teal-a100: #a7ffeb;
      --paper-teal-a200: #64ffda;
      --paper-teal-a400: #1de9b6;
      --paper-teal-a700: #00bfa5;

      --paper-green-50: #e8f5e9;
      --paper-green-100: #c8e6c9;
      --paper-green-200: #a5d6a7;
      --paper-green-300: #81c784;
      --paper-green-400: #66bb6a;
      --paper-green-500: #4caf50;
      --paper-green-600: #43a047;
      --paper-green-700: #388e3c;
      --paper-green-800: #2e7d32;
      --paper-green-900: #1b5e20;
      --paper-green-a100: #b9f6ca;
      --paper-green-a200: #69f0ae;
      --paper-green-a400: #00e676;
      --paper-green-a700: #00c853;

      --paper-light-green-50: #f1f8e9;
      --paper-light-green-100: #dcedc8;
      --paper-light-green-200: #c5e1a5;
      --paper-light-green-300: #aed581;
      --paper-light-green-400: #9ccc65;
      --paper-light-green-500: #8bc34a;
      --paper-light-green-600: #7cb342;
      --paper-light-green-700: #689f38;
      --paper-light-green-800: #558b2f;
      --paper-light-green-900: #33691e;
      --paper-light-green-a100: #ccff90;
      --paper-light-green-a200: #b2ff59;
      --paper-light-green-a400: #76ff03;
      --paper-light-green-a700: #64dd17;

      --paper-lime-50: #f9fbe7;
      --paper-lime-100: #f0f4c3;
      --paper-lime-200: #e6ee9c;
      --paper-lime-300: #dce775;
      --paper-lime-400: #d4e157;
      --paper-lime-500: #cddc39;
      --paper-lime-600: #c0ca33;
      --paper-lime-700: #afb42b;
      --paper-lime-800: #9e9d24;
      --paper-lime-900: #827717;
      --paper-lime-a100: #f4ff81;
      --paper-lime-a200: #eeff41;
      --paper-lime-a400: #c6ff00;
      --paper-lime-a700: #aeea00;

      --paper-yellow-50: #fffde7;
      --paper-yellow-100: #fff9c4;
      --paper-yellow-200: #fff59d;
      --paper-yellow-300: #fff176;
      --paper-yellow-400: #ffee58;
      --paper-yellow-500: #ffeb3b;
      --paper-yellow-600: #fdd835;
      --paper-yellow-700: #fbc02d;
      --paper-yellow-800: #f9a825;
      --paper-yellow-900: #f57f17;
      --paper-yellow-a100: #ffff8d;
      --paper-yellow-a200: #ffff00;
      --paper-yellow-a400: #ffea00;
      --paper-yellow-a700: #ffd600;

      --paper-amber-50: #fff8e1;
      --paper-amber-100: #ffecb3;
      --paper-amber-200: #ffe082;
      --paper-amber-300: #ffd54f;
      --paper-amber-400: #ffca28;
      --paper-amber-500: #ffc107;
      --paper-amber-600: #ffb300;
      --paper-amber-700: #ffa000;
      --paper-amber-800: #ff8f00;
      --paper-amber-900: #ff6f00;
      --paper-amber-a100: #ffe57f;
      --paper-amber-a200: #ffd740;
      --paper-amber-a400: #ffc400;
      --paper-amber-a700: #ffab00;

      --paper-orange-50: #fff3e0;
      --paper-orange-100: #ffe0b2;
      --paper-orange-200: #ffcc80;
      --paper-orange-300: #ffb74d;
      --paper-orange-400: #ffa726;
      --paper-orange-500: #ff9800;
      --paper-orange-600: #fb8c00;
      --paper-orange-700: #f57c00;
      --paper-orange-800: #ef6c00;
      --paper-orange-900: #e65100;
      --paper-orange-a100: #ffd180;
      --paper-orange-a200: #ffab40;
      --paper-orange-a400: #ff9100;
      --paper-orange-a700: #ff6500;

      --paper-deep-orange-50: #fbe9e7;
      --paper-deep-orange-100: #ffccbc;
      --paper-deep-orange-200: #ffab91;
      --paper-deep-orange-300: #ff8a65;
      --paper-deep-orange-400: #ff7043;
      --paper-deep-orange-500: #ff5722;
      --paper-deep-orange-600: #f4511e;
      --paper-deep-orange-700: #e64a19;
      --paper-deep-orange-800: #d84315;
      --paper-deep-orange-900: #bf360c;
      --paper-deep-orange-a100: #ff9e80;
      --paper-deep-orange-a200: #ff6e40;
      --paper-deep-orange-a400: #ff3d00;
      --paper-deep-orange-a700: #dd2c00;

      --paper-brown-50: #efebe9;
      --paper-brown-100: #d7ccc8;
      --paper-brown-200: #bcaaa4;
      --paper-brown-300: #a1887f;
      --paper-brown-400: #8d6e63;
      --paper-brown-500: #795548;
      --paper-brown-600: #6d4c41;
      --paper-brown-700: #5d4037;
      --paper-brown-800: #4e342e;
      --paper-brown-900: #3e2723;

      --paper-grey-50: #fafafa;
      --paper-grey-100: #f5f5f5;
      --paper-grey-200: #eeeeee;
      --paper-grey-300: #e0e0e0;
      --paper-grey-400: #bdbdbd;
      --paper-grey-500: #9e9e9e;
      --paper-grey-600: #757575;
      --paper-grey-700: #616161;
      --paper-grey-800: #424242;
      --paper-grey-900: #212121;

      --paper-blue-grey-50: #eceff1;
      --paper-blue-grey-100: #cfd8dc;
      --paper-blue-grey-200: #b0bec5;
      --paper-blue-grey-300: #90a4ae;
      --paper-blue-grey-400: #78909c;
      --paper-blue-grey-500: #607d8b;
      --paper-blue-grey-600: #546e7a;
      --paper-blue-grey-700: #455a64;
      --paper-blue-grey-800: #37474f;
      --paper-blue-grey-900: #263238;

      /* opacity for dark text on a light background */
      --dark-divider-opacity: 0.12;
      --dark-disabled-opacity: 0.38; /* or hint text or icon */
      --dark-secondary-opacity: 0.54;
      --dark-primary-opacity: 0.87;

      /* opacity for light text on a dark background */
      --light-divider-opacity: 0.12;
      --light-disabled-opacity: 0.3; /* or hint text or icon */
      --light-secondary-opacity: 0.7;
      --light-primary-opacity: 1.0;

    }

  </style>
</custom-style>
`;template$4.setAttribute("style","display: none;"),document.head.appendChild(template$4.content);const template$5=html`
<custom-style>
  <style is="custom-style">
    html {
      /*
       * You can use these generic variables in your elements for easy theming.
       * For example, if all your elements use \`--primary-text-color\` as its main
       * color, then switching from a light to a dark theme is just a matter of
       * changing the value of \`--primary-text-color\` in your application.
       */
      --primary-text-color: var(--light-theme-text-color);
      --primary-background-color: var(--light-theme-background-color);
      --secondary-text-color: var(--light-theme-secondary-color);
      --disabled-text-color: var(--light-theme-disabled-color);
      --divider-color: var(--light-theme-divider-color);
      --error-color: var(--paper-deep-orange-a700);

      /*
       * Primary and accent colors. Also see color.js for more colors.
       */
      --primary-color: var(--paper-indigo-500);
      --light-primary-color: var(--paper-indigo-100);
      --dark-primary-color: var(--paper-indigo-700);

      --accent-color: var(--paper-pink-a200);
      --light-accent-color: var(--paper-pink-a100);
      --dark-accent-color: var(--paper-pink-a400);


      /*
       * Material Design Light background theme
       */
      --light-theme-background-color: #ffffff;
      --light-theme-base-color: #000000;
      --light-theme-text-color: var(--paper-grey-900);
      --light-theme-secondary-color: #737373;  /* for secondary text and icons */
      --light-theme-disabled-color: #9b9b9b;  /* disabled/hint text */
      --light-theme-divider-color: #dbdbdb;

      /*
       * Material Design Dark background theme
       */
      --dark-theme-background-color: var(--paper-grey-900);
      --dark-theme-base-color: #ffffff;
      --dark-theme-text-color: #ffffff;
      --dark-theme-secondary-color: #bcbcbc;  /* for secondary text and icons */
      --dark-theme-disabled-color: #646464;  /* disabled/hint text */
      --dark-theme-divider-color: #3c3c3c;

      /*
       * Deprecated values because of their confusing names.
       */
      --text-primary-color: var(--dark-theme-text-color);
      --default-primary-color: var(--primary-color);
    }
  </style>
</custom-style>`;template$5.setAttribute("style","display: none;"),document.head.appendChild(template$5.content);const template$6=html`<custom-style>
  <style is="custom-style">
    html {

      /* Shared Styles */
      --paper-font-common-base: {
        font-family: 'Roboto', 'Noto', sans-serif;
        -webkit-font-smoothing: antialiased;
      };

      --paper-font-common-code: {
        font-family: 'Roboto Mono', 'Consolas', 'Menlo', monospace;
        -webkit-font-smoothing: antialiased;
      };

      --paper-font-common-expensive-kerning: {
        text-rendering: optimizeLegibility;
      };

      --paper-font-common-nowrap: {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      };

      /* Material Font Styles */

      --paper-font-display4: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 112px;
        font-weight: 300;
        letter-spacing: -.044em;
        line-height: 120px;
      };

      --paper-font-display3: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 56px;
        font-weight: 400;
        letter-spacing: -.026em;
        line-height: 60px;
      };

      --paper-font-display2: {
        @apply --paper-font-common-base;

        font-size: 45px;
        font-weight: 400;
        letter-spacing: -.018em;
        line-height: 48px;
      };

      --paper-font-display1: {
        @apply --paper-font-common-base;

        font-size: 34px;
        font-weight: 400;
        letter-spacing: -.01em;
        line-height: 40px;
      };

      --paper-font-headline: {
        @apply --paper-font-common-base;

        font-size: 24px;
        font-weight: 400;
        letter-spacing: -.012em;
        line-height: 32px;
      };

      --paper-font-title: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 20px;
        font-weight: 500;
        line-height: 28px;
      };

      --paper-font-subhead: {
        @apply --paper-font-common-base;

        font-size: 16px;
        font-weight: 400;
        line-height: 24px;
      };

      --paper-font-body2: {
        @apply --paper-font-common-base;

        font-size: 14px;
        font-weight: 500;
        line-height: 24px;
      };

      --paper-font-body1: {
        @apply --paper-font-common-base;

        font-size: 14px;
        font-weight: 400;
        line-height: 20px;
      };

      --paper-font-caption: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 12px;
        font-weight: 400;
        letter-spacing: 0.011em;
        line-height: 20px;
      };

      --paper-font-menu: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 13px;
        font-weight: 500;
        line-height: 24px;
      };

      --paper-font-button: {
        @apply --paper-font-common-base;
        @apply --paper-font-common-nowrap;

        font-size: 14px;
        font-weight: 500;
        letter-spacing: 0.018em;
        line-height: 24px;
        text-transform: uppercase;
      };

      --paper-font-code2: {
        @apply --paper-font-common-code;

        font-size: 14px;
        font-weight: 700;
        line-height: 20px;
      };

      --paper-font-code1: {
        @apply --paper-font-common-code;

        font-size: 14px;
        font-weight: 500;
        line-height: 20px;
      };

    }

  </style>
</custom-style>`;template$6.setAttribute("style","display: none;"),document.head.appendChild(template$6.content);const $_documentContainer=document.createElement("template");$_documentContainer.setAttribute("style","display: none;"),$_documentContainer.innerHTML='<dom-module id="paper-dialog-shared-styles">\n  <template>\n    <style>\n      :host {\n        display: block;\n        margin: 24px 40px;\n\n        background: var(--paper-dialog-background-color, var(--primary-background-color));\n        color: var(--paper-dialog-color, var(--primary-text-color));\n\n        @apply --paper-font-body1;\n        @apply --shadow-elevation-16dp;\n        @apply --paper-dialog;\n      }\n\n      :host > ::slotted(*) {\n        margin-top: 20px;\n        padding: 0 24px;\n      }\n\n      :host > ::slotted(.no-padding) {\n        padding: 0;\n      }\n\n      \n      :host > ::slotted(*:first-child) {\n        margin-top: 24px;\n      }\n\n      :host > ::slotted(*:last-child) {\n        margin-bottom: 24px;\n      }\n\n      /* In 1.x, this selector was `:host > ::content h2`. In 2.x <slot> allows\n      to select direct children only, which increases the weight of this\n      selector, so we have to re-define first-child/last-child margins below. */\n      :host > ::slotted(h2) {\n        position: relative;\n        margin: 0;\n\n        @apply --paper-font-title;\n        @apply --paper-dialog-title;\n      }\n\n      /* Apply mixin again, in case it sets margin-top. */\n      :host > ::slotted(h2:first-child) {\n        margin-top: 24px;\n        @apply --paper-dialog-title;\n      }\n\n      /* Apply mixin again, in case it sets margin-bottom. */\n      :host > ::slotted(h2:last-child) {\n        margin-bottom: 24px;\n        @apply --paper-dialog-title;\n      }\n\n      :host > ::slotted(.paper-dialog-buttons),\n      :host > ::slotted(.buttons) {\n        position: relative;\n        padding: 8px 8px 8px 24px;\n        margin: 0;\n\n        color: var(--paper-dialog-button-color, var(--primary-color));\n\n        @apply --layout-horizontal;\n        @apply --layout-end-justified;\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild($_documentContainer.content),Polymer({_template:html`
    <style>

      :host {
        display: block;
        @apply --layout-relative;
      }

      :host(.is-scrolled:not(:first-child))::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: var(--divider-color);
      }

      :host(.can-scroll:not(.scrolled-to-bottom):not(:last-child))::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: var(--divider-color);
      }

      .scrollable {
        padding: 0 24px;

        @apply --layout-scroll;
        @apply --paper-dialog-scrollable;
      }

      .fit {
        @apply --layout-fit;
      }
    </style>

    <div id="scrollable" class="scrollable" on-scroll="updateScrollState">
      <slot></slot>
    </div>
`,is:"paper-dialog-scrollable",properties:{dialogElement:{type:Object}},get scrollTarget(){return this.$.scrollable},ready:function(){this._ensureTarget(),this.classList.add("no-padding")},attached:function(){this._ensureTarget(),requestAnimationFrame(this.updateScrollState.bind(this))},updateScrollState:function(){this.toggleClass("is-scrolled",0<this.scrollTarget.scrollTop),this.toggleClass("can-scroll",this.scrollTarget.offsetHeight<this.scrollTarget.scrollHeight),this.toggleClass("scrolled-to-bottom",this.scrollTarget.scrollTop+this.scrollTarget.offsetHeight>=this.scrollTarget.scrollHeight)},_ensureTarget:function(){this.dialogElement=this.dialogElement||this.parentElement,this.dialogElement&&this.dialogElement.behaviors&&0<=this.dialogElement.behaviors.indexOf(PaperDialogBehaviorImpl)?(this.dialogElement.sizingTarget=this.scrollTarget,this.scrollTarget.classList.remove("fit")):this.dialogElement&&this.scrollTarget.classList.add("fit")}}),Polymer({_template:html`
    <style include="paper-dialog-shared-styles"></style>
    <slot></slot>
`,is:"paper-dialog",behaviors:[PaperDialogBehavior,NeonAnimationRunnerBehavior],listeners:{"neon-animation-finish":"_onNeonAnimationFinish"},_renderOpened:function(){this.cancelAnimation(),this.playAnimation("entry")},_renderClosed:function(){this.cancelAnimation(),this.playAnimation("exit")},_onNeonAnimationFinish:function(){this.opened?this._finishRenderOpened():this._finishRenderClosed()}});const $_documentContainer$1=document.createElement("template");$_documentContainer$1.setAttribute("style","display: none;"),$_documentContainer$1.innerHTML='<iron-iconset-svg name="paper-dropdown-menu" size="24">\n<svg><defs>\n<g id="arrow-drop-down"><path d="M7 10l5 5 5-5z"></path></g>\n</defs></svg>\n</iron-iconset-svg>',document.head.appendChild($_documentContainer$1.content);const $_documentContainer$2=document.createElement("template");$_documentContainer$2.setAttribute("style","display: none;"),$_documentContainer$2.innerHTML='<dom-module id="paper-dropdown-menu-shared-styles">\n  <template>\n    <style>\n      :host {\n        display: inline-block;\n        position: relative;\n        text-align: left;\n\n        /* NOTE(cdata): Both values are needed, since some phones require the\n         * value to be `transparent`.\n         */\n        -webkit-tap-highlight-color: rgba(0,0,0,0);\n        -webkit-tap-highlight-color: transparent;\n\n        --paper-input-container-input: {\n          overflow: hidden;\n          white-space: nowrap;\n          text-overflow: ellipsis;\n          max-width: 100%;\n          box-sizing: border-box;\n          cursor: pointer;\n        };\n\n        @apply --paper-dropdown-menu;\n      }\n\n      :host([disabled]) {\n        @apply --paper-dropdown-menu-disabled;\n      }\n\n      :host([noink]) paper-ripple {\n        display: none;\n      }\n\n      :host([no-label-float]) paper-ripple {\n        top: 8px;\n      }\n\n      paper-ripple {\n        top: 12px;\n        left: 0px;\n        bottom: 8px;\n        right: 0px;\n\n        @apply --paper-dropdown-menu-ripple;\n      }\n\n      paper-menu-button {\n        display: block;\n        padding: 0;\n\n        @apply --paper-dropdown-menu-button;\n      }\n\n      paper-input {\n        @apply --paper-dropdown-menu-input;\n      }\n\n      iron-icon {\n        color: var(--disabled-text-color);\n\n        @apply --paper-dropdown-menu-icon;\n      }\n    </style>\n  </template>\n</dom-module>',document.head.appendChild($_documentContainer$2.content);const PaperInputAddonBehavior={attached:function(){this.fire("addon-attached")},update:function(e){}};var paperInputAddonBehavior={PaperInputAddonBehavior:PaperInputAddonBehavior};Polymer({_template:html`
    <style>
      :host {
        display: inline-block;
        float: right;

        @apply --paper-font-caption;
        @apply --paper-input-char-counter;
      }

      :host([hidden]) {
        display: none !important;
      }

      :host(:dir(rtl)) {
        float: left;
      }
    </style>

    <span>[[_charCounterStr]]</span>
`,is:"paper-input-char-counter",behaviors:[PaperInputAddonBehavior],properties:{_charCounterStr:{type:String,value:"0"}},update:function(e){if(e.inputElement){e.value=e.value||"";var t=e.value.toString().length.toString();e.inputElement.hasAttribute("maxlength")&&(t+="/"+e.inputElement.getAttribute("maxlength")),this._charCounterStr=t}}});const template$7=html`
<custom-style>
  <style is="custom-style">
    html {
      --paper-input-container-shared-input-style: {
        position: relative; /* to make a stacking context */
        outline: none;
        box-shadow: none;
        padding: 0;
        margin: 0;
        width: 100%;
        max-width: 100%;
        background: transparent;
        border: none;
        color: var(--paper-input-container-input-color, var(--primary-text-color));
        -webkit-appearance: none;
        text-align: inherit;
        vertical-align: var(--paper-input-container-input-align, bottom);

        @apply --paper-font-subhead;
      };
    }
  </style>
</custom-style>
`;template$7.setAttribute("style","display: none;"),document.head.appendChild(template$7.content),Polymer({_template:html`
    <style>
      :host {
        display: block;
        padding: 8px 0;
        @apply --paper-input-container;
      }

      :host([inline]) {
        display: inline-block;
      }

      :host([disabled]) {
        pointer-events: none;
        opacity: 0.33;

        @apply --paper-input-container-disabled;
      }

      :host([hidden]) {
        display: none !important;
      }

      [hidden] {
        display: none !important;
      }

      .floated-label-placeholder {
        @apply --paper-font-caption;
      }

      .underline {
        height: 2px;
        position: relative;
      }

      .focused-line {
        @apply --layout-fit;
        border-bottom: 2px solid var(--paper-input-container-focus-color, var(--primary-color));

        -webkit-transform-origin: center center;
        transform-origin: center center;
        -webkit-transform: scale3d(0,1,1);
        transform: scale3d(0,1,1);

        @apply --paper-input-container-underline-focus;
      }

      .underline.is-highlighted .focused-line {
        -webkit-transform: none;
        transform: none;
        -webkit-transition: -webkit-transform 0.25s;
        transition: transform 0.25s;

        @apply --paper-transition-easing;
      }

      .underline.is-invalid .focused-line {
        border-color: var(--paper-input-container-invalid-color, var(--error-color));
        -webkit-transform: none;
        transform: none;
        -webkit-transition: -webkit-transform 0.25s;
        transition: transform 0.25s;

        @apply --paper-transition-easing;
      }

      .unfocused-line {
        @apply --layout-fit;
        border-bottom: 1px solid var(--paper-input-container-color, var(--secondary-text-color));
        @apply --paper-input-container-underline;
      }

      :host([disabled]) .unfocused-line {
        border-bottom: 1px dashed;
        border-color: var(--paper-input-container-color, var(--secondary-text-color));
        @apply --paper-input-container-underline-disabled;
      }

      .input-wrapper {
        @apply --layout-horizontal;
        @apply --layout-center;
        position: relative;
      }

      .input-content {
        @apply --layout-flex-auto;
        @apply --layout-relative;
        max-width: 100%;
      }

      .input-content ::slotted(label),
      .input-content ::slotted(.paper-input-label) {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        font: inherit;
        color: var(--paper-input-container-color, var(--secondary-text-color));
        -webkit-transition: -webkit-transform 0.25s, width 0.25s;
        transition: transform 0.25s, width 0.25s;
        -webkit-transform-origin: left top;
        transform-origin: left top;
        /* Fix for safari not focusing 0-height date/time inputs with -webkit-apperance: none; */
        min-height: 1px;

        @apply --paper-font-common-nowrap;
        @apply --paper-font-subhead;
        @apply --paper-input-container-label;
        @apply --paper-transition-easing;
      }

      .input-content.label-is-floating ::slotted(label),
      .input-content.label-is-floating ::slotted(.paper-input-label) {
        -webkit-transform: translateY(-75%) scale(0.75);
        transform: translateY(-75%) scale(0.75);

        /* Since we scale to 75/100 of the size, we actually have 100/75 of the
        original space now available */
        width: 133%;

        @apply --paper-input-container-label-floating;
      }

      :host(:dir(rtl)) .input-content.label-is-floating ::slotted(label),
      :host(:dir(rtl)) .input-content.label-is-floating ::slotted(.paper-input-label) {
        right: 0;
        left: auto;
        -webkit-transform-origin: right top;
        transform-origin: right top;
      }

      .input-content.label-is-highlighted ::slotted(label),
      .input-content.label-is-highlighted ::slotted(.paper-input-label) {
        color: var(--paper-input-container-focus-color, var(--primary-color));

        @apply --paper-input-container-label-focus;
      }

      .input-content.is-invalid ::slotted(label),
      .input-content.is-invalid ::slotted(.paper-input-label) {
        color: var(--paper-input-container-invalid-color, var(--error-color));
      }

      .input-content.label-is-hidden ::slotted(label),
      .input-content.label-is-hidden ::slotted(.paper-input-label) {
        visibility: hidden;
      }

      .input-content ::slotted(input),
      .input-content ::slotted(iron-input),
      .input-content ::slotted(textarea),
      .input-content ::slotted(iron-autogrow-textarea),
      .input-content ::slotted(.paper-input-input) {
        @apply --paper-input-container-shared-input-style;
        /* The apply shim doesn't apply the nested color custom property,
          so we have to re-apply it here. */
        color: var(--paper-input-container-input-color, var(--primary-text-color));
        @apply --paper-input-container-input;
      }

      .input-content ::slotted(input)::-webkit-outer-spin-button,
      .input-content ::slotted(input)::-webkit-inner-spin-button {
        @apply --paper-input-container-input-webkit-spinner;
      }

      .input-content.focused ::slotted(input),
      .input-content.focused ::slotted(iron-input),
      .input-content.focused ::slotted(textarea),
      .input-content.focused ::slotted(iron-autogrow-textarea),
      .input-content.focused ::slotted(.paper-input-input) {
        @apply --paper-input-container-input-focus;
      }

      .input-content.is-invalid ::slotted(input),
      .input-content.is-invalid ::slotted(iron-input),
      .input-content.is-invalid ::slotted(textarea),
      .input-content.is-invalid ::slotted(iron-autogrow-textarea),
      .input-content.is-invalid ::slotted(.paper-input-input) {
        @apply --paper-input-container-input-invalid;
      }

      .prefix ::slotted(*) {
        display: inline-block;
        @apply --paper-font-subhead;
        @apply --layout-flex-none;
        @apply --paper-input-prefix;
      }

      .suffix ::slotted(*) {
        display: inline-block;
        @apply --paper-font-subhead;
        @apply --layout-flex-none;

        @apply --paper-input-suffix;
      }

      /* Firefox sets a min-width on the input, which can cause layout issues */
      .input-content ::slotted(input) {
        min-width: 0;
      }

      .input-content ::slotted(textarea) {
        resize: none;
      }

      .add-on-content {
        position: relative;
      }

      .add-on-content.is-invalid ::slotted(*) {
        color: var(--paper-input-container-invalid-color, var(--error-color));
      }

      .add-on-content.is-highlighted ::slotted(*) {
        color: var(--paper-input-container-focus-color, var(--primary-color));
      }
    </style>

    <div class="floated-label-placeholder" aria-hidden="true" hidden="[[noLabelFloat]]">&nbsp;</div>

    <div class="input-wrapper">
      <span class="prefix"><slot name="prefix"></slot></span>

      <div class$="[[_computeInputContentClass(noLabelFloat,alwaysFloatLabel,focused,invalid,_inputHasContent)]]" id="labelAndInputContainer">
        <slot name="label"></slot>
        <slot name="input"></slot>
      </div>

      <span class="suffix"><slot name="suffix"></slot></span>
    </div>

    <div class$="[[_computeUnderlineClass(focused,invalid)]]">
      <div class="unfocused-line"></div>
      <div class="focused-line"></div>
    </div>

    <div class$="[[_computeAddOnContentClass(focused,invalid)]]">
      <slot name="add-on"></slot>
    </div>
`,is:"paper-input-container",properties:{noLabelFloat:{type:Boolean,value:!1},alwaysFloatLabel:{type:Boolean,value:!1},attrForValue:{type:String,value:"bind-value"},autoValidate:{type:Boolean,value:!1},invalid:{observer:"_invalidChanged",type:Boolean,value:!1},focused:{readOnly:!0,type:Boolean,value:!1,notify:!0},_addons:{type:Array},_inputHasContent:{type:Boolean,value:!1},_inputSelector:{type:String,value:"input,iron-input,textarea,.paper-input-input"},_boundOnFocus:{type:Function,value:function(){return this._onFocus.bind(this)}},_boundOnBlur:{type:Function,value:function(){return this._onBlur.bind(this)}},_boundOnInput:{type:Function,value:function(){return this._onInput.bind(this)}},_boundValueChanged:{type:Function,value:function(){return this._onValueChanged.bind(this)}}},listeners:{"addon-attached":"_onAddonAttached","iron-input-validate":"_onIronInputValidate"},get _valueChangedEvent(){return this.attrForValue+"-changed"},get _propertyForValue(){return dashToCamelCase(this.attrForValue)},get _inputElement(){return dom(this).querySelector(this._inputSelector)},get _inputElementValue(){return this._inputElement[this._propertyForValue]||this._inputElement.value},ready:function(){this.__isFirstValueUpdate=!0,this._addons||(this._addons=[]),this.addEventListener("focus",this._boundOnFocus,!0),this.addEventListener("blur",this._boundOnBlur,!0)},attached:function(){this.attrForValue?this._inputElement.addEventListener(this._valueChangedEvent,this._boundValueChanged):this.addEventListener("input",this._onInput),this._inputElementValue&&""!=this._inputElementValue?this._handleValueAndAutoValidate(this._inputElement):this._handleValue(this._inputElement)},_onAddonAttached:function(e){this._addons||(this._addons=[]);var t=e.target;-1===this._addons.indexOf(t)&&(this._addons.push(t),this.isAttached&&this._handleValue(this._inputElement))},_onFocus:function(){this._setFocused(!0)},_onBlur:function(){this._setFocused(!1),this._handleValueAndAutoValidate(this._inputElement)},_onInput:function(e){this._handleValueAndAutoValidate(e.target)},_onValueChanged:function(e){var t=e.target;this.__isFirstValueUpdate&&(this.__isFirstValueUpdate=!1,void 0===t.value||""===t.value)||this._handleValueAndAutoValidate(e.target)},_handleValue:function(e){var t=this._inputElementValue;t||0===t||"number"===e.type&&!e.checkValidity()?this._inputHasContent=!0:this._inputHasContent=!1,this.updateAddons({inputElement:e,value:t,invalid:this.invalid})},_handleValueAndAutoValidate:function(e){var t;this.autoValidate&&e&&(t=e.validate?e.validate(this._inputElementValue):e.checkValidity(),this.invalid=!t);this._handleValue(e)},_onIronInputValidate:function(e){this.invalid=this._inputElement.invalid},_invalidChanged:function(){this._addons&&this.updateAddons({invalid:this.invalid})},updateAddons:function(e){for(var t,i=0;t=this._addons[i];i++)t.update(e)},_computeInputContentClass:function(e,t,i,r,n){var a="input-content";if(e)n&&(a+=" label-is-hidden"),r&&(a+=" is-invalid");else{var o=this.querySelector("label");t||n?(a+=" label-is-floating",this.$.labelAndInputContainer.style.position="static",r?a+=" is-invalid":i&&(a+=" label-is-highlighted")):(o&&(this.$.labelAndInputContainer.style.position="relative"),r&&(a+=" is-invalid"))}return i&&(a+=" focused"),a},_computeUnderlineClass:function(e,t){var i="underline";return t?i+=" is-invalid":e&&(i+=" is-highlighted"),i},_computeAddOnContentClass:function(e,t){var i="add-on-content";return t?i+=" is-invalid":e&&(i+=" is-highlighted"),i}}),Polymer({_template:html`
    <style>
      :host {
        display: inline-block;
        visibility: hidden;

        color: var(--paper-input-container-invalid-color, var(--error-color));

        @apply --paper-font-caption;
        @apply --paper-input-error;
        position: absolute;
        left:0;
        right:0;
      }

      :host([invalid]) {
        visibility: visible;
      }

      #a11yWrapper {
        visibility: hidden;
      }

      :host([invalid]) #a11yWrapper {
        visibility: visible;
      }
    </style>

    <!--
    If the paper-input-error element is directly referenced by an
    \`aria-describedby\` attribute, such as when used as a paper-input add-on,
    then applying \`visibility: hidden;\` to the paper-input-error element itself
    does not hide the error.

    For more information, see:
    https://www.w3.org/TR/accname-1.1/#mapping_additional_nd_description
    -->
    <div id="a11yWrapper">
      <slot></slot>
    </div>
`,is:"paper-input-error",behaviors:[PaperInputAddonBehavior],properties:{invalid:{readOnly:!0,reflectToAttribute:!0,type:Boolean}},update:function(e){this._setInvalid(e.invalid)}});const PaperInputHelper={NextLabelID:1,NextAddonID:1,NextInputID:1},PaperInputBehaviorImpl={properties:{label:{type:String},value:{notify:!0,type:String},disabled:{type:Boolean,value:!1},invalid:{type:Boolean,value:!1,notify:!0},allowedPattern:{type:String},type:{type:String},list:{type:String},pattern:{type:String},required:{type:Boolean,value:!1},errorMessage:{type:String},charCounter:{type:Boolean,value:!1},noLabelFloat:{type:Boolean,value:!1},alwaysFloatLabel:{type:Boolean,value:!1},autoValidate:{type:Boolean,value:!1},validator:{type:String},autocomplete:{type:String,value:"off"},autofocus:{type:Boolean,observer:"_autofocusChanged"},inputmode:{type:String},minlength:{type:Number},maxlength:{type:Number},min:{type:String},max:{type:String},step:{type:String},name:{type:String},placeholder:{type:String,value:""},readonly:{type:Boolean,value:!1},size:{type:Number},autocapitalize:{type:String,value:"none"},autocorrect:{type:String,value:"off"},autosave:{type:String},results:{type:Number},accept:{type:String},multiple:{type:Boolean},_ariaDescribedBy:{type:String,value:""},_ariaLabelledBy:{type:String,value:""},_inputId:{type:String,value:""}},listeners:{"addon-attached":"_onAddonAttached"},keyBindings:{"shift+tab:keydown":"_onShiftTabDown"},hostAttributes:{tabindex:0},get inputElement(){return this.$||(this.$={}),this.$.input||(this._generateInputId(),this.$.input=this.$$("#"+this._inputId)),this.$.input},get _focusableElement(){return this.inputElement},created:function(){this._typesThatHaveText=["date","datetime","datetime-local","month","time","week","file"]},attached:function(){this._updateAriaLabelledBy(),!PolymerElement&&this.inputElement&&-1!==this._typesThatHaveText.indexOf(this.inputElement.type)&&(this.alwaysFloatLabel=!0)},_appendStringWithSpace:function(e,t){return e=e?e+" "+t:t},_onAddonAttached:function(e){var t=dom(e).rootTarget;if(t.id)this._ariaDescribedBy=this._appendStringWithSpace(this._ariaDescribedBy,t.id);else{var i="paper-input-add-on-"+PaperInputHelper.NextAddonID++;t.id=i,this._ariaDescribedBy=this._appendStringWithSpace(this._ariaDescribedBy,i)}},validate:function(){return this.inputElement.validate()},_focusBlurHandler:function(e){IronControlState._focusBlurHandler.call(this,e),this.focused&&!this._shiftTabPressed&&this._focusableElement&&this._focusableElement.focus()},_onShiftTabDown:function(e){var t=this.getAttribute("tabindex");this._shiftTabPressed=!0,this.setAttribute("tabindex","-1"),this.async(function(){this.setAttribute("tabindex",t),this._shiftTabPressed=!1},1)},_handleAutoValidate:function(){this.autoValidate&&this.validate()},updateValueAndPreserveCaret:function(e){try{var t=this.inputElement.selectionStart;this.value=e,this.inputElement.selectionStart=t,this.inputElement.selectionEnd=t}catch(t){this.value=e}},_computeAlwaysFloatLabel:function(e,t){return t||e},_updateAriaLabelledBy:function(){var e,t=dom(this.root).querySelector("label");t?(t.id?e=t.id:(e="paper-input-label-"+PaperInputHelper.NextLabelID++,t.id=e),this._ariaLabelledBy=e):this._ariaLabelledBy=""},_generateInputId:function(){this._inputId&&""!==this._inputId||(this._inputId="input-"+PaperInputHelper.NextInputID++)},_onChange:function(e){this.shadowRoot&&this.fire(e.type,{sourceEvent:e},{node:this,bubbles:e.bubbles,cancelable:e.cancelable})},_autofocusChanged:function(){if(this.autofocus&&this._focusableElement){var e=document.activeElement;e instanceof HTMLElement&&e!==document.body&&e!==document.documentElement||this._focusableElement.focus()}}},PaperInputBehavior=[IronControlState,IronA11yKeysBehavior,PaperInputBehaviorImpl];var paperInputBehavior={PaperInputHelper:PaperInputHelper,PaperInputBehaviorImpl:PaperInputBehaviorImpl,PaperInputBehavior:PaperInputBehavior};Polymer({is:"paper-input",_template:html`
    <style>
      :host {
        display: block;
      }

      :host([focused]) {
        outline: none;
      }

      :host([hidden]) {
        display: none !important;
      }

      input {
        /* Firefox sets a min-width on the input, which can cause layout issues */
        min-width: 0;
      }

      /* In 1.x, the <input> is distributed to paper-input-container, which styles it.
      In 2.x the <iron-input> is distributed to paper-input-container, which styles
      it, but in order for this to work correctly, we need to reset some
      of the native input's properties to inherit (from the iron-input) */
      iron-input > input {
        @apply --paper-input-container-shared-input-style;
        font-family: inherit;
        font-weight: inherit;
        font-size: inherit;
        letter-spacing: inherit;
        word-spacing: inherit;
        line-height: inherit;
        text-shadow: inherit;
        color: inherit;
        cursor: inherit;
      }

      input:disabled {
        @apply --paper-input-container-input-disabled;
      }

      input::-webkit-outer-spin-button,
      input::-webkit-inner-spin-button {
        @apply --paper-input-container-input-webkit-spinner;
      }

      input::-webkit-clear-button {
        @apply --paper-input-container-input-webkit-clear;
      }

      input::-webkit-calendar-picker-indicator {
        @apply --paper-input-container-input-webkit-calendar-picker-indicator;
      }

      input::-webkit-input-placeholder {
        color: var(--paper-input-container-color, var(--secondary-text-color));
      }

      input:-moz-placeholder {
        color: var(--paper-input-container-color, var(--secondary-text-color));
      }

      input::-moz-placeholder {
        color: var(--paper-input-container-color, var(--secondary-text-color));
      }

      input::-ms-clear {
        @apply --paper-input-container-ms-clear;
      }

      input::-ms-reveal {
        @apply --paper-input-container-ms-reveal;
      }

      input:-ms-input-placeholder {
        color: var(--paper-input-container-color, var(--secondary-text-color));
      }

      label {
        pointer-events: none;
      }
    </style>

    <paper-input-container id="container" no-label-float="[[noLabelFloat]]" always-float-label="[[_computeAlwaysFloatLabel(alwaysFloatLabel,placeholder)]]" auto-validate$="[[autoValidate]]" disabled$="[[disabled]]" invalid="[[invalid]]">

      <slot name="prefix" slot="prefix"></slot>

      <label hidden$="[[!label]]" aria-hidden="true" for$="[[_inputId]]" slot="label">[[label]]</label>

      <!-- Need to bind maxlength so that the paper-input-char-counter works correctly -->
      <iron-input bind-value="{{value}}" slot="input" class="input-element" id$="[[_inputId]]" maxlength$="[[maxlength]]" allowed-pattern="[[allowedPattern]]" invalid="{{invalid}}" validator="[[validator]]">
        <input aria-labelledby$="[[_ariaLabelledBy]]" aria-describedby$="[[_ariaDescribedBy]]" disabled$="[[disabled]]" title$="[[title]]" type$="[[type]]" pattern$="[[pattern]]" required$="[[required]]" autocomplete$="[[autocomplete]]" autofocus$="[[autofocus]]" inputmode$="[[inputmode]]" minlength$="[[minlength]]" maxlength$="[[maxlength]]" min$="[[min]]" max$="[[max]]" step$="[[step]]" name$="[[name]]" placeholder$="[[placeholder]]" readonly$="[[readonly]]" list$="[[list]]" size$="[[size]]" autocapitalize$="[[autocapitalize]]" autocorrect$="[[autocorrect]]" on-change="_onChange" tabindex$="[[tabIndex]]" autosave$="[[autosave]]" results$="[[results]]" accept$="[[accept]]" multiple$="[[multiple]]">
      </iron-input>

      <slot name="suffix" slot="suffix"></slot>

      <template is="dom-if" if="[[errorMessage]]">
        <paper-input-error aria-live="assertive" slot="add-on">[[errorMessage]]</paper-input-error>
      </template>

      <template is="dom-if" if="[[charCounter]]">
        <paper-input-char-counter slot="add-on"></paper-input-char-counter>
      </template>

    </paper-input-container>
  `,behaviors:[PaperInputBehavior,IronFormElementBehavior],properties:{value:{type:String}},get _focusableElement(){return this.inputElement._inputElement},listeners:{"iron-input-ready":"_onIronInputReady"},_onIronInputReady:function(){this.$.nativeInput||(this.$.nativeInput=this.$$("input")),this.inputElement&&-1!==this._typesThatHaveText.indexOf(this.$.nativeInput.type)&&(this.alwaysFloatLabel=!0),this.inputElement.bindValue&&this.$.container._handleValueAndAutoValidate(this.inputElement)}}),Polymer({is:"paper-menu-grow-height-animation",behaviors:[NeonAnimationBehavior],configure:function(e){var t=e.node,i=t.getBoundingClientRect().height;return this._effect=new KeyframeEffect(t,[{height:i/2+"px"},{height:i+"px"}],this.timingFromConfig(e)),this._effect}}),Polymer({is:"paper-menu-grow-width-animation",behaviors:[NeonAnimationBehavior],configure:function(e){var t=e.node,i=t.getBoundingClientRect().width;return this._effect=new KeyframeEffect(t,[{width:i/2+"px"},{width:i+"px"}],this.timingFromConfig(e)),this._effect}}),Polymer({is:"paper-menu-shrink-width-animation",behaviors:[NeonAnimationBehavior],configure:function(e){var t=e.node,i=t.getBoundingClientRect().width;return this._effect=new KeyframeEffect(t,[{width:i+"px"},{width:i-i/20+"px"}],this.timingFromConfig(e)),this._effect}}),Polymer({is:"paper-menu-shrink-height-animation",behaviors:[NeonAnimationBehavior],configure:function(e){var t=e.node,i=t.getBoundingClientRect().height;return this.setPrefixedProperty(t,"transformOrigin","0 0"),this._effect=new KeyframeEffect(t,[{height:i+"px",transform:"translateY(0)"},{height:i/2+"px",transform:"translateY(-20px)"}],this.timingFromConfig(e)),this._effect}});var config$1={ANIMATION_CUBIC_BEZIER:"cubic-bezier(.3,.95,.5,1)",MAX_ANIMATION_TIME_MS:400};const PaperMenuButton=Polymer({_template:html`
    <style>
      :host {
        display: inline-block;
        position: relative;
        padding: 8px;
        outline: none;

        @apply --paper-menu-button;
      }

      :host([disabled]) {
        cursor: auto;
        color: var(--disabled-text-color);

        @apply --paper-menu-button-disabled;
      }

      iron-dropdown {
        @apply --paper-menu-button-dropdown;
      }

      .dropdown-content {
        @apply --shadow-elevation-2dp;

        position: relative;
        border-radius: 2px;
        background-color: var(--paper-menu-button-dropdown-background, var(--primary-background-color));

        @apply --paper-menu-button-content;
      }

      :host([vertical-align="top"]) .dropdown-content {
        margin-bottom: 20px;
        margin-top: -10px;
        top: 10px;
      }

      :host([vertical-align="bottom"]) .dropdown-content {
        bottom: 10px;
        margin-bottom: -10px;
        margin-top: 20px;
      }

      #trigger {
        cursor: pointer;
      }
    </style>

    <div id="trigger" on-tap="toggle">
      <slot name="dropdown-trigger"></slot>
    </div>

    <iron-dropdown id="dropdown" opened="{{opened}}" horizontal-align="[[horizontalAlign]]" vertical-align="[[verticalAlign]]" dynamic-align="[[dynamicAlign]]" horizontal-offset="[[horizontalOffset]]" vertical-offset="[[verticalOffset]]" no-overlap="[[noOverlap]]" open-animation-config="[[openAnimationConfig]]" close-animation-config="[[closeAnimationConfig]]" no-animations="[[noAnimations]]" focus-target="[[_dropdownContent]]" allow-outside-scroll="[[allowOutsideScroll]]" restore-focus-on-close="[[restoreFocusOnClose]]" on-iron-overlay-canceled="__onIronOverlayCanceled">
      <div slot="dropdown-content" class="dropdown-content">
        <slot id="content" name="dropdown-content"></slot>
      </div>
    </iron-dropdown>
`,is:"paper-menu-button",behaviors:[IronA11yKeysBehavior,IronControlState],properties:{opened:{type:Boolean,value:!1,notify:!0,observer:"_openedChanged"},horizontalAlign:{type:String,value:"left",reflectToAttribute:!0},verticalAlign:{type:String,value:"top",reflectToAttribute:!0},dynamicAlign:{type:Boolean},horizontalOffset:{type:Number,value:0,notify:!0},verticalOffset:{type:Number,value:0,notify:!0},noOverlap:{type:Boolean},noAnimations:{type:Boolean,value:!1},ignoreSelect:{type:Boolean,value:!1},closeOnActivate:{type:Boolean,value:!1},openAnimationConfig:{type:Object,value:function(){return[{name:"fade-in-animation",timing:{delay:100,duration:200}},{name:"paper-menu-grow-width-animation",timing:{delay:100,duration:150,easing:config$1.ANIMATION_CUBIC_BEZIER}},{name:"paper-menu-grow-height-animation",timing:{delay:100,duration:275,easing:config$1.ANIMATION_CUBIC_BEZIER}}]}},closeAnimationConfig:{type:Object,value:function(){return[{name:"fade-out-animation",timing:{duration:150}},{name:"paper-menu-shrink-width-animation",timing:{delay:100,duration:50,easing:config$1.ANIMATION_CUBIC_BEZIER}},{name:"paper-menu-shrink-height-animation",timing:{duration:200,easing:"ease-in"}}]}},allowOutsideScroll:{type:Boolean,value:!1},restoreFocusOnClose:{type:Boolean,value:!0},_dropdownContent:{type:Object}},hostAttributes:{role:"group","aria-haspopup":"true"},listeners:{"iron-activate":"_onIronActivate","iron-select":"_onIronSelect"},get contentElement(){for(var e=dom(this.$.content).getDistributedNodes(),t=0,i=e.length;t<i;t++)if(e[t].nodeType===Node.ELEMENT_NODE)return e[t]},toggle:function(){this.opened?this.close():this.open()},open:function(){this.disabled||this.$.dropdown.open()},close:function(){this.$.dropdown.close()},_onIronSelect:function(e){this.ignoreSelect||this.close()},_onIronActivate:function(e){this.closeOnActivate&&this.close()},_openedChanged:function(e,t){e?(this._dropdownContent=this.contentElement,this.fire("paper-dropdown-open")):null!=t&&this.fire("paper-dropdown-close")},_disabledChanged:function(e){IronControlState._disabledChanged.apply(this,arguments),e&&this.opened&&this.close()},__onIronOverlayCanceled:function(e){var t=e.detail,i=this.$.trigger;-1<dom(t).path.indexOf(i)&&e.preventDefault()}});Object.keys(config$1).forEach(function(e){PaperMenuButton[e]=config$1[e]});var paperMenuButton={PaperMenuButton:PaperMenuButton};Polymer({_template:html`
    <style include="paper-dropdown-menu-shared-styles"></style>

    <!-- this div fulfills an a11y requirement for combobox, do not remove -->
    <span role="button"></span>
    <paper-menu-button id="menuButton" vertical-align="[[verticalAlign]]" horizontal-align="[[horizontalAlign]]" dynamic-align="[[dynamicAlign]]" vertical-offset="[[_computeMenuVerticalOffset(noLabelFloat, verticalOffset)]]" disabled="[[disabled]]" no-animations="[[noAnimations]]" on-iron-select="_onIronSelect" on-iron-deselect="_onIronDeselect" opened="{{opened}}" close-on-activate allow-outside-scroll="[[allowOutsideScroll]]" restore-focus-on-close="[[restoreFocusOnClose]]">
      <!-- support hybrid mode: user might be using paper-menu-button 1.x which distributes via <content> -->
      <div class="dropdown-trigger" slot="dropdown-trigger">
        <paper-ripple></paper-ripple>
        <!-- paper-input has type="text" for a11y, do not remove -->
        <paper-input type="text" invalid="[[invalid]]" readonly disabled="[[disabled]]" value="[[value]]" placeholder="[[placeholder]]" error-message="[[errorMessage]]" always-float-label="[[alwaysFloatLabel]]" no-label-float="[[noLabelFloat]]" label="[[label]]">
          <!-- support hybrid mode: user might be using paper-input 1.x which distributes via <content> -->
          <iron-icon icon="paper-dropdown-menu:arrow-drop-down" suffix slot="suffix"></iron-icon>
        </paper-input>
      </div>
      <slot id="content" name="dropdown-content" slot="dropdown-content"></slot>
    </paper-menu-button>
`,is:"paper-dropdown-menu",behaviors:[IronButtonState,IronControlState,IronFormElementBehavior,IronValidatableBehavior],properties:{selectedItemLabel:{type:String,notify:!0,readOnly:!0},selectedItem:{type:Object,notify:!0,readOnly:!0},value:{type:String,notify:!0},label:{type:String},placeholder:{type:String},errorMessage:{type:String},opened:{type:Boolean,notify:!0,value:!1,observer:"_openedChanged"},allowOutsideScroll:{type:Boolean,value:!1},noLabelFloat:{type:Boolean,value:!1,reflectToAttribute:!0},alwaysFloatLabel:{type:Boolean,value:!1},noAnimations:{type:Boolean,value:!1},horizontalAlign:{type:String,value:"right"},verticalAlign:{type:String,value:"top"},verticalOffset:Number,dynamicAlign:{type:Boolean},restoreFocusOnClose:{type:Boolean,value:!0}},listeners:{tap:"_onTap"},keyBindings:{"up down":"open",esc:"close"},hostAttributes:{role:"combobox","aria-autocomplete":"none","aria-haspopup":"true"},observers:["_selectedItemChanged(selectedItem)"],attached:function(){var e=this.contentElement;e&&e.selectedItem&&this._setSelectedItem(e.selectedItem)},get contentElement(){for(var e=dom(this.$.content).getDistributedNodes(),t=0,i=e.length;t<i;t++)if(e[t].nodeType===Node.ELEMENT_NODE)return e[t]},open:function(){this.$.menuButton.open()},close:function(){this.$.menuButton.close()},_onIronSelect:function(e){this._setSelectedItem(e.detail.item)},_onIronDeselect:function(e){this._setSelectedItem(null)},_onTap:function(e){findOriginalTarget(e)===this&&this.open()},_selectedItemChanged:function(e){var t="";t=e?e.label||e.getAttribute("label")||e.textContent.trim():"",this.value=t,this._setSelectedItemLabel(t)},_computeMenuVerticalOffset:function(e,t){return t||(e?-4:8)},_getValidity:function(e){return this.disabled||!this.required||this.required&&!!this.value},_openedChanged:function(){var e=this.opened?"true":"false",t=this.contentElement;t&&t.setAttribute("aria-expanded",e)}});const template$8=html`
  <style include="paper-material-styles">
    :host {
      @apply --layout-vertical;
      @apply --layout-center-center;

      background: var(--paper-fab-background, var(--accent-color));
      border-radius: 50%;
      box-sizing: border-box;
      color: var(--text-primary-color);
      cursor: pointer;
      height: 56px;
      min-width: 0;
      outline: none;
      padding: 16px;
      position: relative;
      -moz-user-select: none;
      -ms-user-select: none;
      -webkit-user-select: none;
      user-select: none;
      width: 56px;
      z-index: 0;

      /* NOTE: Both values are needed, since some phones require the value \`transparent\`. */
      -webkit-tap-highlight-color: rgba(0,0,0,0);
      -webkit-tap-highlight-color: transparent;

      @apply --paper-fab;
    }

    [hidden] {
      display: none !important;
    }

    :host([mini]) {
      width: 40px;
      height: 40px;
      padding: 8px;

      @apply --paper-fab-mini;
    }

    :host([disabled]) {
      color: var(--paper-fab-disabled-text, var(--paper-grey-500));
      background: var(--paper-fab-disabled-background, var(--paper-grey-300));

      @apply --paper-fab-disabled;
    }

    iron-icon {
      @apply --paper-fab-iron-icon;
    }

    span {
      width: 100%;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      text-align: center;

      @apply --paper-fab-label;
    }

    :host(.keyboard-focus) {
      background: var(--paper-fab-keyboard-focus-background, var(--paper-pink-900));
    }

    :host([elevation="1"]) {
      @apply --paper-material-elevation-1;
    }

    :host([elevation="2"]) {
      @apply --paper-material-elevation-2;
    }

    :host([elevation="3"]) {
      @apply --paper-material-elevation-3;
    }

    :host([elevation="4"]) {
      @apply --paper-material-elevation-4;
    }

    :host([elevation="5"]) {
      @apply --paper-material-elevation-5;
    }
  </style>

  <iron-icon id="icon" hidden\$="{{!_computeIsIconFab(icon, src)}}" src="[[src]]" icon="[[icon]]"></iron-icon>
  <span hidden\$="{{_computeIsIconFab(icon, src)}}">{{label}}</span>
`;template$8.setAttribute("strip-whitespace",""),Polymer({_template:template$8,is:"paper-fab",behaviors:[PaperButtonBehavior],properties:{src:{type:String,value:""},icon:{type:String,value:""},mini:{type:Boolean,value:!1,reflectToAttribute:!0},label:{type:String,observer:"_labelChanged"}},_labelChanged:function(){this.setAttribute("aria-label",this.label)},_computeIsIconFab:function(e,t){return 0<e.length||0<t.length}}),Polymer({is:"paper-icon-button",_template:html`
    <style>
      :host {
        display: inline-block;
        position: relative;
        padding: 8px;
        outline: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        cursor: pointer;
        z-index: 0;
        line-height: 1;

        width: 40px;
        height: 40px;

        /*
          NOTE: Both values are needed, since some phones require the value to
          be \`transparent\`.
        */
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        -webkit-tap-highlight-color: transparent;

        /* Because of polymer/2558, this style has lower specificity than * */
        box-sizing: border-box !important;

        @apply --paper-icon-button;
      }

      :host #ink {
        color: var(--paper-icon-button-ink-color, var(--primary-text-color));
        opacity: 0.6;
      }

      :host([disabled]) {
        color: var(--paper-icon-button-disabled-text, var(--disabled-text-color));
        pointer-events: none;
        cursor: auto;

        @apply --paper-icon-button-disabled;
      }

      :host([hidden]) {
        display: none !important;
      }

      :host(:hover) {
        @apply --paper-icon-button-hover;
      }

      iron-icon {
        --iron-icon-width: 100%;
        --iron-icon-height: 100%;
      }
    </style>

    <iron-icon id="icon" src="[[src]]" icon="[[icon]]"
               alt$="[[alt]]"></iron-icon>
  `,hostAttributes:{role:"button",tabindex:"0"},behaviors:[PaperInkyFocusBehavior],registered:function(){this._template.setAttribute("strip-whitespace","")},properties:{src:{type:String},icon:{type:String},alt:{type:String,observer:"_altChanged"}},_altChanged:function(e,t){var i=this.getAttribute("aria-label");i&&t!=i||this.setAttribute("aria-label",e)}}),Polymer({_template:html`
    <style>
      :host {
        display: block;
      }

      :host([hidden]) {
        display: none !important;
      }

      label {
        pointer-events: none;
      }
    </style>

    <paper-input-container no-label-float$="[[noLabelFloat]]" always-float-label="[[_computeAlwaysFloatLabel(alwaysFloatLabel,placeholder)]]" auto-validate$="[[autoValidate]]" disabled$="[[disabled]]" invalid="[[invalid]]">

      <label hidden$="[[!label]]" aria-hidden="true" for$="[[_inputId]]" slot="label">[[label]]</label>

      <iron-autogrow-textarea class="paper-input-input" slot="input" id$="[[_inputId]]" aria-labelledby$="[[_ariaLabelledBy]]" aria-describedby$="[[_ariaDescribedBy]]" bind-value="{{value}}" invalid="{{invalid}}" validator$="[[validator]]" disabled$="[[disabled]]" autocomplete$="[[autocomplete]]" autofocus$="[[autofocus]]" inputmode$="[[inputmode]]" name$="[[name]]" placeholder$="[[placeholder]]" readonly$="[[readonly]]" required$="[[required]]" minlength$="[[minlength]]" maxlength$="[[maxlength]]" autocapitalize$="[[autocapitalize]]" rows$="[[rows]]" max-rows$="[[maxRows]]" on-change="_onChange"></iron-autogrow-textarea>

      <template is="dom-if" if="[[errorMessage]]">
        <paper-input-error aria-live="assertive" slot="add-on">[[errorMessage]]</paper-input-error>
      </template>

      <template is="dom-if" if="[[charCounter]]">
        <paper-input-char-counter slot="add-on"></paper-input-char-counter>
      </template>

    </paper-input-container>
`,is:"paper-textarea",behaviors:[PaperInputBehavior,IronFormElementBehavior],properties:{_ariaLabelledBy:{observer:"_ariaLabelledByChanged",type:String},_ariaDescribedBy:{observer:"_ariaDescribedByChanged",type:String},value:{type:String},rows:{type:Number,value:1},maxRows:{type:Number,value:0}},get selectionStart(){return this.$.input.textarea.selectionStart},set selectionStart(e){this.$.input.textarea.selectionStart=e},get selectionEnd(){return this.$.input.textarea.selectionEnd},set selectionEnd(e){this.$.input.textarea.selectionEnd=e},_ariaLabelledByChanged:function(e){this._focusableElement.setAttribute("aria-labelledby",e)},_ariaDescribedByChanged:function(e){this._focusableElement.setAttribute("aria-describedby",e)},get _focusableElement(){return this.inputElement.textarea}});const $_documentContainer$3=document.createElement("template");$_documentContainer$3.setAttribute("style","display: none;"),$_documentContainer$3.innerHTML="<dom-module id=\"paper-item-shared-styles\">\n  <template>\n    <style>\n      :host, .paper-item {\n        display: block;\n        position: relative;\n        min-height: var(--paper-item-min-height, 48px);\n        padding: 0px 16px;\n      }\n\n      .paper-item {\n        @apply --paper-font-subhead;\n        border:none;\n        outline: none;\n        background: white;\n        width: 100%;\n        text-align: left;\n      }\n\n      :host([hidden]), .paper-item[hidden] {\n        display: none !important;\n      }\n\n      :host(.iron-selected), .paper-item.iron-selected {\n        font-weight: var(--paper-item-selected-weight, bold);\n\n        @apply --paper-item-selected;\n      }\n\n      :host([disabled]), .paper-item[disabled] {\n        color: var(--paper-item-disabled-color, var(--disabled-text-color));\n\n        @apply --paper-item-disabled;\n      }\n\n      :host(:focus), .paper-item:focus {\n        position: relative;\n        outline: 0;\n\n        @apply --paper-item-focused;\n      }\n\n      :host(:focus):before, .paper-item:focus:before {\n        @apply --layout-fit;\n\n        background: currentColor;\n        content: '';\n        opacity: var(--dark-divider-opacity);\n        pointer-events: none;\n\n        @apply --paper-item-focused-before;\n      }\n    </style>\n  </template>\n</dom-module>",document.head.appendChild($_documentContainer$3.content);const PaperItemBehaviorImpl={hostAttributes:{role:"option",tabindex:"0"}},PaperItemBehavior=[IronButtonState,IronControlState,PaperItemBehaviorImpl];var paperItemBehavior={PaperItemBehaviorImpl:PaperItemBehaviorImpl,PaperItemBehavior:PaperItemBehavior};Polymer({_template:html`
    <style include="paper-item-shared-styles">
      :host {
        @apply --layout-horizontal;
        @apply --layout-center;
        @apply --paper-font-subhead;

        @apply --paper-item;
      }
    </style>
    <slot></slot>
`,is:"paper-item",behaviors:[PaperItemBehavior]}),Polymer({_template:html`
    <style>
      :host {
        overflow: hidden; /* needed for text-overflow: ellipsis to work on ff */
        @apply --layout-vertical;
        @apply --layout-center-justified;
        @apply --layout-flex;
      }

      :host([two-line]) {
        min-height: var(--paper-item-body-two-line-min-height, 72px);
      }

      :host([three-line]) {
        min-height: var(--paper-item-body-three-line-min-height, 88px);
      }

      :host > ::slotted(*) {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      :host > ::slotted([secondary]) {
        @apply --paper-font-body1;

        color: var(--paper-item-body-secondary-color, var(--secondary-text-color));

        @apply --paper-item-body-secondary;
      }
    </style>

    <slot></slot>
`,is:"paper-item-body"}),Polymer({_template:html`
    <style include="paper-item-shared-styles"></style>
    <style>
      :host {
        @apply --layout-horizontal;
        @apply --layout-center;
        @apply --paper-font-subhead;

        @apply --paper-item;
        @apply --paper-icon-item;
      }

      .content-icon {
        @apply --layout-horizontal;
        @apply --layout-center;

        width: var(--paper-item-icon-width, 56px);
        @apply --paper-item-icon;
      }
    </style>

    <div id="contentIcon" class="content-icon">
      <slot name="item-icon"></slot>
    </div>
    <slot></slot>
`,is:"paper-icon-item",behaviors:[PaperItemBehavior]}),Polymer({_template:html`
    <style>
      :host {
        display: block;
        padding: 8px 0;

        background: var(--paper-listbox-background-color, var(--primary-background-color));
        color: var(--paper-listbox-color, var(--primary-text-color));

        @apply --paper-listbox;
      }
    </style>

    <slot></slot>
`,is:"paper-listbox",behaviors:[IronMenuBehavior],hostAttributes:{role:"listbox"}});const template$9=html`
<dom-module id="paper-material-shared-styles">
  <template>
    <style>
      :host {
        display: block;
        position: relative;
      }

      :host([elevation="1"]) {
        @apply --shadow-elevation-2dp;
      }

      :host([elevation="2"]) {
        @apply --shadow-elevation-4dp;
      }

      :host([elevation="3"]) {
        @apply --shadow-elevation-6dp;
      }

      :host([elevation="4"]) {
        @apply --shadow-elevation-8dp;
      }

      :host([elevation="5"]) {
        @apply --shadow-elevation-16dp;
      }
    </style>
  </template>
</dom-module>
`;template$9.setAttribute("style","display: none;"),document.body.appendChild(template$9.content),Polymer({_template:html`
    <style include="paper-material-shared-styles"></style>
    <style>
      :host([animated]) {
        @apply --shadow-transition;
      }
      :host {
        @apply --paper-material;
      }
    </style>

    <slot></slot>
`,is:"paper-material",properties:{elevation:{type:Number,reflectToAttribute:!0,value:1},animated:{type:Boolean,reflectToAttribute:!0,value:!1}}}),Polymer({_template:html`
    <style>
      :host {
        display: block;
        width: 200px;
        position: relative;
        overflow: hidden;
      }

      :host([hidden]), [hidden] {
        display: none !important;
      }

      #progressContainer {
        @apply --paper-progress-container;
        position: relative;
      }

      #progressContainer,
      /* the stripe for the indeterminate animation*/
      .indeterminate::after {
        height: var(--paper-progress-height, 4px);
      }

      #primaryProgress,
      #secondaryProgress,
      .indeterminate::after {
        @apply --layout-fit;
      }

      #progressContainer,
      .indeterminate::after {
        background: var(--paper-progress-container-color, var(--google-grey-300));
      }

      :host(.transiting) #primaryProgress,
      :host(.transiting) #secondaryProgress {
        -webkit-transition-property: -webkit-transform;
        transition-property: transform;

        /* Duration */
        -webkit-transition-duration: var(--paper-progress-transition-duration, 0.08s);
        transition-duration: var(--paper-progress-transition-duration, 0.08s);

        /* Timing function */
        -webkit-transition-timing-function: var(--paper-progress-transition-timing-function, ease);
        transition-timing-function: var(--paper-progress-transition-timing-function, ease);

        /* Delay */
        -webkit-transition-delay: var(--paper-progress-transition-delay, 0s);
        transition-delay: var(--paper-progress-transition-delay, 0s);
      }

      #primaryProgress,
      #secondaryProgress {
        @apply --layout-fit;
        -webkit-transform-origin: left center;
        transform-origin: left center;
        -webkit-transform: scaleX(0);
        transform: scaleX(0);
        will-change: transform;
      }

      #primaryProgress {
        background: var(--paper-progress-active-color, var(--google-green-500));
      }

      #secondaryProgress {
        background: var(--paper-progress-secondary-color, var(--google-green-100));
      }

      :host([disabled]) #primaryProgress {
        background: var(--paper-progress-disabled-active-color, var(--google-grey-500));
      }

      :host([disabled]) #secondaryProgress {
        background: var(--paper-progress-disabled-secondary-color, var(--google-grey-300));
      }

      :host(:not([disabled])) #primaryProgress.indeterminate {
        -webkit-transform-origin: right center;
        transform-origin: right center;
        -webkit-animation: indeterminate-bar var(--paper-progress-indeterminate-cycle-duration, 2s) linear infinite;
        animation: indeterminate-bar var(--paper-progress-indeterminate-cycle-duration, 2s) linear infinite;
      }

      :host(:not([disabled])) #primaryProgress.indeterminate::after {
        content: "";
        -webkit-transform-origin: center center;
        transform-origin: center center;

        -webkit-animation: indeterminate-splitter var(--paper-progress-indeterminate-cycle-duration, 2s) linear infinite;
        animation: indeterminate-splitter var(--paper-progress-indeterminate-cycle-duration, 2s) linear infinite;
      }

      @-webkit-keyframes indeterminate-bar {
        0% {
          -webkit-transform: scaleX(1) translateX(-100%);
        }
        50% {
          -webkit-transform: scaleX(1) translateX(0%);
        }
        75% {
          -webkit-transform: scaleX(1) translateX(0%);
          -webkit-animation-timing-function: cubic-bezier(.28,.62,.37,.91);
        }
        100% {
          -webkit-transform: scaleX(0) translateX(0%);
        }
      }

      @-webkit-keyframes indeterminate-splitter {
        0% {
          -webkit-transform: scaleX(.75) translateX(-125%);
        }
        30% {
          -webkit-transform: scaleX(.75) translateX(-125%);
          -webkit-animation-timing-function: cubic-bezier(.42,0,.6,.8);
        }
        90% {
          -webkit-transform: scaleX(.75) translateX(125%);
        }
        100% {
          -webkit-transform: scaleX(.75) translateX(125%);
        }
      }

      @keyframes indeterminate-bar {
        0% {
          transform: scaleX(1) translateX(-100%);
        }
        50% {
          transform: scaleX(1) translateX(0%);
        }
        75% {
          transform: scaleX(1) translateX(0%);
          animation-timing-function: cubic-bezier(.28,.62,.37,.91);
        }
        100% {
          transform: scaleX(0) translateX(0%);
        }
      }

      @keyframes indeterminate-splitter {
        0% {
          transform: scaleX(.75) translateX(-125%);
        }
        30% {
          transform: scaleX(.75) translateX(-125%);
          animation-timing-function: cubic-bezier(.42,0,.6,.8);
        }
        90% {
          transform: scaleX(.75) translateX(125%);
        }
        100% {
          transform: scaleX(.75) translateX(125%);
        }
      }
    </style>

    <div id="progressContainer">
      <div id="secondaryProgress" hidden\$="[[_hideSecondaryProgress(secondaryRatio)]]"></div>
      <div id="primaryProgress"></div>
    </div>
`,is:"paper-progress",behaviors:[IronRangeBehavior],properties:{secondaryProgress:{type:Number,value:0},secondaryRatio:{type:Number,value:0,readOnly:!0},indeterminate:{type:Boolean,value:!1,observer:"_toggleIndeterminate"},disabled:{type:Boolean,value:!1,reflectToAttribute:!0,observer:"_disabledChanged"}},observers:["_progressChanged(secondaryProgress, value, min, max, indeterminate)"],hostAttributes:{role:"progressbar"},_toggleIndeterminate:function(e){this.toggleClass("indeterminate",e,this.$.primaryProgress)},_transformProgress:function(e,t){var i="scaleX("+t/100+")";e.style.transform=e.style.webkitTransform=i},_mainRatioChanged:function(e){this._transformProgress(this.$.primaryProgress,e)},_progressChanged:function(e,t,i,r,n){e=this._clampValue(e),t=this._clampValue(t);var a=100*this._calcRatio(e),o=100*this._calcRatio(t);this._setSecondaryRatio(a),this._transformProgress(this.$.secondaryProgress,a),this._transformProgress(this.$.primaryProgress,o),this.secondaryProgress=e,n?this.removeAttribute("aria-valuenow"):this.setAttribute("aria-valuenow",t),this.setAttribute("aria-valuemin",i),this.setAttribute("aria-valuemax",r)},_disabledChanged:function(e){this.setAttribute("aria-disabled",e?"true":"false")},_hideSecondaryProgress:function(e){return 0===e}});const template$a=html`
  <style>
    :host {
      @apply --layout;
      @apply --layout-justified;
      @apply --layout-center;
      width: 200px;
      cursor: default;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
      --paper-progress-active-color: var(--paper-slider-active-color, var(--google-blue-700));
      --paper-progress-secondary-color: var(--paper-slider-secondary-color, var(--google-blue-300));
      --paper-progress-disabled-active-color: var(--paper-slider-disabled-active-color, var(--paper-grey-400));
      --paper-progress-disabled-secondary-color: var(--paper-slider-disabled-secondary-color, var(--paper-grey-400));
      --calculated-paper-slider-height: var(--paper-slider-height, 2px);
    }

    /* focus shows the ripple */
    :host(:focus) {
      outline: none;
    }

    /**
      * NOTE(keanulee): Though :host-context is not universally supported, some pages
      * still rely on paper-slider being flipped when dir="rtl" is set on body. For full
      * compatibility, dir="rtl" must be explicitly set on paper-slider.
      */
    :dir(rtl) #sliderContainer {
      -webkit-transform: scaleX(-1);
      transform: scaleX(-1);
    }

    /**
      * NOTE(keanulee): This is separate from the rule above because :host-context may
      * not be recognized.
      */
    :host([dir="rtl"]) #sliderContainer {
      -webkit-transform: scaleX(-1);
      transform: scaleX(-1);
    }

    /**
      * NOTE(keanulee): Needed to override the :host-context rule (where supported)
      * to support LTR sliders in RTL pages.
      */
    :host([dir="ltr"]) #sliderContainer {
      -webkit-transform: scaleX(1);
      transform: scaleX(1);
    }

    #sliderContainer {
      position: relative;
      width: 100%;
      height: calc(30px + var(--calculated-paper-slider-height));
      margin-left: calc(15px + var(--calculated-paper-slider-height)/2);
      margin-right: calc(15px + var(--calculated-paper-slider-height)/2);
    }

    #sliderContainer:focus {
      outline: 0;
    }

    #sliderContainer.editable {
      margin-top: 12px;
      margin-bottom: 12px;
    }

    .bar-container {
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      overflow: hidden;
    }

    .ring > .bar-container {
      left: calc(5px + var(--calculated-paper-slider-height)/2);
      transition: left 0.18s ease;
    }

    .ring.expand.dragging > .bar-container {
      transition: none;
    }

    .ring.expand:not(.pin) > .bar-container {
      left: calc(8px + var(--calculated-paper-slider-height)/2);
    }

    #sliderBar {
      padding: 15px 0;
      width: 100%;
      background-color: var(--paper-slider-bar-color, transparent);
      --paper-progress-container-color: var(--paper-slider-container-color, var(--paper-grey-400));
      --paper-progress-height: var(--calculated-paper-slider-height);
    }

    .slider-markers {
      position: absolute;
      /* slider-knob is 30px + the slider-height so that the markers should start at a offset of 15px*/
      top: 15px;
      height: var(--calculated-paper-slider-height);
      left: 0;
      right: -1px;
      box-sizing: border-box;
      pointer-events: none;
      @apply --layout-horizontal;
    }

    .slider-marker {
      @apply --layout-flex;
    }
    .slider-markers::after,
    .slider-marker::after {
      content: "";
      display: block;
      margin-left: -1px;
      width: 2px;
      height: var(--calculated-paper-slider-height);
      border-radius: 50%;
      background-color: var(--paper-slider-markers-color, #000);
    }

    .slider-knob {
      position: absolute;
      left: 0;
      top: 0;
      margin-left: calc(-15px - var(--calculated-paper-slider-height)/2);
      width: calc(30px + var(--calculated-paper-slider-height));
      height: calc(30px + var(--calculated-paper-slider-height));
    }

    .transiting > .slider-knob {
      transition: left 0.08s ease;
    }

    .slider-knob:focus {
      outline: none;
    }

    .slider-knob.dragging {
      transition: none;
    }

    .snaps > .slider-knob.dragging {
      transition: -webkit-transform 0.08s ease;
      transition: transform 0.08s ease;
    }

    .slider-knob-inner {
      margin: 10px;
      width: calc(100% - 20px);
      height: calc(100% - 20px);
      background-color: var(--paper-slider-knob-color, var(--google-blue-700));
      border: 2px solid var(--paper-slider-knob-color, var(--google-blue-700));
      border-radius: 50%;

      -moz-box-sizing: border-box;
      box-sizing: border-box;

      transition-property: -webkit-transform, background-color, border;
      transition-property: transform, background-color, border;
      transition-duration: 0.18s;
      transition-timing-function: ease;
    }

    .expand:not(.pin) > .slider-knob > .slider-knob-inner {
      -webkit-transform: scale(1.5);
      transform: scale(1.5);
    }

    .ring > .slider-knob > .slider-knob-inner {
      background-color: var(--paper-slider-knob-start-color, transparent);
      border: 2px solid var(--paper-slider-knob-start-border-color, var(--paper-grey-400));
    }

    .slider-knob-inner::before {
      background-color: var(--paper-slider-pin-color, var(--google-blue-700));
    }

    .pin > .slider-knob > .slider-knob-inner::before {
      content: "";
      position: absolute;
      top: 0;
      left: 50%;
      margin-left: -13px;
      width: 26px;
      height: 26px;
      border-radius: 50% 50% 50% 0;

      -webkit-transform: rotate(-45deg) scale(0) translate(0);
      transform: rotate(-45deg) scale(0) translate(0);
    }

    .slider-knob-inner::before,
    .slider-knob-inner::after {
      transition: -webkit-transform .18s ease, background-color .18s ease;
      transition: transform .18s ease, background-color .18s ease;
    }

    .pin.ring > .slider-knob > .slider-knob-inner::before {
      background-color: var(--paper-slider-pin-start-color, var(--paper-grey-400));
    }

    .pin.expand > .slider-knob > .slider-knob-inner::before {
      -webkit-transform: rotate(-45deg) scale(1) translate(17px, -17px);
      transform: rotate(-45deg) scale(1) translate(17px, -17px);
    }

    .pin > .slider-knob > .slider-knob-inner::after {
      content: attr(value);
      position: absolute;
      top: 0;
      left: 50%;
      margin-left: -16px;
      width: 32px;
      height: 26px;
      text-align: center;
      color: var(--paper-slider-font-color, #fff);
      font-size: 10px;

      -webkit-transform: scale(0) translate(0);
      transform: scale(0) translate(0);
    }

    .pin.expand > .slider-knob > .slider-knob-inner::after {
      -webkit-transform: scale(1) translate(0, -17px);
      transform: scale(1) translate(0, -17px);
    }

    /* paper-input */
    .slider-input {
      width: 50px;
      overflow: hidden;
      --paper-input-container-input: {
        text-align: center;
        @apply --paper-slider-input-container-input;
      };
      @apply --paper-slider-input;
    }

    /* disabled state */
    #sliderContainer.disabled {
      pointer-events: none;
    }

    .disabled > .slider-knob > .slider-knob-inner {
      background-color: var(--paper-slider-disabled-knob-color, var(--paper-grey-400));
      border: 2px solid var(--paper-slider-disabled-knob-color, var(--paper-grey-400));
      -webkit-transform: scale3d(0.75, 0.75, 1);
      transform: scale3d(0.75, 0.75, 1);
    }

    .disabled.ring > .slider-knob > .slider-knob-inner {
      background-color: var(--paper-slider-knob-start-color, transparent);
      border: 2px solid var(--paper-slider-knob-start-border-color, var(--paper-grey-400));
    }

    paper-ripple {
      color: var(--paper-slider-knob-color, var(--google-blue-700));
    }
  </style>

  <div id="sliderContainer" class\$="[[_getClassNames(disabled, pin, snaps, immediateValue, min, expand, dragging, transiting, editable)]]">
    <div class="bar-container">
      <paper-progress disabled\$="[[disabled]]" id="sliderBar" aria-hidden="true" min="[[min]]" max="[[max]]" step="[[step]]" value="[[immediateValue]]" secondary-progress="[[secondaryProgress]]" on-down="_bardown" on-up="_resetKnob" on-track="_bartrack" on-tap="_barclick">
      </paper-progress>
    </div>

    <template is="dom-if" if="[[snaps]]">
      <div class="slider-markers">
        <template is="dom-repeat" items="[[markers]]">
          <div class="slider-marker"></div>
        </template>
      </div>
    </template>

    <div id="sliderKnob" class="slider-knob" on-down="_knobdown" on-up="_resetKnob" on-track="_onTrack" on-transitionend="_knobTransitionEnd">
        <div class="slider-knob-inner" value\$="[[immediateValue]]"></div>
    </div>
  </div>

  <template is="dom-if" if="[[editable]]">
    <paper-input id="input" type="number" step="[[step]]" min="[[min]]" max="[[max]]" class="slider-input" disabled\$="[[disabled]]" value="[[immediateValue]]" on-change="_changeValue" on-keydown="_inputKeyDown" no-label-float>
    </paper-input>
  </template>
`;template$a.setAttribute("strip-whitespace",""),Polymer({_template:template$a,is:"paper-slider",behaviors:[IronA11yKeysBehavior,IronFormElementBehavior,PaperInkyFocusBehavior,IronRangeBehavior],properties:{value:{type:Number,value:0},snaps:{type:Boolean,value:!1,notify:!0},pin:{type:Boolean,value:!1,notify:!0},secondaryProgress:{type:Number,value:0,notify:!0,observer:"_secondaryProgressChanged"},editable:{type:Boolean,value:!1},immediateValue:{type:Number,value:0,readOnly:!0,notify:!0},maxMarkers:{type:Number,value:0,notify:!0},expand:{type:Boolean,value:!1,readOnly:!0},ignoreBarTouch:{type:Boolean,value:!1},dragging:{type:Boolean,value:!1,readOnly:!0,notify:!0},transiting:{type:Boolean,value:!1,readOnly:!0},markers:{type:Array,readOnly:!0,value:function(){return[]}}},observers:["_updateKnob(value, min, max, snaps, step)","_valueChanged(value)","_immediateValueChanged(immediateValue)","_updateMarkers(maxMarkers, min, max, snaps)"],hostAttributes:{role:"slider",tabindex:0},keyBindings:{left:"_leftKey",right:"_rightKey","down pagedown home":"_decrementKey","up pageup end":"_incrementKey"},ready:function(){this.ignoreBarTouch&&setTouchAction(this.$.sliderBar,"auto")},increment:function(){this.value=this._clampValue(this.value+this.step)},decrement:function(){this.value=this._clampValue(this.value-this.step)},_updateKnob:function(e,t,i,r,n){this.setAttribute("aria-valuemin",t),this.setAttribute("aria-valuemax",i),this.setAttribute("aria-valuenow",e),this._positionKnob(100*this._calcRatio(e))},_valueChanged:function(){this.fire("value-change",{composed:!0})},_immediateValueChanged:function(){this.dragging?this.fire("immediate-value-change",{composed:!0}):this.value=this.immediateValue},_secondaryProgressChanged:function(){this.secondaryProgress=this._clampValue(this.secondaryProgress)},_expandKnob:function(){this._setExpand(!0)},_resetKnob:function(){this.cancelDebouncer("expandKnob"),this._setExpand(!1)},_positionKnob:function(e){this._setImmediateValue(this._calcStep(this._calcKnobPosition(e))),this._setRatio(100*this._calcRatio(this.immediateValue)),this.$.sliderKnob.style.left=this.ratio+"%",this.dragging&&(this._knobstartx=this.ratio*this._w/100,this.translate3d(0,0,0,this.$.sliderKnob))},_calcKnobPosition:function(e){return(this.max-this.min)*e/100+this.min},_onTrack:function(e){switch(e.stopPropagation(),e.detail.state){case"start":this._trackStart(e);break;case"track":this._trackX(e);break;case"end":this._trackEnd()}},_trackStart:function(e){this._setTransiting(!1),this._w=this.$.sliderBar.offsetWidth,this._x=this.ratio*this._w/100,this._startx=this._x,this._knobstartx=this._startx,this._minx=-this._startx,this._maxx=this._w-this._startx,this.$.sliderKnob.classList.add("dragging"),this._setDragging(!0)},_trackX:function(e){this.dragging||this._trackStart(e);var t=this._isRTL?-1:1,i=Math.min(this._maxx,Math.max(this._minx,e.detail.dx*t));this._x=this._startx+i;var r=this._calcStep(this._calcKnobPosition(this._x/this._w*100));this._setImmediateValue(r);var n=this._calcRatio(this.immediateValue)*this._w-this._knobstartx;this.translate3d(n+"px",0,0,this.$.sliderKnob)},_trackEnd:function(){var e=this.$.sliderKnob.style;this.$.sliderKnob.classList.remove("dragging"),this._setDragging(!1),this._resetKnob(),this.value=this.immediateValue,e.transform=e.webkitTransform="",this.fire("change",{composed:!0})},_knobdown:function(e){this._expandKnob(),e.preventDefault(),this.focus()},_bartrack:function(e){this._allowBarEvent(e)&&this._onTrack(e)},_barclick:function(e){this._w=this.$.sliderBar.offsetWidth;var t=this.$.sliderBar.getBoundingClientRect(),i=(e.detail.x-t.left)/this._w*100;this._isRTL&&(i=100-i);var r=this.ratio;this._setTransiting(!0),this._positionKnob(i),r===this.ratio&&this._setTransiting(!1),this.async(function(){this.fire("change",{composed:!0})}),e.preventDefault(),this.focus()},_bardown:function(e){this._allowBarEvent(e)&&(this.debounce("expandKnob",this._expandKnob,60),this._barclick(e))},_knobTransitionEnd:function(e){e.target===this.$.sliderKnob&&this._setTransiting(!1)},_updateMarkers:function(e,t,i,r){r||this._setMarkers([]);var n=Math.round((i-t)/this.step);n>e&&(n=e),(0>n||!isFinite(n))&&(n=0),this._setMarkers(Array(n))},_mergeClasses:function(e){return Object.keys(e).filter(function(t){return e[t]}).join(" ")},_getClassNames:function(){return this._mergeClasses({disabled:this.disabled,pin:this.pin,snaps:this.snaps,ring:this.immediateValue<=this.min,expand:this.expand,dragging:this.dragging,transiting:this.transiting,editable:this.editable})},_allowBarEvent:function(e){return!this.ignoreBarTouch||e.detail.sourceEvent instanceof MouseEvent},get _isRTL(){return void 0===this.__isRTL&&(this.__isRTL="rtl"===window.getComputedStyle(this).direction),this.__isRTL},_leftKey:function(e){this._isRTL?this._incrementKey(e):this._decrementKey(e)},_rightKey:function(e){this._isRTL?this._decrementKey(e):this._incrementKey(e)},_incrementKey:function(e){this.disabled||("end"===e.detail.key?this.value=this.max:this.increment(),this.fire("change"),e.preventDefault())},_decrementKey:function(e){this.disabled||("home"===e.detail.key?this.value=this.min:this.decrement(),this.fire("change"),e.preventDefault())},_changeValue:function(e){this.value=e.target.value,this.fire("change",{composed:!0})},_inputKeyDown:function(e){e.stopPropagation()},_createRipple:function(){return this._rippleContainer=this.$.sliderKnob,PaperInkyFocusBehaviorImpl._createRipple.call(this)},_focusedChanged:function(e){e&&this.ensureRipple(),this.hasRipple()&&(this._ripple.style.display=e?"":"none",this._ripple.holdDown=e)}});const PaperSpinnerBehavior={properties:{active:{type:Boolean,value:!1,reflectToAttribute:!0,observer:"__activeChanged"},alt:{type:String,value:"loading",observer:"__altChanged"},__coolingDown:{type:Boolean,value:!1}},__computeContainerClasses:function(e,t){return[e||t?"active":"",t?"cooldown":""].join(" ")},__activeChanged:function(e,t){this.__setAriaHidden(!e),this.__coolingDown=!e&&t},__altChanged:function(e){"loading"===e?this.alt=this.getAttribute("aria-label")||e:(this.__setAriaHidden(""===e),this.setAttribute("aria-label",e))},__setAriaHidden:function(e){e?this.setAttribute("aria-hidden","true"):this.removeAttribute("aria-hidden")},__reset:function(){this.active=!1,this.__coolingDown=!1}};var paperSpinnerBehavior={PaperSpinnerBehavior:PaperSpinnerBehavior};const $_documentContainer$4=document.createElement("template");$_documentContainer$4.setAttribute("style","display: none;"),$_documentContainer$4.innerHTML="<dom-module id=\"paper-spinner-styles\">\n  <template>\n    <style>\n      /*\n      /**************************/\n      /* STYLES FOR THE SPINNER */\n      /**************************/\n\n      /*\n       * Constants:\n       *      ARCSIZE     = 270 degrees (amount of circle the arc takes up)\n       *      ARCTIME     = 1333ms (time it takes to expand and contract arc)\n       *      ARCSTARTROT = 216 degrees (how much the start location of the arc\n       *                                should rotate each time, 216 gives us a\n       *                                5 pointed star shape (it's 360/5 * 3).\n       *                                For a 7 pointed star, we might do\n       *                                360/7 * 3 = 154.286)\n       *      SHRINK_TIME = 400ms\n       */\n\n      :host {\n        display: inline-block;\n        position: relative;\n        width: 28px;\n        height: 28px;\n\n        /* 360 * ARCTIME / (ARCSTARTROT + (360-ARCSIZE)) */\n        --paper-spinner-container-rotation-duration: 1568ms;\n\n        /* ARCTIME */\n        --paper-spinner-expand-contract-duration: 1333ms;\n\n        /* 4 * ARCTIME */\n        --paper-spinner-full-cycle-duration: 5332ms;\n\n        /* SHRINK_TIME */\n        --paper-spinner-cooldown-duration: 400ms;\n      }\n\n      #spinnerContainer {\n        width: 100%;\n        height: 100%;\n\n        /* The spinner does not have any contents that would have to be\n         * flipped if the direction changes. Always use ltr so that the\n         * style works out correctly in both cases. */\n        direction: ltr;\n      }\n\n      #spinnerContainer.active {\n        -webkit-animation: container-rotate var(--paper-spinner-container-rotation-duration) linear infinite;\n        animation: container-rotate var(--paper-spinner-container-rotation-duration) linear infinite;\n      }\n\n      @-webkit-keyframes container-rotate {\n        to { -webkit-transform: rotate(360deg) }\n      }\n\n      @keyframes container-rotate {\n        to { transform: rotate(360deg) }\n      }\n\n      .spinner-layer {\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        opacity: 0;\n        white-space: nowrap;\n        color: var(--paper-spinner-color, var(--google-blue-500));\n      }\n\n      .layer-1 {\n        color: var(--paper-spinner-layer-1-color, var(--google-blue-500));\n      }\n\n      .layer-2 {\n        color: var(--paper-spinner-layer-2-color, var(--google-red-500));\n      }\n\n      .layer-3 {\n        color: var(--paper-spinner-layer-3-color, var(--google-yellow-500));\n      }\n\n      .layer-4 {\n        color: var(--paper-spinner-layer-4-color, var(--google-green-500));\n      }\n\n      /**\n       * IMPORTANT NOTE ABOUT CSS ANIMATION PROPERTIES (keanulee):\n       *\n       * iOS Safari (tested on iOS 8.1) does not handle animation-delay very well - it doesn't\n       * guarantee that the animation will start _exactly_ after that value. So we avoid using\n       * animation-delay and instead set custom keyframes for each color (as layer-2undant as it\n       * seems).\n       */\n      .active .spinner-layer {\n        -webkit-animation-name: fill-unfill-rotate;\n        -webkit-animation-duration: var(--paper-spinner-full-cycle-duration);\n        -webkit-animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);\n        -webkit-animation-iteration-count: infinite;\n        animation-name: fill-unfill-rotate;\n        animation-duration: var(--paper-spinner-full-cycle-duration);\n        animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);\n        animation-iteration-count: infinite;\n        opacity: 1;\n      }\n\n      .active .spinner-layer.layer-1 {\n        -webkit-animation-name: fill-unfill-rotate, layer-1-fade-in-out;\n        animation-name: fill-unfill-rotate, layer-1-fade-in-out;\n      }\n\n      .active .spinner-layer.layer-2 {\n        -webkit-animation-name: fill-unfill-rotate, layer-2-fade-in-out;\n        animation-name: fill-unfill-rotate, layer-2-fade-in-out;\n      }\n\n      .active .spinner-layer.layer-3 {\n        -webkit-animation-name: fill-unfill-rotate, layer-3-fade-in-out;\n        animation-name: fill-unfill-rotate, layer-3-fade-in-out;\n      }\n\n      .active .spinner-layer.layer-4 {\n        -webkit-animation-name: fill-unfill-rotate, layer-4-fade-in-out;\n        animation-name: fill-unfill-rotate, layer-4-fade-in-out;\n      }\n\n      @-webkit-keyframes fill-unfill-rotate {\n        12.5% { -webkit-transform: rotate(135deg) } /* 0.5 * ARCSIZE */\n        25%   { -webkit-transform: rotate(270deg) } /* 1   * ARCSIZE */\n        37.5% { -webkit-transform: rotate(405deg) } /* 1.5 * ARCSIZE */\n        50%   { -webkit-transform: rotate(540deg) } /* 2   * ARCSIZE */\n        62.5% { -webkit-transform: rotate(675deg) } /* 2.5 * ARCSIZE */\n        75%   { -webkit-transform: rotate(810deg) } /* 3   * ARCSIZE */\n        87.5% { -webkit-transform: rotate(945deg) } /* 3.5 * ARCSIZE */\n        to    { -webkit-transform: rotate(1080deg) } /* 4   * ARCSIZE */\n      }\n\n      @keyframes fill-unfill-rotate {\n        12.5% { transform: rotate(135deg) } /* 0.5 * ARCSIZE */\n        25%   { transform: rotate(270deg) } /* 1   * ARCSIZE */\n        37.5% { transform: rotate(405deg) } /* 1.5 * ARCSIZE */\n        50%   { transform: rotate(540deg) } /* 2   * ARCSIZE */\n        62.5% { transform: rotate(675deg) } /* 2.5 * ARCSIZE */\n        75%   { transform: rotate(810deg) } /* 3   * ARCSIZE */\n        87.5% { transform: rotate(945deg) } /* 3.5 * ARCSIZE */\n        to    { transform: rotate(1080deg) } /* 4   * ARCSIZE */\n      }\n\n      @-webkit-keyframes layer-1-fade-in-out {\n        0% { opacity: 1 }\n        25% { opacity: 1 }\n        26% { opacity: 0 }\n        89% { opacity: 0 }\n        90% { opacity: 1 }\n        to { opacity: 1 }\n      }\n\n      @keyframes layer-1-fade-in-out {\n        0% { opacity: 1 }\n        25% { opacity: 1 }\n        26% { opacity: 0 }\n        89% { opacity: 0 }\n        90% { opacity: 1 }\n        to { opacity: 1 }\n      }\n\n      @-webkit-keyframes layer-2-fade-in-out {\n        0% { opacity: 0 }\n        15% { opacity: 0 }\n        25% { opacity: 1 }\n        50% { opacity: 1 }\n        51% { opacity: 0 }\n        to { opacity: 0 }\n      }\n\n      @keyframes layer-2-fade-in-out {\n        0% { opacity: 0 }\n        15% { opacity: 0 }\n        25% { opacity: 1 }\n        50% { opacity: 1 }\n        51% { opacity: 0 }\n        to { opacity: 0 }\n      }\n\n      @-webkit-keyframes layer-3-fade-in-out {\n        0% { opacity: 0 }\n        40% { opacity: 0 }\n        50% { opacity: 1 }\n        75% { opacity: 1 }\n        76% { opacity: 0 }\n        to { opacity: 0 }\n      }\n\n      @keyframes layer-3-fade-in-out {\n        0% { opacity: 0 }\n        40% { opacity: 0 }\n        50% { opacity: 1 }\n        75% { opacity: 1 }\n        76% { opacity: 0 }\n        to { opacity: 0 }\n      }\n\n      @-webkit-keyframes layer-4-fade-in-out {\n        0% { opacity: 0 }\n        65% { opacity: 0 }\n        75% { opacity: 1 }\n        90% { opacity: 1 }\n        to { opacity: 0 }\n      }\n\n      @keyframes layer-4-fade-in-out {\n        0% { opacity: 0 }\n        65% { opacity: 0 }\n        75% { opacity: 1 }\n        90% { opacity: 1 }\n        to { opacity: 0 }\n      }\n\n      .circle-clipper {\n        display: inline-block;\n        position: relative;\n        width: 50%;\n        height: 100%;\n        overflow: hidden;\n      }\n\n      /**\n       * Patch the gap that appear between the two adjacent div.circle-clipper while the\n       * spinner is rotating (appears on Chrome 50, Safari 9.1.1, and Edge).\n       */\n      .spinner-layer::after {\n        content: '';\n        left: 45%;\n        width: 10%;\n        border-top-style: solid;\n      }\n\n      .spinner-layer::after,\n      .circle-clipper .circle {\n        box-sizing: border-box;\n        position: absolute;\n        top: 0;\n        border-width: var(--paper-spinner-stroke-width, 3px);\n        border-radius: 50%;\n      }\n\n      .circle-clipper .circle {\n        bottom: 0;\n        width: 200%;\n        border-style: solid;\n        border-bottom-color: transparent !important;\n      }\n\n      .circle-clipper.left .circle {\n        left: 0;\n        border-right-color: transparent !important;\n        -webkit-transform: rotate(129deg);\n        transform: rotate(129deg);\n      }\n\n      .circle-clipper.right .circle {\n        left: -100%;\n        border-left-color: transparent !important;\n        -webkit-transform: rotate(-129deg);\n        transform: rotate(-129deg);\n      }\n\n      .active .gap-patch::after,\n      .active .circle-clipper .circle {\n        -webkit-animation-duration: var(--paper-spinner-expand-contract-duration);\n        -webkit-animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);\n        -webkit-animation-iteration-count: infinite;\n        animation-duration: var(--paper-spinner-expand-contract-duration);\n        animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1);\n        animation-iteration-count: infinite;\n      }\n\n      .active .circle-clipper.left .circle {\n        -webkit-animation-name: left-spin;\n        animation-name: left-spin;\n      }\n\n      .active .circle-clipper.right .circle {\n        -webkit-animation-name: right-spin;\n        animation-name: right-spin;\n      }\n\n      @-webkit-keyframes left-spin {\n        0% { -webkit-transform: rotate(130deg) }\n        50% { -webkit-transform: rotate(-5deg) }\n        to { -webkit-transform: rotate(130deg) }\n      }\n\n      @keyframes left-spin {\n        0% { transform: rotate(130deg) }\n        50% { transform: rotate(-5deg) }\n        to { transform: rotate(130deg) }\n      }\n\n      @-webkit-keyframes right-spin {\n        0% { -webkit-transform: rotate(-130deg) }\n        50% { -webkit-transform: rotate(5deg) }\n        to { -webkit-transform: rotate(-130deg) }\n      }\n\n      @keyframes right-spin {\n        0% { transform: rotate(-130deg) }\n        50% { transform: rotate(5deg) }\n        to { transform: rotate(-130deg) }\n      }\n\n      #spinnerContainer.cooldown {\n        -webkit-animation: container-rotate var(--paper-spinner-container-rotation-duration) linear infinite, fade-out var(--paper-spinner-cooldown-duration) cubic-bezier(0.4, 0.0, 0.2, 1);\n        animation: container-rotate var(--paper-spinner-container-rotation-duration) linear infinite, fade-out var(--paper-spinner-cooldown-duration) cubic-bezier(0.4, 0.0, 0.2, 1);\n      }\n\n      @-webkit-keyframes fade-out {\n        0% { opacity: 1 }\n        to { opacity: 0 }\n      }\n\n      @keyframes fade-out {\n        0% { opacity: 1 }\n        to { opacity: 0 }\n      }\n    </style>\n  </template>\n</dom-module>",document.head.appendChild($_documentContainer$4.content);const template$b=html`
  <style include="paper-spinner-styles"></style>

  <div id="spinnerContainer" class-name="[[__computeContainerClasses(active, __coolingDown)]]" on-animationend="__reset" on-webkit-animation-end="__reset">
    <div class="spinner-layer layer-1">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div>
      <div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>

    <div class="spinner-layer layer-2">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div>
      <div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>

    <div class="spinner-layer layer-3">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div>
      <div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>

    <div class="spinner-layer layer-4">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div>
      <div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>
  </div>
`;template$b.setAttribute("strip-whitespace",""),Polymer({_template:template$b,is:"paper-spinner",behaviors:[PaperSpinnerBehavior]}),Polymer({_template:html`
    <style>
      :host {
        @apply --layout-inline;
        @apply --layout-center;
        @apply --layout-center-justified;
        @apply --layout-flex-auto;

        position: relative;
        padding: 0 12px;
        overflow: hidden;
        cursor: pointer;
        vertical-align: middle;

        @apply --paper-font-common-base;
        @apply --paper-tab;
      }

      :host(:focus) {
        outline: none;
      }

      :host([link]) {
        padding: 0;
      }

      .tab-content {
        height: 100%;
        transform: translateZ(0);
          -webkit-transform: translateZ(0);
        transition: opacity 0.1s cubic-bezier(0.4, 0.0, 1, 1);
        @apply --layout-horizontal;
        @apply --layout-center-center;
        @apply --layout-flex-auto;
        @apply --paper-tab-content;
      }

      :host(:not(.iron-selected)) > .tab-content {
        opacity: 0.8;

        @apply --paper-tab-content-unselected;
      }

      :host(:focus) .tab-content {
        opacity: 1;
        font-weight: 700;
      }

      paper-ripple {
        color: var(--paper-tab-ink, var(--paper-yellow-a100));
      }

      .tab-content > ::slotted(a) {
        @apply --layout-flex-auto;

        height: 100%;
      }
    </style>

    <div class="tab-content">
      <slot></slot>
    </div>
`,is:"paper-tab",behaviors:[IronControlState,IronButtonState,PaperRippleBehavior],properties:{link:{type:Boolean,value:!1,reflectToAttribute:!0}},hostAttributes:{role:"tab"},listeners:{down:"_updateNoink",tap:"_onTap"},attached:function(){this._updateNoink()},get _parentNoink(){var e=dom(this).parentNode;return!!e&&!!e.noink},_updateNoink:function(){this.noink=!!this.noink||!!this._parentNoink},_onTap:function(e){if(this.link){var t=this.queryEffectiveChildren("a");if(!t)return;if(e.target===t)return;t.click()}}});const template$c=html`<iron-iconset-svg name="paper-tabs" size="24">
<svg><defs>
<g id="chevron-left"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></g>
<g id="chevron-right"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></g>
</defs></svg>
</iron-iconset-svg>`;document.head.appendChild(template$c.content),Polymer({_template:html`
    <style>
      :host {
        @apply --layout;
        @apply --layout-center;

        height: 48px;
        font-size: 14px;
        font-weight: 500;
        overflow: hidden;
        -moz-user-select: none;
        -ms-user-select: none;
        -webkit-user-select: none;
        user-select: none;

        /* NOTE: Both values are needed, since some phones require the value to be \`transparent\`. */
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        -webkit-tap-highlight-color: transparent;

        @apply --paper-tabs;
      }

      :host(:dir(rtl)) {
        @apply --layout-horizontal-reverse;
      }

      #tabsContainer {
        position: relative;
        height: 100%;
        white-space: nowrap;
        overflow: hidden;
        @apply --layout-flex-auto;
        @apply --paper-tabs-container;
      }

      #tabsContent {
        height: 100%;
        -moz-flex-basis: auto;
        -ms-flex-basis: auto;
        flex-basis: auto;
        @apply --paper-tabs-content;
      }

      #tabsContent.scrollable {
        position: absolute;
        white-space: nowrap;
      }

      #tabsContent:not(.scrollable),
      #tabsContent.scrollable.fit-container {
        @apply --layout-horizontal;
      }

      #tabsContent.scrollable.fit-container {
        min-width: 100%;
      }

      #tabsContent.scrollable.fit-container > ::slotted(*) {
        /* IE - prevent tabs from compressing when they should scroll. */
        -ms-flex: 1 0 auto;
        -webkit-flex: 1 0 auto;
        flex: 1 0 auto;
      }

      .hidden {
        display: none;
      }

      .not-visible {
        opacity: 0;
        cursor: default;
      }

      paper-icon-button {
        width: 48px;
        height: 48px;
        padding: 12px;
        margin: 0 4px;
      }

      #selectionBar {
        position: absolute;
        height: 0;
        bottom: 0;
        left: 0;
        right: 0;
        border-bottom: 2px solid var(--paper-tabs-selection-bar-color, var(--paper-yellow-a100));
          -webkit-transform: scale(0);
        transform: scale(0);
          -webkit-transform-origin: left center;
        transform-origin: left center;
          transition: -webkit-transform;
        transition: transform;

        @apply --paper-tabs-selection-bar;
      }

      #selectionBar.align-bottom {
        top: 0;
        bottom: auto;
      }

      #selectionBar.expand {
        transition-duration: 0.15s;
        transition-timing-function: cubic-bezier(0.4, 0.0, 1, 1);
      }

      #selectionBar.contract {
        transition-duration: 0.18s;
        transition-timing-function: cubic-bezier(0.0, 0.0, 0.2, 1);
      }

      #tabsContent > ::slotted(:not(#selectionBar)) {
        height: 100%;
      }
    </style>

    <paper-icon-button icon="paper-tabs:chevron-left" class\$="[[_computeScrollButtonClass(_leftHidden, scrollable, hideScrollButtons)]]" on-up="_onScrollButtonUp" on-down="_onLeftScrollButtonDown" tabindex="-1"></paper-icon-button>

    <div id="tabsContainer" on-track="_scroll" on-down="_down">
      <div id="tabsContent" class\$="[[_computeTabsContentClass(scrollable, fitContainer)]]">
        <div id="selectionBar" class\$="[[_computeSelectionBarClass(noBar, alignBottom)]]" on-transitionend="_onBarTransitionEnd"></div>
        <slot></slot>
      </div>
    </div>

    <paper-icon-button icon="paper-tabs:chevron-right" class\$="[[_computeScrollButtonClass(_rightHidden, scrollable, hideScrollButtons)]]" on-up="_onScrollButtonUp" on-down="_onRightScrollButtonDown" tabindex="-1"></paper-icon-button>
`,is:"paper-tabs",behaviors:[IronResizableBehavior,IronMenubarBehavior],properties:{noink:{type:Boolean,value:!1,observer:"_noinkChanged"},noBar:{type:Boolean,value:!1},noSlide:{type:Boolean,value:!1},scrollable:{type:Boolean,value:!1},fitContainer:{type:Boolean,value:!1},disableDrag:{type:Boolean,value:!1},hideScrollButtons:{type:Boolean,value:!1},alignBottom:{type:Boolean,value:!1},selectable:{type:String,value:"paper-tab"},autoselect:{type:Boolean,value:!1},autoselectDelay:{type:Number,value:0},_step:{type:Number,value:10},_holdDelay:{type:Number,value:1},_leftHidden:{type:Boolean,value:!1},_rightHidden:{type:Boolean,value:!1},_previousTab:{type:Object}},hostAttributes:{role:"tablist"},listeners:{"iron-resize":"_onTabSizingChanged","iron-items-changed":"_onTabSizingChanged","iron-select":"_onIronSelect","iron-deselect":"_onIronDeselect"},keyBindings:{"left:keyup right:keyup":"_onArrowKeyup"},created:function(){this._holdJob=null,this._pendingActivationItem=void 0,this._pendingActivationTimeout=void 0,this._bindDelayedActivationHandler=this._delayedActivationHandler.bind(this),this.addEventListener("blur",this._onBlurCapture.bind(this),!0)},ready:function(){this.setScrollDirection("y",this.$.tabsContainer)},detached:function(){this._cancelPendingActivation()},_noinkChanged:function(e){dom(this).querySelectorAll("paper-tab").forEach(e?this._setNoinkAttribute:this._removeNoinkAttribute)},_setNoinkAttribute:function(e){e.setAttribute("noink","")},_removeNoinkAttribute:function(e){e.removeAttribute("noink")},_computeScrollButtonClass:function(e,t,i){return!t||i?"hidden":e?"not-visible":""},_computeTabsContentClass:function(e,t){return e?"scrollable"+(t?" fit-container":""):" fit-container"},_computeSelectionBarClass:function(e,t){return e?"hidden":t?"align-bottom":""},_onTabSizingChanged:function(){this.debounce("_onTabSizingChanged",function(){this._scroll(),this._tabChanged(this.selectedItem)},10)},_onIronSelect:function(e){this._tabChanged(e.detail.item,this._previousTab),this._previousTab=e.detail.item,this.cancelDebouncer("tab-changed")},_onIronDeselect:function(e){this.debounce("tab-changed",function(){this._tabChanged(null,this._previousTab),this._previousTab=null},1)},_activateHandler:function(){this._cancelPendingActivation(),IronMenuBehaviorImpl._activateHandler.apply(this,arguments)},_scheduleActivation:function(e,t){this._pendingActivationItem=e,this._pendingActivationTimeout=this.async(this._bindDelayedActivationHandler,t)},_delayedActivationHandler:function(){var e=this._pendingActivationItem;this._pendingActivationItem=void 0,this._pendingActivationTimeout=void 0,e.fire(this.activateEvent,null,{bubbles:!0,cancelable:!0})},_cancelPendingActivation:function(){void 0!==this._pendingActivationTimeout&&(this.cancelAsync(this._pendingActivationTimeout),this._pendingActivationItem=void 0,this._pendingActivationTimeout=void 0)},_onArrowKeyup:function(e){this.autoselect&&this._scheduleActivation(this.focusedItem,this.autoselectDelay)},_onBlurCapture:function(e){e.target===this._pendingActivationItem&&this._cancelPendingActivation()},get _tabContainerScrollSize(){return Math.max(0,this.$.tabsContainer.scrollWidth-this.$.tabsContainer.offsetWidth)},_scroll:function(e,t){if(this.scrollable){var i=t&&-t.ddx||0;this._affectScroll(i)}},_down:function(e){this.async(function(){this._defaultFocusAsync&&(this.cancelAsync(this._defaultFocusAsync),this._defaultFocusAsync=null)},1)},_affectScroll:function(e){this.$.tabsContainer.scrollLeft+=e;var t=this.$.tabsContainer.scrollLeft;this._leftHidden=0===t,this._rightHidden=t===this._tabContainerScrollSize},_onLeftScrollButtonDown:function(){this._scrollToLeft(),this._holdJob=setInterval(this._scrollToLeft.bind(this),this._holdDelay)},_onRightScrollButtonDown:function(){this._scrollToRight(),this._holdJob=setInterval(this._scrollToRight.bind(this),this._holdDelay)},_onScrollButtonUp:function(){clearInterval(this._holdJob),this._holdJob=null},_scrollToLeft:function(){this._affectScroll(-this._step)},_scrollToRight:function(){this._affectScroll(this._step)},_tabChanged:function(e,t){if(!e)return this.$.selectionBar.classList.remove("expand"),this.$.selectionBar.classList.remove("contract"),void this._positionBar(0,0);var i=this.$.tabsContent.getBoundingClientRect(),r=i.width,n=e.getBoundingClientRect(),a=n.left-i.left;if(this._pos={width:this._calcPercent(n.width,r),left:this._calcPercent(a,r)},this.noSlide||null==t)return this.$.selectionBar.classList.remove("expand"),this.$.selectionBar.classList.remove("contract"),void this._positionBar(this._pos.width,this._pos.left);var o=t.getBoundingClientRect(),s=this.items.indexOf(t),l=this.items.indexOf(e);this.$.selectionBar.classList.add("expand");var c=s<l;this._isRTL&&(c=!c),c?this._positionBar(this._calcPercent(n.left+n.width-o.left,r)-5,this._left):this._positionBar(this._calcPercent(o.left+o.width-n.left,r)-5,this._calcPercent(a,r)+5),this.scrollable&&this._scrollToSelectedIfNeeded(n.width,a)},_scrollToSelectedIfNeeded:function(e,t){var i=t-this.$.tabsContainer.scrollLeft;0>i?this.$.tabsContainer.scrollLeft+=i:0<(i+=e-this.$.tabsContainer.offsetWidth)&&(this.$.tabsContainer.scrollLeft+=i)},_calcPercent:function(e,t){return 100*e/t},_positionBar:function(e,t){e=e||0,t=t||0,this._width=e,this._left=t,this.transform("translateX("+t+"%) scaleX("+e/100+")",this.$.selectionBar)},_onBarTransitionEnd:function(e){var t=this.$.selectionBar.classList;t.contains("expand")?(t.remove("expand"),t.add("contract"),this._positionBar(this._pos.width,this._pos.left)):t.contains("contract")&&t.remove("contract")}});const Easing={Linear:{None:e=>e},Quadratic:{In:e=>Math.pow(e,2),Out:e=>e*(2-e),InOut:e=>1>(e*=2)?.5*Math.pow(e,2):-.5*(--e*(e-2)-1)},Cubic:{In:e=>Math.pow(e,3),Out:e=>--e*e*e+1,InOut:e=>1>(e*=2)?.5*Math.pow(e,3):.5*((e-=2)*e*e+2)},Quartic:{In:e=>Math.pow(e,4),Out:e=>1- --e*e*e*e,InOut:e=>1>(e*=2)?.5*Math.pow(e,4):-.5*((e-=2)*e*e*e-2)},Quintic:{In:e=>Math.pow(e,5),Out:e=>--e*e*e*e*e+1,InOut:e=>1>(e*=2)?.5*Math.pow(e,5):.5*((e-=2)*e*e*e*e+2)},Sinusoidal:{In:e=>1-Math.cos(e*Math.PI/2),Out:e=>Math.sin(e*Math.PI/2),InOut:e=>.5*(1-Math.cos(Math.PI*e))},Exponential:{In:e=>0===e?0:Math.pow(1024,e-1),Out:e=>1===e?1:1-Math.pow(2,-10*e),InOut:e=>0===e?0:1===e?1:1>(e*=2)?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},Circular:{In:e=>1-Math.sqrt(1-e*e),Out:e=>Math.sqrt(1- --e*e),InOut:e=>1>(e*=2)?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},Elastic:{In:e=>0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI),Out:e=>0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1,InOut:e=>0===e?0:1===e?1:1>(e*=2)?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1},Back:{In(e){const t=1.70158;return e*e*((t+1)*e-t)},Out(e){const t=1.70158;return--e*e*((t+1)*e+t)+1},InOut(e){const t=2.5949095;return 1>(e*=2)?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:e=>1-Easing.Bounce.Out(1-e),Out(e){let t=2.75,i=7.5625;return e<1/t?i*e*e:e<2/t?i*(e-=1.5/t)*e+.75:e<2.5/t?i*(e-=2.25/t)*e+.9375:i*(e-=2.625/t)*e+.984375},InOut:e=>.5>e?.5*Easing.Bounce.In(2*e):.5*Easing.Bounce.Out(2*e-1)+.5},Stepped:{steps:e=>t=>(0|t*e)/e}};var Easing$1={default:Easing};const FRAME_MS=50/3,TOO_LONG_FRAME_MS=250,CHAINED_TWEENS="_chainedTweens",EVENT_CALLBACK="Callback",EVENT_UPDATE="update",EVENT_COMPLETE="complete",EVENT_START="start",EVENT_REPEAT="repeat",EVENT_REVERSE="reverse",EVENT_PAUSE="pause",EVENT_PLAY="play",EVENT_RESTART="restart",EVENT_STOP="stop",EVENT_SEEK="seek",STRING_PROP="STRING_PROP",NUM_REGEX=/\s+|([A-Za-z?().,{}:""[\]#%]+)|([-+]=+)?([-+]+)?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]=?\d+)?/g;function deepCopy(e){if(e&&e.nodeType||void 0===e||"object"!=typeof e)return e;if(Array.isArray(e))return[].concat(e);if("object"==typeof e){let t={};for(let i in e)t[i]=deepCopy(e[i]);return t}return e}const isNaNForST=e=>isNaN(+e)||("+"===e[0]||"-"===e[0])&&"="===e[1]||""===e||" "===e,hexColor=/^#([0-9a-f]{6}|[0-9a-f]{3})$/gi,hex2rgb=(e,t)=>{let i,r,n;3===t.length&&(t=(i=t[0])+i+(r=t[1])+r+(n=t[2])+n);let a=parseInt(t,16);return"rgb("+(i=255&a>>16)+", "+(r=255&a>>8)+", "+(n=255&a)+")"};function decomposeString(e){if(e&&e.splice&&e.isString)return e;if("string"!=typeof e)return e;if("="===e.charAt(1))return e;const t=e.replace(hexColor,hex2rgb).match(NUM_REGEX).map(e=>isNaNForST(e)?e:+e);return t.isString=!0,t}function decompose(e,t,i,r){const n=i[e],a=r[e];if(n===a)return!0;if(Array.isArray(n)&&Array.isArray(a)&&n.length===a.length)for(let i=0,r=a.length;i<r;i++){const r=n[i],o=a[i];r===o||"number"==typeof r&&"number"==typeof o||decompose(i,t[e],n,a)}if("number"==typeof n&&"number"==typeof a);else if(n&&n.splice&&n.isString&&a&&a.splice&&a.isString);else{if("string"==typeof n&&Array.isArray(a)){const t=decomposeString(n),o=a.map(decomposeString);return i[e]=t,r[e]=o,!0}if("string"==typeof n||"string"==typeof a){let t=Array.isArray(n)&&n[0]===STRING_PROP?n:decomposeString(n),o=Array.isArray(a)&&a[0]===STRING_PROP?a:decomposeString(a);if(void 0===t)return;let s=1;for(;s<t.length;)t[s]===o[s]&&"string"==typeof t[s-1]?(t.splice(s-1,2,t[s-1]+t[s]),o.splice(s-1,2,o[s-1]+o[s])):s++;return s=0,t[0]===STRING_PROP&&t.shift(),o[0]===STRING_PROP&&o.shift(),i[e]=t,r[e]=o,!0}if("object"==typeof n&&"object"==typeof a){if(Array.isArray(n)&&!n.isString)return n.map((i,r)=>decompose(r,t[e],n,a));for(let i in a)decompose(i,t[e],n,a);return!0}}return!1}const RGB="rgb(",RGBA="rgba(",isRGBColor=(e,t,i=RGB)=>"number"==typeof e[t]&&(e[t-1]===i||e[t-3]===i||e[t-5]===i);function recompose(e,t,i,r,n,a,o){const s=o?i:i[e];let l=o?r:r[e];if(void 0===l)return s;if(void 0===s||"string"==typeof s||s===l)return l;if("object"==typeof s&&"object"==typeof l){if(!s||!l)return t[e];if("object"==typeof s&&s&&s.isString&&l&&l.splice&&l.isString){let i="";for(let e=0,t=s.length;e<t;e++)if(s[e]!==l[e]||"number"!=typeof s[e]||"number"==typeof l[e]){const t="number"==typeof s[e]&&"string"==typeof l[e]&&"="===l[e][1];let r="number"!=typeof s[e]?s[e]:t?s[e]+parseFloat(l[e][0]+l[e].substr(2))*n:s[e]+(l[e]-s[e])*n;(isRGBColor(s,e)||isRGBColor(s,e,RGBA))&&(r|=0),i+=r,t&&1===a&&(s[e]=s[e]+parseFloat(l[e][0]+l[e].substr(2)))}else i+=s[e];return o||(t[e]=i),i}if(Array.isArray(s)&&s[0]!==STRING_PROP)for(let i=0,r=s.length;i<r;i++)s[i]!==l[i]&&"string"!=typeof t[e]&&recompose(i,t[e],s,l,n,a);else if("object"==typeof s&&s&&!s.isString)for(let i in s)s[i]!==l[i]&&recompose(i,t[e],s,l,n,a)}else if("number"==typeof s){const r="string"==typeof l;t[e]=r?s+parseFloat(l[0]+l.substr(2))*n:s+(l-s)*n,r&&1===a&&(i[e]=t[e])}else"function"==typeof l&&(t[e]=l(n));return t[e]}const propRegExp=/([.[])/g,replaceBrace=/\]/g,propExtract=function(e,t){const i=e[t],r=t.replace(replaceBrace,"").split(propRegExp),n=r.length-1;let a=Array.isArray(e),o="object"==typeof e&&!a;return o?(e[t]=null,delete e[t]):a&&e.splice(t,1),r.reduce((e,t,s)=>{a&&"."!==t&&"["!==t&&(t*=1);let l="["===r[s+1];if("."===t||"["===t)return"."===t?(o=!0,a=!1):"["===t&&(o=!1,a=!0),e;if(void 0===e[t]){if(a||o)return e[t]=s===n?i:a||l?[]:o?{}:null,o=a=!1,e[t]}else if(void 0!==e[t])return s===n&&(e[t]=i),e[t];return e},e)},SET_NESTED=function(e){if("object"==typeof e&&e)for(let t in e)if(-1!==t.indexOf(".")||-1!==t.indexOf("["))propExtract(e,t);else if("object"==typeof e[t]&&e[t]){let i=e[t];for(let e in i)if(-1!==e.indexOf(".")||-1!==e.indexOf("["))propExtract(i,e);else if("object"==typeof i[e]&&i[e]){let t=i[e];for(let e in t)-1===e.indexOf(".")&&-1===e.indexOf("[")||propExtract(t,e)}}return e};var constants={FRAME_MS:FRAME_MS,TOO_LONG_FRAME_MS:TOO_LONG_FRAME_MS,CHAINED_TWEENS:CHAINED_TWEENS,EVENT_CALLBACK:EVENT_CALLBACK,EVENT_UPDATE:EVENT_UPDATE,EVENT_COMPLETE:EVENT_COMPLETE,EVENT_START:EVENT_START,EVENT_REPEAT:EVENT_REPEAT,EVENT_REVERSE:EVENT_REVERSE,EVENT_PAUSE:EVENT_PAUSE,EVENT_PLAY:EVENT_PLAY,EVENT_RESTART:EVENT_RESTART,EVENT_STOP:EVENT_STOP,EVENT_SEEK:EVENT_SEEK,STRING_PROP:STRING_PROP,NUM_REGEX:NUM_REGEX,deepCopy:deepCopy,decomposeString:decomposeString,decompose:decompose,RGB:RGB,RGBA:RGBA,isRGBColor:isRGBColor,recompose:recompose,SET_NESTED:SET_NESTED};const Interpolation={Linear(e,t,i){const r=e.length-1,n=r*t,a=Math.floor(n),o=Interpolation.Utils.Linear;return 0>t?o(e[0],e[1],n,i):1<t?o(e[r],e[r-1],r-n,i):o(e[a],e[a+1>r?r:a+1],n-a,i)},Bezier(e,t,i){let r=Interpolation.Utils.Reset(i),n=e.length-1,a=Math.pow,o=Interpolation.Utils.Bernstein,s=Array.isArray(r);for(let i=0;i<=n;i++)if("number"==typeof r)r+=a(1-t,n-i)*a(t,i)*e[i]*o(n,i);else if(s)for(let s=0,l=r.length;s<l;s++)"number"==typeof r[s]?r[s]+=a(1-t,n-i)*a(t,i)*e[i][s]*o(n,i):r[s]=e[i][s];else if("object"==typeof r)for(let s in r)"number"==typeof r[s]?r[s]+=a(1-t,n-i)*a(t,i)*e[i][s]*o(n,i):r[s]=e[i][s];else if("string"==typeof r){let i="",r=e[Math.round(n*t)];for(let e=1,t=r.length;e<t;e++)i+=r[e];return i}return r},CatmullRom(e,t,i){const r=e.length-1;let n=r*t,a=Math.floor(n);const o=Interpolation.Utils.CatmullRom;return e[0]===e[r]?(0>t&&(a=Math.floor(n=r*(1+t))),o(e[(a-1+r)%r],e[a],e[(a+1)%r],e[(a+2)%r],n-a,i)):0>t?o(e[1],e[1],e[0],e[0],-t,i):1<t?o(e[r-1],e[r-1],e[r],e[r],(0|t)-t,i):o(e[a?a-1:0],e[a],e[r<a+1?r:a+1],e[r<a+2?r:a+2],n-a,i)},Utils:{Linear(e,t,i,r){if(e===t||"string"==typeof e){if(t.length&&t.splice&&t.isString){t="";for(let i=0,r=e.length;i<r;i++)t+=e[i]}return t}if("number"==typeof e)return"function"==typeof e?e(i):e+(t-e)*i;if("object"==typeof e){if(void 0!==e.length){const n="string"==typeof e[0]||e.isString;if(n||e[0]===STRING_PROP){let r="";for(let a,o=n?0:1,s=e.length;o<s;o++)a=0===i?e[o]:1===i?t[o]:"number"==typeof e[o]?e[o]+(t[o]-e[o])*i:t[o],(0<i&&1>i&&isRGBColor(e,o)||isRGBColor(e,o,RGBA))&&(a|=0),r+=a;return r}if(r&&r.length&&r.splice)for(let n=0,a=r.length;n<a;n++)r[n]=Interpolation.Utils.Linear(e[n],t[n],i,r[n])}else for(const n in r)r[n]=Interpolation.Utils.Linear(e[n],t[n],i,r[n]);return r}},Reset(e){if(Array.isArray(e)){for(let t=0,i=e.length;t<i;t++)e[t]=Interpolation.Utils.Reset(e[t]);return e}if("object"==typeof e){for(let t in e)e[t]=Interpolation.Utils.Reset(e[t]);return e}return"number"==typeof e?0:e},Bernstein(e,t){const i=Interpolation.Utils.Factorial;return i(e)/i(t)/i(e-t)},Factorial:function(){const e=[1];return t=>{let i=1;if(e[t])return e[t];for(let e=t;1<e;e--)i*=e;return e[t]=i,i}}(),CatmullRom(e,t,i,r,n,a){if("string"==typeof e)return t;if("number"==typeof e){const a=.5*(i-e),o=.5*(r-t),s=n*n;return(2*t-2*i+a+o)*(n*s)+(-3*t+3*i-2*a-o)*s+a*n+t}if("object"==typeof e){if(void 0!==e.length){if(e[0]===STRING_PROP){let a="";for(let o,s=1,l=e.length;s<l;s++)o="number"==typeof e[s]?Interpolation.Utils.CatmullRom(e[s],t[s],i[s],r[s],n):r[s],(isRGBColor(e,s)||isRGBColor(e,s,RGBA))&&(o|=0),a+=o;return a}for(let o=0,s=a.length;o<s;o++)a[o]=Interpolation.Utils.CatmullRom(e[o],t[o],i[o],r[o],n,a[o])}else for(const o in a)a[o]=Interpolation.Utils.CatmullRom(e[o],t[o],i[o],r[o],n,a[o]);return a}}}};var Interpolation$1={default:Interpolation};const Interpolator=(e,t)=>{let i=Array.isArray(e)&&!e.isString,r="string"==typeof e?e:i?e.slice():{...e};if(i)for(let i=0,n=e.length;i<n;i++)e[i]===t[i]&&"number"==typeof e[i]&&"number"!=typeof t[i]||decompose(i,r,e,t);else if("object"==typeof e)for(let i in e)e[i]===t[i]&&"number"==typeof e[i]&&"number"!=typeof t[i]||decompose(i,r,e,t);else if("string"==typeof e){e=decomposeString(e),t=decomposeString(t);let i=1;for(;i<e.length;)e[i]===t[i]&&"string"==typeof e[i-1]?(e.splice(i-1,2,e[i-1]+e[i]),t.splice(i-1,2,t[i-1]+t[i])):i++}return n=>{if(i)for(let i=0,a=e.length;i<a;i++)recompose(i,r,e,t,n);else if("object"==typeof r)for(let i in e)recompose(i,r,e,t,n);else"string"==typeof r&&(r=recompose(0,0,e,t,n,n,!0));return r}};var Interpolator$1={default:Interpolator};let root$1="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof exports?exports:{},requestAnimationFrame$1=root$1.requestAnimationFrame||(e=>root$1.setTimeout(e,50/3)),cancelAnimationFrame$1=root$1.cancelAnimationFrame||(e=>root$1.clearTimeout(e));var shim={root:root$1,requestAnimationFrame:requestAnimationFrame$1,cancelAnimationFrame:cancelAnimationFrame$1};const now=function(){if("undefined"==typeof process||void 0===process.hrtime||process.versions&&void 0!==process.versions.electron){if(void 0!==root$1.performance&&void 0!==root$1.performance.now)return root$1.performance.now.bind(root$1.performance);{const e=root$1.performance&&root$1.performance.timing&&root$1.performance.timing.navigationStart?root$1.performance.timing.navigationStart:Date.now();return function(){return Date.now()-e}}}return function(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}}(),_tweens=[];let isStarted=!1,_autoPlay=!1,_onRequestTick=[];const _ticker=requestAnimationFrame$1;let _tick,emptyFrame=0,powerModeThrottle=120,handleLag=!0;const onRequestTick=e=>{_onRequestTick.push(e)},_requestTick=()=>{for(let e=0;e<_onRequestTick.length;e++)_onRequestTick[e]()},add$1=e=>{let t=_tweens.indexOf(e);-1<t&&_tweens.splice(t,1),_tweens.push(e),emptyFrame=0,_autoPlay&&!isStarted&&(_tick=_ticker(update),isStarted=!0)},onTick=e=>_tweens.push({update:e}),FrameThrottle=(e=120)=>{powerModeThrottle=1.05*e},ToggleLagSmoothing=(e=!0)=>{handleLag=e},getAll=()=>_tweens,autoPlay=e=>{_autoPlay=e},removeAll=()=>{_tweens.length=0,cancelAnimationFrame$1(_tick),isStarted=!1},get$1=e=>{for(let t=0;t<_tweens.length;t++)if(e===_tweens[t])return _tweens[t];return null},has=e=>null!==get$1(e),remove$1=e=>{const t=_tweens.indexOf(e);-1!==t&&_tweens.splice(t,1),0===_tweens.length&&(cancelAnimationFrame$1(_tick),isStarted=!1)},update=(e=now(),t)=>{if(emptyFrame>=powerModeThrottle&&handleLag)return isStarted=!1,emptyFrame=0,cancelAnimationFrame$1(_tick),!1;_autoPlay&&isStarted?_tick=_ticker(update):_requestTick(),_tweens.length||emptyFrame++;let i=0,r=_tweens.length;for(;i<r;)_tweens[i++].update(e,t),r>_tweens.length&&i--,r=_tweens.length;return!0},isRunning=()=>isStarted,isLagSmoothing=()=>handleLag,Plugins={};var core={Plugins:Plugins,get:get$1,has:has,getAll:getAll,removeAll:removeAll,remove:remove$1,add:add$1,now:now,update:update,autoPlay:autoPlay,onTick:onTick,onRequestTick:onRequestTick,isRunning:isRunning,isLagSmoothing:isLagSmoothing,FrameThrottle:FrameThrottle,ToggleLagSmoothing:ToggleLagSmoothing};const Store={};function NodeCache(e,t,i){if(!e||!e.nodeType)return t;const r=e.queueID||"q_"+Date.now();e.queueID||(e.queueID=r);const n=Store[r];if(n){if(n.object===t&&e===n.tween.node&&i._startTime===n.tween._startTime)remove$1(n.tween);else if("object"==typeof t&&t&&n.object){for(let e in t)e in n.object&&(i._startTime===n.tween._startTime?delete n.object[e]:n.propNormaliseRequired=!0);Object.assign(n.object,t)}return n.object}return"object"==typeof t&&t?(Store[r]={tween:i,object:t,propNormaliseRequired:!1},Store[r].object):t}var NodeCache$1={Store:Store,default:NodeCache};class PlaybackPosition{constructor(){this.totalTime=0,this.labels=[],this.offsets=[]}parseLabel(e,t){const{offsets:i,labels:r}=this;let n=r.indexOf(e);if("string"==typeof e&&-1!==e.indexOf("=")&&!t&&-1===n){const i=e.substr(e.indexOf("=")-1,2),a=e.split(i);t=2===a.length?i+a[1]:null,e=a[0],n=r.indexOf(e)}if(-1!==n&&e){let e=i[n]||0;if("number"==typeof t)e=t;else if("string"==typeof t&&-1!==t.indexOf("=")){const i=t.charAt(0);t=+t.substr(2),"+"===i||"-"===i?e+=parseFloat(i+t):"*"===i?e*=t:"/"===i?e/=t:"%"===i&&(e*=t/100)}return e}return"number"==typeof t?t:0}addLabel(e,t){return this.labels.push(e),this.offsets.push(this.parseLabel(e,t)),this}setLabel(e,t){const i=this.labels.indexOf(e);return-1!==i&&this.offsets.splice(i,1,this.parseLabel(e,t)),this}eraseLabel(e){const t=this.labels.indexOf(e);return-1!==t&&(this.labels.splice(t,1),this.offsets.splice(t,1)),this}}var PlaybackPosition$1={default:PlaybackPosition};function Selector(e,t,i){return t?e?"undefined"!=typeof window&&e===window||"undefined"!=typeof document&&e===document?[e]:"string"==typeof e?!!document.querySelectorAll&&document.querySelectorAll(e):Array.isArray(e)?e:e.nodeType?[e]:i?e:[]:null:e?"undefined"!=typeof window&&e===window||"undefined"!=typeof document&&e===document?e:"string"==typeof e?!!document.querySelector&&document.querySelector(e):Array.isArray(e)?e[0]:e.nodeType?e:i?e:null:null}var selector={default:Selector};let _id=0;const defaultEasing=Easing.Linear.None;class Tween{static fromTo(e,t,i,r={}){r.quickRender=r.quickRender?r.quickRender:!i;const n=new Tween(e,t).to(i,r);return r.quickRender&&(n.render().update(n._startTime),n._rendered=!1,n._onStartCallbackFired=!1),n}static to(e,t,i){return Tween.fromTo(e,null,t,i)}static from(e,t,i){return Tween.fromTo(e,t,null,i)}constructor(e,t){return this.id=_id++,!e||"object"!=typeof e||t||e.nodeType?e&&(e.nodeType||e.length||"string"==typeof e)&&(e=this.node=Selector(e),t=this.object=NodeCache(e,t,this)):(t=this.object=e,e=null),this._valuesEnd=null,this._valuesStart=Array.isArray(t)?[]:{},this._duration=1e3,this._easingFunction=defaultEasing,this._easingReverse=defaultEasing,this._interpolationFunction=Interpolation.Linear,this._startTime=0,this._initTime=0,this._delayTime=0,this._repeat=0,this._r=0,this._isPlaying=!1,this._yoyo=!1,this._reversed=!1,this._onStartCallbackFired=!1,this._pausedTime=null,this._isFinite=!0,this._maxListener=15,this._chainedTweensCount=0,this._prevTime=null,this}setMaxListener(e=15){return this._maxListener=e,this}on(e,t){const{_maxListener:i}=this,r=e+EVENT_CALLBACK;for(let e=0;e<i;e++){const i=r+e;if(!this[i]){this[i]=t;break}}return this}once(e,t){const{_maxListener:i}=this,r=e+EVENT_CALLBACK;for(let e=0;e<i;e++){const i=r+e;if(!this[i]){this[i]=((...e)=>{t.apply(this,e),this[i]=null});break}}return this}off(e,t){const{_maxListener:i}=this,r=e+EVENT_CALLBACK;for(let e=0;e<i;e++){const i=r+e;this[i]===t&&(this[i]=null)}return this}emit(e,t,i,r){const{_maxListener:n}=this,a=e+EVENT_CALLBACK;if(!this[a+0])return this;for(let e=0;e<n;e++){const n=a+e;this[n]&&this[n](t,i,r)}return this}isPlaying(){return this._isPlaying}isStarted(){return this._onStartCallbackFired}reverse(e){const{_reversed:t}=this;return this._reversed=void 0!==e?e:!t,this}reversed(){return this._reversed}pause(){return this._isPlaying?(this._isPlaying=!1,remove$1(this),this._pausedTime=now(),this.emit(EVENT_PAUSE,this.object)):this}play(){return this._isPlaying?this:(this._isPlaying=!0,this._startTime+=now()-this._pausedTime,this._initTime=this._startTime,add$1(this),this._pausedTime=now(),this.emit(EVENT_PLAY,this.object))}restart(e){return this._repeat=this._r,this.reassignValues(),add$1(this),this.emit(EVENT_RESTART,this.object)}seek(e,t){const{_duration:i,_initTime:r,_startTime:n,_reversed:a}=this;let o=r+e;return this._isPlaying=!0,o<n&&n>=r&&(this._startTime-=i,this._reversed=!a),this.update(e,!1),this.emit(EVENT_SEEK,e,this.object),t?this:this.pause()}duration(e){return this._duration="function"==typeof e?e(this._duration):e,this}to(e,t=1e3,i){if(this._valuesEnd=e,"number"==typeof t||"function"==typeof t)this._duration="function"==typeof t?t(this._duration):t;else if("object"==typeof t)for(const e in t)if("function"==typeof this[e]){const[i=null,r=null,n=null,a=null]=Array.isArray(t[e])?t[e]:[t[e]];this[e](i,r,n,a)}return this}render(){if(this._rendered)return this;let{_valuesStart:e,_valuesEnd:t,object:i,node:r,InitialValues:n}=this;if(SET_NESTED(i),SET_NESTED(t),r&&r.queueID&&Store[r.queueID]){const e=Store[r.queueID];if(e.propNormaliseRequired&&e.tween!==this){for(const i in t)e.tween._valuesEnd[i];e.normalisedProp=!0,e.propNormaliseRequired=!1}}if(r&&n&&(i&&0!==Object.keys(i).length?t&&0!==Object.keys(t).length||(t=this._valuesEnd=n(r,i)):i=this.object=NodeCache(r,n(r,t),this)),!e.processed){for(const r in t){let n=i&&i[r]&&deepCopy(i[r]),a=t[r];if(!(Plugins[r]&&Plugins[r].init&&(Plugins[r].init.call(this,n,a,r,i),void 0===n&&e[r]&&(n=e[r]),Plugins[r].skipProcess))&&!("number"==typeof n&&isNaN(n)||null===n||null===a||!1===n||!1===a||void 0===n||void 0===a||n===a)){if(e[r]=n,Array.isArray(a))if(Array.isArray(n))a.isString&&i[r].isString&&!n.isString?n.isString=!0:decompose(r,i,e,t);else{a.unshift(n);for(let e=0,t=a.length;e<t;e++)"string"==typeof a[e]&&(a[e]=decomposeString(a[e]))}else decompose(r,i,e,t);"number"!=typeof n||"string"!=typeof a||a[1]}}e.processed=!0}return Tween.Renderer&&this.node&&Tween.Renderer.init&&(Tween.Renderer.init.call(this,i,e,t),this.__render=!0),this._rendered=!0,this}start(e){return this._startTime=void 0!==e?"string"==typeof e?now()+parseFloat(e):e:now(),this._startTime+=this._delayTime,this._initTime=this._prevTime=this._startTime,this._onStartCallbackFired=!1,this._rendered=!1,this._isPlaying=!0,add$1(this),this}stop(){let{_isPlaying:e,_isFinite:t,object:i,_startTime:r,_duration:n,_r:a,_yoyo:o,_reversed:s}=this;if(!e)return this;let l=t?1==(a+1)%2:!s;return this._reversed=!1,o&&l?this.update(r):this.update(r+n),remove$1(this),this.emit(EVENT_STOP,i)}delay(e){return this._delayTime="function"==typeof e?e(this._delayTime):e,this}chainedTweens(){if(this._chainedTweensCount=arguments.length,!this._chainedTweensCount)return this;for(let e=0,t=this._chainedTweensCount;e<t;e++)this[CHAINED_TWEENS+e]=arguments[e];return this}repeat(e){return this._repeat=this._duration?"function"==typeof e?e(this._repeat):e:0,this._r=this._repeat,this._isFinite=isFinite(e),this}reverseDelay(e){return this._reverseDelayTime="function"==typeof e?e(this._reverseDelayTime):e,this}yoyo(e,t){return this._yoyo="function"==typeof e?e(this._yoyo):null===e?this._yoyo:e,e||(this._reversed=!1),this._easingReverse=t||null,this}easing(e){return this._easingFunction=e,this}interpolation(e){return"function"==typeof e&&(this._interpolationFunction=e),this}reassignValues(e){const{_valuesStart:t,object:i,_delayTime:r}=this;this._isPlaying=!0,this._startTime=void 0!==e?e:now(),this._startTime+=r,this._reversed=!1,add$1(this);for(const e in t){const r=t[e];i[e]=r}return this}update(e,t,i){let r,n,a,{_onStartCallbackFired:o,_easingFunction:s,_interpolationFunction:l,_easingReverse:c,_repeat:h,_delayTime:u,_reverseDelayTime:d,_yoyo:p,_reversed:m,_startTime:f,_prevTime:g,_duration:v,_valuesStart:y,_valuesEnd:b,object:_,_isFinite:x,_isPlaying:w,__render:S,_chainedTweensCount:T}=this,A=0;if(v){let t=(e=void 0!==e?e:now())-g;if(this._prevTime=e,t>TOO_LONG_FRAME_MS&&isRunning()&&isLagSmoothing()&&(e-=t-FRAME_MS),!w||e<f&&!i)return!0;r=1<(r=(e-f)/v)?1:r,r=m?1-r:r}else r=1,h=0;if(o||(this._rendered||(this.render(),this._rendered=!0),this.emit(EVENT_START,_),this._onStartCallbackFired=!0),n=m&&c||s,!_)return!0;for(a in b){const e=y[a];if(!(void 0!==e&&null!==e||Plugins[a]&&Plugins[a].update))continue;const t=b[a],i=n[a]?n[a](r):"function"==typeof n?n(r):defaultEasing(r),o=l[a]?l[a]:"function"==typeof l?l:Interpolation.Linear;"number"==typeof t?_[a]=e+(t-e)*i:!Array.isArray(t)||t.isString||Array.isArray(e)?t&&t.update?t.update(i):"function"==typeof t?_[a]=t(i):"string"==typeof t&&"number"==typeof e?_[a]=e+parseFloat(t[0]+t.substr(2))*i:recompose(a,_,y,b,i,r):_[a]=o(t,i,_[a]),Plugins[a]&&Plugins[a].update&&Plugins[a].update.call(this,_[a],e,t,i,r,a),A++}if(!A)return remove$1(this),!1;if(S&&Tween.Renderer&&Tween.Renderer.update&&Tween.Renderer.update.call(this,_,r),this.emit(EVENT_UPDATE,_,r,e),1===r||m&&0===r){if(0<h&&0<v){if(x&&this._repeat--,p)this._reversed=!m;else for(a in b){let e=b[a];"string"==typeof e&&"number"==typeof y[a]&&(y[a]+=parseFloat(e[0]+e.substr(2)))}return this.emit(p&&!m?EVENT_REVERSE:EVENT_REPEAT,_),this._startTime=m&&d?e-d:e+u,!0}if(t||(this._isPlaying=!1,remove$1(this),_id--),this.emit(EVENT_COMPLETE,_),this._repeat=this._r,T)for(let t=0;t<T;t++)this[CHAINED_TWEENS+t].start(e+v);return!1}return!0}}var Tween$1={default:Tween};const shuffle=e=>{let t,i,r;for(r=e.length;r;r-=1)t=Math.floor(Math.random()*r),i=e[r-1],e[r-1]=e[t],e[t]=i;return e};let _id$1=0;class Timeline extends Tween{constructor(e){return super(),this._duration=0,this._startTime=e&&void 0!==e.startTime?e.startTime:now(),this._tweens=[],this.elapsed=0,this._id=_id$1++,this._defaultParams=e,this.position=new PlaybackPosition,this.position.addLabel("afterLast",this._duration),this.position.addLabel("afterInit",this._startTime),this._onStartCallbackFired=!1,this}mapTotal(e){return e.call(this,this._tweens),this}timingOrder(e){const t=e(this._tweens.map(e=>e._startTime));return this._tweens.map((e,i)=>{e._startTime=t[i]}),this}getTiming(e,t,i,r=0){if("reverse"===e){const{stagger:e}=i,n=(e||0)*(t.length-1);return t.map((t,i)=>n-(e||0)*i+r)}if("async"===e)return t.map(e=>r);if("sequence"===e||"delayed"===e){let{stagger:e}=i;return e||(e=(i.duration||1e3)/(t.length-1)),t.map((t,i)=>e*i+r)}if("oneByOne"===e)return t.map(e=>i.duration);if("shuffle"===e){const{stagger:e}=i;return shuffle(t.map((t,i)=>(e||0)*i+r))}{const{stagger:e}=i;return t.map((t,i)=>(e||0)*i+r)}}fromTo(e,t,i,r){if((e=Selector(e,!0,!0))&&e.length){this._defaultParams&&(r=r?{...this._defaultParams,...r}:this._defaultParams);const n=r.label,a="number"==typeof n?n:this.position.parseLabel(void 0!==n?n:"afterLast",null),o=this.getTiming(r.mode,e,r,a);for(let n,a=0,s=e.length;a<s;a++)n=e[a],this.add(Tween.fromTo(n,"function"==typeof t?t(a,e.length):"object"==typeof t&&t?{...t}:null,"function"==typeof i?i(a,e.length):i,"function"==typeof r?r(a,e.length):r),o[a])}return this.start()}from(e,t,i){return this.fromTo(e,t,null,i)}to(e,t,i){return this.fromTo(e,null,t,i)}addLabel(e,t){return this.position.addLabel(e,t),this}map(e){for(let t=0,i=this._tweens.length;t<i;t++){const i=this._tweens[t];e(i,t),this._duration=Math.max(this._duration,i._duration+i._startTime)}return this}add(e,t){if(Array.isArray(e))return e.map(e=>{this.add(e,t)}),this;"object"!=typeof e||e instanceof Tween||(e=new Tween(e.from).to(e.to,e));const{_defaultParams:i,_duration:r}=this;if(i)for(const t in i)"function"==typeof e[t]&&e[t](i[t]);const n="number"==typeof t?t:this.position.parseLabel(void 0!==t?t:"afterLast",null);return e._startTime=Math.max(this._startTime,e._delayTime,n),e._delayTime=n,e._isPlaying=!0,this._duration=Math.max(r,Math.max(e._startTime+e._delayTime,e._duration)),this._tweens.push(e),this.position.setLabel("afterLast",this._duration),this}restart(){return this._startTime+=now(),add$1(this),this.emit(EVENT_RESTART)}easing(e){return this.map(t=>t.easing(e))}interpolation(e){return this.map(t=>t.interpolation(e))}update(e){const{_tweens:t,_duration:i,_reverseDelayTime:r,_startTime:n,_reversed:a,_yoyo:o,_repeat:s,_isFinite:l,_isPlaying:c,_prevTime:h,_onStartCallbackFired:u}=this;let d,p=(e=void 0!==e?e:now())-h;if(this._prevTime=e,p>TOO_LONG_FRAME_MS&&isRunning()&&isLagSmoothing()&&(e-=p-FRAME_MS),!c||e<n)return!0;d=1<(d=(e-n)/i)?1:d,d=a?1-d:d,this.elapsed=d,u||(this.emit(EVENT_START),this._onStartCallbackFired=!0);const m=e-n,f=a?i-m:m;let g=0;for(;g<t.length;)t[g].update(f),g++;if(this.emit(EVENT_UPDATE,d,m),1===d||a&&0===d){if(s){for(l&&this._repeat--,this.emit(a?EVENT_REVERSE:EVENT_REPEAT),o&&(this._reversed=!a,this.timingOrder(e=>e.reverse())),this._startTime=a&&r?e+r:e,g=0;g<t.length;)t[g].reassignValues(e),g++;return!0}return this.emit(EVENT_COMPLETE),this._repeat=this._r,remove$1(this),this._isPlaying=!1,!1}return!0}progress(e){return void 0!==e?this.update(e*this._duration):this.elapsed}}var Timeline$1={shuffle:shuffle,default:Timeline},index={Plugins:Plugins,Selector:Selector,Interpolator:Interpolator,onTick:onTick,has:has,get:get$1,getAll:getAll,removeAll:removeAll,remove:remove$1,add:add$1,now:now,update:update,autoPlay:autoPlay,isRunning:isRunning,onRequestTick:onRequestTick,FrameThrottle:FrameThrottle,ToggleLagSmoothing:ToggleLagSmoothing,Tween:Tween,Timeline:Timeline,Easing:Easing,Interpolation:Interpolation,utils:constants},parser=function(){function e(t,i,r,n){this.message=t,this.expected=i,this.found=r,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i}(e,Error),{SyntaxError:e,parse:function(t){var i,r=1<arguments.length?arguments[1]:{},n={},a={start:Le},o=Le,s=function(e){return{type:"messageFormatPattern",elements:e,location:Ae()}},l=function(e){var t,i,r,n,a,o="";for(t=0,r=e.length;t<r;t+=1)for(i=0,a=(n=e[t]).length;i<a;i+=1)o+=n[i];return o},c=function(e){return{type:"messageTextElement",value:e,location:Ae()}},h=/^[^ \t\n\r,.+={}#]/,u={type:"class",value:"[^ \\t\\n\\r,.+={}#]",description:"[^ \\t\\n\\r,.+={}#]"},d="{",p={type:"literal",value:"{",description:'"{"'},m=",",f={type:"literal",value:",",description:'","'},g="}",v={type:"literal",value:"}",description:'"}"'},y=function(e,t){return{type:"argumentElement",id:e,format:t&&t[2],location:Ae()}},b="number",_={type:"literal",value:"number",description:'"number"'},x="date",w={type:"literal",value:"date",description:'"date"'},S="time",T={type:"literal",value:"time",description:'"time"'},A=function(e,t){return{type:e+"Format",style:t&&t[2],location:Ae()}},E="plural",C={type:"literal",value:"plural",description:'"plural"'},M=function(e){return{type:e.type,ordinal:!1,offset:e.offset||0,options:e.options,location:Ae()}},P="selectordinal",L={type:"literal",value:"selectordinal",description:'"selectordinal"'},I=function(e){return{type:e.type,ordinal:!0,offset:e.offset||0,options:e.options,location:Ae()}},B="select",R={type:"literal",value:"select",description:'"select"'},F=function(e){return{type:"selectFormat",options:e,location:Ae()}},O="=",k={type:"literal",value:"=",description:'"="'},D=function(e,t){return{type:"optionalFormatPattern",selector:e,value:t,location:Ae()}},N="offset:",z={type:"literal",value:"offset:",description:'"offset:"'},G=function(e){return e},U=function(e,t){return{type:"pluralFormat",offset:e,options:t,location:Ae()}},V={type:"other",description:"whitespace"},H=/^[ \t\n\r]/,$={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},j={type:"other",description:"optionalWhitespace"},W=/^[0-9]/,X={type:"class",value:"[0-9]",description:"[0-9]"},q=/^[0-9a-f]/i,Y={type:"class",value:"[0-9a-f]i",description:"[0-9a-f]i"},Q="0",K={type:"literal",value:"0",description:'"0"'},Z=/^[1-9]/,J={type:"class",value:"[1-9]",description:"[1-9]"},ee=function(e){return parseInt(e,10)},te=/^[^{}\\\0-\x1F \t\n\r]/,ie={type:"class",value:"[^{}\\\\\\0-\\x1F\\x7f \\t\\n\\r]",description:"[^{}\\\\\\0-\\x1F\\x7f \\t\\n\\r]"},re="\\\\",ne={type:"literal",value:"\\\\",description:'"\\\\\\\\"'},ae=function(){return"\\"},oe="\\#",se={type:"literal",value:"\\#",description:'"\\\\#"'},le=function(){return"\\#"},ce="\\{",he={type:"literal",value:"\\{",description:'"\\\\{"'},ue=function(){return"{"},de="\\}",pe={type:"literal",value:"\\}",description:'"\\\\}"'},me=function(){return"}"},fe="\\u",ge={type:"literal",value:"\\u",description:'"\\\\u"'},ve=function(e){return String.fromCharCode(parseInt(e,16))},ye=function(e){return e.join("")},be=0,_e=0,xe=[{line:1,column:1,seenCR:!1}],we=0,Se=[],Te=0;if("startRule"in r){if(!(r.startRule in a))throw new Error("Can't start parsing from rule \""+r.startRule+'".');o=a[r.startRule]}function Ae(){return Ce(_e,be)}function Ee(e){var i,r,n=xe[e];if(n)return n;for(i=e-1;!xe[i];)i--;for(n={line:(n=xe[i]).line,column:n.column,seenCR:n.seenCR};i<e;)"\n"===(r=t.charAt(i))?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1),i++;return xe[e]=n,n}function Ce(e,t){var i=Ee(e),r=Ee(t);return{start:{offset:e,line:i.line,column:i.column},end:{offset:t,line:r.line,column:r.column}}}function Me(e){be<we||(be>we&&(we=be,Se=[]),Se.push(e))}function Pe(t,i,r,n){return null!==i&&function(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}(i),new e(null!==t?t:function(e,t){var i,r=Array(e.length);for(i=0;i<e.length;i++)r[i]=e[i].description;return"Expected "+(1<e.length?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0])+" but "+(t?'"'+function(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}(t)+'"':"end of input")+" found."}(i,r),i,r,n)}function Le(){return Ie()}function Ie(){var e,t,i;for(e=be,t=[],i=Be();i!==n;)t.push(i),i=Be();return t!==n&&(_e=e,t=s(t)),e=t}function Be(){var e;return(e=function(){var e,i;return e=be,(i=function(){var e,i,r,a,o,s;if(e=be,i=[],r=be,(a=ke())!==n&&(o=Ue())!==n&&(s=ke())!==n?r=a=[a,o,s]:(be=r,r=n),r!==n)for(;r!==n;)i.push(r),r=be,(a=ke())!==n&&(o=Ue())!==n&&(s=ke())!==n?r=a=[a,o,s]:(be=r,r=n);else i=n;return i!==n&&(_e=e,i=l(i)),(e=i)===n&&(e=be,i=Oe(),e=i!==n?t.substring(e,be):i),e}())!==n&&(_e=e,i=c(i)),e=i}())===n&&(e=function(){var e,i,r,a,o,s,l;return e=be,123===t.charCodeAt(be)?(i=d,be++):(i=n,0===Te&&Me(p)),i!==n&&ke()!==n&&(r=function(){var e,i,r;if((e=ze())===n){if(e=be,i=[],h.test(t.charAt(be))?(r=t.charAt(be),be++):(r=n,0===Te&&Me(u)),r!==n)for(;r!==n;)i.push(r),h.test(t.charAt(be))?(r=t.charAt(be),be++):(r=n,0===Te&&Me(u));else i=n;e=i!==n?t.substring(e,be):i}return e}())!==n&&ke()!==n?(a=be,44===t.charCodeAt(be)?(o=m,be++):(o=n,0===Te&&Me(f)),o!==n&&(s=ke())!==n&&(l=function(){var e;return(e=function(){var e,i,r,a,o,s;return e=be,t.substr(be,6)===b?(i=b,be+=6):(i=n,0===Te&&Me(_)),i===n&&(t.substr(be,4)===x?(i=x,be+=4):(i=n,0===Te&&Me(w)),i===n&&(t.substr(be,4)===S?(i=S,be+=4):(i=n,0===Te&&Me(T)))),i!==n&&ke()!==n?(r=be,44===t.charCodeAt(be)?(a=m,be++):(a=n,0===Te&&Me(f)),a!==n&&(o=ke())!==n&&(s=Ue())!==n?r=a=[a,o,s]:(be=r,r=n),r===n&&(r=null),r!==n?(_e=e,i=A(i,r),e=i):(be=e,e=n)):(be=e,e=n),e}())===n&&(e=function(){var e,i,r,a;return e=be,t.substr(be,6)===E?(i=E,be+=6):(i=n,0===Te&&Me(C)),i!==n&&ke()!==n?(44===t.charCodeAt(be)?(r=m,be++):(r=n,0===Te&&Me(f)),r!==n&&ke()!==n&&(a=Fe())!==n?(_e=e,i=M(a),e=i):(be=e,e=n)):(be=e,e=n),e}())===n&&(e=function(){var e,i,r,a;return e=be,t.substr(be,13)===P?(i=P,be+=13):(i=n,0===Te&&Me(L)),i!==n&&ke()!==n?(44===t.charCodeAt(be)?(r=m,be++):(r=n,0===Te&&Me(f)),r!==n&&ke()!==n&&(a=Fe())!==n?(_e=e,i=I(a),e=i):(be=e,e=n)):(be=e,e=n),e}())===n&&(e=function(){var e,i,r,a,o;if(e=be,t.substr(be,6)===B?(i=B,be+=6):(i=n,0===Te&&Me(R)),i!==n)if(ke()!==n)if(44===t.charCodeAt(be)?(r=m,be++):(r=n,0===Te&&Me(f)),r!==n)if(ke()!==n){if(a=[],(o=Re())!==n)for(;o!==n;)a.push(o),o=Re();else a=n;a!==n?(_e=e,i=F(a),e=i):(be=e,e=n)}else be=e,e=n;else be=e,e=n;else be=e,e=n;else be=e,e=n;return e}()),e}())!==n?a=o=[o,s,l]:(be=a,a=n),a===n&&(a=null),a!==n&&(o=ke())!==n?(125===t.charCodeAt(be)?(s=g,be++):(s=n,0===Te&&Me(v)),s!==n?(_e=e,i=y(r,a),e=i):(be=e,e=n)):(be=e,e=n)):(be=e,e=n),e}()),e}function Re(){var e,i,r,a,o;return e=be,ke()!==n&&(i=function(){var e,i,r,a;return e=be,i=be,61===t.charCodeAt(be)?(r=O,be++):(r=n,0===Te&&Me(k)),r!==n&&(a=ze())!==n?i=r=[r,a]:(be=i,i=n),(e=i!==n?t.substring(e,be):i)===n&&(e=Ue()),e}())!==n&&ke()!==n?(123===t.charCodeAt(be)?(r=d,be++):(r=n,0===Te&&Me(p)),r!==n&&ke()!==n&&(a=Ie())!==n&&ke()!==n?(125===t.charCodeAt(be)?(o=g,be++):(o=n,0===Te&&Me(v)),o!==n?(_e=e,e=D(i,a)):(be=e,e=n)):(be=e,e=n)):(be=e,e=n),e}function Fe(){var e,i,r,a;if(e=be,(i=function(){var e,i,r;return e=be,t.substr(be,7)===N?(i=N,be+=7):(i=n,0===Te&&Me(z)),i!==n&&ke()!==n&&(r=ze())!==n?(_e=e,e=i=G(r)):(be=e,e=n),e}())===n&&(i=null),i!==n)if(ke()!==n){if(r=[],(a=Re())!==n)for(;a!==n;)r.push(a),a=Re();else r=n;r!==n?(_e=e,e=i=U(i,r)):(be=e,e=n)}else be=e,e=n;else be=e,e=n;return e}function Oe(){var e,i;if(Te++,e=[],H.test(t.charAt(be))?(i=t.charAt(be),be++):(i=n,0===Te&&Me($)),i!==n)for(;i!==n;)e.push(i),H.test(t.charAt(be))?(i=t.charAt(be),be++):(i=n,0===Te&&Me($));else e=n;return Te--,e===n&&(i=n,0===Te&&Me(V)),e}function ke(){var e,i,r;for(Te++,e=be,i=[],r=Oe();r!==n;)i.push(r),r=Oe();return e=i!==n?t.substring(e,be):i,Te--,e===n&&(i=n,0===Te&&Me(j)),e}function De(){var e;return W.test(t.charAt(be))?(e=t.charAt(be),be++):(e=n,0===Te&&Me(X)),e}function Ne(){var e;return q.test(t.charAt(be))?(e=t.charAt(be),be++):(e=n,0===Te&&Me(Y)),e}function ze(){var e,i,r,a,o,s;if(e=be,48===t.charCodeAt(be)?(i=Q,be++):(i=n,0===Te&&Me(K)),i===n){if(i=be,r=be,Z.test(t.charAt(be))?(a=t.charAt(be),be++):(a=n,0===Te&&Me(J)),a!==n){for(o=[],s=De();s!==n;)o.push(s),s=De();o!==n?r=a=[a,o]:(be=r,r=n)}else be=r,r=n;i=r!==n?t.substring(i,be):r}return i!==n&&(_e=e,i=ee(i)),e=i}function Ge(){var e,i,r,a,o,s,l,c;return te.test(t.charAt(be))?(e=t.charAt(be),be++):(e=n,0===Te&&Me(ie)),e===n&&(e=be,t.substr(be,2)===re?(i=re,be+=2):(i=n,0===Te&&Me(ne)),i!==n&&(_e=e,i=ae()),(e=i)===n&&(e=be,t.substr(be,2)===oe?(i=oe,be+=2):(i=n,0===Te&&Me(se)),i!==n&&(_e=e,i=le()),(e=i)===n&&(e=be,t.substr(be,2)===ce?(i=ce,be+=2):(i=n,0===Te&&Me(he)),i!==n&&(_e=e,i=ue()),(e=i)===n&&(e=be,t.substr(be,2)===de?(i=de,be+=2):(i=n,0===Te&&Me(pe)),i!==n&&(_e=e,i=me()),(e=i)===n&&(e=be,t.substr(be,2)===fe?(i=fe,be+=2):(i=n,0===Te&&Me(ge)),i!==n?(r=be,a=be,(o=Ne())!==n&&(s=Ne())!==n&&(l=Ne())!==n&&(c=Ne())!==n?a=o=[o,s,l,c]:(be=a,a=n),(r=a!==n?t.substring(r,be):a)!==n?(_e=e,e=i=ve(r)):(be=e,e=n)):(be=e,e=n)))))),e}function Ue(){var e,t,i;if(e=be,t=[],(i=Ge())!==n)for(;i!==n;)t.push(i),i=Ge();else t=n;return t!==n&&(_e=e,t=ye(t)),e=t}if((i=o())!==n&&be===t.length)return i;throw i!==n&&be<t.length&&Me({type:"end",description:"end of input"}),Pe(null,Se,we<t.length?t.charAt(we):null,we<t.length?Ce(we,we+1):Ce(we,we))}}}(),parser$1={default:parser};function Compiler(e,t,i){this.locales=e,this.formats=t,this.pluralFn=i}function StringFormat(e){this.id=e}function PluralFormat(e,t,i,r,n){this.id=e,this.useOrdinal=t,this.offset=i,this.options=r,this.pluralFn=n}function PluralOffsetString(e,t,i,r){this.id=e,this.offset=t,this.numberFormat=i,this.string=r}function SelectFormat(e,t){this.id=e,this.options=t}Compiler.prototype.compile=function(e){return this.pluralStack=[],this.currentPlural=null,this.pluralNumberFormat=null,this.compileMessage(e)},Compiler.prototype.compileMessage=function(e){if(!e||"messageFormatPattern"!==e.type)throw new Error('Message AST is not of type: "messageFormatPattern"');var t,i,r,n=e.elements,a=[];for(t=0,i=n.length;t<i;t+=1)switch((r=n[t]).type){case"messageTextElement":a.push(this.compileMessageText(r));break;case"argumentElement":a.push(this.compileArgument(r));break;default:throw new Error("Message element does not have a valid type")}return a},Compiler.prototype.compileMessageText=function(e){return this.currentPlural&&/(^|[^\\])#/g.test(e.value)?(this.pluralNumberFormat||(this.pluralNumberFormat=new Intl.NumberFormat(this.locales)),new PluralOffsetString(this.currentPlural.id,this.currentPlural.format.offset,this.pluralNumberFormat,e.value)):e.value.replace(/\\#/g,"#")},Compiler.prototype.compileArgument=function(e){var t=e.format;if(!t)return new StringFormat(e.id);var i,r=this.formats,n=this.locales,a=this.pluralFn;switch(t.type){case"numberFormat":return i=r.number[t.style],{id:e.id,format:new Intl.NumberFormat(n,i).format};case"dateFormat":return i=r.date[t.style],{id:e.id,format:new Intl.DateTimeFormat(n,i).format};case"timeFormat":return i=r.time[t.style],{id:e.id,format:new Intl.DateTimeFormat(n,i).format};case"pluralFormat":return i=this.compileOptions(e),new PluralFormat(e.id,t.ordinal,t.offset,i,a);case"selectFormat":return i=this.compileOptions(e),new SelectFormat(e.id,i);default:throw new Error("Message element does not have a valid format type")}},Compiler.prototype.compileOptions=function(e){var t,i,r,n=e.format,a=n.options,o={};for(this.pluralStack.push(this.currentPlural),this.currentPlural="pluralFormat"===n.type?e:null,t=0,i=a.length;t<i;t+=1)o[(r=a[t]).selector]=this.compileMessage(r.value);return this.currentPlural=this.pluralStack.pop(),o},StringFormat.prototype.format=function(e){return e||"number"==typeof e?"string"==typeof e?e:e+"":""},PluralFormat.prototype.getOption=function(e){var t=this.options;return t["="+e]||t[this.pluralFn(e-this.offset,this.useOrdinal)]||t.other},PluralOffsetString.prototype.format=function(e){var t=this.numberFormat.format(e-this.offset);return this.string.replace(/(^|[^\\])#/g,"$1"+t).replace(/\\#/g,"#")},SelectFormat.prototype.getOption=function(e){var t=this.options;return t[e]||t.other};var compiler={default:Compiler},hop=Object.prototype.hasOwnProperty;function extend(e){var t,i,r,n,a=Array.prototype.slice.call(arguments,1);for(t=0,i=a.length;t<i;t+=1)if(r=a[t])for(n in r)hop.call(r,n)&&(e[n]=r[n]);return e}var utils={hop:hop,extend:extend},realDefineProp=function(){try{return!!Object.defineProperty({},"a",{})}catch(e){return!1}}(),es3=!realDefineProp&&!Object.prototype.__defineGetter__,defineProperty=realDefineProp?Object.defineProperty:function(e,t,i){"get"in i&&e.__defineGetter__?e.__defineGetter__(t,i.get):(!hop.call(e,t)||"value"in i)&&(e[t]=i.value)},objCreate=Object.create||function(e,t){var i,r;function n(){}for(r in n.prototype=e,i=new n,t)hop.call(t,r)&&defineProperty(i,r,t[r]);return i},es5={defineProperty:defineProperty,objCreate:objCreate};function MessageFormat(e,t,i){var r="string"==typeof e?MessageFormat.__parse(e):e;if(!r||"messageFormatPattern"!==r.type)throw new TypeError("A message must be provided as a String or AST.");i=this._mergeFormats(MessageFormat.formats,i),defineProperty(this,"_locale",{value:this._resolveLocale(t)});var n=this._findPluralRuleFunction(this._locale),a=this._compilePattern(r,t,i,n),o=this;this.format=function(t){try{return o._format(a,t)}catch(t){throw t.variableId?new Error("The intl string context variable '"+t.variableId+"' was not provided to the string '"+e+"'"):t}}}defineProperty(MessageFormat,"formats",{enumerable:!0,value:{number:{currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}}}),defineProperty(MessageFormat,"__localeData__",{value:objCreate(null)}),defineProperty(MessageFormat,"__addLocaleData",{value:function(e){if(!e||!e.locale)throw new Error("Locale data provided to IntlMessageFormat is missing a `locale` property");MessageFormat.__localeData__[e.locale.toLowerCase()]=e}}),defineProperty(MessageFormat,"__parse",{value:parser.parse}),defineProperty(MessageFormat,"defaultLocale",{enumerable:!0,writable:!0,value:void 0}),MessageFormat.prototype.resolvedOptions=function(){return{locale:this._locale}},MessageFormat.prototype._compilePattern=function(e,t,i,r){return new Compiler(t,i,r).compile(e)},MessageFormat.prototype._findPluralRuleFunction=function(e){for(var t=MessageFormat.__localeData__,i=t[e.toLowerCase()];i;){if(i.pluralRuleFunction)return i.pluralRuleFunction;i=i.parentLocale&&t[i.parentLocale.toLowerCase()]}throw new Error("Locale data added to IntlMessageFormat is missing a `pluralRuleFunction` for :"+e)},MessageFormat.prototype._format=function(e,t){var i,r,n,a,o,s,l="";for(i=0,r=e.length;i<r;i+=1)if("string"!=typeof(n=e[i])){if(a=n.id,!t||!hop.call(t,a))throw(s=new Error("A value must be provided for: "+a)).variableId=a,s;o=t[a],n.options?l+=this._format(n.getOption(o),t):l+=n.format(o)}else l+=n;return l},MessageFormat.prototype._mergeFormats=function(e,t){var i,r,n={};for(i in e)hop.call(e,i)&&(n[i]=r=objCreate(e[i]),t&&hop.call(t,i)&&extend(r,t[i]));return n},MessageFormat.prototype._resolveLocale=function(e){"string"==typeof e&&(e=[e]),e=(e||[]).concat(MessageFormat.defaultLocale);var t,i,r,n,a=MessageFormat.__localeData__;for(t=0,i=e.length;t<i;t+=1)for(r=e[t].toLowerCase().split("-");r.length;){if(n=a[r.join("-")])return n.locale;r.pop()}var o=e.pop();throw new Error("No locale data has been added to IntlMessageFormat for: "+e.join(", ")+", or the default locale: "+o)};var core$1={default:MessageFormat},defaultLocale={locale:"en",pluralRuleFunction:function(e,t){var i=(e+"").split("."),r=!i[1],n=+i[0]==e,a=n&&i[0].slice(-1),o=n&&i[0].slice(-2);return t?1==a&&11!=o?"one":2==a&&12!=o?"two":3==a&&13!=o?"few":"other":1==e&&r?"one":"other"}},en={default:defaultLocale};MessageFormat.__addLocaleData(defaultLocale),MessageFormat.defaultLocale="en";var main={default:MessageFormat};const supportsAdoptingStyleSheets="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,constructionToken=Symbol();class CSSResult{constructor(e,t){if(t!==constructionToken)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(supportsAdoptingStyleSheets?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const unsafeCSS=e=>new CSSResult(e+"",constructionToken),textFromCSSResult=e=>{if(e instanceof CSSResult)return e.cssText;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)},css=(e,...t)=>{const i=t.reduce((t,i,r)=>t+textFromCSSResult(i)+e[r+1],e[0]);return new CSSResult(i,constructionToken)};var cssTag={supportsAdoptingStyleSheets:supportsAdoptingStyleSheets,CSSResult:CSSResult,unsafeCSS:unsafeCSS,css:css};const legacyCustomElement=(e,t)=>(window.customElements.define(e,t),t),standardCustomElement=(e,t)=>{const{kind:i,elements:r}=t;return{kind:i,elements:r,finisher(t){window.customElements.define(e,t)}}},customElement=e=>t=>"function"==typeof t?legacyCustomElement(e,t):standardCustomElement(e,t),standardProperty=(e,t)=>"method"!==t.kind||!t.descriptor||"value"in t.descriptor?{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(i){i.createProperty(t.key,e)}}:Object.assign({},t,{finisher(i){i.createProperty(t.key,e)}}),legacyProperty=(e,t,i)=>{t.constructor.createProperty(i,e)};function property(e){return(t,i)=>void 0!==i?legacyProperty(e,t,i):standardProperty(e,t)}function query(e){return(t,i)=>{const r={get(){return this.renderRoot.querySelector(e)},enumerable:!0,configurable:!0};return void 0!==i?legacyQuery(r,t,i):standardQuery(r,t)}}function queryAll(e){return(t,i)=>{const r={get(){return this.renderRoot.querySelectorAll(e)},enumerable:!0,configurable:!0};return void 0!==i?legacyQuery(r,t,i):standardQuery(r,t)}}const legacyQuery=(e,t,i)=>{Object.defineProperty(t,i,e)},standardQuery=(e,t)=>({kind:"method",placement:"prototype",key:t.key,descriptor:e}),standardEventOptions=(e,t)=>Object.assign({},t,{finisher(i){Object.assign(i.prototype[t.key],e)}}),legacyEventOptions=(e,t,i)=>{Object.assign(t[i],e)},eventOptions=e=>(t,i)=>void 0!==i?legacyEventOptions(e,t,i):standardEventOptions(e,t);var decorators={customElement:customElement,property:property,query:query,queryAll:queryAll,eventOptions:eventOptions};window.JSCompiler_renameProperty=((e,t)=>e);const defaultConverter={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:+e;case Object:case Array:return JSON.parse(e)}return e}},notEqual=(e,t)=>t!==e&&(t==t||e==e),defaultPropertyDeclaration={attribute:!0,type:String,converter:defaultConverter,reflect:!1,hasChanged:notEqual},microtaskPromise=Promise.resolve(!0),STATE_HAS_UPDATED=1,STATE_UPDATE_REQUESTED=4,STATE_IS_REFLECTING_TO_ATTRIBUTE=8,STATE_IS_REFLECTING_TO_PROPERTY=16,STATE_HAS_CONNECTED=32;class UpdatingElement extends HTMLElement{constructor(){super(),this._updateState=0,this._instanceProperties=void 0,this._updatePromise=microtaskPromise,this._hasConnectedResolver=void 0,this._changedProperties=new Map,this._reflectingProperties=void 0,this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((t,i)=>{const r=this._attributeNameForProperty(i,t);void 0!==r&&(this._attributeToPropertyMap.set(r,i),e.push(r))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach((e,t)=>this._classProperties.set(t,e))}}static createProperty(e,t=defaultPropertyDeclaration){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const i="symbol"==typeof e?Symbol():`__${e}`;Object.defineProperty(this.prototype,e,{get(){return this[i]},set(t){const r=this[e];this[i]=t,this._requestUpdate(e,r)},configurable:!0,enumerable:!0})}static finalize(){if(this.hasOwnProperty(JSCompiler_renameProperty("finalized",this))&&this.finalized)return;const e=Object.getPrototypeOf(this);if("function"==typeof e.finalize&&e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const i of t)this.createProperty(i,e[i])}}static _attributeNameForProperty(e,t){const i=t.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,i=notEqual){return i(e,t)}static _propertyValueFromAttribute(e,t){const i=t.type,r=t.converter||defaultConverter,n="function"==typeof r?r:r.fromAttribute;return n?n(e,i):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const i=t.type,r=t.converter;return(r&&r.toAttribute||defaultConverter.toAttribute)(e,i)}initialize(){this._saveInstanceProperties(),this._requestUpdate()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,t)=>this[t]=e),this._instanceProperties=void 0}connectedCallback(){this._updateState=this._updateState|STATE_HAS_CONNECTED,this._hasConnectedResolver&&(this._hasConnectedResolver(),this._hasConnectedResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,i){t!==i&&this._attributeToProperty(e,i)}_propertyToAttribute(e,t,i=defaultPropertyDeclaration){const r=this.constructor,n=r._attributeNameForProperty(e,i);if(void 0!==n){const e=r._propertyValueToAttribute(t,i);if(void 0===e)return;this._updateState=this._updateState|STATE_IS_REFLECTING_TO_ATTRIBUTE,null==e?this.removeAttribute(n):this.setAttribute(n,e),this._updateState=this._updateState&~STATE_IS_REFLECTING_TO_ATTRIBUTE}}_attributeToProperty(e,t){if(this._updateState&STATE_IS_REFLECTING_TO_ATTRIBUTE)return;const i=this.constructor,r=i._attributeToPropertyMap.get(e);if(void 0!==r){const e=i._classProperties.get(r)||defaultPropertyDeclaration;this._updateState=this._updateState|STATE_IS_REFLECTING_TO_PROPERTY,this[r]=i._propertyValueFromAttribute(t,e),this._updateState=this._updateState&~STATE_IS_REFLECTING_TO_PROPERTY}}_requestUpdate(e,t){let i=!0;if(void 0!==e){const r=this.constructor,n=r._classProperties.get(e)||defaultPropertyDeclaration;r._valueHasChanged(this[e],t,n.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==n.reflect||this._updateState&STATE_IS_REFLECTING_TO_PROPERTY||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,n))):i=!1}!this._hasRequestedUpdate&&i&&this._enqueueUpdate()}requestUpdate(e,t){return this._requestUpdate(e,t),this.updateComplete}async _enqueueUpdate(){let e,t;this._updateState=this._updateState|STATE_UPDATE_REQUESTED;const i=this._updatePromise;this._updatePromise=new Promise((i,r)=>{e=i,t=r});try{await i}catch(e){}this._hasConnected||await new Promise(e=>this._hasConnectedResolver=e);try{const e=this.performUpdate();null!=e&&await e}catch(e){t(e)}e(!this._hasRequestedUpdate)}get _hasConnected(){return this._updateState&STATE_HAS_CONNECTED}get _hasRequestedUpdate(){return this._updateState&STATE_UPDATE_REQUESTED}get hasUpdated(){return this._updateState&STATE_HAS_UPDATED}performUpdate(){this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{(e=this.shouldUpdate(t))&&this.update(t)}catch(t){throw e=!1,t}finally{this._markUpdated()}e&&(this._updateState&STATE_HAS_UPDATED||(this._updateState=this._updateState|STATE_HAS_UPDATED,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=this._updateState&~STATE_UPDATE_REQUESTED}get updateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&0<this._reflectingProperties.size&&(this._reflectingProperties.forEach((e,t)=>this._propertyToAttribute(t,this[t],e)),this._reflectingProperties=void 0)}updated(e){}firstUpdated(e){}}UpdatingElement.finalized=!0;var updatingElement={defaultConverter:defaultConverter,notEqual:notEqual,UpdatingElement:UpdatingElement};const directives=new WeakMap,directive=e=>(...t)=>{const i=e(...t);return directives.set(i,!0),i},isDirective=e=>"function"==typeof e&&directives.has(e);var directive$1={directive:directive,isDirective:isDirective};const isCEPolyfill=void 0!==window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,reparentNodes=(e,t,i=null,r=null)=>{let n=t;for(;n!==i;){const t=n.nextSibling;e.insertBefore(n,r),n=t}},removeNodes=(e,t,i=null)=>{let r=t;for(;r!==i;){const t=r.nextSibling;e.removeChild(r),r=t}};var dom$1={isCEPolyfill:isCEPolyfill,reparentNodes:reparentNodes,removeNodes:removeNodes};const noChange={},nothing={};var part={noChange:noChange,nothing:nothing};const marker=`{{lit-${(Math.random()+"").slice(2)}}}`,nodeMarker=`\x3c!--${marker}--\x3e`,markerRegex=new RegExp(`${marker}|${nodeMarker}`),boundAttributeSuffix="$lit$";class Template{constructor(e,t){this.parts=[],this.element=t;let i=-1,r=0;const n=[],a=t=>{const o=t.content,s=document.createTreeWalker(o,133,null,!1);let l=0;for(;s.nextNode();){i++;const t=s.currentNode;if(1===t.nodeType){if(t.hasAttributes()){const n=t.attributes;let a=0;for(let e=0;e<n.length;e++)0<=n[e].value.indexOf(marker)&&a++;for(;0<a--;){const n=e.strings[r],a=lastAttributeNameRegex.exec(n)[2],o=a.toLowerCase()+boundAttributeSuffix,s=t.getAttribute(o).split(markerRegex);this.parts.push({type:"attribute",index:i,name:a,strings:s}),t.removeAttribute(o),r+=s.length-1}}"TEMPLATE"===t.tagName&&a(t)}else if(3===t.nodeType){const e=t.data;if(0<=e.indexOf(marker)){const a=t.parentNode,o=e.split(markerRegex),s=o.length-1;for(let e=0;e<s;e++)a.insertBefore(""===o[e]?createMarker():document.createTextNode(o[e]),t),this.parts.push({type:"node",index:++i});""===o[s]?(a.insertBefore(createMarker(),t),n.push(t)):t.data=o[s],r+=s}}else if(8===t.nodeType)if(t.data===marker){const e=t.parentNode;null!==t.previousSibling&&i!==l||(i++,e.insertBefore(createMarker(),t)),l=i,this.parts.push({type:"node",index:i}),null===t.nextSibling?t.data="":(n.push(t),i--),r++}else{let e=-1;for(;-1!==(e=t.data.indexOf(marker,e+1));)this.parts.push({type:"node",index:-1})}}};a(t);for(const e of n)e.parentNode.removeChild(e)}}const isTemplatePartActive=e=>-1!==e.index,createMarker=()=>document.createComment(""),lastAttributeNameRegex=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F \x09\x0a\x0c\x0d"'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;var template$d={marker:marker,nodeMarker:nodeMarker,markerRegex:markerRegex,boundAttributeSuffix:boundAttributeSuffix,Template:Template,isTemplatePartActive:isTemplatePartActive,createMarker:createMarker,lastAttributeNameRegex:lastAttributeNameRegex};class TemplateInstance{constructor(e,t,i){this._parts=[],this.template=e,this.processor=t,this.options=i}update(e){let t=0;for(const i of this._parts)void 0!==i&&i.setValue(e[t]),t++;for(const e of this._parts)void 0!==e&&e.commit()}_clone(){const e=isCEPolyfill?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=this.template.parts;let i=0,r=0;const n=e=>{const a=document.createTreeWalker(e,133,null,!1);let o=a.nextNode();for(;i<t.length&&null!==o;){const e=t[i];if(isTemplatePartActive(e))if(r===e.index){if("node"===e.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(o.previousSibling),this._parts.push(e)}else this._parts.push(...this.processor.handleAttributeExpressions(o,e.name,e.strings,this.options));i++}else r++,"TEMPLATE"===o.nodeName&&n(o.content),o=a.nextNode();else this._parts.push(void 0),i++}};return n(e),isCEPolyfill&&(document.adoptNode(e),customElements.upgrade(e)),e}}var templateInstance={TemplateInstance:TemplateInstance};class TemplateResult{constructor(e,t,i,r){this.strings=e,this.values=t,this.type=i,this.processor=r}getHTML(){const e=this.strings.length-1;let t="";for(let i=0;i<e;i++){const e=this.strings[i],r=lastAttributeNameRegex.exec(e);t+=r?e.substr(0,r.index)+r[1]+r[2]+boundAttributeSuffix+r[3]+marker:e+nodeMarker}return t+this.strings[e]}getTemplateElement(){const e=document.createElement("template");return e.innerHTML=this.getHTML(),e}}class SVGTemplateResult extends TemplateResult{getHTML(){return`<svg>${super.getHTML()}</svg>`}getTemplateElement(){const e=super.getTemplateElement(),t=e.content,i=t.firstChild;return t.removeChild(i),reparentNodes(t,i.firstChild),e}}var templateResult={TemplateResult:TemplateResult,SVGTemplateResult:SVGTemplateResult};const isPrimitive=e=>null===e||!("object"==typeof e||"function"==typeof e);class AttributeCommitter{constructor(e,t,i){this.dirty=!0,this.element=e,this.name=t,this.strings=i,this.parts=[];for(let e=0;e<i.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new AttributePart(this)}_getValue(){const e=this.strings,t=e.length-1;let i="";for(let r=0;r<t;r++){i+=e[r];const t=this.parts[r];if(void 0!==t){const e=t.value;if(null!=e&&(Array.isArray(e)||"string"!=typeof e&&e[Symbol.iterator]))for(const t of e)i+="string"==typeof t?t:t+"";else i+="string"==typeof e?e:e+""}}return i+=e[t]}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class AttributePart{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===noChange||isPrimitive(e)&&e===this.value||(this.value=e,isDirective(e)||(this.committer.dirty=!0))}commit(){for(;isDirective(this.value);){const e=this.value;this.value=noChange,e(this)}this.value!==noChange&&this.committer.commit()}}class NodePart{constructor(e){this.value=void 0,this._pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(createMarker()),this.endNode=e.appendChild(createMarker())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e._insert(this.startNode=createMarker()),e._insert(this.endNode=createMarker())}insertAfterPart(e){e._insert(this.startNode=createMarker()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this._pendingValue=e}commit(){for(;isDirective(this._pendingValue);){const e=this._pendingValue;this._pendingValue=noChange,e(this)}const e=this._pendingValue;e!==noChange&&(isPrimitive(e)?e!==this.value&&this._commitText(e):e instanceof TemplateResult?this._commitTemplateResult(e):e instanceof Node?this._commitNode(e):Array.isArray(e)||e[Symbol.iterator]?this._commitIterable(e):e===nothing?(this.value=nothing,this.clear()):this._commitText(e))}_insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}_commitNode(e){this.value!==e&&(this.clear(),this._insert(e),this.value=e)}_commitText(e){const t=this.startNode.nextSibling;e=null==e?"":e,t===this.endNode.previousSibling&&3===t.nodeType?t.data=e:this._commitNode(document.createTextNode("string"==typeof e?e:e+"")),this.value=e}_commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof TemplateInstance&&this.value.template===t)this.value.update(e.values);else{const i=new TemplateInstance(t,e.processor,this.options),r=i._clone();i.update(e.values),this._commitNode(r),this.value=i}}_commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let i,r=0;for(const n of e)void 0===(i=t[r])&&(i=new NodePart(this.options),t.push(i),0===r?i.appendIntoPart(this):i.insertAfterPart(t[r-1])),i.setValue(n),i.commit(),r++;r<t.length&&(t.length=r,this.clear(i&&i.endNode))}clear(e=this.startNode){removeNodes(this.startNode.parentNode,e.nextSibling,this.endNode)}}class BooleanAttributePart{constructor(e,t,i){if(this.value=void 0,this._pendingValue=void 0,2!==i.length||""!==i[0]||""!==i[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=i}setValue(e){this._pendingValue=e}commit(){for(;isDirective(this._pendingValue);){const e=this._pendingValue;this._pendingValue=noChange,e(this)}if(this._pendingValue===noChange)return;const e=!!this._pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name)),this.value=e,this._pendingValue=noChange}}class PropertyCommitter extends AttributeCommitter{constructor(e,t,i){super(e,t,i),this.single=2===i.length&&""===i[0]&&""===i[1]}_createPart(){return new PropertyPart(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class PropertyPart extends AttributePart{}let eventOptionsSupported=!1;try{const e={get capture(){return eventOptionsSupported=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}class EventPart{constructor(e,t,i){this.value=void 0,this._pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=i,this._boundHandleEvent=(e=>this.handleEvent(e))}setValue(e){this._pendingValue=e}commit(){for(;isDirective(this._pendingValue);){const e=this._pendingValue;this._pendingValue=noChange,e(this)}if(this._pendingValue===noChange)return;const e=this._pendingValue,t=this.value,i=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),r=null!=e&&(null==t||i);i&&this.element.removeEventListener(this.eventName,this._boundHandleEvent,this._options),r&&(this._options=getOptions(e),this.element.addEventListener(this.eventName,this._boundHandleEvent,this._options)),this.value=e,this._pendingValue=noChange}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const getOptions=e=>e&&(eventOptionsSupported?{capture:e.capture,passive:e.passive,once:e.once}:e.capture);var parts={isPrimitive:isPrimitive,AttributeCommitter:AttributeCommitter,AttributePart:AttributePart,NodePart:NodePart,BooleanAttributePart:BooleanAttributePart,PropertyCommitter:PropertyCommitter,PropertyPart:PropertyPart,EventPart:EventPart};class DefaultTemplateProcessor{handleAttributeExpressions(e,t,i,r){const n=t[0];if("."===n){return new PropertyCommitter(e,t.slice(1),i).parts}return"@"===n?[new EventPart(e,t.slice(1),r.eventContext)]:"?"===n?[new BooleanAttributePart(e,t.slice(1),i)]:new AttributeCommitter(e,t,i).parts}handleTextExpression(e){return new NodePart(e)}}const defaultTemplateProcessor=new DefaultTemplateProcessor;var defaultTemplateProcessor$1={DefaultTemplateProcessor:DefaultTemplateProcessor,defaultTemplateProcessor:defaultTemplateProcessor};function templateFactory(e){let t=templateCaches.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},templateCaches.set(e.type,t));let i=t.stringsArray.get(e.strings);if(void 0!==i)return i;const r=e.strings.join(marker);return void 0===(i=t.keyString.get(r))&&(i=new Template(e,e.getTemplateElement()),t.keyString.set(r,i)),t.stringsArray.set(e.strings,i),i}const templateCaches=new Map;var templateFactory$1={templateFactory:templateFactory,templateCaches:templateCaches};const parts$1=new WeakMap,render=(e,t,i)=>{let r=parts$1.get(t);void 0===r&&(removeNodes(t,t.firstChild),parts$1.set(t,r=new NodePart(Object.assign({templateFactory:templateFactory},i))),r.appendInto(t)),r.setValue(e),r.commit()};var render$1={parts:parts$1,render:render};(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.0.0");const html$1=(e,...t)=>new TemplateResult(e,t,"html",defaultTemplateProcessor),svg=(e,...t)=>new SVGTemplateResult(e,t,"svg",defaultTemplateProcessor);var litHtml={html:html$1,svg:svg,DefaultTemplateProcessor:DefaultTemplateProcessor,defaultTemplateProcessor:defaultTemplateProcessor,directive:directive,isDirective:isDirective,removeNodes:removeNodes,reparentNodes:reparentNodes,noChange:noChange,nothing:nothing,AttributeCommitter:AttributeCommitter,AttributePart:AttributePart,BooleanAttributePart:BooleanAttributePart,EventPart:EventPart,isPrimitive:isPrimitive,NodePart:NodePart,PropertyCommitter:PropertyCommitter,PropertyPart:PropertyPart,parts:parts$1,render:render,templateCaches:templateCaches,templateFactory:templateFactory,TemplateInstance:TemplateInstance,SVGTemplateResult:SVGTemplateResult,TemplateResult:TemplateResult,createMarker:createMarker,isTemplatePartActive:isTemplatePartActive,Template:Template};const walkerNodeFilter=133;function removeNodesFromTemplate(e,t){const{element:{content:i},parts:r}=e,n=document.createTreeWalker(i,walkerNodeFilter,null,!1);let a=nextActiveIndexInTemplateParts(r),o=r[a],s=-1,l=0;const c=[];let h=null;for(;n.nextNode();){s++;const e=n.currentNode;for(e.previousSibling===h&&(h=null),t.has(e)&&(c.push(e),null===h&&(h=e)),null!==h&&l++;void 0!==o&&o.index===s;)o.index=null!==h?-1:o.index-l,o=r[a=nextActiveIndexInTemplateParts(r,a)]}c.forEach(e=>e.parentNode.removeChild(e))}const countNodes=e=>{let t=11===e.nodeType?0:1;const i=document.createTreeWalker(e,walkerNodeFilter,null,!1);for(;i.nextNode();)t++;return t},nextActiveIndexInTemplateParts=(e,t=-1)=>{for(let i=t+1;i<e.length;i++){const t=e[i];if(isTemplatePartActive(t))return i}return-1};function insertNodeIntoTemplate(e,t,i=null){const{element:{content:r},parts:n}=e;if(null===i||void 0===i)return void r.appendChild(t);const a=document.createTreeWalker(r,walkerNodeFilter,null,!1);let o=nextActiveIndexInTemplateParts(n),s=0,l=-1;for(;a.nextNode();){for(l++,a.currentNode===i&&(s=countNodes(t),i.parentNode.insertBefore(t,i));-1!==o&&n[o].index===l;){if(0<s){for(;-1!==o;)n[o].index+=s,o=nextActiveIndexInTemplateParts(n,o);return}o=nextActiveIndexInTemplateParts(n,o)}}}var modifyTemplate={removeNodesFromTemplate:removeNodesFromTemplate,insertNodeIntoTemplate:insertNodeIntoTemplate};const getTemplateCacheKey=(e,t)=>`${e}--${t}`;let compatibleShadyCSSVersion=!0;void 0===window.ShadyCSS?compatibleShadyCSSVersion=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected.Please update to at least @webcomponents/webcomponentsjs@2.0.2 and@webcomponents/shadycss@1.3.1."),compatibleShadyCSSVersion=!1);const shadyTemplateFactory=e=>t=>{const i=getTemplateCacheKey(t.type,e);let r=templateCaches.get(i);void 0===r&&(r={stringsArray:new WeakMap,keyString:new Map},templateCaches.set(i,r));let n=r.stringsArray.get(t.strings);if(void 0!==n)return n;const a=t.strings.join(marker);if(void 0===(n=r.keyString.get(a))){const i=t.getTemplateElement();compatibleShadyCSSVersion&&window.ShadyCSS.prepareTemplateDom(i,e),n=new Template(t,i),r.keyString.set(a,n)}return r.stringsArray.set(t.strings,n),n},TEMPLATE_TYPES=["html","svg"],removeStylesFromLitTemplates=e=>{TEMPLATE_TYPES.forEach(t=>{const i=templateCaches.get(getTemplateCacheKey(t,e));void 0!==i&&i.keyString.forEach(e=>{const{element:{content:t}}=e,i=new Set;Array.from(t.querySelectorAll("style")).forEach(e=>{i.add(e)}),removeNodesFromTemplate(e,i)})})},shadyRenderSet=new Set,prepareTemplateStyles=(e,t,i)=>{shadyRenderSet.add(i);const r=e.querySelectorAll("style");if(0===r.length)return void window.ShadyCSS.prepareTemplateStyles(t.element,i);const n=document.createElement("style");for(let e=0;e<r.length;e++){const t=r[e];t.parentNode.removeChild(t),n.textContent+=t.textContent}if(removeStylesFromLitTemplates(i),insertNodeIntoTemplate(t,n,t.element.content.firstChild),window.ShadyCSS.prepareTemplateStyles(t.element,i),window.ShadyCSS.nativeShadow){const i=t.element.content.querySelector("style");e.insertBefore(i.cloneNode(!0),e.firstChild)}else{t.element.content.insertBefore(n,t.element.content.firstChild),removeNodesFromTemplate(t,new Set([n]))}},render$2=(e,t,i)=>{const r=i.scopeName,n=parts$1.has(t),a=t instanceof ShadowRoot&&compatibleShadyCSSVersion&&e instanceof TemplateResult,o=a&&!shadyRenderSet.has(r),s=o?document.createDocumentFragment():t;if(render(e,s,Object.assign({templateFactory:shadyTemplateFactory(r)},i)),o){const e=parts$1.get(s);parts$1.delete(s),e.value instanceof TemplateInstance&&prepareTemplateStyles(s,e.value.template,r),removeNodes(t,t.firstChild),t.appendChild(s),parts$1.set(t,e)}!n&&a&&window.ShadyCSS.styleElement(t.host)};var shadyRender={render:render$2,html:html$1,svg:svg,TemplateResult:TemplateResult};function arrayFlat(e,t=[]){for(let i=0,r=e.length;i<r;i++){const r=e[i];Array.isArray(r)?arrayFlat(r,t):t.push(r)}return t}(window.litElementVersions||(window.litElementVersions=[])).push("2.0.1");const flattenStyles=e=>e.flat?e.flat(1/0):arrayFlat(e);class LitElement extends UpdatingElement{static finalize(){super.finalize(),this._styles=this.hasOwnProperty(JSCompiler_renameProperty("styles",this))?this._getUniqueStyles():this._styles||[]}static _getUniqueStyles(){const e=this.styles,t=[];if(Array.isArray(e)){flattenStyles(e).reduceRight((e,t)=>(e.add(t),e),new Set).forEach(e=>t.unshift(e))}else e&&t.push(e);return t}initialize(){super.initialize(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?supportsAdoptingStyleSheets?this.renderRoot.adoptedStyleSheets=e.map(e=>e.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(e=>e.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){super.update(e);const t=this.render();t instanceof TemplateResult&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)}))}render(){}}LitElement.finalized=!0,LitElement.render=render$2;var litElement={LitElement:LitElement,defaultConverter:defaultConverter,notEqual:notEqual,UpdatingElement:UpdatingElement,customElement:customElement,property:property,query:query,queryAll:queryAll,eventOptions:eventOptions,html:html$1,svg:svg,TemplateResult:TemplateResult,SVGTemplateResult:SVGTemplateResult,supportsAdoptingStyleSheets:supportsAdoptingStyleSheets,CSSResult:CSSResult,unsafeCSS:unsafeCSS,css:css};const createAndInsertPart=(e,t)=>{const i=e.startNode.parentNode,r=void 0===t?e.endNode:t.startNode,n=i.insertBefore(createMarker(),r);i.insertBefore(createMarker(),r);const a=new NodePart(e.options);return a.insertAfterNode(n),a},updatePart=(e,t)=>(e.setValue(t),e.commit(),e),insertPartBefore=(e,t,i)=>{const r=e.startNode.parentNode,n=i?i.startNode:e.endNode,a=t.endNode.nextSibling;a!==n&&reparentNodes(r,t.startNode,a,n)},removePart=e=>{removeNodes(e.startNode.parentNode,e.startNode,e.endNode.nextSibling)},generateMap=(e,t,i)=>{const r=new Map;for(let n=t;n<=i;n++)r.set(e[n],n);return r},partListCache=new WeakMap,keyListCache=new WeakMap,repeat=directive((e,t,i)=>{let r;return void 0===i?i=t:void 0!==t&&(r=t),t=>{if(!(t instanceof NodePart))throw new Error("repeat can only be used in text bindings");const n=partListCache.get(t)||[],a=keyListCache.get(t)||[],o=[],s=[],l=[];let c=0;for(const t of e)l[c]=r?r(t,c):c,s[c]=i(t,c),c++;let h,u,d=0,p=n.length-1,m=0,f=s.length-1;for(;d<=p&&m<=f;)if(null===n[d])d++;else if(null===n[p])p--;else if(a[d]===l[m])o[m]=updatePart(n[d],s[m]),d++,m++;else if(a[p]===l[f])o[f]=updatePart(n[p],s[f]),p--,f--;else if(a[d]===l[f])o[f]=updatePart(n[d],s[f]),insertPartBefore(t,n[d],o[f+1]),d++,f--;else if(a[p]===l[m])o[m]=updatePart(n[p],s[m]),insertPartBefore(t,n[p],n[d]),p--,m++;else if(void 0===h&&(h=generateMap(l,m,f),u=generateMap(a,d,p)),h.has(a[d]))if(h.has(a[p])){const e=u.get(l[m]),i=void 0!==e?n[e]:null;if(null===i){const e=createAndInsertPart(t,n[d]);updatePart(e,s[m]),o[m]=e}else o[m]=updatePart(i,s[m]),insertPartBefore(t,i,n[d]),n[e]=null;m++}else removePart(n[p]),p--;else removePart(n[d]),d++;for(;m<=f;){const e=createAndInsertPart(t,o[f+1]);updatePart(e,s[m]),o[m++]=e}for(;d<=p;){const e=n[d++];null!==e&&removePart(e)}partListCache.set(t,o),keyListCache.set(t,l)}});var repeat$1={repeat:repeat};const previousValues=new WeakMap,unsafeHTML=directive(e=>t=>{if(!(t instanceof NodePart))throw new Error("unsafeHTML can only be used in text bindings");const i=previousValues.get(t);if(void 0!==i&&isPrimitive(e)&&e===i.value&&t.value===i.fragment)return;const r=document.createElement("template");r.innerHTML=e;const n=document.importNode(r.content,!0);t.setValue(n),previousValues.set(t,{value:e,fragment:n})});var unsafeHtml={unsafeHTML:unsafeHTML};const $_documentContainer$5=document.createElement("template");$_documentContainer$5.innerHTML='<dom-module id="paper-share-button">\n    <iron-iconset-svg name="custom" size="24">\n        <svg><defs>\n    <g id="share"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"></path></g>\n    <g id="email"><path d="M0 0h24v24H0z" fill="none"></path><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z"></path></g>\n  </defs></svg>\n    </iron-iconset-svg>\n    <iron-iconset-svg name="brand" size="16">\n        <svg><defs>\n  <g id="facebook"><path d="M15.117 0H.883C.395 0 0 .395 0 .883v14.234c0 .488.395.883.883.883h7.663V9.804H6.46V7.39h2.086V5.607c0-2.066 1.262-3.19 3.106-3.19.883 0 1.642.064 1.863.094v2.16h-1.28c-1 0-1.195.48-1.195 1.18v1.54h2.39l-.31 2.42h-2.08V16h4.077c.488 0 .883-.395.883-.883V.883C16 .395 15.605 0 15.117 0"></path></g>\n  <g id="google"><path d="M5.09 7.273v1.745h2.89c-.116.75-.873 2.197-2.887 2.197-1.737 0-3.155-1.44-3.155-3.215S3.353 4.785 5.09 4.785c.99 0 1.652.422 2.03.786l1.382-1.33c-.887-.83-2.037-1.33-3.41-1.33C2.275 2.91 0 5.19 0 8s2.276 5.09 5.09 5.09c2.94 0 4.888-2.065 4.888-4.974 0-.334-.036-.59-.08-.843H5.09zm10.91 0h-1.455V5.818H13.09v1.455h-1.454v1.454h1.455v1.455h1.46V8.727H16"></path></g>\n  <g id="twitter"><path d="M16 3.038c-.59.26-1.22.437-1.885.517.677-.407 1.198-1.05 1.443-1.816-.634.37-1.337.64-2.085.79-.598-.64-1.45-1.04-2.396-1.04-1.812 0-3.282 1.47-3.282 3.28 0 .26.03.51.085.75-2.728-.13-5.147-1.44-6.766-3.42C.83 2.58.67 3.14.67 3.75c0 1.14.58 2.143 1.46 2.732-.538-.017-1.045-.165-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.22-.276.074-.566.114-.865.114-.21 0-.41-.02-.61-.058.42 1.304 1.63 2.253 3.07 2.28-1.12.88-2.54 1.404-4.07 1.404-.26 0-.52-.015-.78-.045 1.46.93 3.18 1.474 5.04 1.474 6.04 0 9.34-5 9.34-9.33 0-.14 0-.28-.01-.42.64-.46 1.2-1.04 1.64-1.7z" fill-rule="nonzero"></path></g>\n  <g id="vk"><path d="M7.828 12.526h.957s.288-.032.436-.19c.14-.147.14-.42.14-.42s-.02-1.284.58-1.473c.59-.187 1.34 1.24 2.14 1.788.61.42 1.07.33 1.07.33l2.14-.03s1.12-.07.59-.95c-.04-.07-.3-.65-1.58-1.84-1.34-1.24-1.16-1.04.45-3.19.98-1.31 1.38-2.11 1.25-2.45-.11-.32-.84-.24-.84-.24l-2.4.02s-.18-.02-.31.06-.21.26-.21.26-.38 1.02-.89 1.88C10.27 7.9 9.84 8 9.67 7.88c-.403-.26-.3-1.053-.3-1.62 0-1.76.27-2.5-.52-2.69-.26-.06-.454-.1-1.123-.11-.86-.01-1.585.006-1.996.207-.27.135-.48.434-.36.45.16.02.52.098.71.358.25.337.24 1.09.24 1.09s.14 2.077-.33 2.335c-.33.174-.77-.187-1.73-1.837-.49-.84-.86-1.78-.86-1.78s-.07-.17-.2-.27c-.15-.11-.37-.15-.37-.15l-2.29.02s-.34.01-.46.16c-.11.13-.01.41-.01.41s1.79 4.19 3.82 6.3c1.86 1.935 3.97 1.81 3.97 1.81z"></path></g>\n  <g id="blogger"><path d="M14.65 16H1.35C.6 16 0 15.4 0 14.65V1.35C0 .6.6 0 1.35 0H14.7c.7 0 1.3.6 1.3 1.35v13.3c0 .75-.6 1.35-1.35 1.35zM8 2.65H6c-1.85 0-3.35 1.5-3.35 3.35v4c0 1.85 1.5 3.35 3.35 3.35h4c1.85 0 3.35-1.5 3.35-3.35V7.35c0-.4-.3-.7-.7-.7H12c-.35 0-.65-.3-.65-.65 0-1.85-1.5-3.35-3.35-3.35zm2.05 8H6c-.35 0-.65-.3-.65-.65 0-.35.3-.65.65-.65h4.05c.35 0 .65.3.65.65 0 .35-.3.65-.65.65zm-1.7-5.3c.35 0 .65.3.65.65 0 .35-.3.65-.65.65h-2.4c-.35 0-.65-.3-.65-.65 0-.35.3-.65.65-.65h2.4z"></path></g>\n  <g id="reddit"><path d="M1.473 9.368c-.04.185-.06.374-.06.566 0 2.3 2.94 4.173 6.554 4.173 3.613 0 6.553-1.872 6.553-4.173 0-.183-.02-.364-.055-.54l-.01-.022c-.013-.036-.02-.073-.02-.11-.2-.784-.745-1.497-1.533-2.072-.03-.01-.058-.026-.084-.047-.017-.013-.03-.028-.044-.043-1.198-.824-2.91-1.34-4.807-1.34-1.88 0-3.576.506-4.772 1.315-.01.012-.02.023-.033.033-.026.022-.056.04-.087.05-.805.576-1.364 1.293-1.572 2.086 0 .038-.01.077-.025.114l-.005.01zM8 13.003c-1.198 0-2.042-.26-2.58-.8-.116-.116-.116-.305 0-.422.117-.11.307-.11.424 0 .42.42 1.125.63 2.155.63 1.03 0 1.73-.2 2.15-.62.11-.11.3-.11.42 0 .11.12.11.31 0 .43-.54.54-1.38.8-2.58.8zM5.592 7.945c-.61 0-1.12.51-1.12 1.12 0 .608.51 1.102 1.12 1.102.61 0 1.103-.494 1.103-1.102 0-.61-.494-1.12-1.103-1.12zm4.83 0c-.61 0-1.12.51-1.12 1.12 0 .608.51 1.102 1.12 1.102.61 0 1.103-.494 1.103-1.102 0-.61-.494-1.12-1.103-1.12zM13.46 6.88c.693.556 1.202 1.216 1.462 1.94.3-.225.48-.578.48-.968 0-.67-.545-1.214-1.214-1.214-.267 0-.52.087-.728.243zM1.812 6.64c-.67 0-1.214.545-1.214 1.214 0 .363.16.7.43.927.268-.72.782-1.37 1.478-1.92-.202-.14-.443-.22-.694-.22zm6.155 8.067c-3.944 0-7.152-2.14-7.152-4.77 0-.183.016-.363.046-.54-.53-.33-.86-.91-.86-1.545 0-1 .82-1.812 1.82-1.812.45 0 .87.164 1.2.455 1.24-.796 2.91-1.297 4.75-1.33l1.21-3.69.27.063s.01 0 .01.002l2.82.663c.23-.533.76-.908 1.38-.908.82 0 1.49.67 1.49 1.492 0 .823-.67 1.492-1.49 1.492s-1.49-.67-1.49-1.49L9.4 2.18l-.98 2.99c1.77.07 3.37.57 4.57 1.35.33-.31.764-.48 1.225-.48 1 0 1.814.81 1.814 1.81 0 .66-.36 1.26-.92 1.58.02.17.04.33.04.5-.01 2.63-3.21 4.77-7.16 4.77zM13.43 1.893c-.494 0-.895.4-.895.894 0 .493.4.894.894.894.49 0 .89-.4.89-.89s-.4-.89-.9-.89z"></path></g>\n  <g id="tumblr"><path d="M9.708 16c-3.396 0-4.687-2.504-4.687-4.274V6.498H3.41V4.432C5.83 3.557 6.418 1.368 6.55.12c.01-.086.077-.12.115-.12H9.01v4.076h3.2v2.422H8.997v4.98c.01.667.25 1.58 1.472 1.58h.06c.42-.012.99-.136 1.29-.278l.77 2.283c-.29.424-1.6.916-2.77.936H9.7z" fill-rule="nonzero"></path></g>\n  </defs></svg>\n    </iron-iconset-svg>\n\n    <template>\n    <style>\n      :host {\n        display: inline-block;\n      }\n      :host([monochrome]) .social-icon {\n        color: var(--paper-share-button-brand-icon-monochrome-color, black) !important;\n      }\n      #container:hover > #cube { background-color: yellow; }\n      .social-list {\n      }\n      paper-menu-button {\n        padding: 0px;\n      }\n      paper-icon-button {\n        height: var(--paper-share-button-icon-height, 40px);\n        width: var(--paper-share-button-icon-width, 40px);\n        color: var(--paper-share-button-icon-color, black);\n      }\n      .social-icon {\n        height: var(--paper-share-button-brand-icon-height, 40px);\n        width: var(--paper-share-button-brand-icon-width, 40px);\n      }\n\n      [hidden] {\n        display: none !important;\n      }\n    </style>\n    <paper-menu-button id="shareMenu" horizontal-align$="[[horizontalAlign]]" vertical-align="bottom">\n      <paper-icon-button icon="[[buttonIcon]]" slot="dropdown-trigger" alt="Share"></paper-icon-button>\n      <paper-material slot="dropdown-content">\n        <div class="social-list">\n          <div>\n            <paper-icon-button href$="https://www.facebook.com/sharer/sharer.php?u=[[url]]" hidden$="[[!facebook]]" style="color:#3B5998" class="social-icon" cake="1w2" icon="brand:facebook" on-tap="_share"></paper-icon-button>\n          </div>\n          <div>\n            <paper-icon-button href$="https://plus.google.com/share?url=[[url]]" hidden$="[[!google]]" style="color:#DC4E41" class="social-icon" icon="brand:google" on-tap="_share"></paper-icon-button>\n          </div>\n          <div>\n            <paper-icon-button href$="http://twitter.com/intent/tweet?url=[[url]]&amp;text=[[sharingText]]" hidden$="[[!twitter]]" style="color:#1DA1F2" class="social-icon" icon="brand:twitter" on-tap="_share"></paper-icon-button>\n          </div>\n          <div>\n            <paper-icon-button href$="http://reddit.com/submit?url=[[url]]&amp;title=[[sharingText]]" hidden$="[[!reddit]]" style="color:#FF4500" class="social-icon" icon="brand:reddit" on-tap="_share"></paper-icon-button>\n          </div>\n          <div>\n            <paper-icon-button href$="http://vkontakte.ru/share.php?url=[[url]]" hidden$="[[!vk]]" style="color:#6383A8" class="social-icon" icon="brand:vk" on-tap="_share"></paper-icon-button>\n          </div>\n          <div>\n            <paper-icon-button href$="http://www.blogger.com/blog-this.g?n=[[sharingText]]&amp;b=[[sharingText]]%20[[url]]" hidden$="[[!blogger]]" style="color:#F38936" class="social-icon" icon="brand:blogger" on-tap="_share"></paper-icon-button>\n          </div>\n          <div>\n            <paper-icon-button href$="http://www.tumblr.com/share/link?url=[[url]]" hidden$="[[!tumblr]]" style="color:#36465D" class="social-icon" icon="brand:tumblr" on-tap="_share"></paper-icon-button>\n          </div>\n          <div>\n            <a href$="mailto:?body=[[url]]&amp;subject=[[sharingText]]" target="_blank" tabindex="-1">\n              <paper-icon-button hidden$="[[!email]]" style="color:#000000" class="social-icon" icon="custom:email"></paper-icon-button>\n            </a>\n          </div>\n        </div>\n      </paper-material>\n    </paper-menu-button>\n  </template>\n\n    \n</dom-module>',document.head.appendChild($_documentContainer$5.content),Polymer({is:"paper-share-button",properties:{url:{type:String},autoUrl:{type:Boolean},buttonIcon:{type:String,value:"custom:share"},sharingText:{type:String,value:""},monochrome:{type:Boolean,value:!1},popup:{type:Boolean,value:!1},email:{type:Boolean,value:!1},facebook:{type:Boolean,value:!1},google:{type:Boolean,value:!1},twitter:{type:Boolean,value:!1},reddit:{type:Boolean,value:!1},vk:{type:Boolean,value:!1},blogger:{type:Boolean,value:!1},tumblr:{type:Boolean,value:!1},horizontalAlign:{type:String,value:"left"}},_share:function(e){var t=dom(e).localTarget;if(!this.url&&this.autoUrl&&(this.url=window.location.href),this.url)if(this.fire("share-tap",{brand:t.icon}),this.popup)switch(t.icon){case"brand:facebook":this._openPopup(t.getAttribute("href"),"Sharing",600,375);break;case"brand:google":this._openPopup(t.getAttribute("href"),"Sharing",400,445);break;case"brand:twitter":this._openPopup(t.getAttribute("href"),"Sharing",500,230);break;default:window.open(t.getAttribute("href"),"Sharing")}else window.open(t.getAttribute("href"),"Sharing");else console.error("Impossible to share, no url set");this.$.shareMenu.close()},_openPopup:function(e,t,i,r){var n=window.top.outerHeight/2+window.top.screenY-r/2,a=window.top.outerWidth/2+window.top.screenX-i/2;window.open(e,t,"width="+i+", height="+r+", top="+n+", left="+a)}});const installMediaQueryWatcher$1=(e,t)=>{let i=window.matchMedia(e);i.addListener(e=>t(e.matches)),t(i.matches)};var mediaQuery={installMediaQueryWatcher:installMediaQueryWatcher$1};const updateMetadata=({title:e,description:t,url:i,image:r,imageAlt:n})=>{e&&(document.title=e,setMetaTag("property","og:title",e)),t&&(setMetaTag("name","description",t),setMetaTag("property","og:description",t)),r&&setMetaTag("property","og:image",r),n&&setMetaTag("property","og:image:alt",n),setMetaTag("property","og:url",i=i||window.location.href)};function setMetaTag(e,t,i){let r=document.head.querySelector(`meta[${e}="${t}"]`);r||((r=document.createElement("meta")).setAttribute(e,t),document.head.appendChild(r)),r.setAttribute("content",i||"")}var metadata={updateMetadata:updateMetadata,setMetaTag:setMetaTag};const installOfflineWatcher=e=>{window.addEventListener("online",()=>e(!1)),window.addEventListener("offline",()=>e(!0)),e(!1===navigator.onLine)};var network={installOfflineWatcher:installOfflineWatcher};const installRouter=e=>{document.body.addEventListener("click",t=>{if(t.defaultPrevented||0!==t.button||t.metaKey||t.ctrlKey||t.shiftKey)return;const i=t.composedPath().filter(e=>"A"===e.tagName)[0];if(!i||i.target||i.hasAttribute("download")||"external"===i.getAttribute("rel"))return;const r=i.href;if(!r||-1!==r.indexOf("mailto:"))return;const n=window.location,a=n.origin||n.protocol+"//"+n.host;0===r.indexOf(a)&&(t.preventDefault(),r!==n.href&&(window.history.pushState({},"",r),e(n,t)))}),window.addEventListener("popstate",t=>e(window.location,t)),e(window.location,null)};var router={installRouter:installRouter};function EventDispatcher(){}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return 0>e?-1:0<e?1:+e}),!1=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t,i=Object(e),r=1;r<arguments.length;r++)if(void 0!==(t=arguments[r])&&null!==t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);return i}),Object.assign(EventDispatcher.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var i=this._listeners[e];if(void 0!==i){var r=i.indexOf(t);-1!==r&&i.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var i=t.slice(0),r=0,n=i.length;r<n;r++)i[r].call(this,e)}}}});var REVISION="106",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,CullFaceFrontBack=3,FrontFaceDirectionCW=0,FrontFaceDirectionCCW=1,BasicShadowMap=0,PCFShadowMap=1,PCFSoftShadowMap=2,FrontSide=0,BackSide=1,DoubleSide=2,FlatShading=1,SmoothShading=2,NoColors=0,FaceColors=1,VertexColors=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,Uncharted2ToneMapping=3,CineonToneMapping=4,ACESFilmicToneMapping=5,UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,SphericalReflectionMapping=305,CubeUVReflectionMapping=306,CubeUVRefractionMapping=307,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipMapNearestFilter=1004,NearestMipMapLinearFilter=1005,LinearFilter=1006,LinearMipMapNearestFilter=1007,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedShort565Type=1019,UnsignedInt248Type=1020,AlphaFormat=1021,RGBFormat=1022,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,RGBEFormat=RGBAFormat,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,LinearEncoding=3e3,sRGBEncoding=3001,GammaEncoding=3007,RGBEEncoding=3002,LogLuvEncoding=3003,RGBM7Encoding=3004,RGBM16Encoding=3005,RGBDEncoding=3006,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,_Math={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;256>t;t++)e[t]=(16>t?"0":"")+t.toString(16);return function(){var t=0|4294967295*Math.random(),i=0|4294967295*Math.random(),r=0|4294967295*Math.random(),n=0|4294967295*Math.random();return(e[255&t]+e[255&t>>8]+e[255&t>>16]+e[255&t>>24]+"-"+e[255&i]+e[255&i>>8]+"-"+e[64|15&i>>16]+e[255&i>>24]+"-"+e[128|63&r]+e[255&r>>8]+"-"+e[255&r>>16]+e[255&r>>24]+e[255&n]+e[255&n>>8]+e[255&n>>16]+e[255&n>>24]).toUpperCase()}}(),clamp:function(e,t,i){return Math.max(t,Math.min(i,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,i,r,n){return r+(e-t)*(n-r)/(i-t)},lerp:function(e,t,i){return(1-i)*e+i*t},smoothstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*(3-2*e)},smootherstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*_Math.DEG2RAD},radToDeg:function(e){return e*_Math.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function Vector2(e,t){this.x=e||0,this.y=t||0}function Quaternion(e,t,i,r){this._x=e||0,this._y=t||0,this._z=i||0,this._w=void 0!==r?r:1}function Vector3(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0}function Matrix3(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Vector2.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Vector2.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return 0>e&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var i=Math.cos(t),r=Math.sin(t),n=this.x-e.x,a=this.y-e.y;return this.x=n*i-a*r+e.x,this.y=n*r+a*i+e.y,this}}),Object.assign(Quaternion,{slerp:function(e,t,i,r){return i.copy(e).slerp(t,r)},slerpFlat:function(e,t,i,r,n,a,o){var s=i[r+0],l=i[r+1],c=i[r+2],h=i[r+3],u=n[a+0],d=n[a+1],p=n[a+2],m=n[a+3];if(h!==m||s!==u||l!==d||c!==p){var f=1-o,g=s*u+l*d+c*p+h*m,v=0<=g?1:-1,y=1-g*g;if(y>Number.EPSILON){var b=Math.sqrt(y),_=Math.atan2(b,g*v);f=Math.sin(f*_)/b,o=Math.sin(o*_)/b}var x=o*v;if(s=s*f+u*x,l=l*f+d*x,c=c*f+p*x,h=h*f+m*x,f===1-o){var w=1/Math.sqrt(s*s+l*l+c*c+h*h);s*=w,l*=w,c*=w,h*=w}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=h}}),Object.defineProperties(Quaternion.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(Quaternion.prototype,{isQuaternion:!0,set:function(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=e._x,r=e._y,n=e._z,a=e.order,o=Math.cos,s=Math.sin,l=o(i/2),c=o(r/2),h=o(n/2),u=s(i/2),d=s(r/2),p=s(n/2);return"XYZ"===a?(this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p):"YXZ"===a?(this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p):"ZXY"===a?(this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p):"ZYX"===a?(this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p):"YZX"===a?(this._x=u*c*h+l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h-u*d*p):"XZY"===a&&(this._x=u*c*h-l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h+u*d*p),!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t,i=e.elements,r=i[0],n=i[4],a=i[8],o=i[1],s=i[5],l=i[9],c=i[2],h=i[6],u=i[10],d=r+s+u;return 0<d?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(h-l)*t,this._y=(a-c)*t,this._z=(o-n)*t):r>s&&r>u?(t=2*Math.sqrt(1+r-s-u),this._w=(h-l)/t,this._x=.25*t,this._y=(n+o)/t,this._z=(a+c)/t):s>u?(t=2*Math.sqrt(1+s-r-u),this._w=(a-c)/t,this._x=(n+o)/t,this._y=.25*t,this._z=(l+h)/t):(t=2*Math.sqrt(1+u-r-s),this._w=(o-n)/t,this._x=(a+c)/t,this._y=(l+h)/t,this._z=.25*t),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var i=e.dot(t)+1;return i<1e-6?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(_Math.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var i=this.angleTo(e);if(0===i)return this;var r=Math.min(1,t/i);return this.slerp(e,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var i=e._x,r=e._y,n=e._z,a=e._w,o=t._x,s=t._y,l=t._z,c=t._w;return this._x=i*c+a*o+r*l-n*s,this._y=r*c+a*s+n*o-i*l,this._z=n*c+a*l+i*s-r*o,this._w=a*c-i*o-r*s-n*l,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var i=this._x,r=this._y,n=this._z,a=this._w,o=a*e._w+i*e._x+r*e._y+n*e._z;if(0>o?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),1<=o)return this._w=a,this._x=i,this._y=r,this._z=n,this;var s=1-o*o;if(s<=Number.EPSILON){var l=1-t;return this._w=l*a+t*this._w,this._x=l*i+t*this._x,this._y=l*r+t*this._y,this._z=l*n+t*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),h=Math.atan2(c,o),u=Math.sin((1-t)*h)/c,d=Math.sin(t*h)/c;return this._w=a*u+this._w*d,this._x=i*u+this._x*d,this._y=r*u+this._y*d,this._z=n*u+this._z*d,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(Vector3.prototype,{isVector3:!0,set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e=new Quaternion;return function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(e.setFromEuler(t))}}(),applyAxisAngle:function(){var e=new Quaternion;return function(t,i){return this.applyQuaternion(e.setFromAxisAngle(t,i))}}(),applyMatrix3:function(e){var t=this.x,i=this.y,r=this.z,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6]*r,this.y=n[1]*t+n[4]*i+n[7]*r,this.z=n[2]*t+n[5]*i+n[8]*r,this},applyMatrix4:function(e){var t=this.x,i=this.y,r=this.z,n=e.elements,a=1/(n[3]*t+n[7]*i+n[11]*r+n[15]);return this.x=(n[0]*t+n[4]*i+n[8]*r+n[12])*a,this.y=(n[1]*t+n[5]*i+n[9]*r+n[13])*a,this.z=(n[2]*t+n[6]*i+n[10]*r+n[14])*a,this},applyQuaternion:function(e){var t=this.x,i=this.y,r=this.z,n=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*r-o*i,c=s*i+o*t-n*r,h=s*r+n*i-a*t,u=-n*t-a*i-o*r;return this.x=l*s+u*-n+c*-o-h*-a,this.y=c*s+u*-a+h*-n-l*-o,this.z=h*s+u*-o+l*-a-c*-n,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,i=this.y,r=this.z,n=e.elements;return this.x=n[0]*t+n[4]*i+n[8]*r,this.y=n[1]*t+n[5]*i+n[9]*r,this.z=n[2]*t+n[6]*i+n[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var i=e.x,r=e.y,n=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-n*o,this.y=n*a-i*s,this.z=i*o-r*a,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new Vector3;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new Vector3;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(_Math.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,i){var r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(Matrix3.prototype,{isMatrix3:!0,set:function(e,t,i,r,n,a,o,s,l){var c=this.elements;return c[0]=e,c[1]=r,c[2]=o,c[3]=t,c[4]=n,c[5]=s,c[6]=i,c[7]=a,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new Vector3;return function(t){for(var i=0,r=t.count;i<r;i++)e.x=t.getX(i),e.y=t.getY(i),e.z=t.getZ(i),e.applyMatrix3(this),t.setXYZ(i,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,r=t.elements,n=this.elements,a=i[0],o=i[3],s=i[6],l=i[1],c=i[4],h=i[7],u=i[2],d=i[5],p=i[8],m=r[0],f=r[3],g=r[6],v=r[1],y=r[4],b=r[7],_=r[2],x=r[5],w=r[8];return n[0]=a*m+o*v+s*_,n[3]=a*f+o*y+s*x,n[6]=a*g+o*b+s*w,n[1]=l*m+c*v+h*_,n[4]=l*f+c*y+h*x,n[7]=l*g+c*b+h*w,n[2]=u*m+d*v+p*_,n[5]=u*f+d*y+p*x,n[8]=u*g+d*b+p*w,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[1],r=e[2],n=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8];return t*a*c-t*o*l-i*n*c+i*o*s+r*n*l-r*a*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var i=e.elements,r=this.elements,n=i[0],a=i[1],o=i[2],s=i[3],l=i[4],c=i[5],h=i[6],u=i[7],d=i[8],p=d*l-c*u,m=c*h-d*s,f=u*s-l*h,g=n*p+a*m+o*f;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return r[0]=p*y,r[1]=(o*u-d*a)*y,r[2]=(c*a-o*l)*y,r[3]=m*y,r[4]=(d*n-o*h)*y,r[5]=(o*s-c*n)*y,r[6]=f*y,r[7]=(a*h-u*n)*y,r[8]=(l*n-a*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,i,r,n,a,o){var s=Math.cos(n),l=Math.sin(n);this.set(i*s,i*l,-i*(s*a+l*o)+a+e,-r*l,r*s,-r*(-l*a+s*o)+o+t,0,0,1)},scale:function(e,t){var i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this},rotate:function(e){var t=Math.cos(e),i=Math.sin(e),r=this.elements,n=r[0],a=r[3],o=r[6],s=r[1],l=r[4],c=r[7];return r[0]=t*n+i*s,r[3]=t*a+i*l,r[6]=t*o+i*c,r[1]=-i*n+t*s,r[4]=-i*a+t*l,r[7]=-i*o+t*c,this},translate:function(e,t){var i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this},equals:function(e){for(var t=this.elements,i=e.elements,r=0;9>r;r++)if(t[r]!==i[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var i=0;9>i;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}});var _canvas,ImageUtils={getDataURL:function(e){var t;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===_canvas&&(_canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),_canvas.width=e.width,_canvas.height=e.height;var i=_canvas.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=_canvas}return 2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},textureId=0;function Texture(e,t,i,r,n,a,o,s,l,c){Object.defineProperty(this,"id",{value:textureId++}),this.uuid=_Math.generateUUID(),this.name="",this.image=void 0!==e?e:Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Texture.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:ClampToEdgeWrapping,this.wrapT=void 0!==r?r:ClampToEdgeWrapping,this.magFilter=void 0!==n?n:LinearFilter,this.minFilter=void 0!==a?a:LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==o?o:RGBAFormat,this.type=void 0!==s?s:UnsignedByteType,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:LinearEncoding,this.version=0,this.onUpdate=null}function Vector4(e,t,i,r){this.x=e||0,this.y=t||0,this.z=i||0,this.w=void 0!==r?r:1}function WebGLRenderTarget(e,t,i){this.width=e,this.height=t,this.scissor=new Vector4(0,0,e,t),this.scissorTest=!1,this.viewport=new Vector4(0,0,e,t),i=i||{},this.texture=new Texture(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:LinearFilter,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function WebGLMultisampleRenderTarget(e,t,i){WebGLRenderTarget.call(this,e,t,i),this.samples=4}function Matrix4(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Euler(e,t,i,r){this._x=e||0,this._y=t||0,this._z=i||0,this._order=r||Euler.DefaultOrder}function Layers(){this.mask=1}Texture.DEFAULT_IMAGE=void 0,Texture.DEFAULT_MAPPING=UVMapping,Texture.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Texture,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=_Math.generateUUID()),!t&&void 0===e.images[r.uuid]){var n;if(Array.isArray(r)){n=[];for(var a=0,o=r.length;a<o;a++)n.push(ImageUtils.getDataURL(r[a]))}else n=ImageUtils.getDataURL(r);e.images[r.uuid]={uuid:r.uuid,url:n}}i.image=r.uuid}return t||(e.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==UVMapping)return e;if(e.applyMatrix3(this.matrix),0>e.x||1<e.x)switch(this.wrapS){case RepeatWrapping:e.x=e.x-Math.floor(e.x);break;case ClampToEdgeWrapping:e.x=0>e.x?0:1;break;case MirroredRepeatWrapping:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(0>e.y||1<e.y)switch(this.wrapT){case RepeatWrapping:e.y=e.y-Math.floor(e.y);break;case ClampToEdgeWrapping:e.y=0>e.y?0:1;break;case MirroredRepeatWrapping:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Texture.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.defineProperties(Vector4.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(Vector4.prototype,{isVector4:!0,set:function(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,i=this.y,r=this.z,n=this.w,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*r+a[12]*n,this.y=a[1]*t+a[5]*i+a[9]*r+a[13]*n,this.z=a[2]*t+a[6]*i+a[10]*r+a[14]*n,this.w=a[3]*t+a[7]*i+a[11]*r+a[15]*n,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return 1e-4>t?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,i,r,n,a=e.elements,o=a[0],s=a[4],l=a[8],c=a[1],h=a[5],u=a[9],d=a[2],p=a[6],m=a[10];if(Math.abs(s-c)<.01&&Math.abs(l-d)<.01&&Math.abs(u-p)<.01){if(Math.abs(s+c)<.1&&Math.abs(l+d)<.1&&Math.abs(u+p)<.1&&Math.abs(o+h+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var f=(o+1)/2,g=(h+1)/2,v=(m+1)/2,y=(s+c)/4,b=(l+d)/4,_=(u+p)/4;return f>g&&f>v?f<.01?(i=0,r=.707106781,n=.707106781):(r=y/(i=Math.sqrt(f)),n=b/i):g>v?g<.01?(i=.707106781,r=0,n=.707106781):(i=y/(r=Math.sqrt(g)),n=_/r):v<.01?(i=.707106781,r=.707106781,n=0):(i=b/(n=Math.sqrt(v)),r=_/n),this.set(i,r,n,t),this}var x=Math.sqrt((p-u)*(p-u)+(l-d)*(l-d)+(c-s)*(c-s));return.001>Math.abs(x)&&(x=1),this.x=(p-u)/x,this.y=(l-d)/x,this.z=(c-s)/x,this.w=Math.acos((o+h+m-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(i,r){return void 0===e&&(e=new Vector4,t=new Vector4),e.set(i,i,i,i),t.set(r,r,r,r),this.clamp(e,t)}}(),clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),WebGLRenderTarget.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:WebGLRenderTarget,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),WebGLMultisampleRenderTarget.prototype=Object.assign(Object.create(WebGLRenderTarget.prototype),{constructor:WebGLMultisampleRenderTarget,isWebGLMultisampleRenderTarget:!0,copy:function(e){return WebGLRenderTarget.prototype.copy.call(this,e),this.samples=e.samples,this}}),Object.assign(Matrix4.prototype,{isMatrix4:!0,set:function(e,t,i,r,n,a,o,s,l,c,h,u,d,p,m,f){var g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=n,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=c,g[10]=h,g[14]=u,g[3]=d,g[7]=p,g[11]=m,g[15]=f,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Matrix4).fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this},copyPosition:function(e){var t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this},extractBasis:function(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this},extractRotation:function(){var e=new Vector3;return function(t){var i=this.elements,r=t.elements,n=1/e.setFromMatrixColumn(t,0).length(),a=1/e.setFromMatrixColumn(t,1).length(),o=1/e.setFromMatrixColumn(t,2).length();return i[0]=r[0]*n,i[1]=r[1]*n,i[2]=r[2]*n,i[3]=0,i[4]=r[4]*a,i[5]=r[5]*a,i[6]=r[6]*a,i[7]=0,i[8]=r[8]*o,i[9]=r[9]*o,i[10]=r[10]*o,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,i=e.x,r=e.y,n=e.z,a=Math.cos(i),o=Math.sin(i),s=Math.cos(r),l=Math.sin(r),c=Math.cos(n),h=Math.sin(n);if("XYZ"===e.order){var u=a*c,d=a*h,p=o*c,m=o*h;t[0]=s*c,t[4]=-s*h,t[8]=l,t[1]=d+p*l,t[5]=u-m*l,t[9]=-o*s,t[2]=m-u*l,t[6]=p+d*l,t[10]=a*s}else if("YXZ"===e.order){var f=s*c,g=s*h,v=l*c,y=l*h;t[0]=f+y*o,t[4]=v*o-g,t[8]=a*l,t[1]=a*h,t[5]=a*c,t[9]=-o,t[2]=g*o-v,t[6]=y+f*o,t[10]=a*s}else if("ZXY"===e.order){f=s*c,g=s*h,v=l*c,y=l*h;t[0]=f-y*o,t[4]=-a*h,t[8]=v+g*o,t[1]=g+v*o,t[5]=a*c,t[9]=y-f*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){u=a*c,d=a*h,p=o*c,m=o*h;t[0]=s*c,t[4]=p*l-d,t[8]=u*l+m,t[1]=s*h,t[5]=m*l+u,t[9]=d*l-p,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var b=a*s,_=a*l,x=o*s,w=o*l;t[0]=s*c,t[4]=w-b*h,t[8]=x*h+_,t[1]=h,t[5]=a*c,t[9]=-o*c,t[2]=-l*c,t[6]=_*h+x,t[10]=b-w*h}else if("XZY"===e.order){b=a*s,_=a*l,x=o*s,w=o*l;t[0]=s*c,t[4]=-h,t[8]=l*c,t[1]=b*h+w,t[5]=a*c,t[9]=_*h-x,t[2]=x*h-_,t[6]=o*c,t[10]=w*h+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(){var e=new Vector3(0,0,0),t=new Vector3(1,1,1);return function(i){return this.compose(e,i,t)}}(),lookAt:function(){var e=new Vector3,t=new Vector3,i=new Vector3;return function(r,n,a){var o=this.elements;return i.subVectors(r,n),0===i.lengthSq()&&(i.z=1),i.normalize(),e.crossVectors(a,i),0===e.lengthSq()&&(1===Math.abs(a.z)?i.x+=1e-4:i.z+=1e-4,i.normalize(),e.crossVectors(a,i)),e.normalize(),t.crossVectors(i,e),o[0]=e.x,o[4]=t.x,o[8]=i.x,o[1]=e.y,o[5]=t.y,o[9]=i.y,o[2]=e.z,o[6]=t.z,o[10]=i.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,r=t.elements,n=this.elements,a=i[0],o=i[4],s=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],p=i[2],m=i[6],f=i[10],g=i[14],v=i[3],y=i[7],b=i[11],_=i[15],x=r[0],w=r[4],S=r[8],T=r[12],A=r[1],E=r[5],C=r[9],M=r[13],P=r[2],L=r[6],I=r[10],B=r[14],R=r[3],F=r[7],O=r[11],k=r[15];return n[0]=a*x+o*A+s*P+l*R,n[4]=a*w+o*E+s*L+l*F,n[8]=a*S+o*C+s*I+l*O,n[12]=a*T+o*M+s*B+l*k,n[1]=c*x+h*A+u*P+d*R,n[5]=c*w+h*E+u*L+d*F,n[9]=c*S+h*C+u*I+d*O,n[13]=c*T+h*M+u*B+d*k,n[2]=p*x+m*A+f*P+g*R,n[6]=p*w+m*E+f*L+g*F,n[10]=p*S+m*C+f*I+g*O,n[14]=p*T+m*M+f*B+g*k,n[3]=v*x+y*A+b*P+_*R,n[7]=v*w+y*E+b*L+_*F,n[11]=v*S+y*C+b*I+_*O,n[15]=v*T+y*M+b*B+_*k,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new Vector3;return function(t){for(var i=0,r=t.count;i<r;i++)e.x=t.getX(i),e.y=t.getY(i),e.z=t.getZ(i),e.applyMatrix4(this),t.setXYZ(i,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],i=e[4],r=e[8],n=e[12],a=e[1],o=e[5],s=e[9],l=e[13],c=e[2],h=e[6],u=e[10],d=e[14];return e[3]*(+n*s*h-r*l*h-n*o*u+i*l*u+r*o*d-i*s*d)+e[7]*(+t*s*d-t*l*u+n*a*u-r*a*d+r*l*c-n*s*c)+e[11]*(+t*l*h-t*o*d-n*a*h+i*a*d+n*o*c-i*l*c)+e[15]*(-r*o*c-t*s*h+t*o*u+r*a*h-i*a*u+i*s*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e,t,i){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this},getInverse:function(e,t){var i=this.elements,r=e.elements,n=r[0],a=r[1],o=r[2],s=r[3],l=r[4],c=r[5],h=r[6],u=r[7],d=r[8],p=r[9],m=r[10],f=r[11],g=r[12],v=r[13],y=r[14],b=r[15],_=p*y*u-v*m*u+v*h*f-c*y*f-p*h*b+c*m*b,x=g*m*u-d*y*u-g*h*f+l*y*f+d*h*b-l*m*b,w=d*v*u-g*p*u+g*c*f-l*v*f-d*c*b+l*p*b,S=g*p*h-d*v*h-g*c*m+l*v*m+d*c*y-l*p*y,T=n*_+a*x+o*w+s*S;if(0===T){var A="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(A);return console.warn(A),this.identity()}var E=1/T;return i[0]=_*E,i[1]=(v*m*s-p*y*s-v*o*f+a*y*f+p*o*b-a*m*b)*E,i[2]=(c*y*s-v*h*s+v*o*u-a*y*u-c*o*b+a*h*b)*E,i[3]=(p*h*s-c*m*s-p*o*u+a*m*u+c*o*f-a*h*f)*E,i[4]=x*E,i[5]=(d*y*s-g*m*s+g*o*f-n*y*f-d*o*b+n*m*b)*E,i[6]=(g*h*s-l*y*s-g*o*u+n*y*u+l*o*b-n*h*b)*E,i[7]=(l*m*s-d*h*s+d*o*u-n*m*u-l*o*f+n*h*f)*E,i[8]=w*E,i[9]=(g*p*s-d*v*s-g*a*f+n*v*f+d*a*b-n*p*b)*E,i[10]=(l*v*s-g*c*s+g*a*u-n*v*u-l*a*b+n*c*b)*E,i[11]=(d*c*s-l*p*s-d*a*u+n*p*u+l*a*f-n*c*f)*E,i[12]=S*E,i[13]=(d*v*o-g*p*o+g*a*m-n*v*m-d*a*y+n*p*y)*E,i[14]=(g*c*o-l*v*o-g*a*h+n*v*h+l*a*y-n*c*y)*E,i[15]=(l*p*o-d*c*o+d*a*h-n*p*h-l*a*m+n*c*m)*E,this},scale:function(e){var t=this.elements,i=e.x,r=e.y,n=e.z;return t[0]*=i,t[4]*=r,t[8]*=n,t[1]*=i,t[5]*=r,t[9]*=n,t[2]*=i,t[6]*=r,t[10]*=n,t[3]*=i,t[7]*=r,t[11]*=n,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),r=Math.sin(t),n=1-i,a=e.x,o=e.y,s=e.z,l=n*a,c=n*o;return this.set(l*a+i,l*o-r*s,l*s+r*o,0,l*o+r*s,c*o+i,c*s-r*a,0,l*s-r*o,c*s+r*a,n*s*s+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(e,t,i){return this.set(1,t,i,0,e,1,i,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,i){var r=this.elements,n=t._x,a=t._y,o=t._z,s=t._w,l=n+n,c=a+a,h=o+o,u=n*l,d=n*c,p=n*h,m=a*c,f=a*h,g=o*h,v=s*l,y=s*c,b=s*h,_=i.x,x=i.y,w=i.z;return r[0]=(1-(m+g))*_,r[1]=(d+b)*_,r[2]=(p-y)*_,r[3]=0,r[4]=(d-b)*x,r[5]=(1-(u+g))*x,r[6]=(f+v)*x,r[7]=0,r[8]=(p+y)*w,r[9]=(f-v)*w,r[10]=(1-(u+m))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:function(){var e=new Vector3,t=new Matrix4;return function(i,r,n){var a=this.elements,o=e.set(a[0],a[1],a[2]).length(),s=e.set(a[4],a[5],a[6]).length(),l=e.set(a[8],a[9],a[10]).length();0>this.determinant()&&(o=-o),i.x=a[12],i.y=a[13],i.z=a[14],t.copy(this);var c=1/o,h=1/s,u=1/l;return t.elements[0]*=c,t.elements[1]*=c,t.elements[2]*=c,t.elements[4]*=h,t.elements[5]*=h,t.elements[6]*=h,t.elements[8]*=u,t.elements[9]*=u,t.elements[10]*=u,r.setFromRotationMatrix(t),n.x=o,n.y=s,n.z=l,this}}(),makePerspective:function(e,t,i,r,n,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*n/(t-e),l=2*n/(i-r),c=(t+e)/(t-e),h=(i+r)/(i-r),u=-(a+n)/(a-n),d=-2*a*n/(a-n);return o[0]=s,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(e,t,i,r,n,a){var o=this.elements,s=1/(t-e),l=1/(i-r),c=1/(a-n),h=(t+e)*s,u=(i+r)*l,d=(a+n)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){for(var t=this.elements,i=e.elements,r=0;16>r;r++)if(t[r]!==i[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var i=0;16>i;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}),Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Euler.DefaultOrder="XYZ",Object.defineProperties(Euler.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(Euler.prototype,{isEuler:!0,set:function(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,i){var r=_Math.clamp,n=e.elements,a=n[0],o=n[4],s=n[8],l=n[1],c=n[5],h=n[9],u=n[2],d=n[6],p=n[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(r(s,-1,1)),.99999>Math.abs(s)?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(h,-1,1)),.99999>Math.abs(h)?(this._y=Math.atan2(s,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,a),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(d,-1,1)),.99999>Math.abs(d)?(this._y=Math.atan2(-u,p),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,a))):"ZYX"===t?(this._y=Math.asin(-r(u,-1,1)),.99999>Math.abs(u)?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,c))):"YZX"===t?(this._z=Math.asin(r(l,-1,1)),.99999>Math.abs(l)?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,a)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===t?(this._z=Math.asin(-r(o,-1,1)),.99999>Math.abs(o)?(this._x=Math.atan2(d,c),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-h,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==i&&this._onChangeCallback(),this},setFromQuaternion:function(){var e=new Matrix4;return function(t,i,r){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,i,r)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new Quaternion;return function(t){return e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Vector3(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(Layers.prototype,{set:function(e){this.mask=0|1<<e},enable:function(e){this.mask|=0|1<<e},toggle:function(e){this.mask^=0|1<<e},disable:function(e){this.mask&=~(0|1<<e)},test:function(e){return 0!=(this.mask&e.mask)}});var object3DId=0;function Object3D(){Object.defineProperty(this,"id",{value:object3DId++}),this.uuid=_Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DefaultUp.clone();var e=new Vector3,t=new Euler,i=new Quaternion,r=new Vector3(1,1,1);t._onChange(function(){i.setFromEuler(t,!1)}),i._onChange(function(){t.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Scene(){Object3D.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Box3(e,t){this.min=void 0!==e?e:new Vector3(1/0,1/0,1/0),this.max=void 0!==t?t:new Vector3(-1/0,-1/0,-1/0)}function Sphere(e,t){this.center=void 0!==e?e:new Vector3,this.radius=void 0!==t?t:0}function Ray(e,t){this.origin=void 0!==e?e:new Vector3,this.direction=void 0!==t?t:new Vector3}function Triangle(e,t,i){this.a=void 0!==e?e:new Vector3,this.b=void 0!==t?t:new Vector3,this.c=void 0!==i?i:new Vector3}Object3D.DefaultUp=new Vector3(0,1,0),Object3D.DefaultMatrixAutoUpdate=!0,Object3D.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Object3D,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new Quaternion;return function(t,i){return e.setFromAxisAngle(t,i),this.quaternion.multiply(e),this}}(),rotateOnWorldAxis:function(){var e=new Quaternion;return function(t,i){return e.setFromAxisAngle(t,i),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new Vector3;return function(t,i){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(i)),this}}(),translateX:function(){var e=new Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new Quaternion,t=new Matrix4,i=new Vector3,r=new Vector3;return function(n,a,o){n.isVector3?i.copy(n):i.set(n,a,o);var s=this.parent;this.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?t.lookAt(r,i,this.up):t.lookAt(i,r,this.up),this.quaternion.setFromRotationMatrix(t),s&&(t.extractRotation(s.matrixWorld),e.setFromRotationMatrix(t),this.quaternion.premultiply(e.inverse()))}}(),add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent({type:"added"})):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var i=this.children.indexOf(e);return-1!==i&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent({type:"removed"})),this},attach:function(){var e=new Matrix4;return function(t){return this.updateWorldMatrix(!0,!1),e.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),e.multiply(t.parent.matrixWorld)),t.applyMatrix(e),t.updateWorldMatrix(!1,!1),this.add(t),this}}(),getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var i=0,r=this.children.length;i<r;i++){var n=this.children[i].getObjectByProperty(e,t);if(void 0!==n)return n}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Vector3),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new Vector3,t=new Vector3;return function(i){return void 0===i&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),i=new Quaternion),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,i,t),i}}(),getWorldScale:function(){var e=new Vector3,t=new Quaternion;return function(i){return void 0===i&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),i=new Vector3),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,i),i}}(),getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Vector3),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,i=0,r=t.length;i<r;i++)t[i].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,n=0,a=r.length;n<a;n++)r[n].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={uuid:this.uuid,type:this.type};function n(t,i){return void 0===t[i.uuid]&&(t[i.uuid]=i.toJSON(e)),i.uuid}if(""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isMesh&&this.drawMode!==TrianglesDrawMode&&(r.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){r.geometry=n(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s,l=0,c=o.length;l<c;l++)s=o[l],n(e.shapes,s);else n(e.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var h=[];for(l=0,c=this.material.length;l<c;l++)h.push(n(e.materials,this.material[l]));r.material=h}else r.material=n(e.materials,this.material);if(0<this.children.length){r.children=[];for(l=0;l<this.children.length;l++)r.children.push(this.children[l].toJSON(e).object)}if(t){var u=f(e.geometries),d=f(e.materials),p=f(e.textures),m=f(e.images);o=f(e.shapes);0<u.length&&(i.geometries=u),0<d.length&&(i.materials=d),0<p.length&&(i.textures=p),0<m.length&&(i.images=m),0<o.length&&(i.shapes=o)}return i.object=r,i;function f(e){var t=[];for(var i in e){var r=e[i];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var i,r=0;r<e.children.length;r++)i=e.children[r],this.add(i.clone());return this}}),Scene.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Scene,isScene:!0,copy:function(e,t){return Object3D.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=Object3D.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.assign(Box3.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,i=1/0,r=1/0,n=-1/0,a=-1/0,o=-1/0,s=0,l=e.length;s<l;s+=3){var c=e[s],h=e[s+1],u=e[s+2];c<t&&(t=c),h<i&&(i=h),u<r&&(r=u),c>n&&(n=c),h>a&&(a=h),u>o&&(o=u)}return this.min.set(t,i,r),this.max.set(n,a,o),this},setFromBufferAttribute:function(e){for(var t=1/0,i=1/0,r=1/0,n=-1/0,a=-1/0,o=-1/0,s=0,l=e.count;s<l;s++){var c=e.getX(s),h=e.getY(s),u=e.getZ(s);c<t&&(t=c),h<i&&(i=h),u<r&&(r=u),c>n&&(n=c),h>a&&(a=h),u>o&&(o=u)}return this.min.set(t,i,r),this.max.set(n,a,o),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Vector3;return function(t,i){var r=e.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Vector3),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Vector3),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e,t,i,r=new Vector3;function n(n){var a=n.geometry;if(void 0!==a)if(a.isGeometry){var o=a.vertices;for(t=0,i=o.length;t<i;t++)r.copy(o[t]),r.applyMatrix4(n.matrixWorld),e.expandByPoint(r)}else if(a.isBufferGeometry){var s=a.attributes.position;if(void 0!==s)for(t=0,i=s.count;t<i;t++)r.fromBufferAttribute(s,t).applyMatrix4(n.matrixWorld),e.expandByPoint(r)}}return function(t){return e=this,t.updateMatrixWorld(!0),t.traverse(n),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Vector3),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var e=new Vector3;return function(t){return this.clampPoint(t.center,e),e.distanceToSquared(t.center)<=t.radius*t.radius}}(),intersectsPlane:function(e){var t,i;return 0<e.normal.x?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),0<e.normal.y?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant},intersectsTriangle:function(){var e=new Vector3,t=new Vector3,i=new Vector3,r=new Vector3,n=new Vector3,a=new Vector3,o=new Vector3,s=new Vector3,l=new Vector3,c=new Vector3;function h(r){var n,a;for(n=0,a=r.length-3;n<=a;n+=3){o.fromArray(r,n);var s=l.x*Math.abs(o.x)+l.y*Math.abs(o.y)+l.z*Math.abs(o.z),c=e.dot(o),h=t.dot(o),u=i.dot(o);if(Math.max(-Math.max(c,h,u),Math.min(c,h,u))>s)return!1}return!0}return function(o){if(this.isEmpty())return!1;this.getCenter(s),l.subVectors(this.max,s),e.subVectors(o.a,s),t.subVectors(o.b,s),i.subVectors(o.c,s),r.subVectors(t,e),n.subVectors(i,t),a.subVectors(e,i);var u=[0,-r.z,r.y,0,-n.z,n.y,0,-a.z,a.y,r.z,0,-r.x,n.z,0,-n.x,a.z,0,-a.x,-r.y,r.x,0,-n.y,n.x,0,-a.y,a.x,0];return!!h(u)&&(!!h(u=[1,0,0,0,1,0,0,0,1])&&(c.crossVectors(r,n),h(u=[c.x,c.y,c.z])))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Vector3),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Vector3;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new Vector3;return function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3];return function(t){return this.isEmpty()?this:(e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(e),this)}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Sphere.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new Box3;return function(t,i){var r=this.center;void 0!==i?r.copy(i):e.setFromPoints(t).getCenter(r);for(var n=0,a=0,o=t.length;a<o;a++)n=Math.max(n,r.distanceToSquared(t[a]));return this.radius=Math.sqrt(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var i=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Vector3),t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Box3),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(Ray.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Vector3),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Vector3),t.subVectors(e,this.origin);var i=t.dot(this.direction);return 0>i?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new Vector3;return function(t){var i=e.subVectors(t,this.origin).dot(this.direction);return 0>i?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(i).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:function(){var e=new Vector3,t=new Vector3,i=new Vector3;return function(r,n,a,o){e.copy(r).add(n).multiplyScalar(.5),t.copy(n).sub(r).normalize(),i.copy(this.origin).sub(e);var s,l,c,h,u=.5*r.distanceTo(n),d=-this.direction.dot(t),p=i.dot(this.direction),m=-i.dot(t),f=i.lengthSq(),g=Math.abs(1-d*d);if(0<g)if(l=d*p-m,h=u*g,0<=(s=d*m-p))if(l>=-h)if(l<=h){var v=1/g;c=(s*=v)*(s+d*(l*=v)+2*p)+l*(d*s+l+2*m)+f}else l=u,c=-(s=Math.max(0,-(d*l+p)))*s+l*(l+2*m)+f;else l=-u,c=-(s=Math.max(0,-(d*l+p)))*s+l*(l+2*m)+f;else l<=-h?c=-(s=Math.max(0,-(-d*u+p)))*s+(l=0<s?-u:Math.min(Math.max(-u,-m),u))*(l+2*m)+f:l<=h?(s=0,c=(l=Math.min(Math.max(-u,-m),u))*(l+2*m)+f):c=-(s=Math.max(0,-(d*u+p)))*s+(l=0<s?u:Math.min(Math.max(-u,-m),u))*(l+2*m)+f;else l=0<d?-u:u,c=-(s=Math.max(0,-(d*l+p)))*s+l*(l+2*m)+f;return a&&a.copy(this.direction).multiplyScalar(s).add(this.origin),o&&o.copy(t).multiplyScalar(l).add(e),c}}(),intersectSphere:function(){var e=new Vector3;return function(t,i){e.subVectors(t.center,this.origin);var r=e.dot(this.direction),n=e.dot(e)-r*r,a=t.radius*t.radius;if(n>a)return null;var o=Math.sqrt(a-n),s=r-o,l=r+o;return 0>s&&0>l?null:0>s?this.at(l,i):this.at(s,i)}}(),intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(e.normal)+e.constant)/t;return 0<=i?i:null},intersectPlane:function(e,t){var i=this.distanceToPlane(e);return null===i?null:this.at(i,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||0>e.normal.dot(this.direction)*t},intersectBox:function(e,t){var i,r,n,a,o,s,l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return 0<=l?(i=(e.min.x-u.x)*l,r=(e.max.x-u.x)*l):(i=(e.max.x-u.x)*l,r=(e.min.x-u.x)*l),0<=c?(n=(e.min.y-u.y)*c,a=(e.max.y-u.y)*c):(n=(e.max.y-u.y)*c,a=(e.min.y-u.y)*c),i>a||n>r?null:((n>i||i!=i)&&(i=n),(a<r||r!=r)&&(r=a),0<=h?(o=(e.min.z-u.z)*h,s=(e.max.z-u.z)*h):(o=(e.max.z-u.z)*h,s=(e.min.z-u.z)*h),i>s||o>r?null:((o>i||i!=i)&&(i=o),(s<r||r!=r)&&(r=s),0>r?null:this.at(0<=i?i:r,t)))},intersectsBox:function(){var e=new Vector3;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var e=new Vector3,t=new Vector3,i=new Vector3,r=new Vector3;return function(n,a,o,s,l){t.subVectors(a,n),i.subVectors(o,n),r.crossVectors(t,i);var c,h=this.direction.dot(r);if(0<h){if(s)return null;c=1}else{if(!(0>h))return null;c=-1,h=-h}e.subVectors(this.origin,n);var u=c*this.direction.dot(i.crossVectors(e,i));if(0>u)return null;var d=c*this.direction.dot(t.cross(e));if(0>d)return null;if(u+d>h)return null;var p=-c*e.dot(r);return 0>p?null:this.at(p/h,l)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(Triangle,{getNormal:function(){var e=new Vector3;return function(t,i,r,n){void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new Vector3),n.subVectors(r,i),e.subVectors(t,i),n.cross(e);var a=n.lengthSq();return 0<a?n.multiplyScalar(1/Math.sqrt(a)):n.set(0,0,0)}}(),getBarycoord:function(){var e=new Vector3,t=new Vector3,i=new Vector3;return function(r,n,a,o,s){e.subVectors(o,n),t.subVectors(a,n),i.subVectors(r,n);var l=e.dot(e),c=e.dot(t),h=e.dot(i),u=t.dot(t),d=t.dot(i),p=l*u-c*c;if(void 0===s&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),s=new Vector3),0===p)return s.set(-2,-1,-1);var m=1/p,f=(u*h-c*d)*m,g=(l*d-c*h)*m;return s.set(1-f-g,g,f)}}(),containsPoint:function(){var e=new Vector3;return function(t,i,r,n){return Triangle.getBarycoord(t,i,r,n,e),0<=e.x&&0<=e.y&&1>=e.x+e.y}}(),getUV:function(){var e=new Vector3;return function(t,i,r,n,a,o,s,l){return this.getBarycoord(t,i,r,n,e),l.set(0,0),l.addScaledVector(a,e.x),l.addScaledVector(o,e.y),l.addScaledVector(s,e.z),l}}(),isFrontFacing:function(){var e=new Vector3,t=new Vector3;return function(i,r,n,a){return e.subVectors(n,r),t.subVectors(i,r),0>e.cross(t).dot(a)}}()}),Object.assign(Triangle.prototype,{set:function(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this},setFromPointsAndIndices:function(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){var e=new Vector3,t=new Vector3;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Vector3),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Triangle.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Vector3),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Triangle.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,i,r,n){return Triangle.getUV(e,this.a,this.b,this.c,t,i,r,n)},containsPoint:function(e){return Triangle.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return Triangle.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(){var e=new Vector3,t=new Vector3,i=new Vector3,r=new Vector3,n=new Vector3,a=new Vector3;return function(o,s){void 0===s&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),s=new Vector3);var l,c,h=this.a,u=this.b,d=this.c;e.subVectors(u,h),t.subVectors(d,h),r.subVectors(o,h);var p=e.dot(r),m=t.dot(r);if(0>=p&&0>=m)return s.copy(h);n.subVectors(o,u);var f=e.dot(n),g=t.dot(n);if(0<=f&&g<=f)return s.copy(u);var v=p*g-f*m;if(0>=v&&0<=p&&0>=f)return l=p/(p-f),s.copy(h).addScaledVector(e,l);a.subVectors(o,d);var y=e.dot(a),b=t.dot(a);if(0<=b&&y<=b)return s.copy(d);var _=y*m-p*b;if(0>=_&&0<=m&&0>=b)return c=m/(m-b),s.copy(h).addScaledVector(t,c);var x=f*b-y*g;if(0>=x&&0<=g-f&&0<=y-b)return i.subVectors(d,u),c=(g-f)/(g-f+(y-b)),s.copy(u).addScaledVector(i,c);var w=1/(x+_+v);return l=_*w,c=v*w,s.copy(h).addScaledVector(e,l).addScaledVector(t,c)}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Color(e,t,i){return void 0===t&&void 0===i?this.set(e):this.setRGB(e,t,i)}function hue2rgb(e,t,i){return 0>i&&(i+=1),1<i&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+6*(t-e)*(2/3-i):e}function SRGBToLinear(e){return.04045>e?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function LinearToSRGB(e){return.0031308>e?12.92*e:1.055*Math.pow(e,.41666)-.055}function Face3(e,t,i,r,n,a){this.a=e,this.b=t,this.c=i,this.normal=r&&r.isVector3?r:new Vector3,this.vertexNormals=Array.isArray(r)?r:[],this.color=n&&n.isColor?n:new Color,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=void 0!==a?a:0}Object.assign(Color.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(255&e>>16)/255,this.g=(255&e>>8)/255,this.b=(255&e)/255,this},setRGB:function(e,t,i){return this.r=e,this.g=t,this.b=i,this},setHSL:function(e,t,i){if(e=_Math.euclideanModulo(e,1),t=_Math.clamp(t,0,1),i=_Math.clamp(i,0,1),0===t)this.r=this.g=this.b=i;else{var r=.5>=i?i*(1+t):i+t-i*t,n=2*i-r;this.r=hue2rgb(n,r,e+1/3),this.g=hue2rgb(n,r,e),this.b=hue2rgb(n,r,e-1/3)}return this},setStyle:function(e){function t(t){void 0!==t&&1>parseFloat(t)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r,n=i[1],a=i[2];switch(n){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,l=parseInt(r[3],10)/100;return t(r[5]),this.setHSL(o,s,l)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){var c,h=(c=i[1]).length;if(3===h)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===h)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}e&&0<e.length&&(void 0!==(c=ColorKeywords[e])?this.setHex(c):console.warn("THREE.Color: Unknown color "+e));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var i=0<t?1/t:1;return this.r=Math.pow(e.r,i),this.g=Math.pow(e.g,i),this.b=Math.pow(e.b,i),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=SRGBToLinear(e.r),this.g=SRGBToLinear(e.g),this.b=SRGBToLinear(e.b),this},copyLinearToSRGB:function(e){return this.r=LinearToSRGB(e.r),this.g=LinearToSRGB(e.g),this.b=LinearToSRGB(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,i,r=this.r,n=this.g,a=this.b,o=Math.max(r,n,a),s=Math.min(r,n,a),l=(s+o)/2;if(s===o)t=0,i=0;else{var c=o-s;switch(i=.5>=l?c/(o+s):c/(2-o-s),o){case r:t=(n-a)/c+(n<a?6:0);break;case n:t=(a-r)/c+2;break;case a:t=(r-n)/c+4}t/=6}return e.h=t,e.s=i,e.l=l,e},getStyle:function(){return"rgb("+(0|255*this.r)+","+(0|255*this.g)+","+(0|255*this.b)+")"},offsetHSL:function(){var e={};return function(t,i,r){return this.getHSL(e),e.h+=t,e.s+=i,e.l+=r,this.setHSL(e.h,e.s,e.l),this}}(),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(){var e={h:0,s:0,l:0},t={h:0,s:0,l:0};return function(i,r){this.getHSL(e),i.getHSL(t);var n=_Math.lerp(e.h,t.h,r),a=_Math.lerp(e.s,t.s,r),o=_Math.lerp(e.l,t.l,r);return this.setHSL(n,a,o),this}}(),equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),Object.assign(Face3.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,i=e.vertexNormals.length;t<i;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,i=e.vertexColors.length;t<i;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var materialId=0;function Material(){Object.defineProperty(this,"id",{value:materialId++}),this.uuid=_Math.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=NormalBlending,this.side=FrontSide,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=NoColors,this.opacity=1,this.transparent=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}function MeshBasicMaterial(e){Material.call(this),this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function BufferAttribute(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===i,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Int8BufferAttribute(e,t,i){BufferAttribute.call(this,new Int8Array(e),t,i)}function Uint8BufferAttribute(e,t,i){BufferAttribute.call(this,new Uint8Array(e),t,i)}function Uint8ClampedBufferAttribute(e,t,i){BufferAttribute.call(this,new Uint8ClampedArray(e),t,i)}function Int16BufferAttribute(e,t,i){BufferAttribute.call(this,new Int16Array(e),t,i)}function Uint16BufferAttribute(e,t,i){BufferAttribute.call(this,new Uint16Array(e),t,i)}function Int32BufferAttribute(e,t,i){BufferAttribute.call(this,new Int32Array(e),t,i)}function Uint32BufferAttribute(e,t,i){BufferAttribute.call(this,new Uint32Array(e),t,i)}function Float32BufferAttribute(e,t,i){BufferAttribute.call(this,new Float32Array(e),t,i)}function Float64BufferAttribute(e,t,i){BufferAttribute.call(this,new Float64Array(e),t,i)}function DirectGeometry(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function arrayMax(e){if(0===e.length)return-1/0;for(var t=e[0],i=1,r=e.length;i<r;++i)e[i]>t&&(t=e[i]);return t}Material.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Material,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var i=e[t];if(void 0!==i)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===FlatShading;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"},uuid:this.uuid,type:this.type};function r(e){var t=[];for(var i in e){var r=e[i];delete r.metadata,t.push(r)}return t}if(""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearCoat&&(i.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(i.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,i.reflectivity=this.reflectivity,i.refractionRatio=this.refractionRatio,void 0!==this.combine&&(i.combine=this.combine),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(i.blending=this.blending),!0===this.flatShading&&(i.flatShading=this.flatShading),this.side!==FrontSide&&(i.side=this.side),this.vertexColors!==NoColors&&(i.vertexColors=this.vertexColors),1>this.opacity&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),0<this.alphaTest&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),1<this.wireframeLinewidth&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(i.morphTargets=!0),!0===this.morphNormals&&(i.morphNormals=!0),!0===this.skinning&&(i.skinning=!0),!1===this.visible&&(i.visible=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),t){var n=r(e.textures),a=r(e.images);0<n.length&&(i.textures=n),0<a.length&&(i.images=a)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,i=null;if(null!==t){var r=t.length;i=Array(r);for(var n=0;n!==r;++n)i[n]=t[n].clone()}return this.clippingPlanes=i,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),MeshBasicMaterial.prototype=Object.create(Material.prototype),MeshBasicMaterial.prototype.constructor=MeshBasicMaterial,MeshBasicMaterial.prototype.isMeshBasicMaterial=!0,MeshBasicMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Object.defineProperty(BufferAttribute.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(BufferAttribute.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.itemSize:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,i){e*=this.itemSize,i*=t.itemSize;for(var r=0,n=this.itemSize;r<n;r++)this.array[e+r]=t.array[i+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t,i=this.array,r=0,n=0,a=e.length;n<a;n++)void 0===(t=e[n])&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),t=new Color),i[r++]=t.r,i[r++]=t.g,i[r++]=t.b;return this},copyVector2sArray:function(e){for(var t,i=this.array,r=0,n=0,a=e.length;n<a;n++)void 0===(t=e[n])&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),t=new Vector2),i[r++]=t.x,i[r++]=t.y;return this},copyVector3sArray:function(e){for(var t,i=this.array,r=0,n=0,a=e.length;n<a;n++)void 0===(t=e[n])&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),t=new Vector3),i[r++]=t.x,i[r++]=t.y,i[r++]=t.z;return this},copyVector4sArray:function(e){for(var t,i=this.array,r=0,n=0,a=e.length;n<a;n++)void 0===(t=e[n])&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),t=new Vector4),i[r++]=t.x,i[r++]=t.y,i[r++]=t.z,i[r++]=t.w;return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this},setXYZ:function(e,t,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this},setXYZW:function(e,t,i,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=n,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Int8BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Int8BufferAttribute.prototype.constructor=Int8BufferAttribute,Uint8BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint8BufferAttribute.prototype.constructor=Uint8BufferAttribute,Uint8ClampedBufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint8ClampedBufferAttribute.prototype.constructor=Uint8ClampedBufferAttribute,Int16BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Int16BufferAttribute.prototype.constructor=Int16BufferAttribute,Uint16BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint16BufferAttribute.prototype.constructor=Uint16BufferAttribute,Int32BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Int32BufferAttribute.prototype.constructor=Int32BufferAttribute,Uint32BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint32BufferAttribute.prototype.constructor=Uint32BufferAttribute,Float32BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Float32BufferAttribute.prototype.constructor=Float32BufferAttribute,Float64BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Float64BufferAttribute.prototype.constructor=Float64BufferAttribute,Object.assign(DirectGeometry.prototype,{computeGroups:function(e){for(var t,i,r=[],n=void 0,a=e.faces,o=0;o<a.length;o++)(i=a[o]).materialIndex!==n&&(n=i.materialIndex,void 0!==t&&(t.count=3*o-t.start,r.push(t)),t={start:3*o,materialIndex:n});void 0!==t&&(t.count=3*o-t.start,r.push(t)),this.groups=r},fromGeometry:function(e){var t,i=e.faces,r=e.vertices,n=e.faceVertexUvs,a=n[0]&&0<n[0].length,o=n[1]&&0<n[1].length,s=e.morphTargets,l=s.length;if(0<l){t=[];for(var c=0;c<l;c++)t[c]={name:s[c].name,data:[]};this.morphTargets.position=t}var h,u=e.morphNormals,d=u.length;if(0<d){h=[];for(c=0;c<d;c++)h[c]={name:u[c].name,data:[]};this.morphTargets.normal=h}var p=e.skinIndices,m=e.skinWeights,f=p.length===r.length,g=m.length===r.length;0<r.length&&0===i.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");var v;for(c=0;c<i.length;c++){v=i[c],this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=v.normal;this.normals.push(b,b,b)}var _,x=v.vertexColors;if(3===x.length)this.colors.push(x[0],x[1],x[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===a)void 0!==(_=n[0][c])?this.uvs.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new Vector2,new Vector2,new Vector2));if(!0===o)void 0!==(_=n[1][c])?this.uvs2.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new Vector2,new Vector2,new Vector2));for(var S,T=0;T<l;T++)S=s[T].vertices,t[T].data.push(S[v.a],S[v.b],S[v.c]);var A;for(T=0;T<d;T++)A=u[T].vertexNormals[c],h[T].data.push(A.a,A.b,A.c);f&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(m[v.a],m[v.b],m[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});var bufferGeometryId=1;function BufferGeometry(){Object.defineProperty(this,"id",{value:bufferGeometryId+=2}),this.uuid=_Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function Mesh(e,t){Object3D.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new BufferGeometry,this.material=void 0!==t?t:new MeshBasicMaterial({color:16777215*Math.random()}),this.drawMode=TrianglesDrawMode,this.updateMorphTargets()}BufferGeometry.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:BufferGeometry,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(65535<arrayMax(e)?Uint32BufferAttribute:Uint16BufferAttribute)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new BufferAttribute(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,i){this.groups.push({start:e,count:t,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var i=this.attributes.normal;void 0!==i&&((new Matrix3).getNormalMatrix(e).applyToBufferAttribute(i),i.needsUpdate=!0);var r=this.attributes.tangent;void 0!==r&&((new Matrix3).getNormalMatrix(e).applyToBufferAttribute(r),r.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new Matrix4;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Matrix4;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Matrix4;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new Matrix4;return function(t,i,r){return e.makeTranslation(t,i,r),this.applyMatrix(e),this}}(),scale:function(){var e=new Matrix4;return function(t,i,r){return e.makeScale(t,i,r),this.applyMatrix(e),this}}(),lookAt:function(){var e=new Object3D;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){var e=new Vector3;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var i=new Float32BufferAttribute(3*t.vertices.length,3),r=new Float32BufferAttribute(3*t.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(t.vertices)),this.addAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var n=new Float32BufferAttribute(t.lineDistances.length,1);this.addAttribute("lineDistance",n.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t,i=[],r=0,n=e.length;r<n;r++)t=e[r],i.push(t.x,t.y,t.z||0);return this.addAttribute("position",new Float32BufferAttribute(i,3)),this},updateFromObject:function(e){var t,i=e.geometry;if(e.isMesh){var r=i.__directGeometry;if(!0===i.elementsNeedUpdate&&(r=void 0,i.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(i);r.verticesNeedUpdate=i.verticesNeedUpdate,r.normalsNeedUpdate=i.normalsNeedUpdate,r.colorsNeedUpdate=i.colorsNeedUpdate,r.uvsNeedUpdate=i.uvsNeedUpdate,r.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=r}return!0===i.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(i.vertices),t.needsUpdate=!0),i.verticesNeedUpdate=!1),!0===i.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(i.normals),t.needsUpdate=!0),i.normalsNeedUpdate=!1),!0===i.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(i.colors),t.needsUpdate=!0),i.colorsNeedUpdate=!1),i.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(i.uvs),t.needsUpdate=!0),i.uvsNeedUpdate=!1),i.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(i.lineDistances),t.needsUpdate=!0),i.lineDistancesNeedUpdate=!1),i.groupsNeedUpdate&&(i.computeGroups(e.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new DirectGeometry).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new BufferAttribute(t,3).copyVector3sArray(e.vertices)),0<e.normals.length){var i=new Float32Array(3*e.normals.length);this.addAttribute("normal",new BufferAttribute(i,3).copyVector3sArray(e.normals))}if(0<e.colors.length){var r=new Float32Array(3*e.colors.length);this.addAttribute("color",new BufferAttribute(r,3).copyColorsArray(e.colors))}if(0<e.uvs.length){var n=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new BufferAttribute(n,2).copyVector2sArray(e.uvs))}if(0<e.uvs2.length){var a=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new BufferAttribute(a,2).copyVector2sArray(e.uvs2))}for(var o in this.groups=e.groups,e.morphTargets){for(var s=[],l=e.morphTargets[o],c=0,h=l.length;c<h;c++){var u=l[c],d=new Float32BufferAttribute(3*u.data.length,3);d.name=u.name,s.push(d.copyVector3sArray(u.data))}this.morphAttributes[o]=s}if(0<e.skinIndices.length){var p=new Float32BufferAttribute(4*e.skinIndices.length,4);this.addAttribute("skinIndex",p.copyVector4sArray(e.skinIndices))}if(0<e.skinWeights.length){var m=new Float32BufferAttribute(4*e.skinWeights.length,4);this.addAttribute("skinWeight",m.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){var e=new Box3;return function(){null===this.boundingBox&&(this.boundingBox=new Box3);var t=this.attributes.position,i=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),i)for(var r,n=0,a=i.length;n<a;n++)r=i[n],e.setFromBufferAttribute(r),this.boundingBox.expandByPoint(e.min),this.boundingBox.expandByPoint(e.max)}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var e=new Box3,t=new Box3,i=new Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new Sphere);var r=this.attributes.position,n=this.morphAttributes.position;if(r){var a=this.boundingSphere.center;if(e.setFromBufferAttribute(r),n)for(var o=0,s=n.length;o<s;o++)c=n[o],t.setFromBufferAttribute(c),e.expandByPoint(t.min),e.expandByPoint(t.max);e.getCenter(a);var l=0;for(o=0,s=r.count;o<s;o++)i.fromBufferAttribute(r,o),l=Math.max(l,a.distanceToSquared(i));if(n){var c;for(o=0,s=n.length;o<s;o++)for(var h=0,u=(c=n[o]).count;h<u;h++)i.fromBufferAttribute(c,h),l=Math.max(l,a.distanceToSquared(i))}this.boundingSphere.radius=Math.sqrt(l),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var i=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new BufferAttribute(new Float32Array(i.length),3));else for(var r=t.normal.array,n=0,a=r.length;n<a;n++)r[n]=0;var o,s,l,c=t.normal.array,h=new Vector3,u=new Vector3,d=new Vector3,p=new Vector3,m=new Vector3;if(e){var f=e.array;for(n=0,a=e.count;n<a;n+=3)o=3*f[n+0],s=3*f[n+1],l=3*f[n+2],h.fromArray(i,o),u.fromArray(i,s),d.fromArray(i,l),p.subVectors(d,u),m.subVectors(h,u),p.cross(m),c[o]+=p.x,c[o+1]+=p.y,c[o+2]+=p.z,c[s]+=p.x,c[s+1]+=p.y,c[s+2]+=p.z,c[l]+=p.x,c[l+1]+=p.y,c[l+2]+=p.z}else for(n=0,a=i.length;n<a;n+=9)h.fromArray(i,n),u.fromArray(i,n+3),d.fromArray(i,n+6),p.subVectors(d,u),m.subVectors(h,u),p.cross(m),c[n]=p.x,c[n+1]=p.y,c[n+2]=p.z,c[n+3]=p.x,c[n+4]=p.y,c[n+5]=p.z,c[n+6]=p.x,c[n+7]=p.y,c[n+8]=p.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var i=this.attributes;for(var r in i)if(void 0!==e.attributes[r])for(var n=i[r].array,a=e.attributes[r],o=a.array,s=a.itemSize*t,l=Math.min(o.length,n.length-s),c=0,h=s;c<l;c++,h++)n[h]=o[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var e=new Vector3;return function(){for(var t=this.attributes.normal,i=0,r=t.count;i<r;i++)e.x=t.getX(i),e.y=t.getY(i),e.z=t.getZ(i),e.normalize(),t.setXYZ(i,e.x,e.y,e.z)}}(),toNonIndexed:function(){function e(e,t){for(var i=e.array,r=e.itemSize,n=new i.constructor(t.length*r),a=0,o=0,s=0,l=t.length;s<l;s++){a=t[s]*r;for(var c=0;c<r;c++)n[o++]=i[a++]}return new BufferAttribute(n,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new BufferGeometry,i=this.index.array,r=this.attributes;for(var n in r){var a=e(r[n],i);t.addAttribute(n,a)}var o=this.morphAttributes;for(n in o){for(var s=[],l=o[n],c=0,h=l.length;c<h;c++){a=e(l[c],i);s.push(a)}t.morphAttributes[n]=s}for(var u,d=this.groups,p=(c=0,d.length);c<p;c++)u=d[c],t.addGroup(u.start,u.count,u.materialIndex);return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"},uuid:this.uuid,type:this.type};if(""!==this.name&&(e.name=this.name),0<Object.keys(this.userData).length&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var n=this.attributes;for(var i in n){var a=(d=n[i]).toJSON();""!==d.name&&(a.name=d.name),e.data.attributes[i]=a}var o={},s=!1;for(var i in this.morphAttributes){for(var l=this.morphAttributes[i],c=[],h=0,u=l.length;h<u;h++){var d;a=(d=l[h]).toJSON();""!==d.name&&(a.name=d.name),c.push(a)}0<c.length&&(o[i]=c,s=!0)}s&&(e.data.morphAttributes=o);var p=this.groups;0<p.length&&(e.data.groups=JSON.parse(JSON.stringify(p)));var m=this.boundingSphere;return null!==m&&(e.data.boundingSphere={center:m.center.toArray(),radius:m.radius}),e},clone:function(){return(new BufferGeometry).copy(this)},copy:function(e){var t,i,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone());var a=e.attributes;for(t in a){var o=a[t];this.addAttribute(t,o.clone())}var s=e.morphAttributes;for(t in s){var l=[],c=s[t];for(i=0,r=c.length;i<r;i++)l.push(c[i].clone());this.morphAttributes[t]=l}var h=e.groups;for(i=0,r=h.length;i<r;i++){var u=h[i];this.addGroup(u.start,u.count,u.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Mesh.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Mesh,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return Object3D.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,i,r=this.geometry;if(r.isBufferGeometry){var n=r.morphAttributes,a=Object.keys(n);if(0<a.length){var o=n[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=o.length;e<t;e++)i=o[e].name||e+"",this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}else{var s=r.morphTargets;void 0!==s&&0<s.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(){var e=new Matrix4,t=new Ray,i=new Sphere,r=new Vector3,n=new Vector3,a=new Vector3,o=new Vector3,s=new Vector3,l=new Vector3,c=new Vector3,h=new Vector3,u=new Vector3,d=new Vector2,p=new Vector2,m=new Vector2,f=new Vector3,g=new Vector3;function v(e,t,i,r,n,a,o,s){if(null===(t.side===BackSide?r.intersectTriangle(o,a,n,!0,s):r.intersectTriangle(n,a,o,t.side!==DoubleSide,s)))return null;g.copy(s),g.applyMatrix4(e.matrixWorld);var l=i.ray.origin.distanceTo(g);return l<i.near||l>i.far?null:{distance:l,point:g.clone(),object:e}}function y(e,t,i,g,y,b,_,x,w,S){r.fromBufferAttribute(y,x),n.fromBufferAttribute(y,w),a.fromBufferAttribute(y,S);var T=e.morphTargetInfluences;if(t.morphTargets&&b&&T){c.set(0,0,0),h.set(0,0,0),u.set(0,0,0);for(var A=0,E=b.length;A<E;A++){var C=T[A],M=b[A];0!==C&&(o.fromBufferAttribute(M,x),s.fromBufferAttribute(M,w),l.fromBufferAttribute(M,S),c.addScaledVector(o.sub(r),C),h.addScaledVector(s.sub(n),C),u.addScaledVector(l.sub(a),C))}r.add(c),n.add(h),a.add(u)}var P=v(e,t,i,g,r,n,a,f);if(P){_&&(d.fromBufferAttribute(_,x),p.fromBufferAttribute(_,w),m.fromBufferAttribute(_,S),P.uv=Triangle.getUV(f,r,n,a,d,p,m,new Vector2));var L=new Face3(x,w,S);Triangle.getNormal(r,n,a,L.normal),P.face=L}return P}return function(r,n){var a,o=this.geometry,s=this.material,l=this.matrixWorld;if(void 0!==s&&(null===o.boundingSphere&&o.computeBoundingSphere(),i.copy(o.boundingSphere),i.applyMatrix4(l),!1!==r.ray.intersectsSphere(i)&&(e.getInverse(l),t.copy(r.ray).applyMatrix4(e),null===o.boundingBox||!1!==t.intersectsBox(o.boundingBox))))if(o.isBufferGeometry){var c,h,u,g,b,_,x,w,S,T=o.index,A=o.attributes.position,E=o.morphAttributes.position,C=o.attributes.uv,M=o.groups,P=o.drawRange;if(null!==T)if(Array.isArray(s))for(g=0,_=M.length;g<_;g++)for(S=s[(w=M[g]).materialIndex],b=Math.max(w.start,P.start),x=Math.min(w.start+w.count,P.start+P.count);b<x;b+=3)c=T.getX(b),h=T.getX(b+1),u=T.getX(b+2),(a=y(this,S,r,t,A,E,C,c,h,u))&&(a.faceIndex=Math.floor(b/3),a.face.materialIndex=w.materialIndex,n.push(a));else for(g=Math.max(0,P.start),_=Math.min(T.count,P.start+P.count);g<_;g+=3)c=T.getX(g),h=T.getX(g+1),u=T.getX(g+2),(a=y(this,s,r,t,A,E,C,c,h,u))&&(a.faceIndex=Math.floor(g/3),n.push(a));else if(void 0!==A)if(Array.isArray(s))for(g=0,_=M.length;g<_;g++)for(S=s[(w=M[g]).materialIndex],b=Math.max(w.start,P.start),x=Math.min(w.start+w.count,P.start+P.count);b<x;b+=3)(a=y(this,S,r,t,A,E,C,c=b,h=b+1,u=b+2))&&(a.faceIndex=Math.floor(b/3),a.face.materialIndex=w.materialIndex,n.push(a));else for(g=Math.max(0,P.start),_=Math.min(A.count,P.start+P.count);g<_;g+=3)(a=y(this,s,r,t,A,E,C,c=g,h=g+1,u=g+2))&&(a.faceIndex=Math.floor(g/3),n.push(a))}else if(o.isGeometry){var L,I,B,R,F=Array.isArray(s),O=o.vertices,k=o.faces,D=o.faceVertexUvs[0];0<D.length&&(R=D);for(var N=0,z=k.length;N<z;N++){var G=k[N],U=F?s[G.materialIndex]:s;if(void 0!==U&&(L=O[G.a],I=O[G.b],B=O[G.c],a=v(this,U,r,t,L,I,B,f))){if(R&&R[N]){var V=R[N];d.copy(V[0]),p.copy(V[1]),m.copy(V[2]),a.uv=Triangle.getUV(f,L,I,B,d,p,m,new Vector2)}a.face=G,a.faceIndex=N,n.push(a)}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var geometryId=0;function Geometry(){Object.defineProperty(this,"id",{value:geometryId+=2}),this.uuid=_Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function BoxGeometry(e,t,i,r,n,a){Geometry.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:n,depthSegments:a},this.fromBufferGeometry(new BoxBufferGeometry(e,t,i,r,n,a)),this.mergeVertices()}function BoxBufferGeometry(e,t,i,r,n,a){BufferGeometry.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:n,depthSegments:a};var o=this;e=e||1,t=t||1,i=i||1,r=Math.floor(r)||1,n=Math.floor(n)||1;var s=[],l=[],c=[],h=[],u=0,d=0;function p(e,t,i,r,n,a,p,m,f,g,v){var y,b,_=a/f,x=p/g,w=a/2,S=p/2,T=m/2,A=f+1,E=g+1,C=0,M=0,P=new Vector3;for(b=0;b<E;b++){var L=b*x-S;for(y=0;y<A;y++){var I=y*_-w;P[e]=I*r,P[t]=L*n,P[i]=T,l.push(P.x,P.y,P.z),P[e]=0,P[t]=0,P[i]=0<m?1:-1,c.push(P.x,P.y,P.z),h.push(y/f),h.push(1-b/g),C+=1}}for(b=0;b<g;b++)for(y=0;y<f;y++){var B=u+y+A*b,R=u+y+A*(b+1),F=u+(y+1)+A*(b+1),O=u+(y+1)+A*b;s.push(B,R,O),s.push(R,F,O),M+=6}o.addGroup(d,M,v),d+=M,u+=C}p("z","y","x",-1,-1,i,t,e,a=Math.floor(a)||1,n,0),p("z","y","x",1,-1,i,t,-e,a,n,1),p("x","z","y",1,1,e,i,t,r,a,2),p("x","z","y",1,-1,e,i,-t,r,a,3),p("x","y","z",1,-1,e,t,i,r,n,4),p("x","y","z",-1,-1,e,t,-i,r,n,5),this.setIndex(s),this.addAttribute("position",new Float32BufferAttribute(l,3)),this.addAttribute("normal",new Float32BufferAttribute(c,3)),this.addAttribute("uv",new Float32BufferAttribute(h,2))}function cloneUniforms(e){var t={};for(var i in e)for(var r in t[i]={},e[i]){var n=e[i][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture)?t[i][r]=n.clone():Array.isArray(n)?t[i][r]=n.slice():t[i][r]=n}return t}function mergeUniforms(e){for(var t,i={},r=0;r<e.length;r++)for(var n in t=cloneUniforms(e[r]))i[n]=t[n];return i}Geometry.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Geometry,isGeometry:!0,applyMatrix:function(e){for(var t=(new Matrix3).getNormalMatrix(e),i=0,r=this.vertices.length;i<r;i++)this.vertices[i].applyMatrix4(e);var n;for(i=0,r=this.faces.length;i<r;i++){(n=this.faces[i]).normal.applyMatrix3(t).normalize();for(var a=0,o=n.vertexNormals.length;a<o;a++)n.vertexNormals[a].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new Matrix4;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Matrix4;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Matrix4;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new Matrix4;return function(t,i,r){return e.makeTranslation(t,i,r),this.applyMatrix(e),this}}(),scale:function(){var e=new Matrix4;return function(t,i,r){return e.makeScale(t,i,r),this.applyMatrix(e),this}}(),lookAt:function(){var e=new Object3D;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){var t=this,i=null!==e.index?e.index.array:void 0,r=e.attributes,n=r.position.array,a=void 0!==r.normal?r.normal.array:void 0,o=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,l=void 0!==r.uv2?r.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var c=0;c<n.length;c+=3)t.vertices.push((new Vector3).fromArray(n,c)),void 0!==o&&t.colors.push((new Color).fromArray(o,c));function h(e,i,r,n){var c=void 0===o?[]:[t.colors[e].clone(),t.colors[i].clone(),t.colors[r].clone()],h=new Face3(e,i,r,void 0===a?[]:[(new Vector3).fromArray(a,3*e),(new Vector3).fromArray(a,3*i),(new Vector3).fromArray(a,3*r)],c,n);t.faces.push(h),void 0!==s&&t.faceVertexUvs[0].push([(new Vector2).fromArray(s,2*e),(new Vector2).fromArray(s,2*i),(new Vector2).fromArray(s,2*r)]),void 0!==l&&t.faceVertexUvs[1].push([(new Vector2).fromArray(l,2*e),(new Vector2).fromArray(l,2*i),(new Vector2).fromArray(l,2*r)])}var u=e.groups;if(0<u.length)for(c=0;c<u.length;c++)for(var d=u[c],p=d.start,m=p,f=p+d.count;m<f;m+=3)void 0!==i?h(i[m],i[m+1],i[m+2],d.materialIndex):h(m,m+1,m+2,d.materialIndex);else if(void 0!==i)for(c=0;c<i.length;c+=3)h(i[c],i[c+1],i[c+2]);else for(c=0;c<n.length/3;c+=3)h(c,c+1,c+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){var e=new Vector3;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,i=0===t?1:1/t,r=new Matrix4;return r.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var e=new Vector3,t=new Vector3,i=0,r=this.faces.length;i<r;i++){var n=this.faces[i],a=this.vertices[n.a],o=this.vertices[n.b],s=this.vertices[n.c];e.subVectors(s,o),t.subVectors(a,o),e.cross(t),e.normalize(),n.normal.copy(e)}},computeVertexNormals:function(e){var t,i,r,n,a,o;for(void 0===e&&(e=!0),o=Array(this.vertices.length),t=0,i=this.vertices.length;t<i;t++)o[t]=new Vector3;if(e){var s,l,c,h=new Vector3,u=new Vector3;for(r=0,n=this.faces.length;r<n;r++)a=this.faces[r],s=this.vertices[a.a],l=this.vertices[a.b],c=this.vertices[a.c],h.subVectors(c,l),u.subVectors(s,l),h.cross(u),o[a.a].add(h),o[a.b].add(h),o[a.c].add(h)}else for(this.computeFaceNormals(),r=0,n=this.faces.length;r<n;r++)o[(a=this.faces[r]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(t=0,i=this.vertices.length;t<i;t++)o[t].normalize();for(r=0,n=this.faces.length;r<n;r++){var d=(a=this.faces[r]).vertexNormals;3===d.length?(d[0].copy(o[a.a]),d[1].copy(o[a.b]),d[2].copy(o[a.c])):(d[0]=o[a.a].clone(),d[1]=o[a.b].clone(),d[2]=o[a.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,i;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var r=(i=this.faces[e]).vertexNormals;3===r.length?(r[0].copy(i.normal),r[1].copy(i.normal),r[2].copy(i.normal)):(r[0]=i.normal.clone(),r[1]=i.normal.clone(),r[2]=i.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,i,r,n;for(i=0,r=this.faces.length;i<r;i++)for((n=this.faces[i]).__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]),e=0,t=n.vertexNormals.length;e<t;e++)n.__originalVertexNormals[e]?n.__originalVertexNormals[e].copy(n.vertexNormals[e]):n.__originalVertexNormals[e]=n.vertexNormals[e].clone();var a=new Geometry;for(a.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var o=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(i=0,r=this.faces.length;i<r;i++)l=new Vector3,c={a:new Vector3,b:new Vector3,c:new Vector3},o.push(l),s.push(c)}var l,c,h=this.morphNormals[e];for(a.vertices=this.morphTargets[e].vertices,a.computeFaceNormals(),a.computeVertexNormals(),i=0,r=this.faces.length;i<r;i++)n=this.faces[i],l=h.faceNormals[i],c=h.vertexNormals[i],l.copy(n.normal),c.a.copy(n.vertexNormals[0]),c.b.copy(n.vertexNormals[1]),c.c.copy(n.vertexNormals[2])}for(i=0,r=this.faces.length;i<r;i++)(n=this.faces[i]).normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,i){if(e&&e.isGeometry){var r,n=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,l=e.faces,c=this.faceVertexUvs[0],h=e.faceVertexUvs[0],u=this.colors,d=e.colors;void 0===i&&(i=0),void 0!==t&&(r=(new Matrix3).getNormalMatrix(t));for(var p=0,m=o.length;p<m;p++){var f=o[p].clone();void 0!==t&&f.applyMatrix4(t),a.push(f)}for(p=0,m=d.length;p<m;p++)u.push(d[p].clone());for(p=0,m=l.length;p<m;p++){var g,v,y,b=l[p],_=b.vertexNormals,x=b.vertexColors;(g=new Face3(b.a+n,b.b+n,b.c+n)).normal.copy(b.normal),void 0!==r&&g.normal.applyMatrix3(r).normalize();for(var w=0,S=_.length;w<S;w++)v=_[w].clone(),void 0!==r&&v.applyMatrix3(r).normalize(),g.vertexNormals.push(v);g.color.copy(b.color);for(w=0,S=x.length;w<S;w++)y=x[w],g.vertexColors.push(y.clone());g.materialIndex=b.materialIndex+i,s.push(g)}for(p=0,m=h.length;p<m;p++){var T=h[p],A=[];if(void 0!==T){for(w=0,S=T.length;w<S;w++)A.push(T[w].clone());c.push(A)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,i,r,n,a,o,s,l={},c=[],h=[],u=Math.pow(10,4);for(i=0,r=this.vertices.length;i<r;i++)e=this.vertices[i],void 0===l[t=Math.round(e.x*u)+"_"+Math.round(e.y*u)+"_"+Math.round(e.z*u)]?(l[t]=i,c.push(this.vertices[i]),h[i]=c.length-1):h[i]=h[l[t]];var d=[];for(i=0,r=this.faces.length;i<r;i++){(n=this.faces[i]).a=h[n.a],n.b=h[n.b],n.c=h[n.c],a=[n.a,n.b,n.c];for(var p=0;3>p;p++)if(a[p]===a[(p+1)%3]){d.push(i);break}}for(i=d.length-1;0<=i;i--){var m=d[i];for(this.faces.splice(m,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(m,1)}var f=this.vertices.length-c.length;return this.vertices=c,f},setFromPoints:function(e){this.vertices=[];for(var t,i=0,r=e.length;i<r;i++)t=e[i],this.vertices.push(new Vector3(t.x,t.y,t.z||0));return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,i=0;i<t;i++)e[i]._id=i;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var r,n,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===t&&(r=[]),o&&o.length===t&&(n=[]);var s;for(i=0;i<t;i++)s=e[i]._id,r&&r.push(a[s]),n&&n.push(o[s]);r&&(this.faceVertexUvs[0]=r),n&&(this.faceVertexUvs[1]=n)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"},uuid:this.uuid,type:this.type};if(""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}for(var r,n=[],a=0;a<this.vertices.length;a++)r=this.vertices[a],n.push(r.x,r.y,r.z);var o=[],s=[],l={},c=[],h={},u=[],d={};for(a=0;a<this.faces.length;a++){var p=this.faces[a],m=void 0!==this.faceVertexUvs[0][a],f=0<p.normal.length(),g=0<p.vertexNormals.length,v=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=0<p.vertexColors.length,b=0;if(b=S(b=S(b=S(b=S(b=S(b=S(b=S(b=S(b,0,0),1,!0),2,!1),3,m),4,f),5,g),6,v),7,y),o.push(b),o.push(p.a,p.b,p.c),o.push(p.materialIndex),m){var _=this.faceVertexUvs[0][a];o.push(E(_[0]),E(_[1]),E(_[2]))}if(f&&o.push(T(p.normal)),g){var x=p.vertexNormals;o.push(T(x[0]),T(x[1]),T(x[2]))}if(v&&o.push(A(p.color)),y){var w=p.vertexColors;o.push(A(w[0]),A(w[1]),A(w[2]))}}function S(e,t,i){return i?e|1<<t:e&~(1<<t)}function T(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]?l[t]:(l[t]=s.length/3,s.push(e.x,e.y,e.z),l[t])}function A(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==h[t]?h[t]:(h[t]=c.length,c.push(e.getHex()),h[t])}function E(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]?d[t]:(d[t]=u.length/2,u.push(e.x,e.y),d[t])}return e.data={},e.data.vertices=n,e.data.normals=s,0<c.length&&(e.data.colors=c),0<u.length&&(e.data.uvs=[u]),e.data.faces=o,e},clone:function(){return(new Geometry).copy(this)},copy:function(e){var t,i,r,n,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,i=s.length;t<i;t++)this.vertices.push(s[t].clone());var l=e.colors;for(t=0,i=l.length;t<i;t++)this.colors.push(l[t].clone());var c=e.faces;for(t=0,i=c.length;t<i;t++)this.faces.push(c[t].clone());for(t=0,i=e.faceVertexUvs.length;t<i;t++){var h=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),r=0,n=h.length;r<n;r++){var u=h[r],d=[];for(a=0,o=u.length;a<o;a++){var p=u[a];d.push(p.clone())}this.faceVertexUvs[t].push(d)}}var m=e.morphTargets;for(t=0,i=m.length;t<i;t++){var f={name:m[t].name};if(void 0!==m[t].vertices)for(f.vertices=[],r=0,n=m[t].vertices.length;r<n;r++)f.vertices.push(m[t].vertices[r].clone());if(void 0!==m[t].normals)for(f.normals=[],r=0,n=m[t].normals.length;r<n;r++)f.normals.push(m[t].normals[r].clone());this.morphTargets.push(f)}var g=e.morphNormals;for(t=0,i=g.length;t<i;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],r=0,n=g[t].vertexNormals.length;r<n;r++){var y=g[t].vertexNormals[r],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),v.vertexNormals.push(b)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],r=0,n=g[t].faceNormals.length;r<n;r++)v.faceNormals.push(g[t].faceNormals[r].clone());this.morphNormals.push(v)}var _=e.skinWeights;for(t=0,i=_.length;t<i;t++)this.skinWeights.push(_[t].clone());var x=e.skinIndices;for(t=0,i=x.length;t<i;t++)this.skinIndices.push(x[t].clone());var w=e.lineDistances;for(t=0,i=w.length;t<i;t++)this.lineDistances.push(w[t]);var S=e.boundingBox;null!==S&&(this.boundingBox=S.clone());var T=e.boundingSphere;return null!==T&&(this.boundingSphere=T.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),BoxGeometry.prototype=Object.create(Geometry.prototype),BoxGeometry.prototype.constructor=BoxGeometry,BoxBufferGeometry.prototype=Object.create(BufferGeometry.prototype),BoxBufferGeometry.prototype.constructor=BoxBufferGeometry;var UniformsUtils={clone:cloneUniforms,merge:mergeUniforms},default_vertex="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",default_fragment="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function ShaderMaterial(e){Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Camera(){Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4}function PerspectiveCamera(e,t,i,r){Camera.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}ShaderMaterial.prototype=Object.create(Material.prototype),ShaderMaterial.prototype.constructor=ShaderMaterial,ShaderMaterial.prototype.isShaderMaterial=!0,ShaderMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=cloneUniforms(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},ShaderMaterial.prototype.toJSON=function(e){var t=Material.prototype.toJSON.call(this,e);for(var i in t.uniforms={},this.uniforms){var r=this.uniforms[i].value;r&&r.isTexture?t.uniforms[i]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[i]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[i]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[i]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[i]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[i]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[i]={type:"m4",value:r.toArray()}:t.uniforms[i]={value:r}}0<Object.keys(this.defines).length&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var n={};for(var a in this.extensions)!0===this.extensions[a]&&(n[a]=!0);return 0<Object.keys(n).length&&(t.extensions=n),t},Camera.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Camera,isCamera:!0,copy:function(e,t){return Object3D.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Vector3),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Object3D.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),PerspectiveCamera.prototype=Object.assign(Object.create(Camera.prototype),{constructor:PerspectiveCamera,isPerspectiveCamera:!0,copy:function(e,t){return Camera.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*_Math.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*_Math.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*_Math.RAD2DEG*Math.atan(Math.tan(.5*_Math.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,i,r,n,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*_Math.DEG2RAD*this.fov)/this.zoom,i=2*t,r=this.aspect*i,n=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;n+=a.offsetX*r/o,t-=a.offsetY*i/s,r*=a.width/o,i*=a.height/s}var l=this.filmOffset;0!==l&&(n+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+r,t,t-i,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Object3D.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});var fov=90,aspect=1;function CubeCamera(e,t,i,r){Object3D.call(this),this.type="CubeCamera";var n=new PerspectiveCamera(fov,aspect,e,t);n.up.set(0,-1,0),n.lookAt(new Vector3(1,0,0)),this.add(n);var a=new PerspectiveCamera(fov,aspect,e,t);a.up.set(0,-1,0),a.lookAt(new Vector3(-1,0,0)),this.add(a);var o=new PerspectiveCamera(fov,aspect,e,t);o.up.set(0,0,1),o.lookAt(new Vector3(0,1,0)),this.add(o);var s=new PerspectiveCamera(fov,aspect,e,t);s.up.set(0,0,-1),s.lookAt(new Vector3(0,-1,0)),this.add(s);var l=new PerspectiveCamera(fov,aspect,e,t);l.up.set(0,-1,0),l.lookAt(new Vector3(0,0,1)),this.add(l);var c=new PerspectiveCamera(fov,aspect,e,t);c.up.set(0,-1,0),c.lookAt(new Vector3(0,0,-1)),this.add(c),r=r||{format:RGBFormat,magFilter:LinearFilter,minFilter:LinearFilter},this.renderTarget=new WebGLRenderTargetCube(i,i,r),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var i=e.getRenderTarget(),r=this.renderTarget,h=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,n),e.setRenderTarget(r,1),e.render(t,a),e.setRenderTarget(r,2),e.render(t,o),e.setRenderTarget(r,3),e.render(t,s),e.setRenderTarget(r,4),e.render(t,l),r.texture.generateMipmaps=h,e.setRenderTarget(r,5),e.render(t,c),e.setRenderTarget(i)},this.clear=function(e,t,i,r){for(var n=e.getRenderTarget(),a=this.renderTarget,o=0;6>o;o++)e.setRenderTarget(a,o),e.clear(t,i,r);e.setRenderTarget(n)}}function WebGLRenderTargetCube(e,t,i){WebGLRenderTarget.call(this,e,t,i)}function DataTexture(e,t,i,r,n,a,o,s,l,c,h,u){Texture.call(this,null,a,o,s,l,c,r,n,h,u),this.image={data:e,width:t,height:i},this.magFilter=void 0!==l?l:NearestFilter,this.minFilter=void 0!==c?c:NearestFilter,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Plane(e,t){this.normal=void 0!==e?e:new Vector3(1,0,0),this.constant=void 0!==t?t:0}function Frustum(e,t,i,r,n,a){this.planes=[void 0!==e?e:new Plane,void 0!==t?t:new Plane,void 0!==i?i:new Plane,void 0!==r?r:new Plane,void 0!==n?n:new Plane,void 0!==a?a:new Plane]}CubeCamera.prototype=Object.create(Object3D.prototype),CubeCamera.prototype.constructor=CubeCamera,WebGLRenderTargetCube.prototype=Object.create(WebGLRenderTarget.prototype),WebGLRenderTargetCube.prototype.constructor=WebGLRenderTargetCube,WebGLRenderTargetCube.prototype.isWebGLRenderTargetCube=!0,WebGLRenderTargetCube.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;var i=new Scene,r={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},n=new ShaderMaterial({type:"CubemapFromEquirect",uniforms:cloneUniforms(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:BackSide,blending:NoBlending});n.uniforms.tEquirect.value=t;var a=new Mesh(new BoxBufferGeometry(5,5,5),n);i.add(a);var o=new CubeCamera(1,10,1);return o.renderTarget=this,o.renderTarget.texture.name="CubeCameraTexture",o.update(e,i),a.geometry.dispose(),a.material.dispose(),this},DataTexture.prototype=Object.create(Texture.prototype),DataTexture.prototype.constructor=DataTexture,DataTexture.prototype.isDataTexture=!0,Object.assign(Plane.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new Vector3,t=new Vector3;return function(i,r,n){var a=e.subVectors(n,r).cross(t.subVectors(i,r)).normalize();return this.setFromNormalAndCoplanarPoint(a,i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Vector3),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new Vector3;return function(t,i){void 0===i&&(console.warn("THREE.Plane: .intersectLine() target is now required"),i=new Vector3);var r=t.delta(e),n=this.normal.dot(r);if(0===n)return 0===this.distanceToPoint(t.start)?i.copy(t.start):void 0;var a=-(t.start.dot(this.normal)+this.constant)/n;return 0>a||1<a?void 0:i.copy(r).multiplyScalar(a).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return 0>t&&0<i||0>i&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Vector3),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new Vector3,t=new Matrix3;return function(i,r){var n=r||t.getNormalMatrix(i),a=this.coplanarPoint(e).applyMatrix4(i),o=this.normal.applyMatrix3(n).normalize();return this.constant=-a.dot(o),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(Frustum.prototype,{set:function(e,t,i,r,n,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(i),o[3].copy(r),o[4].copy(n),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,i=0;6>i;i++)t[i].copy(e.planes[i]);return this},setFromMatrix:function(e){var t=this.planes,i=e.elements,r=i[0],n=i[1],a=i[2],o=i[3],s=i[4],l=i[5],c=i[6],h=i[7],u=i[8],d=i[9],p=i[10],m=i[11],f=i[12],g=i[13],v=i[14],y=i[15];return t[0].setComponents(o-r,h-s,m-u,y-f).normalize(),t[1].setComponents(o+r,h+s,m+u,y+f).normalize(),t[2].setComponents(o+n,h+l,m+d,y+g).normalize(),t[3].setComponents(o-n,h-l,m-d,y-g).normalize(),t[4].setComponents(o-a,h-c,m-p,y-v).normalize(),t[5].setComponents(o+a,h+c,m+p,y+v).normalize(),this},intersectsObject:function(){var e=new Sphere;return function(t){var i=t.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),e.copy(i.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new Sphere;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,i=e.center,r=-e.radius,n=0;6>n;n++)if(t[n].distanceToPoint(i)<r)return!1;return!0},intersectsBox:function(){var e=new Vector3;return function(t){for(var i,r=this.planes,n=0;6>n;n++)if(i=r[n],e.x=0<i.normal.x?t.max.x:t.min.x,e.y=0<i.normal.y?t.max.y:t.min.y,e.z=0<i.normal.z?t.max.z:t.min.z,0>i.distanceToPoint(e))return!1;return!0}}(),containsPoint:function(e){for(var t=this.planes,i=0;6>i;i++)if(0>t[i].distanceToPoint(e))return!1;return!0}});var alphamap_fragment="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex="vec3 transformed = vec3( position );",beginnormal_vertex="vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs="vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}",bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment="#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}",cube_uv_reflection_fragment="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",defaultnormal_vertex="vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment="\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_pars_fragment="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_vertex="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex="#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex="#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment="#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",lightmap_fragment="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin="uniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",envmap_physical_pars_fragment="#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",lights_phong_fragment="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif",lights_physical_pars_fragment="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#endif\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec3 singleScattering = vec3( 0.0 );\n\t\tvec3 multiScattering = vec3( 0.0 );\n\t\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\t\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * singleScattering;\n\t\treflectedLight.indirectDiffuse += multiScattering * cosineWeightedIrradiance;\n\t\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\t#else\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#endif\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps="#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif",lights_fragment_end="#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, irradiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif",logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif",map_fragment="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment="#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif",map_particle_pars_fragment="#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif",metalnessmap_fragment="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t#endif\n#endif",normal_fragment_maps="#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\t#ifdef USE_TANGENT\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy = normalScale * mapN.xy;\n\t\t\tnormal = normalize( vTBN * mapN );\n\t\t#else\n\t\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t\t#endif\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif",packing="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex="vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment="#if defined( DITHERING )\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment="#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif",shadowmap_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment="#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment="#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif",background_frag="uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert="varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",linedashed_vert="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshbasic_vert="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert="#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag="#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshmatcap_vert="#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshphong_frag="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",points_vert="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert="#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert="uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",ShaderChunk={alphamap_fragment:alphamap_fragment,alphamap_pars_fragment:alphamap_pars_fragment,alphatest_fragment:alphatest_fragment,aomap_fragment:aomap_fragment,aomap_pars_fragment:aomap_pars_fragment,begin_vertex:begin_vertex,beginnormal_vertex:beginnormal_vertex,bsdfs:bsdfs,bumpmap_pars_fragment:bumpmap_pars_fragment,clipping_planes_fragment:clipping_planes_fragment,clipping_planes_pars_fragment:clipping_planes_pars_fragment,clipping_planes_pars_vertex:clipping_planes_pars_vertex,clipping_planes_vertex:clipping_planes_vertex,color_fragment:color_fragment,color_pars_fragment:color_pars_fragment,color_pars_vertex:color_pars_vertex,color_vertex:color_vertex,common:common,cube_uv_reflection_fragment:cube_uv_reflection_fragment,defaultnormal_vertex:defaultnormal_vertex,displacementmap_pars_vertex:displacementmap_pars_vertex,displacementmap_vertex:displacementmap_vertex,emissivemap_fragment:emissivemap_fragment,emissivemap_pars_fragment:emissivemap_pars_fragment,encodings_fragment:encodings_fragment,encodings_pars_fragment:encodings_pars_fragment,envmap_fragment:envmap_fragment,envmap_pars_fragment:envmap_pars_fragment,envmap_pars_vertex:envmap_pars_vertex,envmap_physical_pars_fragment:envmap_physical_pars_fragment,envmap_vertex:envmap_vertex,fog_vertex:fog_vertex,fog_pars_vertex:fog_pars_vertex,fog_fragment:fog_fragment,fog_pars_fragment:fog_pars_fragment,gradientmap_pars_fragment:gradientmap_pars_fragment,lightmap_fragment:lightmap_fragment,lightmap_pars_fragment:lightmap_pars_fragment,lights_lambert_vertex:lights_lambert_vertex,lights_pars_begin:lights_pars_begin,lights_phong_fragment:lights_phong_fragment,lights_phong_pars_fragment:lights_phong_pars_fragment,lights_physical_fragment:lights_physical_fragment,lights_physical_pars_fragment:lights_physical_pars_fragment,lights_fragment_begin:lights_fragment_begin,lights_fragment_maps:lights_fragment_maps,lights_fragment_end:lights_fragment_end,logdepthbuf_fragment:logdepthbuf_fragment,logdepthbuf_pars_fragment:logdepthbuf_pars_fragment,logdepthbuf_pars_vertex:logdepthbuf_pars_vertex,logdepthbuf_vertex:logdepthbuf_vertex,map_fragment:map_fragment,map_pars_fragment:map_pars_fragment,map_particle_fragment:map_particle_fragment,map_particle_pars_fragment:map_particle_pars_fragment,metalnessmap_fragment:metalnessmap_fragment,metalnessmap_pars_fragment:metalnessmap_pars_fragment,morphnormal_vertex:morphnormal_vertex,morphtarget_pars_vertex:morphtarget_pars_vertex,morphtarget_vertex:morphtarget_vertex,normal_fragment_begin:normal_fragment_begin,normal_fragment_maps:normal_fragment_maps,normalmap_pars_fragment:normalmap_pars_fragment,packing:packing,premultiplied_alpha_fragment:premultiplied_alpha_fragment,project_vertex:project_vertex,dithering_fragment:dithering_fragment,dithering_pars_fragment:dithering_pars_fragment,roughnessmap_fragment:roughnessmap_fragment,roughnessmap_pars_fragment:roughnessmap_pars_fragment,shadowmap_pars_fragment:shadowmap_pars_fragment,shadowmap_pars_vertex:shadowmap_pars_vertex,shadowmap_vertex:shadowmap_vertex,shadowmask_pars_fragment:shadowmask_pars_fragment,skinbase_vertex:skinbase_vertex,skinning_pars_vertex:skinning_pars_vertex,skinning_vertex:skinning_vertex,skinnormal_vertex:skinnormal_vertex,specularmap_fragment:specularmap_fragment,specularmap_pars_fragment:specularmap_pars_fragment,tonemapping_fragment:tonemapping_fragment,tonemapping_pars_fragment:tonemapping_pars_fragment,uv_pars_fragment:uv_pars_fragment,uv_pars_vertex:uv_pars_vertex,uv_vertex:uv_vertex,uv2_pars_fragment:uv2_pars_fragment,uv2_pars_vertex:uv2_pars_vertex,uv2_vertex:uv2_vertex,worldpos_vertex:worldpos_vertex,background_frag:background_frag,background_vert:background_vert,cube_frag:cube_frag,cube_vert:cube_vert,depth_frag:depth_frag,depth_vert:depth_vert,distanceRGBA_frag:distanceRGBA_frag,distanceRGBA_vert:distanceRGBA_vert,equirect_frag:equirect_frag,equirect_vert:equirect_vert,linedashed_frag:linedashed_frag,linedashed_vert:linedashed_vert,meshbasic_frag:meshbasic_frag,meshbasic_vert:meshbasic_vert,meshlambert_frag:meshlambert_frag,meshlambert_vert:meshlambert_vert,meshmatcap_frag:meshmatcap_frag,meshmatcap_vert:meshmatcap_vert,meshphong_frag:meshphong_frag,meshphong_vert:meshphong_vert,meshphysical_frag:meshphysical_frag,meshphysical_vert:meshphysical_vert,normal_frag:normal_frag,normal_vert:normal_vert,points_frag:points_frag,points_vert:points_vert,shadow_frag:shadow_frag,shadow_vert:shadow_vert,sprite_frag:sprite_frag,sprite_vert:sprite_vert},UniformsLib={common:{diffuse:{value:new Color(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Matrix3},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Color(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(15658734)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new Matrix3}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.normal_vert,fragmentShader:ShaderChunk.normal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};function WebGLAnimation(){var e=null,t=!1,i=null;function r(n,a){!1!==t&&(i(n,a),e.requestAnimationFrame(r))}return{start:function(){!0!==t&&null!==i&&(e.requestAnimationFrame(r),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){i=e},setContext:function(t){e=t}}}function WebGLAttributes(e){var t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(i){i.isInterleavedBufferAttribute&&(i=i.data);var r=t.get(i);r&&(e.deleteBuffer(r.buffer),t.delete(i))},update:function(i,r){i.isInterleavedBufferAttribute&&(i=i.data);var n=t.get(i);void 0===n?t.set(i,function(t,i){var r=t.array,n=t.dynamic?35048:35044,a=e.createBuffer();e.bindBuffer(i,a),e.bufferData(i,r,n),t.onUploadCallback();var o=5126;return r instanceof Float32Array?o=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?o=5123:r instanceof Int16Array?o=5122:r instanceof Uint32Array?o=5125:r instanceof Int32Array?o=5124:r instanceof Int8Array?o=5120:r instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(i,r)):n.version<i.version&&(function(t,i,r){var n=i.array,a=i.updateRange;e.bindBuffer(r,t),!1===i.dynamic?e.bufferData(r,n,35044):-1===a.count?e.bufferSubData(r,0,n):0===a.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(r,a.offset*n.BYTES_PER_ELEMENT,n.subarray(a.offset,a.offset+a.count)),a.count=-1)}(n.buffer,i,r),n.version=i.version)}}}function PlaneGeometry(e,t,i,r){Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r},this.fromBufferGeometry(new PlaneBufferGeometry(e,t,i,r)),this.mergeVertices()}function PlaneBufferGeometry(e,t,i,r){BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};var n,a,o=(e=e||1)/2,s=(t=t||1)/2,l=Math.floor(i)||1,c=Math.floor(r)||1,h=l+1,u=c+1,d=e/l,p=t/c,m=[],f=[],g=[],v=[];for(a=0;a<u;a++){var y=a*p-s;for(n=0;n<h;n++){var b=n*d-o;f.push(b,-y,0),g.push(0,0,1),v.push(n/l),v.push(1-a/c)}}for(a=0;a<c;a++)for(n=0;n<l;n++){var _=n+h*a,x=n+h*(a+1),w=n+1+h*(a+1),S=n+1+h*a;m.push(_,x,S),m.push(x,w,S)}this.setIndex(m),this.addAttribute("position",new Float32BufferAttribute(f,3)),this.addAttribute("normal",new Float32BufferAttribute(g,3)),this.addAttribute("uv",new Float32BufferAttribute(v,2))}function WebGLBackground(e,t,i,r){var n,a,o=new Color(0),s=0,l=null,c=0;function h(e,i){t.buffers.color.setClear(e.r,e.g,e.b,i,r)}return{getClearColor:function(){return o},setClearColor:function(e,t){o.set(e),h(o,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){h(o,s=e)},render:function(t,r,u,d){var p=r.background,m=e.vr,f=m.getSession&&m.getSession();if(f&&"additive"===f.environmentBlendMode&&(p=null),null===p?(h(o,s),l=null,c=0):p&&p.isColor&&(h(p,1),d=!0,l=null,c=0),(e.autoClear||d)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLRenderTargetCube)){void 0===a&&((a=new Mesh(new BoxBufferGeometry(1,1,1),new ShaderMaterial({type:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.cube.uniforms),vertexShader:ShaderLib.cube.vertexShader,fragmentShader:ShaderLib.cube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),a.geometry.removeAttribute("uv"),a.onBeforeRender=function(e,t,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.tCube.value}}),i.update(a));var g=p.isWebGLRenderTargetCube?p.texture:p;a.material.uniforms.tCube.value=g,a.material.uniforms.tFlip.value=p.isWebGLRenderTargetCube?1:-1,l===p&&c===g.version||(a.material.needsUpdate=!0,l=p,c=g.version),t.unshift(a,a.geometry,a.material,0,0,null)}else p&&p.isTexture&&(void 0===n&&((n=new Mesh(new PlaneBufferGeometry(2,2),new ShaderMaterial({type:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),Object.defineProperty(n.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(n)),n.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),n.material.uniforms.uvTransform.value.copy(p.matrix),l===p&&c===p.version||(n.material.needsUpdate=!0,l=p,c=p.version),t.unshift(n,n.geometry,n.material,0,0,null))}}}function WebGLBufferRenderer(e,t,i,r){var n;this.setMode=function(e){n=e},this.render=function(t,r){e.drawArrays(n,t,r),i.update(r,n)},this.renderInstances=function(a,o,s){var l;if(r.isWebGL2)l=e;else if(null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[r.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](n,o,s,a.maxInstancedCount),i.update(s,n,a.maxInstancedCount)}}function WebGLCapabilities(e,t,i){var r;function n(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,o=void 0!==i.precision?i.precision:"highp",s=n(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var l=!0===i.logarithmicDepthBuffer,c=e.getParameter(34930),h=e.getParameter(35660),u=e.getParameter(3379),d=e.getParameter(34076),p=e.getParameter(34921),m=e.getParameter(36347),f=e.getParameter(36348),g=e.getParameter(36349),v=0<h,y=a||!!t.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==r)return r;var i=t.get("EXT_texture_filter_anisotropic");return r=null!==i?e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:n,precision:o,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:h,maxTextureSize:u,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:m,maxVaryings:f,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:a?e.getParameter(36183):0}}function WebGLClipping(){var e=this,t=null,i=0,r=!1,n=!1,a=new Plane,o=new Matrix3,s={value:null,needsUpdate:!1};function l(){s.value!==t&&(s.value=t,s.needsUpdate=0<i),e.numPlanes=i,e.numIntersection=0}function c(t,i,r,n){var l=null!==t?t.length:0,c=null;if(0!==l){if(c=s.value,!0!==n||null===c){var h=r+4*l,u=i.matrixWorldInverse;o.getNormalMatrix(u),(null===c||c.length<h)&&(c=new Float32Array(h));for(var d=0,p=r;d!==l;++d,p+=4)a.copy(t[d]).applyMatrix4(u,o),a.normal.toArray(c,p),c[p+3]=a.constant}s.value=c,s.needsUpdate=!0}return e.numPlanes=l,c}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,n,a){var o=0!==e.length||n||0!==i||r;return r=n,t=c(e,a,0),i=e.length,o},this.beginShadows=function(){n=!0,c(null)},this.endShadows=function(){n=!1,l()},this.setState=function(e,a,o,h,u,d){if(!r||null===e||0===e.length||n&&!o)n?c(null):l();else{var p=n?0:i,m=4*p,f=u.clippingState||null;s.value=f,f=c(e,h,m,d);for(var g=0;g!==m;++g)f[g]=t[g];u.clippingState=f,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=p}}}function WebGLExtensions(e){var t={};return{get:function(i){if(void 0!==t[i])return t[i];var r;switch(i){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(i)}return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),t[i]=r,r}}}function WebGLGeometries(e,t,i){var r={},n={};function a(e){var o=e.target,s=r[o.id];for(var l in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[l]);o.removeEventListener("dispose",a),delete r[o.id];var c=n[s.id];c&&(t.remove(c),delete n[s.id]),i.memory.geometries--}return{get:function(e,t){var n=r[t.id];return n||(t.addEventListener("dispose",a),t.isBufferGeometry?n=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new BufferGeometry).setFromObject(e)),n=t._bufferGeometry),r[t.id]=n,i.memory.geometries++,n)},update:function(e){var i=e.index,r=e.attributes;for(var n in null!==i&&t.update(i,34963),r)t.update(r[n],34962);var a=e.morphAttributes;for(var n in a)for(var o=a[n],s=0,l=o.length;s<l;s++)t.update(o[s],34962)},getWireframeAttribute:function(e){var i=n[e.id];if(i)return i;var r,a=[],o=e.index,s=e.attributes;if(null!==o)for(var l=0,c=(r=o.array).length;l<c;l+=3){var h=r[l+0],u=r[l+1],d=r[l+2];a.push(h,u,u,d,d,h)}else for(l=0,c=(r=s.position.array).length/3-1;l<c;l+=3)h=l+0,u=l+1,d=l+2,a.push(h,u,u,d,d,h);return i=new(65535<arrayMax(a)?Uint32BufferAttribute:Uint16BufferAttribute)(a,1),t.update(i,34963),n[e.id]=i,i}}}function WebGLIndexedBufferRenderer(e,t,i,r){var n,a,o;this.setMode=function(e){n=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(n,r,a,t*o),i.update(r,n)},this.renderInstances=function(s,l,c){var h;if(r.isWebGL2)h=e;else if(null===(h=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[r.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](n,c,a,l*o,s.maxInstancedCount),i.update(c,n,s.maxInstancedCount)}}function WebGLInfo(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,i,r){switch(r=r||1,t.calls++,i){case 4:t.triangles+=r*(e/3);break;case 5:case 6:t.triangles+=r*(e-2);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function absNumericalSort(e,t){return Math.abs(t[1])-Math.abs(e[1])}function WebGLMorphtargets(e){var t={},i=new Float32Array(8);return{update:function(r,n,a,o){var s=r.morphTargetInfluences,l=s.length,c=t[n.id];if(void 0===c){c=[];for(var h=0;h<l;h++)c[h]=[h,0];t[n.id]=c}var u,d=a.morphTargets&&n.morphAttributes.position,p=a.morphNormals&&n.morphAttributes.normal;for(h=0;h<l;h++)0!==(u=c[h])[1]&&(d&&n.removeAttribute("morphTarget"+h),p&&n.removeAttribute("morphNormal"+h));for(h=0;h<l;h++)(u=c[h])[0]=h,u[1]=s[h];for(c.sort(absNumericalSort),h=0;8>h;h++){if(u=c[h]){var m=u[0],f=u[1];if(f){d&&n.addAttribute("morphTarget"+h,d[m]),p&&n.addAttribute("morphNormal"+h,p[m]),i[h]=f;continue}}i[h]=0}o.getUniforms().setValue(e,"morphTargetInfluences",i)}}}function WebGLObjects(e,t){var i={};return{update:function(r){var n=t.render.frame,a=r.geometry,o=e.get(r,a);return i[o.id]!==n&&(a.isGeometry&&o.updateFromObject(r),e.update(o),i[o.id]=n),o},dispose:function(){i={}}}}function CubeTexture(e,t,i,r,n,a,o,s,l,c){e=void 0!==e?e:[],t=void 0!==t?t:CubeReflectionMapping,o=void 0!==o?o:RGBFormat,Texture.call(this,e,t,i,r,n,a,o,s,l,c),this.flipY=!1}function DataTexture2DArray(e,t,i,r){Texture.call(this,null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1}function DataTexture3D(e,t,i,r){Texture.call(this,null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1}ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},PlaneGeometry.prototype=Object.create(Geometry.prototype),PlaneGeometry.prototype.constructor=PlaneGeometry,PlaneBufferGeometry.prototype=Object.create(BufferGeometry.prototype),PlaneBufferGeometry.prototype.constructor=PlaneBufferGeometry,CubeTexture.prototype=Object.create(Texture.prototype),CubeTexture.prototype.constructor=CubeTexture,CubeTexture.prototype.isCubeTexture=!0,Object.defineProperty(CubeTexture.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),DataTexture2DArray.prototype=Object.create(Texture.prototype),DataTexture2DArray.prototype.constructor=DataTexture2DArray,DataTexture2DArray.prototype.isDataTexture2DArray=!0,DataTexture3D.prototype=Object.create(Texture.prototype),DataTexture3D.prototype.constructor=DataTexture3D,DataTexture3D.prototype.isDataTexture3D=!0;var emptyTexture=new Texture,emptyTexture2dArray=new DataTexture2DArray,emptyTexture3d=new DataTexture3D,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten(e,t,i){var r=e[0];if(0>=r||0<r)return e;var n=t*i,a=arrayCacheF32[n];if(void 0===a&&(a=new Float32Array(n),arrayCacheF32[n]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=i,e[o].toArray(a,s)}return a}function arraysEqual(e,t){if(e.length!==t.length)return!1;for(var i=0,r=e.length;i<r;i++)if(e[i]!==t[i])return!1;return!0}function copyArray(e,t){for(var i=0,r=t.length;i<r;i++)e[i]=t[i]}function allocTexUnits(e,t){var i=arrayCacheI32[t];void 0===i&&(i=new Int32Array(t),arrayCacheI32[t]=i);for(var r=0;r!==t;++r)i[r]=e.allocateTextureUnit();return i}function setValueV1f(e,t){var i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function setValueV2f(e,t){var i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(arraysEqual(i,t))return;e.uniform2fv(this.addr,t),copyArray(i,t)}}function setValueV3f(e,t){var i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y&&i[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(void 0!==t.r)i[0]===t.r&&i[1]===t.g&&i[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(arraysEqual(i,t))return;e.uniform3fv(this.addr,t),copyArray(i,t)}}function setValueV4f(e,t){var i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y&&i[2]===t.z&&i[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(arraysEqual(i,t))return;e.uniform4fv(this.addr,t),copyArray(i,t)}}function setValueM2(e,t){var i=this.cache,r=t.elements;if(void 0===r){if(arraysEqual(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),copyArray(i,t)}else{if(arraysEqual(i,r))return;mat2array.set(r),e.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(i,r)}}function setValueM3(e,t){var i=this.cache,r=t.elements;if(void 0===r){if(arraysEqual(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),copyArray(i,t)}else{if(arraysEqual(i,r))return;mat3array.set(r),e.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(i,r)}}function setValueM4(e,t){var i=this.cache,r=t.elements;if(void 0===r){if(arraysEqual(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),copyArray(i,t)}else{if(arraysEqual(i,r))return;mat4array.set(r),e.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(i,r)}}function setValueT1(e,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.safeSetTexture2D(t||emptyTexture,n)}function setValueT2DArray1(e,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.setTexture2DArray(t||emptyTexture2dArray,n)}function setValueT3D1(e,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.setTexture3D(t||emptyTexture3d,n)}function setValueT6(e,t,i){var r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.safeSetTextureCube(t||emptyCubeTexture,n)}function setValueV1i(e,t){var i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function setValueV2i(e,t){var i=this.cache;arraysEqual(i,t)||(e.uniform2iv(this.addr,t),copyArray(i,t))}function setValueV3i(e,t){var i=this.cache;arraysEqual(i,t)||(e.uniform3iv(this.addr,t),copyArray(i,t))}function setValueV4i(e,t){var i=this.cache;arraysEqual(i,t)||(e.uniform4iv(this.addr,t),copyArray(i,t))}function getSingularSetter(e){switch(e){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 35678:case 36198:return setValueT1;case 35679:return setValueT3D1;case 35680:return setValueT6;case 36289:return setValueT2DArray1;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i}}function setValueV1fArray(e,t){e.uniform1fv(this.addr,t)}function setValueV1iArray(e,t){e.uniform1iv(this.addr,t)}function setValueV2iArray(e,t){e.uniform2iv(this.addr,t)}function setValueV3iArray(e,t){e.uniform3iv(this.addr,t)}function setValueV4iArray(e,t){e.uniform4iv(this.addr,t)}function setValueV2fArray(e,t){var i=flatten(t,this.size,2);e.uniform2fv(this.addr,i)}function setValueV3fArray(e,t){var i=flatten(t,this.size,3);e.uniform3fv(this.addr,i)}function setValueV4fArray(e,t){var i=flatten(t,this.size,4);e.uniform4fv(this.addr,i)}function setValueM2Array(e,t){var i=flatten(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function setValueM3Array(e,t){var i=flatten(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function setValueM4Array(e,t){var i=flatten(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function setValueT1Array(e,t,i){var r=t.length,n=allocTexUnits(i,r);e.uniform1iv(this.addr,n);for(var a=0;a!==r;++a)i.safeSetTexture2D(t[a]||emptyTexture,n[a])}function setValueT6Array(e,t,i){var r=t.length,n=allocTexUnits(i,r);e.uniform1iv(this.addr,n);for(var a=0;a!==r;++a)i.safeSetTextureCube(t[a]||emptyCubeTexture,n[a])}function getPureArraySetter(e){switch(e){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 35678:return setValueT1Array;case 35680:return setValueT6Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray}}function SingleUniform(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=getSingularSetter(t.type)}function PureArrayUniform(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=getPureArraySetter(t.type)}function StructuredUniform(e){this.id=e,this.seq=[],this.map={}}PureArrayUniform.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),copyArray(t,e)},StructuredUniform.prototype.setValue=function(e,t,i){for(var r,n=this.seq,a=0,o=n.length;a!==o;++a)(r=n[a]).setValue(e,t[r.id],i)};var RePathPart=/([\w\d_]+)(\])?(\[|\.)?/g;function addUniform(e,t){e.seq.push(t),e.map[t.id]=t}function parseUniform(e,t,i){var r=e.name,n=r.length;for(RePathPart.lastIndex=0;;){var a=RePathPart.exec(r),o=RePathPart.lastIndex,s=a[1],l="]"===a[2],c=a[3];if(l&&(s|=0),void 0===c||"["===c&&o+2===n){addUniform(i,void 0===c?new SingleUniform(s,e,t):new PureArrayUniform(s,e,t));break}var h=i.map[s];void 0===h&&addUniform(i,h=new StructuredUniform(s)),i=h}}function WebGLUniforms(e,t){this.seq=[],this.map={};for(var i=e.getProgramParameter(t,35718),r=0;r<i;++r){var n=e.getActiveUniform(t,r);parseUniform(n,e.getUniformLocation(t,n.name),this)}}function WebGLShader(e,t,i){var r=e.createShader(t);return e.shaderSource(r,i),e.compileShader(r),r}WebGLUniforms.prototype.setValue=function(e,t,i,r){var n=this.map[t];void 0!==n&&n.setValue(e,i,r)},WebGLUniforms.prototype.setOptional=function(e,t,i){var r=t[i];void 0!==r&&this.setValue(e,i,r)},WebGLUniforms.upload=function(e,t,i,r){for(var n=0,a=t.length;n!==a;++n){var o=t[n],s=i[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},WebGLUniforms.seqWithValue=function(e,t){for(var i,r=[],n=0,a=e.length;n!==a;++n)(i=e[n]).id in t&&r.push(i);return r};var programIdCount=0;function addLineNumbers(e){for(var t=e.split("\n"),i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join("\n")}function getEncodingComponents(e){switch(e){case LinearEncoding:return["Linear","( value )"];case sRGBEncoding:return["sRGB","( value )"];case RGBEEncoding:return["RGBE","( value )"];case RGBM7Encoding:return["RGBM","( value, 7.0 )"];case RGBM16Encoding:return["RGBM","( value, 16.0 )"];case RGBDEncoding:return["RGBD","( value, 256.0 )"];case GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function getShaderErrors(e,t,i){var r=e.getShaderParameter(t,35713),n=e.getShaderInfoLog(t).trim();return r&&""===n?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+i+"\n"+n+addLineNumbers(e.getShaderSource(t))}function getTexelDecodingFunction(e,t){var i=getEncodingComponents(t);return"vec4 "+e+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function getTexelEncodingFunction(e,t){var i=getEncodingComponents(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function getToneMappingFunction(e,t){var i;switch(t){case LinearToneMapping:i="Linear";break;case ReinhardToneMapping:i="Reinhard";break;case Uncharted2ToneMapping:i="Uncharted2";break;case CineonToneMapping:i="OptimizedCineon";break;case ACESFilmicToneMapping:i="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function generateExtensions(e,t,i){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap&&!t.objectSpaceNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(filterEmptyLine).join("\n")}function generateDefines(e){var t=[];for(var i in e){var r=e[i];!1!==r&&t.push("#define "+i+" "+r)}return t.join("\n")}function fetchAttributeLocations(e,t){for(var i={},r=e.getProgramParameter(t,35721),n=0;n<r;n++){var a=e.getActiveAttrib(t,n).name;i[a]=e.getAttribLocation(t,a)}return i}function filterEmptyLine(e){return""!==e}function replaceLightNums(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function replaceClippingPlaneNums(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function parseIncludes(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(e,t){var i=ShaderChunk[t];if(void 0===i)throw new Error("Can not resolve #include <"+t+">");return parseIncludes(i)})}function unrollLoops(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,i,r){for(var n="",a=parseInt(t);a<parseInt(i);a++)n+=r.replace(/\[ i \]/g,"[ "+a+" ]");return n})}function WebGLProgram(e,t,i,r,n,a,o){var s=e.context,l=r.defines,c=n.vertexShader,h=n.fragmentShader,u="SHADOWMAP_TYPE_BASIC";a.shadowMapType===PCFShadowMap?u="SHADOWMAP_TYPE_PCF":a.shadowMapType===PCFSoftShadowMap&&(u="SHADOWMAP_TYPE_PCF_SOFT");var d="ENVMAP_TYPE_CUBE",p="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(a.envMap){switch(r.envMap.mapping){case CubeReflectionMapping:case CubeRefractionMapping:d="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:case CubeUVRefractionMapping:d="ENVMAP_TYPE_CUBE_UV";break;case EquirectangularReflectionMapping:case EquirectangularRefractionMapping:d="ENVMAP_TYPE_EQUIREC";break;case SphericalReflectionMapping:d="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case CubeRefractionMapping:case EquirectangularRefractionMapping:p="ENVMAP_MODE_REFRACTION"}switch(r.combine){case MultiplyOperation:m="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:m="ENVMAP_BLENDING_MIX";break;case AddOperation:m="ENVMAP_BLENDING_ADD"}}var f,g,v=0<e.gammaFactor?e.gammaFactor:1,y=o.isWebGL2?"":generateExtensions(r.extensions,a,t),b=generateDefines(l),_=s.createProgram();if(r.isRawShaderMaterial?(0<(f=[b].filter(filterEmptyLine).join("\n")).length&&(f+="\n"),0<(g=[y,b].filter(filterEmptyLine).join("\n")).length&&(g+="\n")):(f=["precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+n.name,b,a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+v,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+p:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+u:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(o.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(filterEmptyLine).join("\n"),g=[y,"precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+n.name,b,a.alphaTest?"#define ALPHATEST "+a.alphaTest+(a.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+v,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+d:"",a.envMap?"#define "+p:"",a.envMap?"#define "+m:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+u:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(o.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",a.envMap&&(o.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",a.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",a.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",a.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.matcapEncoding||a.envMapEncoding||a.emissiveMapEncoding?ShaderChunk.encodings_pars_fragment:"",a.mapEncoding?getTexelDecodingFunction("mapTexelToLinear",a.mapEncoding):"",a.matcapEncoding?getTexelDecodingFunction("matcapTexelToLinear",a.matcapEncoding):"",a.envMapEncoding?getTexelDecodingFunction("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?getTexelDecodingFunction("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.outputEncoding?getTexelEncodingFunction("linearToOutputTexel",a.outputEncoding):"",a.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(filterEmptyLine).join("\n")),c=replaceClippingPlaneNums(c=replaceLightNums(c=parseIncludes(c),a),a),h=replaceClippingPlaneNums(h=replaceLightNums(h=parseIncludes(h),a),a),c=unrollLoops(c),h=unrollLoops(h),o.isWebGL2&&!r.isRawShaderMaterial){var x=!1,w=/^\s*#version\s+300\s+es\s*\n/;r.isShaderMaterial&&null!==c.match(w)&&null!==h.match(w)&&(x=!0,c=c.replace(w,""),h=h.replace(w,"")),f=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+f,g=["#version 300 es\n","#define varying in",x?"":"out highp vec4 pc_fragColor;",x?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g}var S,T,A=g+h,E=WebGLShader(s,35633,f+c),C=WebGLShader(s,35632,A);if(s.attachShader(_,E),s.attachShader(_,C),void 0!==r.index0AttributeName?s.bindAttribLocation(_,0,r.index0AttributeName):!0===a.morphTargets&&s.bindAttribLocation(_,0,"position"),s.linkProgram(_),e.debug.checkShaderErrors){var M=s.getProgramInfoLog(_).trim(),P=s.getShaderInfoLog(E).trim(),L=s.getShaderInfoLog(C).trim(),I=!0,B=!0;if(!1===s.getProgramParameter(_,35714)){I=!1;var R=getShaderErrors(s,E,"vertex"),F=getShaderErrors(s,C,"fragment");console.error("THREE.WebGLProgram: shader error: ",s.getError(),"35715",s.getProgramParameter(_,35715),"gl.getProgramInfoLog",M,R,F)}else""!==M?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",M):""!==P&&""!==L||(B=!1);B&&(this.diagnostics={runnable:I,material:r,programLog:M,vertexShader:{log:P,prefix:f},fragmentShader:{log:L,prefix:g}})}return s.deleteShader(E),s.deleteShader(C),this.getUniforms=function(){return void 0===S&&(S=new WebGLUniforms(s,_)),S},this.getAttributes=function(){return void 0===T&&(T=fetchAttributeLocations(s,_)),T},this.destroy=function(){s.deleteProgram(_),this.program=void 0},this.name=n.name,this.id=programIdCount++,this.code=i,this.usedTimes=1,this.program=_,this.vertexShader=E,this.fragmentShader=C,this}function WebGLPrograms(e,t,i){var r=[],n={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},a=["precision","supportsVertexTextures","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function o(e,t){var i;return e?e.isTexture?i=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=e.texture.encoding):i=LinearEncoding,i===LinearEncoding&&t&&(i=GammaEncoding),i}this.getParameters=function(t,r,a,s,l,c,h){var u=n[t.type],d=h.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(i.floatVertexTextures)return 1024;var r=i.maxVertexUniforms,n=Math.floor((r-20)/4),a=Math.min(n,t.length);return a<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+a+"."),0):a}(h):0,p=i.precision;null!==t.precision&&(p=i.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",p,"instead.");var m=e.getRenderTarget();return{shaderID:u,precision:p,supportsVertexTextures:i.vertexTextures,outputEncoding:o(m?m.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:o(t.map,e.gammaInput),matcap:!!t.matcap,matcapEncoding:o(t.matcap,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:o(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===CubeUVReflectionMapping||t.envMap.mapping===CubeUVRefractionMapping),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:o(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:t.normalMapType===ObjectSpaceNormalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexTangents:t.normalMap&&t.vertexTangents,vertexColors:t.vertexColors,fog:!!s,useFog:t.fog,fogExp:s&&s.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:i.logarithmicDepthBuffer,skinning:t.skinning&&0<d,maxBones:d,useVertexTexture:i.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:l,numClipIntersection:c,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&h.receiveShadow&&0<a.length,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===DoubleSide,flipSided:t.side===BackSide,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,i){var r=[];if(i.shaderID?r.push(i.shaderID):(r.push(t.fragmentShader),r.push(t.vertexShader)),void 0!==t.defines)for(var n in t.defines)r.push(n),r.push(t.defines[n]);for(var o=0;o<a.length;o++)r.push(i[a[o]]);return r.push(t.onBeforeCompile.toString()),r.push(e.gammaOutput),r.push(e.gammaFactor),r.join()},this.acquireProgram=function(n,a,o,s){for(var l,c,h=0,u=r.length;h<u;h++)if((c=r[h]).code===s){++(l=c).usedTimes;break}return void 0===l&&(l=new WebGLProgram(e,t,s,n,a,o,i),r.push(l)),l},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=r.indexOf(e);r[t]=r[r.length-1],r.pop(),e.destroy()}},this.programs=r}function WebGLProperties(){var e=new WeakMap;return{get:function(t){var i=e.get(t);return void 0===i&&(i={},e.set(t,i)),i},remove:function(t){e.delete(t)},update:function(t,i,r){e.get(t)[i]=r},dispose:function(){e=new WeakMap}}}function painterSortStable(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function reversePainterSortStable(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function WebGLRenderList(){var e=[],t=0,i=[],r=[],n={id:-1};function a(i,r,a,o,s,l){var c=e[t];return void 0===c?(c={id:i.id,object:i,geometry:r,material:a,program:a.program||n,groupOrder:o,renderOrder:i.renderOrder,z:s,group:l},e[t]=c):(c.id=i.id,c.object=i,c.geometry=r,c.material=a,c.program=a.program||n,c.groupOrder=o,c.renderOrder=i.renderOrder,c.z=s,c.group=l),t++,c}return{opaque:i,transparent:r,init:function(){t=0,i.length=0,r.length=0},push:function(e,t,n,o,s,l){var c=a(e,t,n,o,s,l);(!0===n.transparent?r:i).push(c)},unshift:function(e,t,n,o,s,l){var c=a(e,t,n,o,s,l);(!0===n.transparent?r:i).unshift(c)},sort:function(){1<i.length&&i.sort(painterSortStable),1<r.length&&r.sort(reversePainterSortStable)}}}function WebGLRenderLists(){var e={};function t(i){var r=i.target;r.removeEventListener("dispose",t),delete e[r.id]}return{get:function(i,r){var n,a=e[i.id];return void 0===a?(n=new WebGLRenderList,e[i.id]={},e[i.id][r.id]=n,i.addEventListener("dispose",t)):void 0===(n=a[r.id])&&(n=new WebGLRenderList,a[r.id]=n),n},dispose:function(){e={}}}}function UniformsCache(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var i;switch(t.type){case"DirectionalLight":i={direction:new Vector3,color:new Color,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":i={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":i={position:new Vector3,color:new Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":i={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":i={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3}}return e[t.id]=i,i}}}var nextVersion=0;function WebGLLights(){for(var e=new UniformsCache,t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},i=0;9>i;i++)t.probe.push(new Vector3);var r=new Vector3,n=new Matrix4,a=new Matrix4;return{setup:function(i,o,s){for(var l=0,c=0,h=0,u=0;9>u;u++)t.probe[u].set(0,0,0);for(var d=0,p=0,m=0,f=0,g=0,v=s.matrixWorldInverse,y=(u=0,i.length);u<y;u++){var b=i[u],_=b.color,x=b.intensity,w=b.distance,S=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)l+=_.r*x,c+=_.g*x,h+=_.b*x;else if(b.isLightProbe)for(var T=0;9>T;T++)t.probe[T].addScaledVector(b.sh.coefficients[T],x);else if(b.isDirectionalLight){if((E=e.get(b)).color.copy(b.color).multiplyScalar(b.intensity),E.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),E.direction.sub(r),E.direction.transformDirection(v),E.shadow=b.castShadow,b.castShadow){var A=b.shadow;E.shadowBias=A.bias,E.shadowRadius=A.radius,E.shadowMapSize=A.mapSize}t.directionalShadowMap[d]=S,t.directionalShadowMatrix[d]=b.shadow.matrix,t.directional[d]=E,d++}else if(b.isSpotLight)(E=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(v),E.color.copy(_).multiplyScalar(x),E.distance=w,E.direction.setFromMatrixPosition(b.matrixWorld),r.setFromMatrixPosition(b.target.matrixWorld),E.direction.sub(r),E.direction.transformDirection(v),E.coneCos=Math.cos(b.angle),E.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),E.decay=b.decay,E.shadow=b.castShadow,b.castShadow&&(A=b.shadow,E.shadowBias=A.bias,E.shadowRadius=A.radius,E.shadowMapSize=A.mapSize),t.spotShadowMap[m]=S,t.spotShadowMatrix[m]=b.shadow.matrix,t.spot[m]=E,m++;else if(b.isRectAreaLight)(E=e.get(b)).color.copy(_).multiplyScalar(x),E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(v),a.identity(),n.copy(b.matrixWorld),n.premultiply(v),a.extractRotation(n),E.halfWidth.set(.5*b.width,0,0),E.halfHeight.set(0,.5*b.height,0),E.halfWidth.applyMatrix4(a),E.halfHeight.applyMatrix4(a),t.rectArea[f]=E,f++;else if(b.isPointLight)(E=e.get(b)).position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(v),E.color.copy(b.color).multiplyScalar(b.intensity),E.distance=b.distance,E.decay=b.decay,E.shadow=b.castShadow,b.castShadow&&(A=b.shadow,E.shadowBias=A.bias,E.shadowRadius=A.radius,E.shadowMapSize=A.mapSize,E.shadowCameraNear=A.camera.near,E.shadowCameraFar=A.camera.far),t.pointShadowMap[p]=S,t.pointShadowMatrix[p]=b.shadow.matrix,t.point[p]=E,p++;else if(b.isHemisphereLight){var E;(E=e.get(b)).direction.setFromMatrixPosition(b.matrixWorld),E.direction.transformDirection(v),E.direction.normalize(),E.skyColor.copy(b.color).multiplyScalar(x),E.groundColor.copy(b.groundColor).multiplyScalar(x),t.hemi[g]=E,g++}}t.ambient[0]=l,t.ambient[1]=c,t.ambient[2]=h;var C=t.hash;C.directionalLength===d&&C.pointLength===p&&C.spotLength===m&&C.rectAreaLength===f&&C.hemiLength===g&&C.shadowsLength===o.length||(t.directional.length=d,t.spot.length=m,t.rectArea.length=f,t.point.length=p,t.hemi.length=g,C.directionalLength=d,C.pointLength=p,C.spotLength=m,C.rectAreaLength=f,C.hemiLength=g,C.shadowsLength=o.length,t.version=nextVersion++)},state:t}}function WebGLRenderState(){var e=new WebGLLights,t=[],i=[];return{init:function(){t.length=0,i.length=0},state:{lightsArray:t,shadowsArray:i,lights:e},setupLights:function(r){e.setup(t,i,r)},pushLight:function(e){t.push(e)},pushShadow:function(e){i.push(e)}}}function WebGLRenderStates(){var e={};function t(i){var r=i.target;r.removeEventListener("dispose",t),delete e[r.id]}return{get:function(i,r){var n;return void 0===e[i.id]?(n=new WebGLRenderState,e[i.id]={},e[i.id][r.id]=n,i.addEventListener("dispose",t)):void 0===e[i.id][r.id]?(n=new WebGLRenderState,e[i.id][r.id]=n):n=e[i.id][r.id],n},dispose:function(){e={}}}}function MeshDepthMaterial(e){Material.call(this),this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function MeshDistanceMaterial(e){Material.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Vector3,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function WebGLShadowMap(e,t,i){for(var r=new Frustum,n=new Matrix4,a=new Vector2,o=new Vector2(i,i),s=new Vector3,l=new Vector3,c=1,h=2,u=1+(c|h),d=Array(u),p=Array(u),m={},f={0:BackSide,1:FrontSide,2:DoubleSide},g=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],v=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)],y=[new Vector4,new Vector4,new Vector4,new Vector4,new Vector4,new Vector4],b=0;b!==u;++b){var _=0!=(b&c),x=0!=(b&h),w=new MeshDepthMaterial({depthPacking:RGBADepthPacking,morphTargets:_,skinning:x});d[b]=w;var S=new MeshDistanceMaterial({morphTargets:_,skinning:x});p[b]=S}var T=this;function A(t,i,r,n,a,o){var s=t.geometry,l=null,u=d,g=t.customDepthMaterial;if(r&&(u=p,g=t.customDistanceMaterial),g)l=g;else{var v=!1;i.morphTargets&&(s&&s.isBufferGeometry?v=s.morphAttributes&&s.morphAttributes.position&&0<s.morphAttributes.position.length:s&&s.isGeometry&&(v=s.morphTargets&&0<s.morphTargets.length)),t.isSkinnedMesh&&!1===i.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var y=t.isSkinnedMesh&&i.skinning,b=0;v&&(b|=c),y&&(b|=h),l=u[b]}if(e.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){var _=l.uuid,x=i.uuid,w=m[_];void 0===w&&(w={},m[_]=w);var S=w[x];void 0===S&&(S=l.clone(),w[x]=S),l=S}return l.visible=i.visible,l.wireframe=i.wireframe,l.side=null!=i.shadowSide?i.shadowSide:f[i.side],l.clipShadows=i.clipShadows,l.clippingPlanes=i.clippingPlanes,l.clipIntersection=i.clipIntersection,l.wireframeLinewidth=i.wireframeLinewidth,l.linewidth=i.linewidth,r&&l.isMeshDistanceMaterial&&(l.referencePosition.copy(n),l.nearDistance=a,l.farDistance=o),l}function E(i,n,a,o){if(!1!==i.visible){if(i.layers.test(n.layers)&&(i.isMesh||i.isLine||i.isPoints)&&i.castShadow&&(!i.frustumCulled||r.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,i.matrixWorld);var s=t.update(i),c=i.material;if(Array.isArray(c))for(var h=s.groups,u=0,d=h.length;u<d;u++){var p=h[u],m=c[p.materialIndex];if(m&&m.visible){var f=A(i,m,o,l,a.near,a.far);e.renderBufferDirect(a,null,s,f,i,p)}}else if(c.visible){f=A(i,c,o,l,a.near,a.far);e.renderBufferDirect(a,null,s,f,i,null)}}for(var g=i.children,v=0,y=g.length;v<y;v++)E(g[v],n,a,o)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap,this.render=function(t,i,c){if(!1!==T.enabled&&(!1!==T.autoUpdate||!1!==T.needsUpdate)&&0!==t.length){var h=e.getRenderTarget(),u=e.getActiveCubeFace(),d=e.getActiveMipMapLevel(),p=e.state;p.setBlending(NoBlending),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(var m,f=0,b=t.length;f<b;f++){var _=t[f],x=_.shadow,w=_&&_.isPointLight;if(void 0!==x){var S=x.camera;if(a.copy(x.mapSize),a.min(o),w){var A=a.x,C=a.y;y[0].set(2*A,C,A,C),y[1].set(0,C,A,C),y[2].set(3*A,C,A,C),y[3].set(A,C,A,C),y[4].set(3*A,0,A,C),y[5].set(A,0,A,C),a.x*=4,a.y*=2}if(null===x.map){var M={minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat};x.map=new WebGLRenderTarget(a.x,a.y,M),x.map.texture.name=_.name+".shadowMap",S.updateProjectionMatrix()}x.isSpotLightShadow&&x.update(_);var P=x.map,L=x.matrix;l.setFromMatrixPosition(_.matrixWorld),S.position.copy(l),w?(m=6,L.makeTranslation(-l.x,-l.y,-l.z)):(m=1,s.setFromMatrixPosition(_.target.matrixWorld),S.lookAt(s),S.updateMatrixWorld(),L.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),L.multiply(S.projectionMatrix),L.multiply(S.matrixWorldInverse)),e.setRenderTarget(P),e.clear();for(var I=0;I<m;I++){if(w){s.copy(S.position),s.add(g[I]),S.up.copy(v[I]),S.lookAt(s),S.updateMatrixWorld();var B=y[I];p.viewport(B)}n.multiplyMatrices(S.projectionMatrix,S.matrixWorldInverse),r.setFromMatrix(n),E(i,c,S,w)}}else console.warn("THREE.WebGLShadowMap:",_,"has no shadow.")}T.needsUpdate=!1,e.setRenderTarget(h,u,d)}}}function WebGLState(e,t,i,r){var n=new function(){var t=!1,i=new Vector4,r=null,n=new Vector4(0,0,0,0);return{setMask:function(i){r===i||t||(e.colorMask(i,i,i,i),r=i)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),i.set(t,r,a,o),!1===n.equals(i)&&(e.clearColor(t,r,a,o),n.copy(i))},reset:function(){t=!1,r=null,n.set(-1,0,0,0)}}},a=new function(){var t=!1,i=null,r=null,n=null;return{setTest:function(e){e?z(2929):G(2929)},setMask:function(r){i===r||t||(e.depthMask(r),i=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case NeverDepth:e.depthFunc(512);break;case AlwaysDepth:e.depthFunc(519);break;case LessDepth:e.depthFunc(513);break;case LessEqualDepth:e.depthFunc(515);break;case EqualDepth:e.depthFunc(514);break;case GreaterEqualDepth:e.depthFunc(518);break;case GreaterDepth:e.depthFunc(516);break;case NotEqualDepth:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){n!==t&&(e.clearDepth(t),n=t)},reset:function(){t=!1,i=null,r=null,n=null}}},o=new function(){var t=!1,i=null,r=null,n=null,a=null,o=null,s=null,l=null,c=null;return{setTest:function(e){e?z(2960):G(2960)},setMask:function(r){i===r||t||(e.stencilMask(r),i=r)},setFunc:function(t,i,o){r===t&&n===i&&a===o||(e.stencilFunc(t,i,o),r=t,n=i,a=o)},setOp:function(t,i,r){o===t&&s===i&&l===r||(e.stencilOp(t,i,r),o=t,s=i,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,i=null,r=null,n=null,a=null,o=null,s=null,l=null,c=null}}},s=e.getParameter(34921),l=new Uint8Array(s),c=new Uint8Array(s),h=new Uint8Array(s),u={},d=null,p=null,m=null,f=null,g=null,v=null,y=null,b=null,_=null,x=null,w=!1,S=null,T=null,A=null,E=null,C=null,M=e.getParameter(35661),P=!1,L=0,I=e.getParameter(7938);-1!==I.indexOf("WebGL")?(L=parseFloat(/^WebGL\ ([0-9])/.exec(I)[1]),P=1<=L):-1!==I.indexOf("OpenGL ES")&&(L=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(I)[1]),P=2<=L);var B=null,R={},F=new Vector4,O=new Vector4;function k(t,i,r){var n=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var o=0;o<r;o++)e.texImage2D(i+o,0,6408,1,1,0,6408,5121,n);return a}var D={3553:k(3553,3553,1),34067:k(34067,34069,6)};function N(i,n){(l[i]=1,0===c[i]&&(e.enableVertexAttribArray(i),c[i]=1),h[i]!==n)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](i,n),h[i]=n)}function z(t){!0!==u[t]&&(e.enable(t),u[t]=!0)}function G(t){!1!==u[t]&&(e.disable(t),u[t]=!1)}function U(t,r,n,a,o,s,l,c){if(t!==NoBlending){if(m||(z(3042),m=!0),t===CustomBlending)o=o||r,s=s||n,l=l||a,r===g&&o===b||(e.blendEquationSeparate(i.convert(r),i.convert(o)),g=r,b=o),n===v&&a===y&&s===_&&l===x||(e.blendFuncSeparate(i.convert(n),i.convert(a),i.convert(s),i.convert(l)),v=n,y=a,_=s,x=l),f=t,w=null;else if(t!==f||c!==w){if(g===AddEquation&&b===AddEquation||(e.blendEquation(32774),g=AddEquation,b=AddEquation),c)switch(t){case NormalBlending:e.blendFuncSeparate(1,771,1,771);break;case AdditiveBlending:e.blendFunc(1,1);break;case SubtractiveBlending:e.blendFuncSeparate(0,0,769,771);break;case MultiplyBlending:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case NormalBlending:e.blendFuncSeparate(770,771,1,771);break;case AdditiveBlending:e.blendFunc(770,1);break;case SubtractiveBlending:e.blendFunc(0,769);break;case MultiplyBlending:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,y=null,_=null,x=null,f=t,w=c}}else m&&(G(3042),m=!1)}function V(t){S!==t&&(t?e.frontFace(2304):e.frontFace(2305),S=t)}function H(t){t!==CullFaceNone?(z(2884),t!==T&&(t===CullFaceBack?e.cullFace(1029):t===CullFaceFront?e.cullFace(1028):e.cullFace(1032))):G(2884),T=t}function $(t,i,r){t?(z(32823),E===i&&C===r||(e.polygonOffset(i,r),E=i,C=r)):G(32823)}function j(t){void 0===t&&(t=33984+M-1),B!==t&&(e.activeTexture(t),B=t)}return n.setClear(0,0,0,1),a.setClear(1),o.setClear(0),z(2929),a.setFunc(LessEqualDepth),V(!1),H(CullFaceBack),z(2884),U(NoBlending),{buffers:{color:n,depth:a,stencil:o},initAttributes:function(){for(var e=0,t=l.length;e<t;e++)l[e]=0},enableAttribute:function(e){N(e,0)},enableAttributeAndDivisor:N,disableUnusedAttributes:function(){for(var t=0,i=c.length;t!==i;++t)c[t]!==l[t]&&(e.disableVertexAttribArray(t),c[t]=0)},enable:z,disable:G,getCompressedTextureFormats:function(){if(null===d&&(d=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var i=e.getParameter(34467),r=0;r<i.length;r++)d.push(i[r]);return d},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:U,setMaterial:function(e,t){e.side===DoubleSide?G(2884):z(2884);var i=e.side===BackSide;t&&(i=!i),V(i),e.blending===NormalBlending&&!1===e.transparent?U(NoBlending):U(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),a.setFunc(e.depthFunc),a.setTest(e.depthTest),a.setMask(e.depthWrite),n.setMask(e.colorWrite),$(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:V,setCullFace:H,setLineWidth:function(t){t!==A&&(P&&e.lineWidth(t),A=t)},setPolygonOffset:$,setScissorTest:function(e){e?z(3089):G(3089)},activeTexture:j,bindTexture:function(t,i){null===B&&j();var r=R[B];void 0===r&&(r={type:void 0,texture:void 0},R[B]=r),r.type===t&&r.texture===i||(e.bindTexture(t,i||D[t]),r.type=t,r.texture=i)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===F.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),F.copy(t))},viewport:function(t){!1===O.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),O.copy(t))},reset:function(){for(var t=0;t<c.length;t++)1===c[t]&&(e.disableVertexAttribArray(t),c[t]=0);u={},d=null,B=null,R={},p=null,f=null,S=null,T=null,n.reset(),a.reset(),o.reset()}}}function WebGLTextures(e,t,i,r,n,a,o){var s,l={},c="undefined"!=typeof OffscreenCanvas;function h(e,t){return c?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function u(e,t,i,r){var n=1;if((e.width>r||e.height>r)&&(n=r/Math.max(e.width,e.height)),1>n||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?_Math.floorPowerOfTwo:Math.floor,o=a(n*e.width),l=a(n*e.height);void 0===s&&(s=h(o,l));var c=i?h(o,l):s;return c.width=o,c.height=l,c.getContext("2d").drawImage(e,0,0,o,l),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+l+")."),c}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function d(e){return _Math.isPowerOfTwo(e.width)&&_Math.isPowerOfTwo(e.height)}function p(e,t){return e.generateMipmaps&&t&&e.minFilter!==NearestFilter&&e.minFilter!==LinearFilter}function m(t,i,n,a){e.generateMipmap(t),r.get(i).__maxMipLevel=Math.log(Math.max(n,a))*Math.LOG2E}function f(e,i){if(!n.isWebGL2)return e;var r=e;return 6403===e&&(5126===i&&(r=33326),5131===i&&(r=33325),5121===i&&(r=33321)),6407===e&&(5126===i&&(r=34837),5131===i&&(r=34843),5121===i&&(r=32849)),6408===e&&(5126===i&&(r=34836),5131===i&&(r=34842),5121===i&&(r=32856)),33325===r||33326===r||34842===r||34836===r?t.get("EXT_color_buffer_float"):34843!==r&&34837!==r||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),r}function g(e){return e===NearestFilter||e===NearestMipMapNearestFilter||e===NearestMipMapLinearFilter?9728:9729}function v(t){var i=t.target;i.removeEventListener("dispose",v),function(t){var i=r.get(t);if(void 0===i.__webglInit)return;e.deleteTexture(i.__webglTexture),r.remove(t)}(i),i.isVideoTexture&&delete l[i.id],o.memory.textures--}function y(t){var i=t.target;i.removeEventListener("dispose",y),function(t){var i=r.get(t),n=r.get(t.texture);if(!t)return;void 0!==n.__webglTexture&&e.deleteTexture(n.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var a=0;6>a;a++)e.deleteFramebuffer(i.__webglFramebuffer[a]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[a]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer);r.remove(t.texture),r.remove(t)}(i),o.memory.textures--}var b=0;function _(e,t){var n=r.get(e);if(e.isVideoTexture&&function(e){var t=e.id,i=o.render.frame;l[t]!==i&&(l[t]=i,e.update())}(e),0<e.version&&n.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void A(n,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}i.activeTexture(33984+t),i.bindTexture(3553,n.__webglTexture)}function x(t,o){var s=r.get(t);if(6===t.image.length)if(0<t.version&&s.__version!==t.version){T(s,t),i.activeTexture(33984+o),i.bindTexture(34067,s.__webglTexture),e.pixelStorei(37440,t.flipY);for(var l=t&&t.isCompressedTexture,c=t.image[0]&&t.image[0].isDataTexture,h=[],g=0;6>g;g++)h[g]=l||c?c?t.image[g].image:t.image[g]:u(t.image[g],!1,!0,n.maxCubemapSize);var v=h[0],y=d(v)||n.isWebGL2,b=a.convert(t.format),_=a.convert(t.type),x=f(b,_);S(34067,t,y);for(g=0;6>g;g++)if(l)for(var w,A=h[g].mipmaps,E=0,C=A.length;E<C;E++)w=A[E],t.format!==RGBAFormat&&t.format!==RGBFormat?-1<i.getCompressedTextureFormats().indexOf(b)?i.compressedTexImage2D(34069+g,E,x,w.width,w.height,0,w.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+g,E,x,w.width,w.height,0,b,_,w.data);else c?i.texImage2D(34069+g,0,x,h[g].width,h[g].height,0,b,_,h[g].data):i.texImage2D(34069+g,0,x,b,_,h[g]);s.__maxMipLevel=l?A.length-1:0,p(t,y)&&m(34067,t,v.width,v.height),s.__version=t.version,t.onUpdate&&t.onUpdate(t)}else i.activeTexture(33984+o),i.bindTexture(34067,s.__webglTexture)}function w(e,t){i.activeTexture(33984+t),i.bindTexture(34067,r.get(e).__webglTexture)}function S(i,o,s){var l;if(s?(e.texParameteri(i,10242,a.convert(o.wrapS)),e.texParameteri(i,10243,a.convert(o.wrapT)),32879!==i&&35866!==i||e.texParameteri(i,32882,a.convert(o.wrapR)),e.texParameteri(i,10240,a.convert(o.magFilter)),e.texParameteri(i,10241,a.convert(o.minFilter))):(e.texParameteri(i,10242,33071),e.texParameteri(i,10243,33071),32879!==i&&35866!==i||e.texParameteri(i,32882,33071),o.wrapS===ClampToEdgeWrapping&&o.wrapT===ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(i,10240,g(o.magFilter)),e.texParameteri(i,10241,g(o.minFilter)),o.minFilter!==NearestFilter&&o.minFilter!==LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),l=t.get("EXT_texture_filter_anisotropic")){if(o.type===FloatType&&null===t.get("OES_texture_float_linear"))return;if(o.type===HalfFloatType&&null===(n.isWebGL2||t.get("OES_texture_half_float_linear")))return;(1<o.anisotropy||r.get(o).__currentAnisotropy)&&(e.texParameterf(i,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,n.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function T(t,i){void 0===t.__webglInit&&(t.__webglInit=!0,i.addEventListener("dispose",v),t.__webglTexture=e.createTexture(),o.memory.textures++)}function A(t,r,o){var s=3553;r.isDataTexture2DArray&&(s=35866),r.isDataTexture3D&&(s=32879),T(t,r),i.activeTexture(33984+o),i.bindTexture(s,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment);var l=function(e){return!n.isWebGL2&&(e.wrapS!==ClampToEdgeWrapping||e.wrapT!==ClampToEdgeWrapping||e.minFilter!==NearestFilter&&e.minFilter!==LinearFilter)}(r)&&!1===d(r.image),c=u(r.image,l,!1,n.maxTextureSize),h=d(c)||n.isWebGL2,g=a.convert(r.format),v=a.convert(r.type),y=f(g,v);S(s,r,h);var b,_=r.mipmaps;if(r.isDepthTexture){if(y=6402,r.type===FloatType){if(!n.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");y=36012}else n.isWebGL2&&(y=33189);r.format===DepthFormat&&6402===y&&r.type!==UnsignedShortType&&r.type!==UnsignedIntType&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=UnsignedShortType,v=a.convert(r.type)),r.format===DepthStencilFormat&&(y=34041,r.type!==UnsignedInt248Type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=UnsignedInt248Type,v=a.convert(r.type))),i.texImage2D(3553,0,y,c.width,c.height,0,g,v,null)}else if(r.isDataTexture)if(0<_.length&&h){for(var x=0,w=_.length;x<w;x++)b=_[x],i.texImage2D(3553,x,y,b.width,b.height,0,g,v,b.data);r.generateMipmaps=!1,t.__maxMipLevel=_.length-1}else i.texImage2D(3553,0,y,c.width,c.height,0,g,v,c.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(x=0,w=_.length;x<w;x++)b=_[x],r.format!==RGBAFormat&&r.format!==RGBFormat?-1<i.getCompressedTextureFormats().indexOf(g)?i.compressedTexImage2D(3553,x,y,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,x,y,b.width,b.height,0,g,v,b.data);t.__maxMipLevel=_.length-1}else if(r.isDataTexture2DArray)i.texImage3D(35866,0,y,c.width,c.height,c.depth,0,g,v,c.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)i.texImage3D(32879,0,y,c.width,c.height,c.depth,0,g,v,c.data),t.__maxMipLevel=0;else if(0<_.length&&h){for(x=0,w=_.length;x<w;x++)b=_[x],i.texImage2D(3553,x,y,g,v,b);r.generateMipmaps=!1,t.__maxMipLevel=_.length-1}else i.texImage2D(3553,0,y,g,v,c),t.__maxMipLevel=0;p(r,h)&&m(3553,r,c.width,c.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function E(t,n,o,s){var l=a.convert(n.texture.format),c=a.convert(n.texture.type),h=f(l,c);i.texImage2D(s,0,h,n.width,n.height,0,l,c,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,r.get(n.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function C(t,i,r){if(e.bindRenderbuffer(36161,t),i.depthBuffer&&!i.stencilBuffer){if(r){var n=P(i);e.renderbufferStorageMultisample(36161,n,33189,i.width,i.height)}else e.renderbufferStorage(36161,33189,i.width,i.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(i.depthBuffer&&i.stencilBuffer){if(r){n=P(i);e.renderbufferStorageMultisample(36161,n,35056,i.width,i.height)}else e.renderbufferStorage(36161,34041,i.width,i.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var o=f(a.convert(i.texture.format),a.convert(i.texture.type));if(r){n=P(i);e.renderbufferStorageMultisample(36161,n,o,i.width,i.height)}else e.renderbufferStorage(36161,o,i.width,i.height)}e.bindRenderbuffer(36161,null)}function M(t){var i=r.get(t),n=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(n)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),_(i.depthTexture,0);var n=r.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===DepthFormat)e.framebufferTexture2D(36160,36096,3553,n,0);else{if(i.depthTexture.format!==DepthStencilFormat)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,n,0)}}(i.__webglFramebuffer,t)}else if(n){i.__webglDepthbuffer=[];for(var a=0;6>a;a++)e.bindFramebuffer(36160,i.__webglFramebuffer[a]),i.__webglDepthbuffer[a]=e.createRenderbuffer(),C(i.__webglDepthbuffer[a],t)}else e.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),C(i.__webglDepthbuffer,t);e.bindFramebuffer(36160,null)}function P(e){return n.isWebGL2&&e.isWebGLMultisampleRenderTarget?Math.min(n.maxSamples,e.samples):0}var L=!1,I=!1;this.allocateTextureUnit=function(){var e=b;return e>=n.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+n.maxTextures),b+=1,e},this.resetTextureUnits=function(){b=0},this.setTexture2D=_,this.setTexture2DArray=function(e,t){var n=r.get(e);0<e.version&&n.__version!==e.version?A(n,e,t):(i.activeTexture(33984+t),i.bindTexture(35866,n.__webglTexture))},this.setTexture3D=function(e,t){var n=r.get(e);0<e.version&&n.__version!==e.version?A(n,e,t):(i.activeTexture(33984+t),i.bindTexture(32879,n.__webglTexture))},this.setTextureCube=x,this.setTextureCubeDynamic=w,this.setupRenderTarget=function(t){var s=r.get(t),l=r.get(t.texture);t.addEventListener("dispose",y),l.__webglTexture=e.createTexture(),o.memory.textures++;var c=!0===t.isWebGLRenderTargetCube,h=!0===t.isWebGLMultisampleRenderTarget,u=d(t)||n.isWebGL2;if(c){s.__webglFramebuffer=[];for(var g=0;6>g;g++)s.__webglFramebuffer[g]=e.createFramebuffer()}else if(s.__webglFramebuffer=e.createFramebuffer(),h)if(n.isWebGL2){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var v=f(a.convert(t.texture.format),a.convert(t.texture.type)),b=P(t);e.renderbufferStorageMultisample(36161,b,v,t.width,t.height),e.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),C(s.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(c){for(i.bindTexture(34067,l.__webglTexture),S(34067,t.texture,u),g=0;6>g;g++)E(s.__webglFramebuffer[g],t,36064,34069+g);p(t.texture,u)&&m(34067,t.texture,t.width,t.height),i.bindTexture(34067,null)}else i.bindTexture(3553,l.__webglTexture),S(3553,t.texture,u),E(s.__webglFramebuffer,t,36064,3553),p(t.texture,u)&&m(3553,t.texture,t.width,t.height),i.bindTexture(3553,null);t.depthBuffer&&M(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(p(t,d(e)||n.isWebGL2)){var a=e.isWebGLRenderTargetCube?34067:3553,o=r.get(t).__webglTexture;i.bindTexture(a,o),m(a,t,e.width,e.height),i.bindTexture(a,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(n.isWebGL2){var i=r.get(t);e.bindFramebuffer(36008,i.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,i.__webglFramebuffer);var a=t.width,o=t.height,s=16384;t.depthBuffer&&(s|=256),t.stencilBuffer&&(s|=1024),e.blitFramebuffer(0,0,a,o,0,0,a,o,s,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===L&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),L=!0),e=e.texture),_(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLRenderTargetCube&&(!1===I&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),I=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?x(e,t):w(e,t)}}function WebGLUtils(e,t,i){return{convert:function(e){var r;if(e===RepeatWrapping)return 10497;if(e===ClampToEdgeWrapping)return 33071;if(e===MirroredRepeatWrapping)return 33648;if(e===NearestFilter)return 9728;if(e===NearestMipMapNearestFilter)return 9984;if(e===NearestMipMapLinearFilter)return 9986;if(e===LinearFilter)return 9729;if(e===LinearMipMapNearestFilter)return 9985;if(e===LinearMipMapLinearFilter)return 9987;if(e===UnsignedByteType)return 5121;if(e===UnsignedShort4444Type)return 32819;if(e===UnsignedShort5551Type)return 32820;if(e===UnsignedShort565Type)return 33635;if(e===ByteType)return 5120;if(e===ShortType)return 5122;if(e===UnsignedShortType)return 5123;if(e===IntType)return 5124;if(e===UnsignedIntType)return 5125;if(e===FloatType)return 5126;if(e===HalfFloatType){if(i.isWebGL2)return 5131;if(null!==(r=t.get("OES_texture_half_float")))return r.HALF_FLOAT_OES}if(e===AlphaFormat)return 6406;if(e===RGBFormat)return 6407;if(e===RGBAFormat)return 6408;if(e===LuminanceFormat)return 6409;if(e===LuminanceAlphaFormat)return 6410;if(e===DepthFormat)return 6402;if(e===DepthStencilFormat)return 34041;if(e===RedFormat)return 6403;if(e===AddEquation)return 32774;if(e===SubtractEquation)return 32778;if(e===ReverseSubtractEquation)return 32779;if(e===ZeroFactor)return 0;if(e===OneFactor)return 1;if(e===SrcColorFactor)return 768;if(e===OneMinusSrcColorFactor)return 769;if(e===SrcAlphaFactor)return 770;if(e===OneMinusSrcAlphaFactor)return 771;if(e===DstAlphaFactor)return 772;if(e===OneMinusDstAlphaFactor)return 773;if(e===DstColorFactor)return 774;if(e===OneMinusDstColorFactor)return 775;if(e===SrcAlphaSaturateFactor)return 776;if((e===RGB_S3TC_DXT1_Format||e===RGBA_S3TC_DXT1_Format||e===RGBA_S3TC_DXT3_Format||e===RGBA_S3TC_DXT5_Format)&&null!==(r=t.get("WEBGL_compressed_texture_s3tc"))){if(e===RGB_S3TC_DXT1_Format)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===RGBA_S3TC_DXT1_Format)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===RGBA_S3TC_DXT3_Format)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===RGBA_S3TC_DXT5_Format)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((e===RGB_PVRTC_4BPPV1_Format||e===RGB_PVRTC_2BPPV1_Format||e===RGBA_PVRTC_4BPPV1_Format||e===RGBA_PVRTC_2BPPV1_Format)&&null!==(r=t.get("WEBGL_compressed_texture_pvrtc"))){if(e===RGB_PVRTC_4BPPV1_Format)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===RGB_PVRTC_2BPPV1_Format)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===RGBA_PVRTC_4BPPV1_Format)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===RGBA_PVRTC_2BPPV1_Format)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===RGB_ETC1_Format&&null!==(r=t.get("WEBGL_compressed_texture_etc1")))return r.COMPRESSED_RGB_ETC1_WEBGL;if((e===RGBA_ASTC_4x4_Format||e===RGBA_ASTC_5x4_Format||e===RGBA_ASTC_5x5_Format||e===RGBA_ASTC_6x5_Format||e===RGBA_ASTC_6x6_Format||e===RGBA_ASTC_8x5_Format||e===RGBA_ASTC_8x6_Format||e===RGBA_ASTC_8x8_Format||e===RGBA_ASTC_10x5_Format||e===RGBA_ASTC_10x6_Format||e===RGBA_ASTC_10x8_Format||e===RGBA_ASTC_10x10_Format||e===RGBA_ASTC_12x10_Format||e===RGBA_ASTC_12x12_Format)&&null!==(r=t.get("WEBGL_compressed_texture_astc")))return e;if(e===MinEquation||e===MaxEquation){if(i.isWebGL2){if(e===MinEquation)return 32775;if(e===MaxEquation)return 32776}if(null!==(r=t.get("EXT_blend_minmax"))){if(e===MinEquation)return r.MIN_EXT;if(e===MaxEquation)return r.MAX_EXT}}if(e===UnsignedInt248Type){if(i.isWebGL2)return 34042;if(null!==(r=t.get("WEBGL_depth_texture")))return r.UNSIGNED_INT_24_8_WEBGL}return 0}}}function Group(){Object3D.call(this),this.type="Group"}function ArrayCamera(e){PerspectiveCamera.call(this),this.cameras=e||[]}MeshDepthMaterial.prototype=Object.create(Material.prototype),MeshDepthMaterial.prototype.constructor=MeshDepthMaterial,MeshDepthMaterial.prototype.isMeshDepthMaterial=!0,MeshDepthMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},MeshDistanceMaterial.prototype=Object.create(Material.prototype),MeshDistanceMaterial.prototype.constructor=MeshDistanceMaterial,MeshDistanceMaterial.prototype.isMeshDistanceMaterial=!0,MeshDistanceMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},Group.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Group,isGroup:!0}),ArrayCamera.prototype=Object.assign(Object.create(PerspectiveCamera.prototype),{constructor:ArrayCamera,isArrayCamera:!0});var geometry,cameraLPos=new Vector3,cameraRPos=new Vector3;function setProjectionFromUnion(e,t,i){cameraLPos.setFromMatrixPosition(t.matrixWorld),cameraRPos.setFromMatrixPosition(i.matrixWorld);var r=cameraLPos.distanceTo(cameraRPos),n=t.projectionMatrix.elements,a=i.projectionMatrix.elements,o=n[14]/(n[10]-1),s=n[14]/(n[10]+1),l=(n[9]+1)/n[5],c=(n[9]-1)/n[5],h=(n[8]-1)/n[0],u=(a[8]+1)/a[0],d=o*h,p=o*u,m=r/(-h+u),f=m*-h;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(f),e.translateZ(m),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var g=o+m,v=s+m,y=d-f,b=p+(r-f),_=l*s/v*g,x=c*s/v*g;e.projectionMatrix.makePerspective(y,b,_,x,g,v)}function WebVRManager(e){var t,i,r=this,n=null,a=null,o=null,s=[],l=new Matrix4,c=new Matrix4,h=1,u="local-floor";"undefined"!=typeof window&&"VRFrameData"in window&&(a=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",x,!1));var d=new Matrix4,p=new Quaternion,m=new Vector3,f=new PerspectiveCamera;f.viewport=new Vector4,f.layers.enable(1);var g=new PerspectiveCamera;g.viewport=new Vector4,g.layers.enable(2);var v=new ArrayCamera([f,g]);function y(){return null!==n&&!0===n.isPresenting}v.layers.enable(1),v.layers.enable(2);var b,_=new Vector2;function x(){if(y()){var a=n.getEyeParameters("left");t=2*a.renderWidth*h,i=a.renderHeight*h,b=e.getPixelRatio(),e.getSize(_),e.setDrawingBufferSize(t,i,1),f.viewport.set(0,0,t/2,i),g.viewport.set(t/2,0,t/2,i),A.start(),r.dispatchEvent({type:"sessionstart"})}else r.enabled&&e.setDrawingBufferSize(_.width,_.height,b),A.stop(),r.dispatchEvent({type:"sessionend"})}var w=[];function S(e){for(var t,i=navigator.getGamepads&&navigator.getGamepads(),r=0,n=0,a=i.length;r<a;r++)if((t=i[r])&&("Daydream Controller"===t.id||"Gear VR Controller"===t.id||"Oculus Go Controller"===t.id||"OpenVR Gamepad"===t.id||t.id.startsWith("Oculus Touch")||t.id.startsWith("HTC Vive Focus")||t.id.startsWith("Spatial Controller"))){if(n===e)return t;n++}}function T(e,r){null!==r&&4===r.length&&e.set(r[0]*t,r[1]*i,r[2]*t,r[3]*i)}this.enabled=!1,this.getController=function(e){var t=s[e];return void 0===t&&((t=new Group).matrixAutoUpdate=!1,t.visible=!1,s[e]=t),t},this.getDevice=function(){return n},this.setDevice=function(e){void 0!==e&&(n=e),A.setContext(e)},this.setFramebufferScaleFactor=function(e){h=e},this.setReferenceSpaceType=function(e){u=e},this.setPoseTarget=function(e){void 0!==e&&(o=e)},this.getCamera=function(e){var t="local-floor"===u?1.6:0;if(!1===y())return e.position.set(0,t,0),e.rotation.set(0,0,0),e;if(n.depthNear=e.near,n.depthFar=e.far,n.getFrameData(a),"local-floor"===u){var i=n.stageParameters;i?l.fromArray(i.sittingToStandingTransform):l.makeTranslation(0,t,0)}var r=a.pose,h=null!==o?o:e;h.matrix.copy(l),h.matrix.decompose(h.position,h.quaternion,h.scale),null!==r.orientation&&(p.fromArray(r.orientation),h.quaternion.multiply(p)),null!==r.position&&(p.setFromRotationMatrix(l),m.fromArray(r.position),m.applyQuaternion(p),h.position.add(m)),h.updateMatrixWorld(),f.near=e.near,g.near=e.near,f.far=e.far,g.far=e.far,f.matrixWorldInverse.fromArray(a.leftViewMatrix),g.matrixWorldInverse.fromArray(a.rightViewMatrix),c.getInverse(l),"local-floor"===u&&(f.matrixWorldInverse.multiply(c),g.matrixWorldInverse.multiply(c));var b=h.parent;null!==b&&(d.getInverse(b.matrixWorld),f.matrixWorldInverse.multiply(d),g.matrixWorldInverse.multiply(d)),f.matrixWorld.getInverse(f.matrixWorldInverse),g.matrixWorld.getInverse(g.matrixWorldInverse),f.projectionMatrix.fromArray(a.leftProjectionMatrix),g.projectionMatrix.fromArray(a.rightProjectionMatrix),setProjectionFromUnion(v,f,g);var _=n.getLayers();if(_.length){var x=_[0];T(f.viewport,x.leftBounds),T(g.viewport,x.rightBounds)}return function(){for(var e=0;e<s.length;e++){var t=s[e],i=S(e);if(void 0!==i&&void 0!==i.pose){if(null===i.pose)return;var r=i.pose;!1===r.hasPosition&&t.position.set(.2,-.6,-.05),null!==r.position&&t.position.fromArray(r.position),null!==r.orientation&&t.quaternion.fromArray(r.orientation),t.matrix.compose(t.position,t.quaternion,t.scale),t.matrix.premultiply(l),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorldNeedsUpdate=!0,t.visible=!0;var n="Daydream Controller"===i.id?0:1;void 0===w[e]&&(w[e]=!1),w[e]!==i.buttons[n].pressed&&(w[e]=i.buttons[n].pressed,!0===w[e]?t.dispatchEvent({type:"selectstart"}):(t.dispatchEvent({type:"selectend"}),t.dispatchEvent({type:"select"})))}else t.visible=!1}}(),v},this.getStandingMatrix=function(){return l},this.isPresenting=y;var A=new WebGLAnimation;this.setAnimationLoop=function(e){A.setAnimationLoop(e),y()&&A.start()},this.submitFrame=function(){y()&&n.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",x)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}function WebXRManager(e){var t=this,i=e.context,r=null,n=null,a="local-floor",o=null,s=[],l=[];function c(){return null!==r&&null!==n}var h=new PerspectiveCamera;h.layers.enable(1),h.viewport=new Vector4;var u=new PerspectiveCamera;u.layers.enable(2),u.viewport=new Vector4;var d=new ArrayCamera([h,u]);function p(e){for(var t=0;t<s.length;t++)l[t]===e.inputSource&&s[t].dispatchEvent({type:e.type})}function m(){e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),y.stop(),t.dispatchEvent({type:"sessionend"})}function f(e){n=e,y.setContext(r),y.start(),t.dispatchEvent({type:"sessionstart"})}function g(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}d.layers.enable(1),d.layers.enable(2),this.enabled=!1,this.getController=function(e){var t=s[e];return void 0===t&&((t=new Group).matrixAutoUpdate=!1,t.visible=!1,s[e]=t),t},this.setFramebufferScaleFactor=function(e){},this.setReferenceSpaceType=function(e){a=e},this.getSession=function(){return r},this.setSession=function(e){null!==(r=e)&&(r.addEventListener("select",p),r.addEventListener("selectstart",p),r.addEventListener("selectend",p),r.addEventListener("end",m),r.updateRenderState({baseLayer:new XRWebGLLayer(r,i)}),r.requestReferenceSpace(a).then(f),l=r.inputSources,r.addEventListener("inputsourceschange",function(){l=r.inputSources,console.log(l);for(var e=0;e<s.length;e++)s[e].userData.inputSource=l[e]}))},this.getCamera=function(e){if(c()){var t=e.parent,i=d.cameras;g(d,t);for(var r=0;r<i.length;r++)g(i[r],t);e.matrixWorld.copy(d.matrixWorld);for(var n=e.children,a=(r=0,n.length);r<a;r++)n[r].updateMatrixWorld(!0);return setProjectionFromUnion(d,h,u),d}return e},this.isPresenting=c;var v=null;var y=new WebGLAnimation;y.setAnimationLoop(function(t,i){if(null!==(o=i.getViewerPose(n))){var a=o.views,c=r.renderState.baseLayer;e.setFramebuffer(c.framebuffer);for(var h=0;h<a.length;h++){var u=a[h],p=c.getViewport(u),m=u.transform.inverse.matrix,f=d.cameras[h];f.matrix.fromArray(m).getInverse(f.matrix),f.projectionMatrix.fromArray(u.projectionMatrix),f.viewport.set(p.x,p.y,p.width,p.height),0===h&&d.matrix.copy(f.matrix)}}for(h=0;h<s.length;h++){var g=s[h],y=l[h];if(y){var b=i.getPose(y.targetRaySpace,n);if(null!==b){g.matrix.fromArray(b.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.visible=!0;continue}}g.visible=!1}v&&v(t)}),this.setAnimationLoop=function(e){v=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new Matrix4},this.getDevice=function(){console.warn("THREE.WebXRManager: getDevice() has been deprecated.")},this.setDevice=function(){console.warn("THREE.WebXRManager: setDevice() has been deprecated.")},this.setFrameOfReferenceType=function(){console.warn("THREE.WebXRManager: setFrameOfReferenceType() has been deprecated.")},this.submitFrame=function(){}}function WebGLRenderer(e){console.log("THREE.WebGLRenderer",REVISION);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),i=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,n=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",h=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,u=null,d=null;this.domElement=t,this.context=null,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=LinearToneMapping,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var p,m,f,g,v,y,b,_,x,w,S,T,A,E,C,M,P,L,I=this,B=!1,R=null,F=0,O=0,k=null,D=null,N=-1,z={geometry:null,program:null,wireframe:!1},G=null,U=null,V=new Vector4,H=new Vector4,$=null,j=t.width,W=t.height,X=1,q=new Vector4(0,0,j,W),Y=new Vector4(0,0,j,W),Q=!1,K=new Frustum,Z=new WebGLClipping,J=!1,ee=!1,te=new Matrix4,ie=new Vector3;function re(){return null===k?X:1}try{var ne={alpha:r,depth:n,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:h,xrCompatible:!0};if(t.addEventListener("webglcontextlost",le,!1),t.addEventListener("webglcontextrestored",ce,!1),null===(p=i||t.getContext("webgl",ne)||t.getContext("experimental-webgl",ne)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===p.getShaderPrecisionFormat&&(p.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function ae(){m=new WebGLExtensions(p),(f=new WebGLCapabilities(p,m,e)).isWebGL2||(m.get("WEBGL_depth_texture"),m.get("OES_texture_float"),m.get("OES_texture_half_float"),m.get("OES_texture_half_float_linear"),m.get("OES_standard_derivatives"),m.get("OES_element_index_uint"),m.get("ANGLE_instanced_arrays")),m.get("OES_texture_float_linear"),L=new WebGLUtils(p,m,f),(g=new WebGLState(p,m,L,f)).scissor(H.copy(Y).multiplyScalar(X).floor()),g.viewport(V.copy(q).multiplyScalar(X).floor()),v=new WebGLInfo(p),y=new WebGLProperties,b=new WebGLTextures(p,m,g,y,f,L,v),_=new WebGLAttributes(p),x=new WebGLGeometries(p,_,v),w=new WebGLObjects(x,v),C=new WebGLMorphtargets(p),S=new WebGLPrograms(I,m,f),T=new WebGLRenderLists,A=new WebGLRenderStates,E=new WebGLBackground(I,g,w,s),M=new WebGLBufferRenderer(p,m,v,f),P=new WebGLIndexedBufferRenderer(p,m,v,f),v.programs=S.programs,I.context=p,I.capabilities=f,I.extensions=m,I.properties=y,I.renderLists=T,I.state=g,I.info=v}ae();var oe="undefined"!=typeof navigator&&"xr"in navigator&&"supportsSession"in navigator.xr?new WebXRManager(I):new WebVRManager(I);this.vr=oe;var se=new WebGLShadowMap(I,w,f.maxTextureSize);function le(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),B=!0}function ce(){console.log("THREE.WebGLRenderer: Context Restored."),B=!1,ae()}function he(e){var t=e.target;t.removeEventListener("dispose",he),function(e){ue(e),y.remove(e)}(t)}function ue(e){var t=y.get(e).program;e.program=void 0,void 0!==t&&S.releaseProgram(t)}this.shadowMap=se,this.getContext=function(){return p},this.getContextAttributes=function(){return p.getContextAttributes()},this.forceContextLoss=function(){var e=m.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=m.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(e){void 0!==e&&(X=e,this.setSize(j,W,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new Vector2),e.set(j,W)},this.setSize=function(e,i,r){oe.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(j=e,W=i,t.width=Math.floor(e*X),t.height=Math.floor(i*X),!1!==r&&(t.style.width=e+"px",t.style.height=i+"px"),this.setViewport(0,0,e,i))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new Vector2),e.set(j*X,W*X).floor()},this.setDrawingBufferSize=function(e,i,r){j=e,W=i,X=r,t.width=Math.floor(e*r),t.height=Math.floor(i*r),this.setViewport(0,0,e,i)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new Vector4),e.copy(V)},this.getViewport=function(e){return e.copy(q)},this.setViewport=function(e,t,i,r){e.isVector4?q.set(e.x,e.y,e.z,e.w):q.set(e,t,i,r),g.viewport(V.copy(q).multiplyScalar(X).floor())},this.getScissor=function(e){return e.copy(Y)},this.setScissor=function(e,t,i,r){e.isVector4?Y.set(e.x,e.y,e.z,e.w):Y.set(e,t,i,r),g.scissor(H.copy(Y).multiplyScalar(X).floor())},this.getScissorTest=function(){return Q},this.setScissorTest=function(e){g.setScissorTest(Q=e)},this.getClearColor=function(){return E.getClearColor()},this.setClearColor=function(){E.setClearColor.apply(E,arguments)},this.getClearAlpha=function(){return E.getClearAlpha()},this.setClearAlpha=function(){E.setClearAlpha.apply(E,arguments)},this.clear=function(e,t,i){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===i||i)&&(r|=1024),p.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",le,!1),t.removeEventListener("webglcontextrestored",ce,!1),T.dispose(),A.dispose(),y.dispose(),w.dispose(),oe.dispose(),pe.stop()},this.renderBufferImmediate=function(e,t){g.initAttributes();var i=y.get(e);e.hasPositions&&!i.position&&(i.position=p.createBuffer()),e.hasNormals&&!i.normal&&(i.normal=p.createBuffer()),e.hasUvs&&!i.uv&&(i.uv=p.createBuffer()),e.hasColors&&!i.color&&(i.color=p.createBuffer());var r=t.getAttributes();e.hasPositions&&(p.bindBuffer(34962,i.position),p.bufferData(34962,e.positionArray,35048),g.enableAttribute(r.position),p.vertexAttribPointer(r.position,3,5126,!1,0,0)),e.hasNormals&&(p.bindBuffer(34962,i.normal),p.bufferData(34962,e.normalArray,35048),g.enableAttribute(r.normal),p.vertexAttribPointer(r.normal,3,5126,!1,0,0)),e.hasUvs&&(p.bindBuffer(34962,i.uv),p.bufferData(34962,e.uvArray,35048),g.enableAttribute(r.uv),p.vertexAttribPointer(r.uv,2,5126,!1,0,0)),e.hasColors&&(p.bindBuffer(34962,i.color),p.bufferData(34962,e.colorArray,35048),g.enableAttribute(r.color),p.vertexAttribPointer(r.color,3,5126,!1,0,0)),g.disableUnusedAttributes(),p.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,i,r,n,a){var o=n.isMesh&&0>n.matrixWorld.determinant();g.setMaterial(r,o);var s=ve(e,t,r,n),l=!1;z.geometry===i.id&&z.program===s.id&&z.wireframe===(!0===r.wireframe)||(z.geometry=i.id,z.program=s.id,z.wireframe=!0===r.wireframe,l=!0),n.morphTargetInfluences&&(C.update(n,i,r,s),l=!0);var c=i.index,h=i.attributes.position,u=1;!0===r.wireframe&&(c=x.getWireframeAttribute(i),u=2);var d,v=M;null!==c&&(d=_.get(c),(v=P).setIndex(d)),l&&(!function(e,t,i){if(i&&i.isInstancedBufferGeometry&&!f.isWebGL2&&null===m.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");g.initAttributes();var r=i.attributes,n=t.getAttributes(),a=e.defaultAttributeValues;for(var o in n){var s=n[o];if(0<=s){var l=r[o];if(void 0!==l){var c=l.normalized,h=l.itemSize,u=_.get(l);if(void 0===u)continue;var d=u.buffer,v=u.type,y=u.bytesPerElement;if(l.isInterleavedBufferAttribute){var b=l.data,x=b.stride,w=l.offset;b&&b.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(s,b.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=b.meshPerAttribute*b.count)):g.enableAttribute(s),p.bindBuffer(34962,d),p.vertexAttribPointer(s,h,v,c,x*y,w*y)}else l.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(s,l.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=l.meshPerAttribute*l.count)):g.enableAttribute(s),p.bindBuffer(34962,d),p.vertexAttribPointer(s,h,v,c,0,0)}else if(void 0!==a){var S=a[o];if(void 0!==S)switch(S.length){case 2:p.vertexAttrib2fv(s,S);break;case 3:p.vertexAttrib3fv(s,S);break;case 4:p.vertexAttrib4fv(s,S);break;default:p.vertexAttrib1fv(s,S)}}}}g.disableUnusedAttributes()}(r,s,i),null!==c&&p.bindBuffer(34963,d.buffer));var y=1/0;null!==c?y=c.count:void 0!==h&&(y=h.count);var b=i.drawRange.start*u,w=i.drawRange.count*u,S=null!==a?a.start*u:0,T=null!==a?a.count*u:1/0,A=Math.max(b,S),E=Math.min(y,b+w,S+T)-1,L=Math.max(0,E-A+1);if(0!==L){if(n.isMesh)if(!0===r.wireframe)g.setLineWidth(r.wireframeLinewidth*re()),v.setMode(1);else switch(n.drawMode){case TrianglesDrawMode:v.setMode(4);break;case TriangleStripDrawMode:v.setMode(5);break;case TriangleFanDrawMode:v.setMode(6)}else if(n.isLine){var I=r.linewidth;void 0===I&&(I=1),g.setLineWidth(I*re()),n.isLineSegments?v.setMode(1):n.isLineLoop?v.setMode(2):v.setMode(3)}else n.isPoints?v.setMode(0):n.isSprite&&v.setMode(4);i&&i.isInstancedBufferGeometry?0<i.maxInstancedCount&&v.renderInstances(i,A,L):v.render(A,L)}},this.compile=function(e,t){(d=A.get(e,t)).init(),e.traverse(function(e){e.isLight&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))}),d.setupLights(t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var i=0;i<t.material.length;i++)ge(t.material[i],e.fog,t);else ge(t.material,e.fog,t)})};var de=null;var pe=new WebGLAnimation;function me(e,t,i,r){for(var n=0,a=e.length;n<a;n++){var o=e[n],s=o.object,l=o.geometry,c=void 0===r?o.material:r,h=o.group;if(i.isArrayCamera){U=i;for(var u,p=i.cameras,m=0,f=p.length;m<f;m++)u=p[m],s.layers.test(u.layers)&&(g.viewport(V.copy(u.viewport)),d.setupLights(u),fe(s,t,u,l,c,h))}else U=null,fe(s,t,i,l,c,h)}}function fe(e,t,i,r,n,a){if(e.onBeforeRender(I,t,i,r,n,a),d=A.get(t,U||i),e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){g.setMaterial(n);var o=ve(i,t.fog,n,e);z.geometry=null,z.program=null,z.wireframe=!1,function(e,t){e.render(function(e){I.renderBufferImmediate(e,t)})}(e,o)}else I.renderBufferDirect(i,t.fog,r,n,e,a);e.onAfterRender(I,t,i,r,n,a),d=A.get(t,U||i)}function ge(e,t,i){var r=y.get(e),n=d.state.lights,a=d.state.shadowsArray,o=n.state.version,s=S.getParameters(e,n.state,a,t,Z.numPlanes,Z.numIntersection,i),l=S.getProgramCode(e,s),c=r.program,h=!0;if(void 0===c)e.addEventListener("dispose",he);else if(c.code!==l)ue(e);else if(r.lightsStateVersion!==o)r.lightsStateVersion=o,h=!1;else{if(void 0!==s.shaderID)return;h=!1}if(h){if(s.shaderID){var u=ShaderLib[s.shaderID];r.shader={name:e.type,uniforms:cloneUniforms(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}}else r.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(r.shader,I),l=S.getProgramCode(e,s),c=S.acquireProgram(e,r.shader,s,l),r.program=c,e.program=c}var p=c.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var m=0;m<I.maxMorphTargets;m++)0<=p["morphTarget"+m]&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(m=0;m<I.maxMorphNormals;m++)0<=p["morphNormal"+m]&&e.numSupportedMorphNormals++}var f=r.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=Z.numPlanes,r.numIntersection=Z.numIntersection,f.clippingPlanes=Z.uniform),r.fog=t,r.lightsStateVersion=o,e.lights&&(f.ambientLightColor.value=n.state.ambient,f.lightProbe.value=n.state.probe,f.directionalLights.value=n.state.directional,f.spotLights.value=n.state.spot,f.rectAreaLights.value=n.state.rectArea,f.pointLights.value=n.state.point,f.hemisphereLights.value=n.state.hemi,f.directionalShadowMap.value=n.state.directionalShadowMap,f.directionalShadowMatrix.value=n.state.directionalShadowMatrix,f.spotShadowMap.value=n.state.spotShadowMap,f.spotShadowMatrix.value=n.state.spotShadowMatrix,f.pointShadowMap.value=n.state.pointShadowMap,f.pointShadowMatrix.value=n.state.pointShadowMatrix);var g=r.program.getUniforms(),v=WebGLUniforms.seqWithValue(g.seq,f);r.uniformsList=v}function ve(e,t,i,r){b.resetTextureUnits();var n=y.get(i),a=d.state.lights;if(J&&(ee||e!==G)){var o=e===G&&i.id===N;Z.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,e,n,o)}!1===i.needsUpdate&&(void 0===n.program?i.needsUpdate=!0:i.fog&&n.fog!==t?i.needsUpdate=!0:i.lights&&n.lightsStateVersion!==a.state.version?i.needsUpdate=!0:void 0===n.numClippingPlanes||n.numClippingPlanes===Z.numPlanes&&n.numIntersection===Z.numIntersection||(i.needsUpdate=!0)),i.needsUpdate&&(ge(i,t,r),i.needsUpdate=!1);var s,l,c=!1,h=!1,u=!1,m=n.program,v=m.getUniforms(),_=n.shader.uniforms;if(g.useProgram(m.program)&&(c=!0,h=!0,u=!0),i.id!==N&&(N=i.id,h=!0),c||G!==e){if(v.setValue(p,"projectionMatrix",e.projectionMatrix),f.logarithmicDepthBuffer&&v.setValue(p,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),G!==e&&(G=e,h=!0,u=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap){var x=v.map.cameraPosition;void 0!==x&&x.setValue(p,ie.setFromMatrixPosition(e.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&v.setValue(p,"viewMatrix",e.matrixWorldInverse)}if(i.skinning){v.setOptional(p,r,"bindMatrix"),v.setOptional(p,r,"bindMatrixInverse");var w=r.skeleton;if(w){var S=w.bones;if(f.floatVertexTextures){if(void 0===w.boneTexture){var T=Math.sqrt(4*S.length);T=_Math.ceilPowerOfTwo(T),T=Math.max(T,4);var A=new Float32Array(T*T*4);A.set(w.boneMatrices);var E=new DataTexture(A,T,T,RGBAFormat,FloatType);E.needsUpdate=!0,w.boneMatrices=A,w.boneTexture=E,w.boneTextureSize=T}v.setValue(p,"boneTexture",w.boneTexture,b),v.setValue(p,"boneTextureSize",w.boneTextureSize)}else v.setOptional(p,w,"boneMatrices")}}return h&&(v.setValue(p,"toneMappingExposure",I.toneMappingExposure),v.setValue(p,"toneMappingWhitePoint",I.toneMappingWhitePoint),i.lights&&(l=u,(s=_).ambientLightColor.needsUpdate=l,s.lightProbe.needsUpdate=l,s.directionalLights.needsUpdate=l,s.pointLights.needsUpdate=l,s.spotLights.needsUpdate=l,s.rectAreaLights.needsUpdate=l,s.hemisphereLights.needsUpdate=l),t&&i.fog&&function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(_,t),i.isMeshBasicMaterial?ye(_,i):i.isMeshLambertMaterial?(ye(_,i),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(_,i)):i.isMeshPhongMaterial?(ye(_,i),i.isMeshToonMaterial?function(e,t){be(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(_,i):be(_,i)):i.isMeshStandardMaterial?(ye(_,i),i.isMeshPhysicalMaterial?function(e,t){_e(e,t),e.reflectivity.value=t.reflectivity,e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness}(_,i):_e(_,i)):i.isMeshMatcapMaterial?(ye(_,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===BackSide&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===BackSide&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(_,i)):i.isMeshDepthMaterial?(ye(_,i),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(_,i)):i.isMeshDistanceMaterial?(ye(_,i),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(_,i)):i.isMeshNormalMaterial?(ye(_,i),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===BackSide&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===BackSide&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(_,i)):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(_,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(_,i)):i.isPointsMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*X,e.scale.value=.5*W,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(_,i):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(_,i):i.isShadowMaterial&&(_.color.value.copy(i.color),_.opacity.value=i.opacity),void 0!==_.ltc_1&&(_.ltc_1.value=UniformsLib.LTC_1),void 0!==_.ltc_2&&(_.ltc_2.value=UniformsLib.LTC_2),WebGLUniforms.upload(p,n.uniformsList,_,b)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(WebGLUniforms.upload(p,n.uniformsList,_,b),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&v.setValue(p,"center",r.center),v.setValue(p,"modelViewMatrix",r.modelViewMatrix),v.setValue(p,"normalMatrix",r.normalMatrix),v.setValue(p,"modelMatrix",r.matrixWorld),m}function ye(e,t){var i;e.opacity.value=t.opacity,t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=y.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?i=t.map:t.specularMap?i=t.specularMap:t.displacementMap?i=t.displacementMap:t.normalMap?i=t.normalMap:t.bumpMap?i=t.bumpMap:t.roughnessMap?i=t.roughnessMap:t.metalnessMap?i=t.metalnessMap:t.alphaMap?i=t.alphaMap:t.emissiveMap&&(i=t.emissiveMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}function be(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===BackSide&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===BackSide&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function _e(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===BackSide&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===BackSide&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}pe.setAnimationLoop(function(e){oe.isPresenting()||de&&de(e)}),"undefined"!=typeof window&&pe.setContext(window),this.setAnimationLoop=function(e){de=e,oe.setAnimationLoop(e),pe.start()},this.render=function(e,t){var i,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),i=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),t&&t.isCamera){if(!B){z.geometry=null,z.program=null,z.wireframe=!1,N=-1,G=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),oe.enabled&&(t=oe.getCamera(t)),(d=A.get(e,t)).init(),e.onBeforeRender(I,e,t,i||k),te.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),K.setFromMatrix(te),ee=this.localClippingEnabled,J=Z.init(this.clippingPlanes,ee,t),(u=T.get(e,t)).init(),function e(t,i,r,n){if(!1===t.visible)return;var a=t.layers.test(i.layers);if(a)if(t.isGroup)r=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(i);else if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||K.intersectsSprite(t)){n&&ie.setFromMatrixPosition(t.matrixWorld).applyMatrix4(te);var o=w.update(t),s=t.material;s.visible&&u.push(t,o,s,r,ie.z,null)}}else if(t.isImmediateRenderObject)n&&ie.setFromMatrixPosition(t.matrixWorld).applyMatrix4(te),u.push(t,null,t.material,r,ie.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||K.intersectsObject(t))){n&&ie.setFromMatrixPosition(t.matrixWorld).applyMatrix4(te);var o=w.update(t),s=t.material;if(Array.isArray(s))for(var l=o.groups,c=0,h=l.length;c<h;c++){var p=l[c],m=s[p.materialIndex];m&&m.visible&&u.push(t,o,m,r,ie.z,p)}else s.visible&&u.push(t,o,s,r,ie.z,null)}for(var f=t.children,c=0,h=f.length;c<h;c++)e(f[c],i,r,n)}(e,t,0,I.sortObjects),!0===I.sortObjects&&u.sort(),J&&Z.beginShadows();var n=d.state.shadowsArray;se.render(n,e,t),d.setupLights(t),J&&Z.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==i&&this.setRenderTarget(i),E.render(u,e,t,r);var a=u.opaque,o=u.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;a.length&&me(a,e,t,s),o.length&&me(o,e,t,s)}else a.length&&me(a,e,t),o.length&&me(o,e,t);e.onAfterRender(I,e,t),null!==k&&(b.updateRenderTargetMipmap(k),b.updateMultisampleRenderTarget(k)),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),oe.enabled&&oe.submitFrame(),u=null,d=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){R!==e&&p.bindFramebuffer(36160,e),R=e},this.getActiveCubeFace=function(){return F},this.getActiveMipMapLevel=function(){return O},this.getRenderTarget=function(){return k},this.setRenderTarget=function(e,t,i){k=e,F=t,O=i,e&&void 0===y.get(e).__webglFramebuffer&&b.setupRenderTarget(e);var r=R,n=!1;if(e){var a=y.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(r=a[t||0],n=!0):r=e.isWebGLMultisampleRenderTarget?y.get(e).__webglMultisampledFramebuffer:a,V.copy(e.viewport),H.copy(e.scissor),$=e.scissorTest}else V.copy(q).multiplyScalar(X).floor(),H.copy(Y).multiplyScalar(X).floor(),$=Q;if(D!==r&&(p.bindFramebuffer(36160,r),D=r),g.viewport(V),g.scissor(H),g.setScissorTest($),n){var o=y.get(e.texture);p.framebufferTexture2D(36160,36064,34069+(t||0),o.__webglTexture,i||0)}},this.readRenderTargetPixels=function(e,t,i,r,n,a,o){if(e&&e.isWebGLRenderTarget){var s=y.get(e).__webglFramebuffer;if(e.isWebGLRenderTargetCube&&void 0!==o&&(s=s[o]),s){var l=!1;s!==D&&(p.bindFramebuffer(36160,s),l=!0);try{var c=e.texture,h=c.format,u=c.type;if(h!==RGBAFormat&&L.convert(h)!==p.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(u===UnsignedByteType||L.convert(u)===p.getParameter(35738)||u===FloatType&&(f.isWebGL2||m.get("OES_texture_float")||m.get("WEBGL_color_buffer_float"))||u===HalfFloatType&&(f.isWebGL2?m.get("EXT_color_buffer_float"):m.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===p.checkFramebufferStatus(36160)?0<=t&&t<=e.width-r&&0<=i&&i<=e.height-n&&p.readPixels(t,i,r,n,L.convert(h),L.convert(u),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{l&&p.bindFramebuffer(36160,D)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,i){var r=t.image.width,n=t.image.height,a=L.convert(t.format);b.setTexture2D(t,0),p.copyTexImage2D(3553,i||0,a,e.x,e.y,r,n,0)},this.copyTextureToTexture=function(e,t,i,r){var n=t.image.width,a=t.image.height,o=L.convert(i.format),s=L.convert(i.type);b.setTexture2D(i,0),t.isDataTexture?p.texSubImage2D(3553,r||0,e.x,e.y,n,a,o,s,t.image.data):p.texSubImage2D(3553,r||0,e.x,e.y,o,s,t.image)},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function FogExp2(e,t){this.name="",this.color=new Color(e),this.density=void 0!==t?t:25e-5}function Fog(e,t,i){this.name="",this.color=new Color(e),this.near=void 0!==t?t:1,this.far=void 0!==i?i:1e3}function InterleavedBuffer(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function InterleavedBufferAttribute(e,t,i,r){this.data=e,this.itemSize=t,this.offset=i,this.normalized=!0===r}function SpriteMaterial(e){Material.call(this),this.type="SpriteMaterial",this.color=new Color(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(e)}function Sprite(e){if(Object3D.call(this),this.type="Sprite",void 0===geometry){geometry=new BufferGeometry;var t=new InterleavedBuffer(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);geometry.setIndex([0,1,2,0,2,3]),geometry.addAttribute("position",new InterleavedBufferAttribute(t,3,0,!1)),geometry.addAttribute("uv",new InterleavedBufferAttribute(t,2,3,!1))}this.geometry=geometry,this.material=void 0!==e?e:new SpriteMaterial,this.center=new Vector2(.5,.5)}function LOD(){Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function SkinnedMesh(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Mesh.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4}function Skeleton(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Matrix4)}}function Bone(){Object3D.call(this),this.type="Bone"}function LineBasicMaterial(e){Material.call(this),this.type="LineBasicMaterial",this.color=new Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function Line(e,t,i){1===i&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Object3D.call(this),this.type="Line",this.geometry=void 0!==e?e:new BufferGeometry,this.material=void 0!==t?t:new LineBasicMaterial({color:16777215*Math.random()})}function LineSegments(e,t){Line.call(this,e,t),this.type="LineSegments"}function LineLoop(e,t){Line.call(this,e,t),this.type="LineLoop"}function PointsMaterial(e){Material.call(this),this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Points(e,t){Object3D.call(this),this.type="Points",this.geometry=void 0!==e?e:new BufferGeometry,this.material=void 0!==t?t:new PointsMaterial({color:16777215*Math.random()}),this.updateMorphTargets()}function VideoTexture(e,t,i,r,n,a,o,s,l){Texture.call(this,e,t,i,r,n,a,o,s,l),this.format=void 0!==o?o:RGBFormat,this.minFilter=void 0!==a?a:LinearFilter,this.magFilter=void 0!==n?n:LinearFilter,this.generateMipmaps=!1}function CompressedTexture(e,t,i,r,n,a,o,s,l,c,h,u){Texture.call(this,null,a,o,s,l,c,r,n,h,u),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function CanvasTexture(e,t,i,r,n,a,o,s,l){Texture.call(this,e,t,i,r,n,a,o,s,l),this.needsUpdate=!0}function DepthTexture(e,t,i,r,n,a,o,s,l,c){if((c=void 0!==c?c:DepthFormat)!==DepthFormat&&c!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&c===DepthFormat&&(i=UnsignedShortType),void 0===i&&c===DepthStencilFormat&&(i=UnsignedInt248Type),Texture.call(this,null,r,n,a,o,s,c,i,l),this.image={width:e,height:t},this.magFilter=void 0!==o?o:NearestFilter,this.minFilter=void 0!==s?s:NearestFilter,this.flipY=!1,this.generateMipmaps=!1}function WireframeGeometry(e){BufferGeometry.call(this),this.type="WireframeGeometry";var t,i,r,n,a,o,s,l,c,h,u=[],d=[0,0],p={},m=["a","b","c"];if(e&&e.isGeometry){var f=e.faces;for(t=0,r=f.length;t<r;t++){var g=f[t];for(i=0;3>i;i++)s=g[m[i]],l=g[m[(i+1)%3]],d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===p[c=d[0]+","+d[1]]&&(p[c]={index1:d[0],index2:d[1]})}for(c in p)o=p[c],h=e.vertices[o.index1],u.push(h.x,h.y,h.z),h=e.vertices[o.index2],u.push(h.x,h.y,h.z)}else if(e&&e.isBufferGeometry){var v,y,b,_,x,w,S;if(h=new Vector3,null!==e.index){for(v=e.attributes.position,y=e.index,0===(b=e.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),n=0,a=b.length;n<a;++n)for(t=x=(_=b[n]).start,r=x+_.count;t<r;t+=3)for(i=0;3>i;i++)s=y.getX(t+i),l=y.getX(t+(i+1)%3),d[0]=Math.min(s,l),d[1]=Math.max(s,l),void 0===p[c=d[0]+","+d[1]]&&(p[c]={index1:d[0],index2:d[1]});for(c in p)o=p[c],h.fromBufferAttribute(v,o.index1),u.push(h.x,h.y,h.z),h.fromBufferAttribute(v,o.index2),u.push(h.x,h.y,h.z)}else for(t=0,r=(v=e.attributes.position).count/3;t<r;t++)for(i=0;3>i;i++)w=3*t+i,h.fromBufferAttribute(v,w),u.push(h.x,h.y,h.z),S=3*t+(i+1)%3,h.fromBufferAttribute(v,S),u.push(h.x,h.y,h.z)}this.addAttribute("position",new Float32BufferAttribute(u,3))}function ParametricGeometry(e,t,i){Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:i},this.fromBufferGeometry(new ParametricBufferGeometry(e,t,i)),this.mergeVertices()}function ParametricBufferGeometry(e,t,i){BufferGeometry.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:i};var r,n,a=[],o=[],s=[],l=[],c=new Vector3,h=new Vector3,u=new Vector3,d=new Vector3,p=new Vector3;3>e.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var m=t+1;for(r=0;r<=i;r++){var f=r/i;for(n=0;n<=t;n++){var g=n/t;e(g,f,h),o.push(h.x,h.y,h.z),0<=g-1e-5?(e(g-1e-5,f,u),d.subVectors(h,u)):(e(g+1e-5,f,u),d.subVectors(u,h)),0<=f-1e-5?(e(g,f-1e-5,u),p.subVectors(h,u)):(e(g,f+1e-5,u),p.subVectors(u,h)),c.crossVectors(d,p).normalize(),s.push(c.x,c.y,c.z),l.push(g,f)}}for(r=0;r<i;r++)for(n=0;n<t;n++){var v=r*m+n,y=r*m+n+1,b=(r+1)*m+n+1,_=(r+1)*m+n;a.push(v,y,_),a.push(y,b,_)}this.setIndex(a),this.addAttribute("position",new Float32BufferAttribute(o,3)),this.addAttribute("normal",new Float32BufferAttribute(s,3)),this.addAttribute("uv",new Float32BufferAttribute(l,2))}function PolyhedronGeometry(e,t,i,r){Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r},this.fromBufferGeometry(new PolyhedronBufferGeometry(e,t,i,r)),this.mergeVertices()}function PolyhedronBufferGeometry(e,t,i,r){BufferGeometry.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r},i=i||1;var n=[],a=[];function o(e,t,i,r){var n,a,o=Math.pow(2,r),l=[];for(n=0;n<=o;n++){l[n]=[];var c=e.clone().lerp(i,n/o),h=t.clone().lerp(i,n/o),u=o-n;for(a=0;a<=u;a++)l[n][a]=0===a&&n===o?c:c.clone().lerp(h,a/u)}for(n=0;n<o;n++)for(a=0;a<2*(o-n)-1;a++){var d=Math.floor(a/2);0==a%2?(s(l[n][d+1]),s(l[n+1][d]),s(l[n][d])):(s(l[n][d+1]),s(l[n+1][d+1]),s(l[n+1][d]))}}function s(e){n.push(e.x,e.y,e.z)}function l(t,i){var r=3*t;i.x=e[r+0],i.y=e[r+1],i.z=e[r+2]}function c(e,t,i,r){0>r&&1===e.x&&(a[t]=e.x-1),0===i.x&&0===i.z&&(a[t]=r/2/Math.PI+.5)}function h(e){return Math.atan2(e.z,-e.x)}!function(e){for(var i=new Vector3,r=new Vector3,n=new Vector3,a=0;a<t.length;a+=3)l(t[a+0],i),l(t[a+1],r),l(t[a+2],n),o(i,r,n,e)}(r=r||0),function(e){for(var t=new Vector3,i=0;i<n.length;i+=3)t.x=n[i+0],t.y=n[i+1],t.z=n[i+2],t.normalize().multiplyScalar(e),n[i+0]=t.x,n[i+1]=t.y,n[i+2]=t.z}(i),function(){for(var e=new Vector3,t=0;t<n.length;t+=3){e.x=n[t+0],e.y=n[t+1],e.z=n[t+2];var i=h(e)/2/Math.PI+.5,r=(o=e,Math.atan2(-o.y,Math.sqrt(o.x*o.x+o.z*o.z))/Math.PI+.5);a.push(i,1-r)}var o;(function(){for(var e=new Vector3,t=new Vector3,i=new Vector3,r=new Vector3,o=new Vector2,s=new Vector2,l=new Vector2,u=0,d=0;u<n.length;u+=9,d+=6){e.set(n[u+0],n[u+1],n[u+2]),t.set(n[u+3],n[u+4],n[u+5]),i.set(n[u+6],n[u+7],n[u+8]),o.set(a[d+0],a[d+1]),s.set(a[d+2],a[d+3]),l.set(a[d+4],a[d+5]),r.copy(e).add(t).add(i).divideScalar(3);var p=h(r);c(o,d+0,e,p),c(s,d+2,t,p),c(l,d+4,i,p)}})(),function(){for(var e=0;e<a.length;e+=6){var t=a[e+0],i=a[e+2],r=a[e+4],n=Math.max(t,i,r),o=Math.min(t,i,r);.9<n&&.1>o&&(.2>t&&(a[e+0]+=1),.2>i&&(a[e+2]+=1),.2>r&&(a[e+4]+=1))}}()}(),this.addAttribute("position",new Float32BufferAttribute(n,3)),this.addAttribute("normal",new Float32BufferAttribute(n.slice(),3)),this.addAttribute("uv",new Float32BufferAttribute(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function TetrahedronGeometry(e,t){Geometry.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new TetrahedronBufferGeometry(e,t)),this.mergeVertices()}function TetrahedronBufferGeometry(e,t){PolyhedronBufferGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function OctahedronGeometry(e,t){Geometry.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new OctahedronBufferGeometry(e,t)),this.mergeVertices()}function OctahedronBufferGeometry(e,t){PolyhedronBufferGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function IcosahedronGeometry(e,t){Geometry.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new IcosahedronBufferGeometry(e,t)),this.mergeVertices()}function IcosahedronBufferGeometry(e,t){var i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];PolyhedronBufferGeometry.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function DodecahedronGeometry(e,t){Geometry.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new DodecahedronBufferGeometry(e,t)),this.mergeVertices()}function DodecahedronBufferGeometry(e,t){var i=(1+Math.sqrt(5))/2,r=1/i,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r];PolyhedronBufferGeometry.call(this,n,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function TubeGeometry(e,t,i,r,n,a){Geometry.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:n},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new TubeBufferGeometry(e,t,i,r,n);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function TubeBufferGeometry(e,t,i,r,n){BufferGeometry.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:n},t=t||64,i=i||1,r=r||8,n=n||!1;var a=e.computeFrenetFrames(t,n);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o,s,l=new Vector3,c=new Vector3,h=new Vector2,u=new Vector3,d=[],p=[],m=[],f=[];function g(n){u=e.getPointAt(n/t,u);var o=a.normals[n],h=a.binormals[n];for(s=0;s<=r;s++){var m=s/r*Math.PI*2,f=Math.sin(m),g=-Math.cos(m);c.x=g*o.x+f*h.x,c.y=g*o.y+f*h.y,c.z=g*o.z+f*h.z,c.normalize(),p.push(c.x,c.y,c.z),l.x=u.x+i*c.x,l.y=u.y+i*c.y,l.z=u.z+i*c.z,d.push(l.x,l.y,l.z)}}!function(){for(o=0;o<t;o++)g(o);g(!1===n?t:0),function(){for(o=0;o<=t;o++)for(s=0;s<=r;s++)h.x=o/t,h.y=s/r,m.push(h.x,h.y)}(),function(){for(s=1;s<=t;s++)for(o=1;o<=r;o++){var e=(r+1)*(s-1)+(o-1),i=(r+1)*s+(o-1),n=(r+1)*s+o,a=(r+1)*(s-1)+o;f.push(e,i,a),f.push(i,n,a)}}()}(),this.setIndex(f),this.addAttribute("position",new Float32BufferAttribute(d,3)),this.addAttribute("normal",new Float32BufferAttribute(p,3)),this.addAttribute("uv",new Float32BufferAttribute(m,2))}function TorusKnotGeometry(e,t,i,r,n,a,o){Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:n,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new TorusKnotBufferGeometry(e,t,i,r,n,a)),this.mergeVertices()}function TorusKnotBufferGeometry(e,t,i,r,n,a){BufferGeometry.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:n,q:a},e=e||1,t=t||.4,i=Math.floor(i)||64,r=Math.floor(r)||8,n=n||2,a=a||3;var o,s,l=[],c=[],h=[],u=[],d=new Vector3,p=new Vector3,m=new Vector3,f=new Vector3,g=new Vector3,v=new Vector3,y=new Vector3;for(o=0;o<=i;++o){var b=o/i*n*Math.PI*2;for(C(b,n,a,e,m),C(b+.01,n,a,e,f),v.subVectors(f,m),y.addVectors(f,m),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=r;++s){var _=s/r*Math.PI*2,x=-t*Math.cos(_),w=t*Math.sin(_);d.x=m.x+(x*y.x+w*g.x),d.y=m.y+(x*y.y+w*g.y),d.z=m.z+(x*y.z+w*g.z),c.push(d.x,d.y,d.z),p.subVectors(d,m).normalize(),h.push(p.x,p.y,p.z),u.push(o/i),u.push(s/r)}}for(s=1;s<=i;s++)for(o=1;o<=r;o++){var S=(r+1)*(s-1)+(o-1),T=(r+1)*s+(o-1),A=(r+1)*s+o,E=(r+1)*(s-1)+o;l.push(S,T,E),l.push(T,A,E)}function C(e,t,i,r,n){var a=Math.cos(e),o=Math.sin(e),s=i/t*e,l=Math.cos(s);n.x=r*(2+l)*.5*a,n.y=r*(2+l)*o*.5,n.z=r*Math.sin(s)*.5}this.setIndex(l),this.addAttribute("position",new Float32BufferAttribute(c,3)),this.addAttribute("normal",new Float32BufferAttribute(h,3)),this.addAttribute("uv",new Float32BufferAttribute(u,2))}function TorusGeometry(e,t,i,r,n){Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:n},this.fromBufferGeometry(new TorusBufferGeometry(e,t,i,r,n)),this.mergeVertices()}function TorusBufferGeometry(e,t,i,r,n){BufferGeometry.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:n},e=e||1,t=t||.4,i=Math.floor(i)||8,r=Math.floor(r)||6,n=n||2*Math.PI;var a,o,s=[],l=[],c=[],h=[],u=new Vector3,d=new Vector3,p=new Vector3;for(a=0;a<=i;a++)for(o=0;o<=r;o++){var m=o/r*n,f=a/i*Math.PI*2;d.x=(e+t*Math.cos(f))*Math.cos(m),d.y=(e+t*Math.cos(f))*Math.sin(m),d.z=t*Math.sin(f),l.push(d.x,d.y,d.z),u.x=e*Math.cos(m),u.y=e*Math.sin(m),p.subVectors(d,u).normalize(),c.push(p.x,p.y,p.z),h.push(o/r),h.push(a/i)}for(a=1;a<=i;a++)for(o=1;o<=r;o++){var g=(r+1)*a+o-1,v=(r+1)*(a-1)+o-1,y=(r+1)*(a-1)+o,b=(r+1)*a+o;s.push(g,v,b),s.push(v,y,b)}this.setIndex(s),this.addAttribute("position",new Float32BufferAttribute(l,3)),this.addAttribute("normal",new Float32BufferAttribute(c,3)),this.addAttribute("uv",new Float32BufferAttribute(h,2))}Object.assign(WebVRManager.prototype,EventDispatcher.prototype),Object.assign(WebXRManager.prototype,EventDispatcher.prototype),Object.assign(FogExp2.prototype,{isFogExp2:!0,clone:function(){return new FogExp2(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Fog.prototype,{isFog:!0,clone:function(){return new Fog(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(InterleavedBuffer.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(InterleavedBuffer.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.stride:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,i){e*=this.stride,i*=t.stride;for(var r=0,n=this.stride;r<n;r++)this.array[e+r]=t.array[i+r];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Object.defineProperties(InterleavedBufferAttribute.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(InterleavedBufferAttribute.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this},setXYZ:function(e,t,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this},setXYZW:function(e,t,i,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=n,this}}),SpriteMaterial.prototype=Object.create(Material.prototype),SpriteMaterial.prototype.constructor=SpriteMaterial,SpriteMaterial.prototype.isSpriteMaterial=!0,SpriteMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this},Sprite.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Sprite,isSprite:!0,raycast:function(){var e=new Vector3,t=new Vector3,i=new Vector3,r=new Vector2,n=new Vector2,a=new Matrix4,o=new Vector3,s=new Vector3,l=new Vector3,c=new Vector2,h=new Vector2,u=new Vector2;function d(e,t,i,o,s,l){r.subVectors(e,i).addScalar(.5).multiply(o),void 0!==s?(n.x=l*r.x-s*r.y,n.y=s*r.x+l*r.y):n.copy(r),e.copy(t),e.x+=n.x,e.y+=n.y,e.applyMatrix4(a)}return function(r,n){t.setFromMatrixScale(this.matrixWorld),a.copy(r._camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(r._camera.matrixWorldInverse,this.matrixWorld),i.setFromMatrixPosition(this.modelViewMatrix),r._camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&t.multiplyScalar(-i.z);var p,m,f=this.material.rotation;0!==f&&(m=Math.cos(f),p=Math.sin(f));var g=this.center;d(o.set(-.5,-.5,0),i,g,t,p,m),d(s.set(.5,-.5,0),i,g,t,p,m),d(l.set(.5,.5,0),i,g,t,p,m),c.set(0,0),h.set(1,0),u.set(1,1);var v=r.ray.intersectTriangle(o,s,l,!1,e);if(null!==v||(d(s.set(-.5,.5,0),i,g,t,p,m),h.set(0,1),null!==(v=r.ray.intersectTriangle(o,l,s,!1,e)))){var y=r.ray.origin.distanceTo(e);y<r.near||y>r.far||n.push({distance:y,point:e.clone(),uv:Triangle.getUV(e,o,s,l,c,h,u,new Vector2),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return Object3D.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),LOD.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:LOD,isLOD:!0,copy:function(e){Object3D.prototype.copy.call(this,e,!1);for(var t,i=e.levels,r=0,n=i.length;r<n;r++)t=i[r],this.addLevel(t.object.clone(),t.distance);return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var i=this.levels,r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,object:e}),this.add(e),this},getObjectForDistance:function(e){for(var t=this.levels,i=1,r=t.length;i<r&&!(e<t[i].distance);i++);return t[i-1].object},raycast:function(){var e=new Vector3;return function(t,i){e.setFromMatrixPosition(this.matrixWorld);var r=t.ray.origin.distanceTo(e);this.getObjectForDistance(r).raycast(t,i)}}(),update:function(){var e=new Vector3,t=new Vector3;return function(i){var r=this.levels;if(1<r.length){e.setFromMatrixPosition(i.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var n=e.distanceTo(t);r[0].object.visible=!0;for(var a=1,o=r.length;a<o&&n>=r[a].distance;a++)r[a-1].object.visible=!1,r[a].object.visible=!0;for(;a<o;a++)r[a].object.visible=!1}}}(),toJSON:function(e){var t=Object3D.prototype.toJSON.call(this,e);t.object.levels=[];for(var i,r=this.levels,n=0,a=r.length;n<a;n++)i=r[n],t.object.levels.push({object:i.object.uuid,distance:i.distance});return t}}),SkinnedMesh.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:SkinnedMesh,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new Vector4,t=this.geometry.attributes.skinWeight,i=0,r=t.count;i<r;i++){e.x=t.getX(i),e.y=t.getY(i),e.z=t.getZ(i),e.w=t.getW(i);var n=1/e.manhattanLength();n!==1/0?e.multiplyScalar(n):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Mesh.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.assign(Skeleton.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e,t=0,i=this.bones.length;t<i;t++)e=new Matrix4,this.bones[t]&&e.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(e)},pose:function(){var e,t,i;for(t=0,i=this.bones.length;t<i;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,i=this.bones.length;t<i;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){var e=new Matrix4,t=new Matrix4;return function(){for(var i,r=this.bones,n=this.boneInverses,a=this.boneMatrices,o=this.boneTexture,s=0,l=r.length;s<l;s++)i=r[s]?r[s].matrixWorld:t,e.multiplyMatrices(i,n[s]),e.toArray(a,16*s);void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new Skeleton(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t,i=0,r=this.bones.length;i<r;i++)if((t=this.bones[i]).name===e)return t}}),Bone.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Bone,isBone:!0}),LineBasicMaterial.prototype=Object.create(Material.prototype),LineBasicMaterial.prototype.constructor=LineBasicMaterial,LineBasicMaterial.prototype.isLineBasicMaterial=!0,LineBasicMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},Line.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Line,isLine:!0,computeLineDistances:function(){var e=new Vector3,t=new Vector3;return function(){var i=this.geometry;if(i.isBufferGeometry)if(null===i.index){for(var r=i.attributes.position,n=[0],a=1,o=r.count;a<o;a++)e.fromBufferAttribute(r,a-1),t.fromBufferAttribute(r,a),n[a]=n[a-1],n[a]+=e.distanceTo(t);i.addAttribute("lineDistance",new Float32BufferAttribute(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(i.isGeometry){var s=i.vertices;(n=i.lineDistances)[0]=0;for(a=1,o=s.length;a<o;a++)n[a]=n[a-1],n[a]+=s[a-1].distanceTo(s[a])}return this}}(),raycast:function(){var e=new Matrix4,t=new Ray,i=new Sphere;return function(r,n){var a=r.linePrecision,o=this.geometry,s=this.matrixWorld;if(null===o.boundingSphere&&o.computeBoundingSphere(),i.copy(o.boundingSphere),i.applyMatrix4(s),i.radius+=a,!1!==r.ray.intersectsSphere(i)){e.getInverse(s),t.copy(r.ray).applyMatrix4(e);var l=a/((this.scale.x+this.scale.y+this.scale.z)/3),c=l*l,h=new Vector3,u=new Vector3,d=new Vector3,p=new Vector3,m=this&&this.isLineSegments?2:1;if(o.isBufferGeometry){var f=o.index,g=o.attributes.position.array;if(null!==f)for(var v=f.array,y=0,b=v.length-1;y<b;y+=m){var _=v[y],x=v[y+1];if(h.fromArray(g,3*_),u.fromArray(g,3*x),!(t.distanceSqToSegment(h,u,p,d)>c))p.applyMatrix4(this.matrixWorld),(T=r.ray.origin.distanceTo(p))<r.near||T>r.far||n.push({distance:T,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(y=0,b=g.length/3-1;y<b;y+=m){if(h.fromArray(g,3*y),u.fromArray(g,3*y+3),!(t.distanceSqToSegment(h,u,p,d)>c))p.applyMatrix4(this.matrixWorld),(T=r.ray.origin.distanceTo(p))<r.near||T>r.far||n.push({distance:T,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else if(o.isGeometry){var w=o.vertices,S=w.length;for(y=0;y<S-1;y+=m){var T;if(!(t.distanceSqToSegment(w[y],w[y+1],p,d)>c))p.applyMatrix4(this.matrixWorld),(T=r.ray.origin.distanceTo(p))<r.near||T>r.far||n.push({distance:T,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),LineSegments.prototype=Object.assign(Object.create(Line.prototype),{constructor:LineSegments,isLineSegments:!0,computeLineDistances:function(){var e=new Vector3,t=new Vector3;return function(){var i=this.geometry;if(i.isBufferGeometry)if(null===i.index){for(var r=i.attributes.position,n=[],a=0,o=r.count;a<o;a+=2)e.fromBufferAttribute(r,a),t.fromBufferAttribute(r,a+1),n[a]=0===a?0:n[a-1],n[a+1]=n[a]+e.distanceTo(t);i.addAttribute("lineDistance",new Float32BufferAttribute(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(i.isGeometry){var s=i.vertices;for(n=i.lineDistances,a=0,o=s.length;a<o;a+=2)e.copy(s[a]),t.copy(s[a+1]),n[a]=0===a?0:n[a-1],n[a+1]=n[a]+e.distanceTo(t)}return this}}()}),LineLoop.prototype=Object.assign(Object.create(Line.prototype),{constructor:LineLoop,isLineLoop:!0}),PointsMaterial.prototype=Object.create(Material.prototype),PointsMaterial.prototype.constructor=PointsMaterial,PointsMaterial.prototype.isPointsMaterial=!0,PointsMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},Points.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Points,isPoints:!0,raycast:function(){var e=new Matrix4,t=new Ray,i=new Sphere;return function(r,n){var a=this,o=this.geometry,s=this.matrixWorld,l=r.params.Points.threshold;if(null===o.boundingSphere&&o.computeBoundingSphere(),i.copy(o.boundingSphere),i.applyMatrix4(s),i.radius+=l,!1!==r.ray.intersectsSphere(i)){e.getInverse(s),t.copy(r.ray).applyMatrix4(e);var c=l/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c,u=new Vector3,d=new Vector3;if(o.isBufferGeometry){var p=o.index,m=o.attributes.position.array;if(null!==p)for(var f,g=p.array,v=0,y=g.length;v<y;v++)f=g[v],u.fromArray(m,3*f),x(u,f);else{v=0;for(var b=m.length/3;v<b;v++)u.fromArray(m,3*v),x(u,v)}}else{var _=o.vertices;for(v=0,b=_.length;v<b;v++)x(_[v],v)}}function x(e,i){var o=t.distanceSqToPoint(e);if(o<h){t.closestPointToPoint(e,d),d.applyMatrix4(s);var l=r.ray.origin.distanceTo(d);if(l<r.near||l>r.far)return;n.push({distance:l,distanceToRay:Math.sqrt(o),point:d.clone(),index:i,face:null,object:a})}}}}(),updateMorphTargets:function(){var e,t,i,r=this.geometry.morphAttributes,n=Object.keys(r);if(0<n.length){var a=r[n[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)i=a[e].name||e+"",this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),VideoTexture.prototype=Object.assign(Object.create(Texture.prototype),{constructor:VideoTexture,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),CompressedTexture.prototype=Object.create(Texture.prototype),CompressedTexture.prototype.constructor=CompressedTexture,CompressedTexture.prototype.isCompressedTexture=!0,CanvasTexture.prototype=Object.create(Texture.prototype),CanvasTexture.prototype.constructor=CanvasTexture,CanvasTexture.prototype.isCanvasTexture=!0,DepthTexture.prototype=Object.create(Texture.prototype),DepthTexture.prototype.constructor=DepthTexture,DepthTexture.prototype.isDepthTexture=!0,WireframeGeometry.prototype=Object.create(BufferGeometry.prototype),WireframeGeometry.prototype.constructor=WireframeGeometry,ParametricGeometry.prototype=Object.create(Geometry.prototype),ParametricGeometry.prototype.constructor=ParametricGeometry,ParametricBufferGeometry.prototype=Object.create(BufferGeometry.prototype),ParametricBufferGeometry.prototype.constructor=ParametricBufferGeometry,PolyhedronGeometry.prototype=Object.create(Geometry.prototype),PolyhedronGeometry.prototype.constructor=PolyhedronGeometry,PolyhedronBufferGeometry.prototype=Object.create(BufferGeometry.prototype),PolyhedronBufferGeometry.prototype.constructor=PolyhedronBufferGeometry,TetrahedronGeometry.prototype=Object.create(Geometry.prototype),TetrahedronGeometry.prototype.constructor=TetrahedronGeometry,TetrahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype),TetrahedronBufferGeometry.prototype.constructor=TetrahedronBufferGeometry,OctahedronGeometry.prototype=Object.create(Geometry.prototype),OctahedronGeometry.prototype.constructor=OctahedronGeometry,OctahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype),OctahedronBufferGeometry.prototype.constructor=OctahedronBufferGeometry,IcosahedronGeometry.prototype=Object.create(Geometry.prototype),IcosahedronGeometry.prototype.constructor=IcosahedronGeometry,IcosahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype),IcosahedronBufferGeometry.prototype.constructor=IcosahedronBufferGeometry,DodecahedronGeometry.prototype=Object.create(Geometry.prototype),DodecahedronGeometry.prototype.constructor=DodecahedronGeometry,DodecahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype),DodecahedronBufferGeometry.prototype.constructor=DodecahedronBufferGeometry,TubeGeometry.prototype=Object.create(Geometry.prototype),TubeGeometry.prototype.constructor=TubeGeometry,TubeBufferGeometry.prototype=Object.create(BufferGeometry.prototype),TubeBufferGeometry.prototype.constructor=TubeBufferGeometry,TubeBufferGeometry.prototype.toJSON=function(){var e=BufferGeometry.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},TorusKnotGeometry.prototype=Object.create(Geometry.prototype),TorusKnotGeometry.prototype.constructor=TorusKnotGeometry,TorusKnotBufferGeometry.prototype=Object.create(BufferGeometry.prototype),TorusKnotBufferGeometry.prototype.constructor=TorusKnotBufferGeometry,TorusGeometry.prototype=Object.create(Geometry.prototype),TorusGeometry.prototype.constructor=TorusGeometry,TorusBufferGeometry.prototype=Object.create(BufferGeometry.prototype),TorusBufferGeometry.prototype.constructor=TorusBufferGeometry;var Earcut={triangulate:function(e,t,i){i=i||2;var r,n,a,o,s,l,c,h=t&&t.length,u=h?t[0]*i:e.length,d=linkedList(e,0,u,i,!0),p=[];if(!d||d.next===d.prev)return p;if(h&&(d=eliminateHoles(e,t,d,i)),e.length>80*i){r=a=e[0],n=o=e[1];for(var m=i;m<u;m+=i)s=e[m],l=e[m+1],s<r&&(r=s),l<n&&(n=l),s>a&&(a=s),l>o&&(o=l);c=0!==(c=Math.max(a-r,o-n))?1/c:0}return earcutLinked(d,p,i,r,n,c),p}};function linkedList(e,t,i,r,n){var a,o;if(n===0<signedArea(e,t,i,r))for(a=t;a<i;a+=r)o=insertNode(a,e[a],e[a+1],o);else for(a=i-r;a>=t;a-=r)o=insertNode(a,e[a],e[a+1],o);return o&&equals$1(o,o.next)&&(removeNode(o),o=o.next),o}function filterPoints(e,t){if(!e)return e;t||(t=e);var i,r=e;do{if(i=!1,r.steiner||!equals$1(r,r.next)&&0!==area(r.prev,r,r.next))r=r.next;else{if(removeNode(r),(r=t=r.prev)===r.next)break;i=!0}}while(i||r!==t);return t}function earcutLinked(e,t,i,r,n,a,o){if(e){!o&&a&&indexCurve(e,r,n,a);for(var s,l,c=e;e.prev!==e.next;)if(s=e.prev,l=e.next,a?isEarHashed(e,r,n,a):isEar(e))t.push(s.i/i),t.push(e.i/i),t.push(l.i/i),removeNode(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?earcutLinked(e=cureLocalIntersections(e,t,i),t,i,r,n,a,2):2===o&&splitEarcut(e,t,i,r,n,a):earcutLinked(filterPoints(e),t,i,r,n,a,1);break}}}function isEar(e){var t=e.prev,i=e,r=e.next;if(0<=area(t,i,r))return!1;for(var n=e.next.next;n!==e.prev;){if(pointInTriangle(t.x,t.y,i.x,i.y,r.x,r.y,n.x,n.y)&&0<=area(n.prev,n,n.next))return!1;n=n.next}return!0}function isEarHashed(e,t,i,r){var n=e.prev,a=e,o=e.next;if(0<=area(n,a,o))return!1;for(var s=n.x<a.x?n.x<o.x?n.x:o.x:a.x<o.x?a.x:o.x,l=n.y<a.y?n.y<o.y?n.y:o.y:a.y<o.y?a.y:o.y,c=n.x>a.x?n.x>o.x?n.x:o.x:a.x>o.x?a.x:o.x,h=n.y>a.y?n.y>o.y?n.y:o.y:a.y>o.y?a.y:o.y,u=zOrder(s,l,t,i,r),d=zOrder(c,h,t,i,r),p=e.prevZ,m=e.nextZ;p&&p.z>=u&&m&&m.z<=d;){if(p!==e.prev&&p!==e.next&&pointInTriangle(n.x,n.y,a.x,a.y,o.x,o.y,p.x,p.y)&&0<=area(p.prev,p,p.next))return!1;if(p=p.prevZ,m!==e.prev&&m!==e.next&&pointInTriangle(n.x,n.y,a.x,a.y,o.x,o.y,m.x,m.y)&&0<=area(m.prev,m,m.next))return!1;m=m.nextZ}for(;p&&p.z>=u;){if(p!==e.prev&&p!==e.next&&pointInTriangle(n.x,n.y,a.x,a.y,o.x,o.y,p.x,p.y)&&0<=area(p.prev,p,p.next))return!1;p=p.prevZ}for(;m&&m.z<=d;){if(m!==e.prev&&m!==e.next&&pointInTriangle(n.x,n.y,a.x,a.y,o.x,o.y,m.x,m.y)&&0<=area(m.prev,m,m.next))return!1;m=m.nextZ}return!0}function cureLocalIntersections(e,t,i){var r=e;do{var n=r.prev,a=r.next.next;!equals$1(n,a)&&intersects(n,r,r.next,a)&&locallyInside(n,a)&&locallyInside(a,n)&&(t.push(n.i/i),t.push(r.i/i),t.push(a.i/i),removeNode(r),removeNode(r.next),r=e=a),r=r.next}while(r!==e);return r}function splitEarcut(e,t,i,r,n,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&isValidDiagonal(o,s)){var l=splitPolygon(o,s);return o=filterPoints(o,o.next),l=filterPoints(l,l.next),earcutLinked(o,t,i,r,n,a),void earcutLinked(l,t,i,r,n,a)}s=s.next}o=o.next}while(o!==e)}function eliminateHoles(e,t,i,r){var n,a,o,s=[];for(n=0,a=t.length;n<a;n++)(o=linkedList(e,t[n]*r,n<a-1?t[n+1]*r:e.length,r,!1))===o.next&&(o.steiner=!0),s.push(getLeftmost(o));for(s.sort(compareX),n=0;n<s.length;n++)eliminateHole(s[n],i),i=filterPoints(i,i.next);return i}function compareX(e,t){return e.x-t.x}function eliminateHole(e,t){if(t=findHoleBridge(e,t)){var i=splitPolygon(t,e);filterPoints(i,i.next)}}function findHoleBridge(e,t){var i,r=t,n=e.x,a=e.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>o){if(o=s,s===n){if(a===r.y)return r;if(a===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!i)return null;if(n===o)return i.prev;var l,c=i,h=i.x,u=i.y,d=1/0;for(r=i.next;r!==c;)n>=r.x&&r.x>=h&&n!==r.x&&pointInTriangle(a<u?n:o,a,h,u,a<u?o:n,a,r.x,r.y)&&((l=Math.abs(a-r.y)/(n-r.x))<d||l===d&&r.x>i.x)&&locallyInside(r,e)&&(i=r,d=l),r=r.next;return i}function indexCurve(e,t,i,r){var n=e;do{null===n.z&&(n.z=zOrder(n.x,n.y,t,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,sortLinked(n)}function sortLinked(e){var t,i,r,n,a,o,s,l,c=1;do{for(i=e,e=null,a=null,o=0;i;){for(o++,r=i,s=0,t=0;t<c&&(s++,r=r.nextZ);t++);for(l=c;0<s||0<l&&r;)0!==s&&(0===l||!r||i.z<=r.z)?(n=i,i=i.nextZ,s--):(n=r,r=r.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;i=r}a.nextZ=null,c*=2}while(1<o);return e}function zOrder(e,t,i,r,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function getLeftmost(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function pointInTriangle(e,t,i,r,n,a,o,s){return 0<=(n-o)*(t-s)-(e-o)*(a-s)&&0<=(e-o)*(r-s)-(i-o)*(t-s)&&0<=(i-o)*(a-s)-(n-o)*(r-s)}function isValidDiagonal(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!intersectsPolygon(e,t)&&locallyInside(e,t)&&locallyInside(t,e)&&middleInside(e,t)}function area(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function equals$1(e,t){return e.x===t.x&&e.y===t.y}function intersects(e,t,i,r){return!!(equals$1(e,i)&&equals$1(t,r)||equals$1(e,r)&&equals$1(i,t))||0<area(e,t,i)!=0<area(e,t,r)&&0<area(i,r,e)!=0<area(i,r,t)}function intersectsPolygon(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&intersects(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}function locallyInside(e,t){return 0>area(e.prev,e,e.next)?0<=area(e,t,e.next)&&0<=area(e,e.prev,t):0>area(e,t,e.prev)||0>area(e,e.next,t)}function middleInside(e,t){var i=e,r=!1,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do{i.y>a!=i.next.y>a&&i.next.y!==i.y&&n<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==e);return r}function splitPolygon(e,t){var i=new Node$1(e.i,e.x,e.y),r=new Node$1(t.i,t.x,t.y),n=e.next,a=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,r.next=i,i.prev=r,a.next=r,r.prev=a,r}function insertNode(e,t,i,r){var n=new Node$1(e,t,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function removeNode(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node$1(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(e,t,i,r){for(var n=0,a=t,o=i-r;a<i;a+=r)n+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return n}var ShapeUtils={area:function(e){for(var t=e.length,i=0,r=t-1,n=0;n<t;r=n++)i+=e[r].x*e[n].y-e[n].x*e[r].y;return.5*i},isClockWise:function(e){return 0>ShapeUtils.area(e)},triangulateShape:function(e,t){var i=[],r=[],n=[];removeDupEndPts(e),addContour(i,e);var a=e.length;t.forEach(removeDupEndPts);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,addContour(i,t[o]);var s=Earcut.triangulate(i,r);for(o=0;o<s.length;o+=3)n.push(s.slice(o,o+3));return n}};function removeDupEndPts(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function addContour(e,t){for(var i=0;i<t.length;i++)e.push(t[i].x),e.push(t[i].y)}function ExtrudeGeometry(e,t){Geometry.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new ExtrudeBufferGeometry(e,t)),this.mergeVertices()}function ExtrudeBufferGeometry(e,t){BufferGeometry.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t};for(var i=this,r=[],n=[],a=0,o=(e=Array.isArray(e)?e:[e]).length;a<o;a++)s(e[a]);function s(e){var a=[],o=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:100,c=void 0===t.bevelEnabled||t.bevelEnabled,h=void 0!==t.bevelThickness?t.bevelThickness:6,u=void 0!==t.bevelSize?t.bevelSize:h-2,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3,m=t.extrudePath,f=void 0!==t.UVGenerator?t.UVGenerator:WorldUVGenerator;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);var g,v,y,b,_,x=!1;m&&(g=m.getSpacedPoints(s),x=!0,c=!1,v=m.computeFrenetFrames(s,!1),y=new Vector3,b=new Vector3,_=new Vector3),c||(p=0,h=0,u=0,d=0);var w,S,T,A=e.extractPoints(o),E=A.shape,C=A.holes;if(!ShapeUtils.isClockWise(E))for(E=E.reverse(),S=0,T=C.length;S<T;S++)w=C[S],ShapeUtils.isClockWise(w)&&(C[S]=w.reverse());var M=ShapeUtils.triangulateShape(E,C),P=E;for(S=0,T=C.length;S<T;S++)w=C[S],E=E.concat(w);function L(e,t,i){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(i).add(e)}var I,B,R,F,O,k,D=E.length,N=M.length;function z(e,t,i){var r,n,a,o=e.x-t.x,s=e.y-t.y,l=i.x-e.x,c=i.y-e.y,h=o*o+s*s,u=o*c-s*l;if(Math.abs(u)>Number.EPSILON){var d=Math.sqrt(h),p=Math.sqrt(l*l+c*c),m=t.x-s/d,f=t.y+o/d,g=((i.x-c/p-m)*c-(i.y+l/p-f)*l)/(o*c-s*l),v=(r=m+o*g-e.x)*r+(n=f+s*g-e.y)*n;if(2>=v)return new Vector2(r,n);a=Math.sqrt(v/2)}else{var y=!1;o>Number.EPSILON?l>Number.EPSILON&&(y=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(c)&&(y=!0),y?(r=-s,n=o,a=Math.sqrt(h)):(r=o,n=s,a=Math.sqrt(h/2))}return new Vector2(r/a,n/a)}for(var G=[],U=0,V=P.length,H=V-1,$=U+1;U<V;U++,H++,$++)H===V&&(H=0),$===V&&($=0),G[U]=z(P[U],P[H],P[$]);var j,W,X=[],q=G.concat();for(S=0,T=C.length;S<T;S++){for(w=C[S],j=[],U=0,H=(V=w.length)-1,$=U+1;U<V;U++,H++,$++)H===V&&(H=0),$===V&&($=0),j[U]=z(w[U],w[H],w[$]);X.push(j),q=q.concat(j)}for(I=0;I<p;I++){for(R=I/p,F=h*Math.cos(R*Math.PI/2),B=u*Math.sin(R*Math.PI/2)+d,U=0,V=P.length;U<V;U++)Q((O=L(P[U],G[U],B)).x,O.y,-F);for(S=0,T=C.length;S<T;S++)for(w=C[S],j=X[S],U=0,V=w.length;U<V;U++)Q((O=L(w[U],j[U],B)).x,O.y,-F)}for(B=u+d,U=0;U<D;U++)O=c?L(E[U],q[U],B):E[U],x?(b.copy(v.normals[0]).multiplyScalar(O.x),y.copy(v.binormals[0]).multiplyScalar(O.y),_.copy(g[0]).add(b).add(y),Q(_.x,_.y,_.z)):Q(O.x,O.y,0);for(W=1;W<=s;W++)for(U=0;U<D;U++)O=c?L(E[U],q[U],B):E[U],x?(b.copy(v.normals[W]).multiplyScalar(O.x),y.copy(v.binormals[W]).multiplyScalar(O.y),_.copy(g[W]).add(b).add(y),Q(_.x,_.y,_.z)):Q(O.x,O.y,l/s*W);for(I=p-1;0<=I;I--){for(R=I/p,F=h*Math.cos(R*Math.PI/2),B=u*Math.sin(R*Math.PI/2)+d,U=0,V=P.length;U<V;U++)Q((O=L(P[U],G[U],B)).x,O.y,l+F);for(S=0,T=C.length;S<T;S++)for(w=C[S],j=X[S],U=0,V=w.length;U<V;U++)O=L(w[U],j[U],B),x?Q(O.x,O.y+g[s-1].y,g[s-1].x+F):Q(O.x,O.y,l+F)}function Y(e,t){var i,r;for(U=e.length;0<=--U;){i=U,0>(r=U-1)&&(r=e.length-1);var n=0,a=s+2*p;for(n=0;n<a;n++){var o=D*n,l=D*(n+1);Z(t+i+o,t+r+o,t+r+l,t+i+l)}}}function Q(e,t,i){a.push(e),a.push(t),a.push(i)}function K(e,t,n){J(e),J(t),J(n);var a=r.length/3,o=f.generateTopUV(i,r,a-3,a-2,a-1);ee(o[0]),ee(o[1]),ee(o[2])}function Z(e,t,n,a){J(e),J(t),J(a),J(t),J(n),J(a);var o=r.length/3,s=f.generateSideWallUV(i,r,o-6,o-3,o-2,o-1);ee(s[0]),ee(s[1]),ee(s[3]),ee(s[1]),ee(s[2]),ee(s[3])}function J(e){r.push(a[3*e+0]),r.push(a[3*e+1]),r.push(a[3*e+2])}function ee(e){n.push(e.x),n.push(e.y)}!function(){var e=r.length/3;if(c){var t=0,n=D*t;for(U=0;U<N;U++)K((k=M[U])[2]+n,k[1]+n,k[0]+n);for(n=D*(t=s+2*p),U=0;U<N;U++)K((k=M[U])[0]+n,k[1]+n,k[2]+n)}else{for(U=0;U<N;U++)K((k=M[U])[2],k[1],k[0]);for(U=0;U<N;U++)K((k=M[U])[0]+D*s,k[1]+D*s,k[2]+D*s)}i.addGroup(e,r.length/3-e,0)}(),function(){var e=r.length/3,t=0;for(Y(P,t),t+=P.length,S=0,T=C.length;S<T;S++)Y(w=C[S],t),t+=w.length;i.addGroup(e,r.length/3-e,1)}()}this.addAttribute("position",new Float32BufferAttribute(r,3)),this.addAttribute("uv",new Float32BufferAttribute(n,2)),this.computeVertexNormals()}ExtrudeGeometry.prototype=Object.create(Geometry.prototype),ExtrudeGeometry.prototype.constructor=ExtrudeGeometry,ExtrudeGeometry.prototype.toJSON=function(){var e=Geometry.prototype.toJSON.call(this);return toJSON(this.parameters.shapes,this.parameters.options,e)},ExtrudeBufferGeometry.prototype=Object.create(BufferGeometry.prototype),ExtrudeBufferGeometry.prototype.constructor=ExtrudeBufferGeometry,ExtrudeBufferGeometry.prototype.toJSON=function(){var e=BufferGeometry.prototype.toJSON.call(this);return toJSON(this.parameters.shapes,this.parameters.options,e)};var WorldUVGenerator={generateTopUV:function(e,t,i,r,n){var a=t[3*i],o=t[3*i+1],s=t[3*r],l=t[3*r+1],c=t[3*n],h=t[3*n+1];return[new Vector2(a,o),new Vector2(s,l),new Vector2(c,h)]},generateSideWallUV:function(e,t,i,r,n,a){var o=t[3*i],s=t[3*i+1],l=t[3*i+2],c=t[3*r],h=t[3*r+1],u=t[3*r+2],d=t[3*n],p=t[3*n+1],m=t[3*n+2],f=t[3*a],g=t[3*a+1],v=t[3*a+2];return.01>Math.abs(s-h)?[new Vector2(o,1-l),new Vector2(c,1-u),new Vector2(d,1-m),new Vector2(f,1-v)]:[new Vector2(s,1-l),new Vector2(h,1-u),new Vector2(p,1-m),new Vector2(g,1-v)]}};function toJSON(e,t,i){if(i.shapes=[],Array.isArray(e))for(var r,n=0,a=e.length;n<a;n++)r=e[n],i.shapes.push(r.uuid);else i.shapes.push(e.uuid);return void 0!==t.extrudePath&&(i.options.extrudePath=t.extrudePath.toJSON()),i}function TextGeometry(e,t){Geometry.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new TextBufferGeometry(e,t)),this.mergeVertices()}function TextBufferGeometry(e,t){var i=(t=t||{}).font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Geometry;var r=i.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),ExtrudeBufferGeometry.call(this,r,t),this.type="TextBufferGeometry"}function SphereGeometry(e,t,i,r,n,a,o){Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:n,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new SphereBufferGeometry(e,t,i,r,n,a,o)),this.mergeVertices()}function SphereBufferGeometry(e,t,i,r,n,a,o){BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:n,thetaStart:a,thetaLength:o},e=e||1,t=Math.max(3,Math.floor(t)||8),i=Math.max(2,Math.floor(i)||6),r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;var s,l,c=Math.min(a+o,Math.PI),h=0,u=[],d=new Vector3,p=new Vector3,m=[],f=[],g=[],v=[];for(l=0;l<=i;l++){var y=[],b=l/i,_=0;for(0==l&&0==a?_=.5/t:l==i&&c==Math.PI&&(_=-.5/t),s=0;s<=t;s++){var x=s/t;d.x=-e*Math.cos(r+x*n)*Math.sin(a+b*o),d.y=e*Math.cos(a+b*o),d.z=e*Math.sin(r+x*n)*Math.sin(a+b*o),f.push(d.x,d.y,d.z),p.copy(d).normalize(),g.push(p.x,p.y,p.z),v.push(x+_,1-b),y.push(h++)}u.push(y)}for(l=0;l<i;l++)for(s=0;s<t;s++){var w=u[l][s+1],S=u[l][s],T=u[l+1][s],A=u[l+1][s+1];(0!==l||0<a)&&m.push(w,S,A),(l!==i-1||c<Math.PI)&&m.push(S,T,A)}this.setIndex(m),this.addAttribute("position",new Float32BufferAttribute(f,3)),this.addAttribute("normal",new Float32BufferAttribute(g,3)),this.addAttribute("uv",new Float32BufferAttribute(v,2))}function RingGeometry(e,t,i,r,n,a){Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:n,thetaLength:a},this.fromBufferGeometry(new RingBufferGeometry(e,t,i,r,n,a)),this.mergeVertices()}function RingBufferGeometry(e,t,i,r,n,a){BufferGeometry.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:n,thetaLength:a},e=e||.5,t=t||1,n=void 0!==n?n:0,a=void 0!==a?a:2*Math.PI,i=void 0!==i?Math.max(3,i):8;var o,s,l,c=[],h=[],u=[],d=[],p=e,m=(t-e)/(r=void 0!==r?Math.max(1,r):1),f=new Vector3,g=new Vector2;for(s=0;s<=r;s++){for(l=0;l<=i;l++)o=n+l/i*a,f.x=p*Math.cos(o),f.y=p*Math.sin(o),h.push(f.x,f.y,f.z),u.push(0,0,1),g.x=(f.x/t+1)/2,g.y=(f.y/t+1)/2,d.push(g.x,g.y);p+=m}for(s=0;s<r;s++){var v=s*(i+1);for(l=0;l<i;l++){var y=o=l+v,b=o+i+1,_=o+i+2,x=o+1;c.push(y,b,x),c.push(b,_,x)}}this.setIndex(c),this.addAttribute("position",new Float32BufferAttribute(h,3)),this.addAttribute("normal",new Float32BufferAttribute(u,3)),this.addAttribute("uv",new Float32BufferAttribute(d,2))}function LatheGeometry(e,t,i,r){Geometry.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},this.fromBufferGeometry(new LatheBufferGeometry(e,t,i,r)),this.mergeVertices()}function LatheBufferGeometry(e,t,i,r){BufferGeometry.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t)||12,i=i||0,r=r||2*Math.PI,r=_Math.clamp(r,0,2*Math.PI);var n,a,o,s=[],l=[],c=[],h=1/t,u=new Vector3,d=new Vector2;for(a=0;a<=t;a++){var p=i+a*h*r,m=Math.sin(p),f=Math.cos(p);for(o=0;o<=e.length-1;o++)u.x=e[o].x*m,u.y=e[o].y,u.z=e[o].x*f,l.push(u.x,u.y,u.z),d.x=a/t,d.y=o/(e.length-1),c.push(d.x,d.y)}for(a=0;a<t;a++)for(o=0;o<e.length-1;o++){var g=n=o+a*e.length,v=n+e.length,y=n+e.length+1,b=n+1;s.push(g,v,b),s.push(v,y,b)}if(this.setIndex(s),this.addAttribute("position",new Float32BufferAttribute(l,3)),this.addAttribute("uv",new Float32BufferAttribute(c,2)),this.computeVertexNormals(),r===2*Math.PI){var _=this.attributes.normal.array,x=new Vector3,w=new Vector3,S=new Vector3;for(n=t*e.length*3,a=0,o=0;a<e.length;a++,o+=3)x.x=_[o+0],x.y=_[o+1],x.z=_[o+2],w.x=_[n+o+0],w.y=_[n+o+1],w.z=_[n+o+2],S.addVectors(x,w).normalize(),_[o+0]=_[n+o+0]=S.x,_[o+1]=_[n+o+1]=S.y,_[o+2]=_[n+o+2]=S.z}}function ShapeGeometry(e,t){Geometry.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new ShapeBufferGeometry(e,t)),this.mergeVertices()}function ShapeBufferGeometry(e,t){BufferGeometry.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var i=[],r=[],n=[],a=[],o=0,s=0;if(!1===Array.isArray(e))c(e);else for(var l=0;l<e.length;l++)c(e[l]),this.addGroup(o,s,l),o+=s,s=0;function c(e){var o,l,c,h=r.length/3,u=e.extractPoints(t),d=u.shape,p=u.holes;for(!1===ShapeUtils.isClockWise(d)&&(d=d.reverse()),o=0,l=p.length;o<l;o++)c=p[o],!0===ShapeUtils.isClockWise(c)&&(p[o]=c.reverse());var m=ShapeUtils.triangulateShape(d,p);for(o=0,l=p.length;o<l;o++)c=p[o],d=d.concat(c);for(o=0,l=d.length;o<l;o++){var f=d[o];r.push(f.x,f.y,0),n.push(0,0,1),a.push(f.x,f.y)}for(o=0,l=m.length;o<l;o++){var g=m[o],v=g[0]+h,y=g[1]+h,b=g[2]+h;i.push(v,y,b),s+=3}}this.setIndex(i),this.addAttribute("position",new Float32BufferAttribute(r,3)),this.addAttribute("normal",new Float32BufferAttribute(n,3)),this.addAttribute("uv",new Float32BufferAttribute(a,2))}function toJSON$1(e,t){if(t.shapes=[],Array.isArray(e))for(var i,r=0,n=e.length;r<n;r++)i=e[r],t.shapes.push(i.uuid);else t.shapes.push(e.uuid);return t}function EdgesGeometry(e,t){BufferGeometry.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var i,r,n,a,o=[],s=Math.cos(_Math.DEG2RAD*t),l=[0,0],c={},h=["a","b","c"];e.isBufferGeometry?(a=new Geometry).fromBufferGeometry(e):a=e.clone(),a.mergeVertices(),a.computeFaceNormals();for(var u,d=a.vertices,p=a.faces,m=0,f=p.length;m<f;m++){u=p[m];for(var g=0;3>g;g++)i=u[h[g]],r=u[h[(g+1)%3]],l[0]=Math.min(i,r),l[1]=Math.max(i,r),void 0===c[n=l[0]+","+l[1]]?c[n]={index1:l[0],index2:l[1],face1:m,face2:void 0}:c[n].face2=m}for(n in c){var v=c[n];if(void 0===v.face2||p[v.face1].normal.dot(p[v.face2].normal)<=s){var y=d[v.index1];o.push(y.x,y.y,y.z),y=d[v.index2],o.push(y.x,y.y,y.z)}}this.addAttribute("position",new Float32BufferAttribute(o,3))}function CylinderGeometry(e,t,i,r,n,a,o,s){Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:n,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new CylinderBufferGeometry(e,t,i,r,n,a,o,s)),this.mergeVertices()}function CylinderBufferGeometry(e,t,i,r,n,a,o,s){BufferGeometry.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:n,openEnded:a,thetaStart:o,thetaLength:s};var l=this;e=void 0!==e?e:1,t=void 0!==t?t:1,i=i||1,r=Math.floor(r)||8,n=Math.floor(n)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var c=[],h=[],u=[],d=[],p=0,m=[],f=i/2,g=0;function v(i){var n,a,m,v=new Vector2,y=new Vector3,b=0,_=!0===i?e:t,x=!0===i?1:-1;for(a=p,n=1;n<=r;n++)h.push(0,f*x,0),u.push(0,x,0),d.push(.5,.5),p++;for(m=p,n=0;n<=r;n++){var w=n/r*s+o,S=Math.cos(w),T=Math.sin(w);y.x=_*T,y.y=f*x,y.z=_*S,h.push(y.x,y.y,y.z),u.push(0,x,0),v.x=.5*S+.5,v.y=.5*T*x+.5,d.push(v.x,v.y),p++}for(n=0;n<r;n++){var A=a+n,E=m+n;!0===i?c.push(E,E+1,A):c.push(E+1,E,A),b+=3}l.addGroup(g,b,!0===i?1:2),g+=b}!function(){var a,v,y=new Vector3,b=new Vector3,_=0,x=(t-e)/i;for(v=0;v<=n;v++){var w=[],S=v/n,T=S*(t-e)+e;for(a=0;a<=r;a++){var A=a/r,E=A*s+o,C=Math.sin(E),M=Math.cos(E);b.x=T*C,b.y=-S*i+f,b.z=T*M,h.push(b.x,b.y,b.z),y.set(C,x,M).normalize(),u.push(y.x,y.y,y.z),d.push(A,1-S),w.push(p++)}m.push(w)}for(a=0;a<r;a++)for(v=0;v<n;v++){var P=m[v][a],L=m[v+1][a],I=m[v+1][a+1],B=m[v][a+1];c.push(P,L,B),c.push(L,I,B),_+=6}l.addGroup(g,_,0),g+=_}(),!1===a&&(0<e&&v(!0),0<t&&v(!1)),this.setIndex(c),this.addAttribute("position",new Float32BufferAttribute(h,3)),this.addAttribute("normal",new Float32BufferAttribute(u,3)),this.addAttribute("uv",new Float32BufferAttribute(d,2))}function ConeGeometry(e,t,i,r,n,a,o){CylinderGeometry.call(this,0,e,t,i,r,n,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:n,thetaStart:a,thetaLength:o}}function ConeBufferGeometry(e,t,i,r,n,a,o){CylinderBufferGeometry.call(this,0,e,t,i,r,n,a,o),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:n,thetaStart:a,thetaLength:o}}function CircleGeometry(e,t,i,r){Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},this.fromBufferGeometry(new CircleBufferGeometry(e,t,i,r)),this.mergeVertices()}function CircleBufferGeometry(e,t,i,r){BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},e=e||1,t=void 0!==t?Math.max(3,t):8,i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI;var n,a,o=[],s=[],l=[],c=[],h=new Vector3,u=new Vector2;for(s.push(0,0,0),l.push(0,0,1),c.push(.5,.5),a=0,n=3;a<=t;a++,n+=3){var d=i+a/t*r;h.x=e*Math.cos(d),h.y=e*Math.sin(d),s.push(h.x,h.y,h.z),l.push(0,0,1),u.x=(s[n]/e+1)/2,u.y=(s[n+1]/e+1)/2,c.push(u.x,u.y)}for(n=1;n<=t;n++)o.push(n,n+1,0);this.setIndex(o),this.addAttribute("position",new Float32BufferAttribute(s,3)),this.addAttribute("normal",new Float32BufferAttribute(l,3)),this.addAttribute("uv",new Float32BufferAttribute(c,2))}TextGeometry.prototype=Object.create(Geometry.prototype),TextGeometry.prototype.constructor=TextGeometry,TextBufferGeometry.prototype=Object.create(ExtrudeBufferGeometry.prototype),TextBufferGeometry.prototype.constructor=TextBufferGeometry,SphereGeometry.prototype=Object.create(Geometry.prototype),SphereGeometry.prototype.constructor=SphereGeometry,SphereBufferGeometry.prototype=Object.create(BufferGeometry.prototype),SphereBufferGeometry.prototype.constructor=SphereBufferGeometry,RingGeometry.prototype=Object.create(Geometry.prototype),RingGeometry.prototype.constructor=RingGeometry,RingBufferGeometry.prototype=Object.create(BufferGeometry.prototype),RingBufferGeometry.prototype.constructor=RingBufferGeometry,LatheGeometry.prototype=Object.create(Geometry.prototype),LatheGeometry.prototype.constructor=LatheGeometry,LatheBufferGeometry.prototype=Object.create(BufferGeometry.prototype),LatheBufferGeometry.prototype.constructor=LatheBufferGeometry,ShapeGeometry.prototype=Object.create(Geometry.prototype),ShapeGeometry.prototype.constructor=ShapeGeometry,ShapeGeometry.prototype.toJSON=function(){var e=Geometry.prototype.toJSON.call(this);return toJSON$1(this.parameters.shapes,e)},ShapeBufferGeometry.prototype=Object.create(BufferGeometry.prototype),ShapeBufferGeometry.prototype.constructor=ShapeBufferGeometry,ShapeBufferGeometry.prototype.toJSON=function(){var e=BufferGeometry.prototype.toJSON.call(this);return toJSON$1(this.parameters.shapes,e)},EdgesGeometry.prototype=Object.create(BufferGeometry.prototype),EdgesGeometry.prototype.constructor=EdgesGeometry,CylinderGeometry.prototype=Object.create(Geometry.prototype),CylinderGeometry.prototype.constructor=CylinderGeometry,CylinderBufferGeometry.prototype=Object.create(BufferGeometry.prototype),CylinderBufferGeometry.prototype.constructor=CylinderBufferGeometry,ConeGeometry.prototype=Object.create(CylinderGeometry.prototype),ConeGeometry.prototype.constructor=ConeGeometry,ConeBufferGeometry.prototype=Object.create(CylinderBufferGeometry.prototype),ConeBufferGeometry.prototype.constructor=ConeBufferGeometry,CircleGeometry.prototype=Object.create(Geometry.prototype),CircleGeometry.prototype.constructor=CircleGeometry,CircleBufferGeometry.prototype=Object.create(BufferGeometry.prototype),CircleBufferGeometry.prototype.constructor=CircleBufferGeometry;var Geometries=Object.freeze({WireframeGeometry:WireframeGeometry,ParametricGeometry:ParametricGeometry,ParametricBufferGeometry:ParametricBufferGeometry,TetrahedronGeometry:TetrahedronGeometry,TetrahedronBufferGeometry:TetrahedronBufferGeometry,OctahedronGeometry:OctahedronGeometry,OctahedronBufferGeometry:OctahedronBufferGeometry,IcosahedronGeometry:IcosahedronGeometry,IcosahedronBufferGeometry:IcosahedronBufferGeometry,DodecahedronGeometry:DodecahedronGeometry,DodecahedronBufferGeometry:DodecahedronBufferGeometry,PolyhedronGeometry:PolyhedronGeometry,PolyhedronBufferGeometry:PolyhedronBufferGeometry,TubeGeometry:TubeGeometry,TubeBufferGeometry:TubeBufferGeometry,TorusKnotGeometry:TorusKnotGeometry,TorusKnotBufferGeometry:TorusKnotBufferGeometry,TorusGeometry:TorusGeometry,TorusBufferGeometry:TorusBufferGeometry,TextGeometry:TextGeometry,TextBufferGeometry:TextBufferGeometry,SphereGeometry:SphereGeometry,SphereBufferGeometry:SphereBufferGeometry,RingGeometry:RingGeometry,RingBufferGeometry:RingBufferGeometry,PlaneGeometry:PlaneGeometry,PlaneBufferGeometry:PlaneBufferGeometry,LatheGeometry:LatheGeometry,LatheBufferGeometry:LatheBufferGeometry,ShapeGeometry:ShapeGeometry,ShapeBufferGeometry:ShapeBufferGeometry,ExtrudeGeometry:ExtrudeGeometry,ExtrudeBufferGeometry:ExtrudeBufferGeometry,EdgesGeometry:EdgesGeometry,ConeGeometry:ConeGeometry,ConeBufferGeometry:ConeBufferGeometry,CylinderGeometry:CylinderGeometry,CylinderBufferGeometry:CylinderBufferGeometry,CircleGeometry:CircleGeometry,CircleBufferGeometry:CircleBufferGeometry,BoxGeometry:BoxGeometry,BoxBufferGeometry:BoxBufferGeometry});function ShadowMaterial(e){Material.call(this),this.type="ShadowMaterial",this.color=new Color(0),this.transparent=!0,this.setValues(e)}function RawShaderMaterial(e){ShaderMaterial.call(this,e),this.type="RawShaderMaterial"}function MeshStandardMaterial(e){Material.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function MeshPhysicalMaterial(e){MeshStandardMaterial.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function MeshPhongMaterial(e){Material.call(this),this.type="MeshPhongMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function MeshToonMaterial(e){MeshPhongMaterial.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function MeshNormalMaterial(e){Material.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function MeshLambertMaterial(e){Material.call(this),this.type="MeshLambertMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function MeshMatcapMaterial(e){Material.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(e)}function LineDashedMaterial(e){LineBasicMaterial.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}ShadowMaterial.prototype=Object.create(Material.prototype),ShadowMaterial.prototype.constructor=ShadowMaterial,ShadowMaterial.prototype.isShadowMaterial=!0,ShadowMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.color.copy(e.color),this},RawShaderMaterial.prototype=Object.create(ShaderMaterial.prototype),RawShaderMaterial.prototype.constructor=RawShaderMaterial,RawShaderMaterial.prototype.isRawShaderMaterial=!0,MeshStandardMaterial.prototype=Object.create(Material.prototype),MeshStandardMaterial.prototype.constructor=MeshStandardMaterial,MeshStandardMaterial.prototype.isMeshStandardMaterial=!0,MeshStandardMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},MeshPhysicalMaterial.prototype=Object.create(MeshStandardMaterial.prototype),MeshPhysicalMaterial.prototype.constructor=MeshPhysicalMaterial,MeshPhysicalMaterial.prototype.isMeshPhysicalMaterial=!0,MeshPhysicalMaterial.prototype.copy=function(e){return MeshStandardMaterial.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},MeshPhongMaterial.prototype=Object.create(Material.prototype),MeshPhongMaterial.prototype.constructor=MeshPhongMaterial,MeshPhongMaterial.prototype.isMeshPhongMaterial=!0,MeshPhongMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},MeshToonMaterial.prototype=Object.create(MeshPhongMaterial.prototype),MeshToonMaterial.prototype.constructor=MeshToonMaterial,MeshToonMaterial.prototype.isMeshToonMaterial=!0,MeshToonMaterial.prototype.copy=function(e){return MeshPhongMaterial.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},MeshNormalMaterial.prototype=Object.create(Material.prototype),MeshNormalMaterial.prototype.constructor=MeshNormalMaterial,MeshNormalMaterial.prototype.isMeshNormalMaterial=!0,MeshNormalMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},MeshLambertMaterial.prototype=Object.create(Material.prototype),MeshLambertMaterial.prototype.constructor=MeshLambertMaterial,MeshLambertMaterial.prototype.isMeshLambertMaterial=!0,MeshLambertMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},MeshMatcapMaterial.prototype=Object.create(Material.prototype),MeshMatcapMaterial.prototype.constructor=MeshMatcapMaterial,MeshMatcapMaterial.prototype.isMeshMatcapMaterial=!0,MeshMatcapMaterial.prototype.copy=function(e){return Material.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},LineDashedMaterial.prototype=Object.create(LineBasicMaterial.prototype),LineDashedMaterial.prototype.constructor=LineDashedMaterial,LineDashedMaterial.prototype.isLineDashedMaterial=!0,LineDashedMaterial.prototype.copy=function(e){return LineBasicMaterial.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Materials=Object.freeze({ShadowMaterial:ShadowMaterial,SpriteMaterial:SpriteMaterial,RawShaderMaterial:RawShaderMaterial,ShaderMaterial:ShaderMaterial,PointsMaterial:PointsMaterial,MeshPhysicalMaterial:MeshPhysicalMaterial,MeshStandardMaterial:MeshStandardMaterial,MeshPhongMaterial:MeshPhongMaterial,MeshToonMaterial:MeshToonMaterial,MeshNormalMaterial:MeshNormalMaterial,MeshLambertMaterial:MeshLambertMaterial,MeshDepthMaterial:MeshDepthMaterial,MeshDistanceMaterial:MeshDistanceMaterial,MeshBasicMaterial:MeshBasicMaterial,MeshMatcapMaterial:MeshMatcapMaterial,LineDashedMaterial:LineDashedMaterial,LineBasicMaterial:LineBasicMaterial,Material:Material}),AnimationUtils={arraySlice:function(e,t,i){return AnimationUtils.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==i?i:e.length)):e.slice(t,i)},convertArray:function(e,t,i){return!e||!i&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,i=Array(t),r=0;r!==t;++r)i[r]=r;return i.sort(function(t,i){return e[t]-e[i]}),i},sortedArray:function(e,t,i){for(var r,n=e.length,a=new e.constructor(n),o=0,s=0;s!==n;++o){r=i[o]*t;for(var l=0;l!==t;++l)a[s++]=e[r+l]}return a},flattenJSON:function(e,t,i,r){for(var n=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[n++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(t.push(a.time),i.push.apply(i,o)),a=e[n++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(t.push(a.time),o.toArray(i,i.length)),a=e[n++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(t.push(a.time),i.push(o)),a=e[n++]}while(void 0!==a)}}};function Interpolant(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i}function CubicInterpolant(e,t,i,r){Interpolant.call(this,e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function LinearInterpolant(e,t,i,r){Interpolant.call(this,e,t,i,r)}function DiscreteInterpolant(e,t,i,r){Interpolant.call(this,e,t,i,r)}function KeyframeTrack(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=AnimationUtils.convertArray(t,this.TimeBufferType),this.values=AnimationUtils.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function BooleanKeyframeTrack(e,t,i){KeyframeTrack.call(this,e,t,i)}function ColorKeyframeTrack(e,t,i,r){KeyframeTrack.call(this,e,t,i,r)}function NumberKeyframeTrack(e,t,i,r){KeyframeTrack.call(this,e,t,i,r)}function QuaternionLinearInterpolant(e,t,i,r){Interpolant.call(this,e,t,i,r)}function QuaternionKeyframeTrack(e,t,i,r){KeyframeTrack.call(this,e,t,i,r)}function StringKeyframeTrack(e,t,i,r){KeyframeTrack.call(this,e,t,i,r)}function VectorKeyframeTrack(e,t,i,r){KeyframeTrack.call(this,e,t,i,r)}function AnimationClip(e,t,i){this.name=e,this.tracks=i,this.duration=void 0!==t?t:-1,this.uuid=_Math.generateUUID(),0>this.duration&&this.resetDuration()}function getTrackTypeForValueTypeName(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function parseKeyframeTrack(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var i=[],r=[];AnimationUtils.flattenJSON(e.keys,i,r,"value"),e.times=i,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(Interpolant.prototype,{evaluate:function(e){var t=this.parameterPositions,i=this._cachedIndex,r=t[i],n=t[i-1];e:{t:{var a;i:{r:if(!(e<r)){for(var o=i+2;;){if(void 0===r){if(e<n)break r;return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,e,n)}if(i===o)break;if(n=r,e<(r=t[++i]))break t}a=t.length;break i}if(e>=n)break e;var s=t[1];e<s&&(i=2,n=s);for(o=i-2;;){if(void 0===n)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(i===o)break;if(r=n,e>=(n=t[--i-1]))break t}a=i,i=0}for(;i<a;){var l=i+a>>>1;e<t[l]?a=l:i=l+1}if(r=t[i],void 0===(n=t[i-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,n,e)}this._cachedIndex=i,this.intervalChanged_(i,n,r)}return this.interpolate_(i,n,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,n=e*r,a=0;a!==r;++a)t[a]=i[n+a];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Interpolant.prototype,{beforeStart_:Interpolant.prototype.copySampleValue_,afterEnd_:Interpolant.prototype.copySampleValue_}),CubicInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:CubicInterpolant,DefaultSettings_:{endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding},intervalChanged_:function(e,t,i){var r=this.parameterPositions,n=e-2,a=e+1,o=r[n],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:n=e,o=2*t-i;break;case WrapAroundEnding:o=t+r[n=r.length-2]-r[n+1];break;default:n=e,o=i}if(void 0===s)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:a=e,s=2*i-t;break;case WrapAroundEnding:a=1,s=i+r[1]-r[0];break;default:a=e-1,s=t}var l=.5*(i-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-i),this._offsetPrev=n*c,this._offsetNext=a*c},interpolate_:function(e,t,i,r){for(var n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(i-t)/(r-t),m=p*p,f=m*p,g=-u*f+2*u*m-u*p,v=(1+u)*f+(-1.5-2*u)*m+(-.5+u)*p+1,y=(-1-d)*f+(1.5+d)*m+.5*p,b=d*f-d*m,_=0;_!==o;++_)n[_]=g*a[c+_]+v*a[l+_]+y*a[s+_]+b*a[h+_];return n}}),LinearInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:LinearInterpolant,interpolate_:function(e,t,i,r){for(var n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(i-t)/(r-t),h=1-c,u=0;u!==o;++u)n[u]=a[l+u]*h+a[s+u]*c;return n}}),DiscreteInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:DiscreteInterpolant,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(KeyframeTrack,{toJSON:function(e){var t,i=e.constructor;if(void 0!==i.toJSON)t=i.toJSON(e);else{t={name:e.name,times:AnimationUtils.convertArray(e.times,Array),values:AnimationUtils.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}),Object.assign(KeyframeTrack.prototype,{constructor:KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:InterpolateLinear,InterpolantFactoryMethodDiscrete:function(e){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new LinearInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new CubicInterpolant(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case InterpolateDiscrete:t=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:t=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,i=0,r=t.length;i!==r;++i)t[i]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,i=0,r=t.length;i!==r;++i)t[i]*=e;return this},trim:function(e,t){for(var i=this.times,r=i.length,n=0,a=r-1;n!==r&&i[n]<e;)++n;for(;-1!==a&&i[a]>t;)--a;if(++a,0!==n||a!==r){n>=a&&(n=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=AnimationUtils.arraySlice(i,n,a),this.values=AnimationUtils.arraySlice(this.values,n*o,a*o)}return this},validate:function(){var e=!0,t=this.getValueSize();0!=t-Math.floor(t)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var i=this.times,r=this.values,n=i.length;0===n&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a,o=null,s=0;s!==n;s++){if("number"==typeof(a=i[s])&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,a),e=!1;break}if(null!==o&&o>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,a,o),e=!1;break}o=a}if(void 0!==r&&AnimationUtils.isTypedArray(r)){s=0;for(var l,c=r.length;s!==c;++s)if(l=r[s],isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,l),e=!1;break}}return e},optimize:function(){for(var e=this.times,t=this.values,i=this.getValueSize(),r=this.getInterpolation()===InterpolateSmooth,n=1,a=e.length-1,o=1;o<a;++o){var s=!1,l=e[o];if(l!==e[o+1]&&(1!==o||l!==l[0]))if(r)s=!0;else for(var c,h=o*i,u=h-i,d=h+i,p=0;p!==i;++p)if((c=t[h+p])!==t[u+p]||c!==t[d+p]){s=!0;break}if(s){if(o!==n){e[n]=e[o];var m=o*i,f=n*i;for(p=0;p!==i;++p)t[f+p]=t[m+p]}++n}}if(0<a){e[n]=e[a];for(m=a*i,f=n*i,p=0;p!==i;++p)t[f+p]=t[m+p];++n}return n!==e.length&&(this.times=AnimationUtils.arraySlice(e,0,n),this.values=AnimationUtils.arraySlice(t,0,n*i)),this},clone:function(){var e=AnimationUtils.arraySlice(this.times,0),t=AnimationUtils.arraySlice(this.values,0),i=new(0,this.constructor)(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}),BooleanKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ColorKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:ColorKeyframeTrack,ValueTypeName:"color"}),NumberKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:NumberKeyframeTrack,ValueTypeName:"number"}),QuaternionLinearInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:QuaternionLinearInterpolant,interpolate_:function(e,t,i,r){for(var n=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=(i-t)/(r-t),c=s+o;s!==c;s+=4)Quaternion.slerpFlat(n,0,a,s-o,a,s,l);return n}}),QuaternionKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:InterpolateLinear,InterpolantFactoryMethodLinear:function(e){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),StringKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),VectorKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:VectorKeyframeTrack,ValueTypeName:"vector"}),Object.assign(AnimationClip,{parse:function(e){for(var t=[],i=e.tracks,r=1/(e.fps||1),n=0,a=i.length;n!==a;++n)t.push(parseKeyframeTrack(i[n]).scale(r));return new AnimationClip(e.name,e.duration,t)},toJSON:function(e){for(var t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},n=0,a=i.length;n!==a;++n)t.push(KeyframeTrack.toJSON(i[n]));return r},CreateFromMorphTargetSequence:function(e,t,i,r){for(var n=t.length,a=[],o=0;o<n;o++){var s=[],l=[];s.push((o+n-1)%n,o,(o+1)%n),l.push(0,1,0);var c=AnimationUtils.getKeyframeOrder(s);s=AnimationUtils.sortedArray(s,1,c),l=AnimationUtils.sortedArray(l,1,c),r||0!==s[0]||(s.push(n),l.push(l[0])),a.push(new NumberKeyframeTrack(".morphTargetInfluences["+t[o].name+"]",s,l).scale(1/i))}return new AnimationClip(e,-1,a)},findByName:function(e,t){var i=e;if(!Array.isArray(e)){var r=e;i=r.geometry&&r.geometry.animations||r.animations}for(var n=0;n<i.length;n++)if(i[n].name===t)return i[n];return null},CreateClipsFromMorphTargetSequences:function(e,t,i){for(var r={},n=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],l=s.name.match(n);if(l&&1<l.length){var c=r[u=l[1]];c||(r[u]=c=[]),c.push(s)}}var h=[];for(var u in r)h.push(AnimationClip.CreateFromMorphTargetSequence(u,r[u],t,i));return h},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var i,r=function(e,t,i,r,n){if(0!==i.length){var a=[],o=[];AnimationUtils.flattenJSON(i,a,o,r),0!==a.length&&n.push(new e(t,a,o))}},n=[],a=e.name||"default",o=e.length||-1,s=e.fps||30,l=e.hierarchy||[],c=0;c<l.length;c++)if((i=l[c].keys)&&0!==i.length)if(i[0].morphTargets){for(var h={},u=0;u<i.length;u++)if(i[u].morphTargets)for(var d=0;d<i[u].morphTargets.length;d++)h[i[u].morphTargets[d]]=-1;for(var p in h){var m,f=[],g=[];for(d=0;d!==i[u].morphTargets.length;++d)m=i[u],f.push(m.time),g.push(m.morphTarget===p?1:0);n.push(new NumberKeyframeTrack(".morphTargetInfluence["+p+"]",f,g))}o=h.length*(s||1)}else{var v=".bones["+t[c].name+"]";r(VectorKeyframeTrack,v+".position",i,"pos",n),r(QuaternionKeyframeTrack,v+".quaternion",i,"rot",n),r(VectorKeyframeTrack,v+".scale",i,"scl",n)}return 0===n.length?null:new AnimationClip(a,o,n)}}),Object.assign(AnimationClip.prototype,{resetDuration:function(){for(var e,t=0,i=0,r=this.tracks.length;i!==r;++i)e=this.tracks[i],t=Math.max(t,e.times[e.times.length-1]);return this.duration=t,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new AnimationClip(this.name,this.duration,e)}});var Cache={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function LoadingManager(e,t,i){var r=this,n=!1,a=0,o=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(e){o++,!1===n&&void 0!==r.onStart&&r.onStart(e,a,o),n=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(n=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var DefaultLoadingManager=new LoadingManager,loading={};function FileLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function AnimationLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function CompressedTextureLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager,this._parser=null}function DataTextureLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager,this._parser=null}function ImageLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function CubeTextureLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function TextureLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function Curve(){this.type="Curve",this.arcLengthDivisions=200}function EllipseCurve(e,t,i,r,n,a,o,s){Curve.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=i||1,this.yRadius=r||1,this.aStartAngle=n||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function ArcCurve(e,t,i,r,n,a){EllipseCurve.call(this,e,t,i,i,r,n,a),this.type="ArcCurve"}function CubicPoly(){var e=0,t=0,i=0,r=0;function n(n,a,o,s){e=n,t=o,i=-3*n+3*a-2*o-s,r=2*n-2*a+o+s}return{initCatmullRom:function(e,t,i,r,a){n(t,i,a*(i-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,i,r,a,o,s){var l=(t-e)/a-(i-e)/(a+o)+(i-t)/o,c=(i-t)/o-(r-t)/(o+s)+(r-i)/s;n(t,i,l*=o,c*=o)},calc:function(n){var a=n*n;return e+t*n+i*a+r*(a*n)}}}Object.assign(FileLoader.prototype,{load:function(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var n=this,a=Cache.get(e);if(void 0!==a)return n.manager.itemStart(e),setTimeout(function(){t&&t(a),n.manager.itemEnd(e)},0),a;if(void 0===loading[e]){var o=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){var s=o[1],l=!!o[2],c=o[3];c=decodeURIComponent(c),l&&(c=atob(c));try{var h,u=(this.responseType||"").toLowerCase();switch(u){case"arraybuffer":case"blob":for(var d=new Uint8Array(c.length),p=0;p<c.length;p++)d[p]=c.charCodeAt(p);h="blob"===u?new Blob([d.buffer],{type:s}):d.buffer;break;case"document":var m=new DOMParser;h=m.parseFromString(c,s);break;case"json":h=JSON.parse(c);break;default:h=c}setTimeout(function(){t&&t(h),n.manager.itemEnd(e)},0)}catch(t){setTimeout(function(){r&&r(t),n.manager.itemError(e),n.manager.itemEnd(e)},0)}}else{loading[e]=[],loading[e].push({onLoad:t,onProgress:i,onError:r});var f=new XMLHttpRequest;for(var g in f.open("GET",e,!0),f.addEventListener("load",function(t){var i=this.response;Cache.add(e,i);var r=loading[e];if(delete loading[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var a=0,o=r.length;a<o;a++)(s=r[a]).onLoad&&s.onLoad(i);n.manager.itemEnd(e)}else{var s;for(a=0,o=r.length;a<o;a++)(s=r[a]).onError&&s.onError(t);n.manager.itemError(e),n.manager.itemEnd(e)}},!1),f.addEventListener("progress",function(t){for(var i,r=loading[e],n=0,a=r.length;n<a;n++)(i=r[n]).onProgress&&i.onProgress(t)},!1),f.addEventListener("error",function(t){var i=loading[e];delete loading[e];for(var r,a=0,o=i.length;a<o;a++)(r=i[a]).onError&&r.onError(t);n.manager.itemError(e),n.manager.itemEnd(e)},!1),f.addEventListener("abort",function(t){var i=loading[e];delete loading[e];for(var r,a=0,o=i.length;a<o;a++)(r=i[a]).onError&&r.onError(t);n.manager.itemError(e),n.manager.itemEnd(e)},!1),void 0!==this.responseType&&(f.responseType=this.responseType),void 0!==this.withCredentials&&(f.withCredentials=this.withCredentials),f.overrideMimeType&&f.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)f.setRequestHeader(g,this.requestHeader[g]);f.send(null)}return n.manager.itemStart(e),f}loading[e].push({onLoad:t,onProgress:i,onError:r})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(AnimationLoader.prototype,{load:function(e,t,i,r){var n=this,a=new FileLoader(n.manager);a.setPath(n.path),a.load(e,function(e){t(n.parse(JSON.parse(e)))},i,r)},parse:function(e){for(var t,i=[],r=0;r<e.length;r++)t=AnimationClip.parse(e[r]),i.push(t);return i},setPath:function(e){return this.path=e,this}}),Object.assign(CompressedTextureLoader.prototype,{load:function(e,t,i,r){var n=this,a=[],o=new CompressedTexture;o.image=a;var s=new FileLoader(this.manager);function l(l){s.load(e[l],function(e){var i=n._parser(e,!0);a[l]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},6===(c+=1)&&(1===i.mipmapCount&&(o.minFilter=LinearFilter),o.format=i.format,o.needsUpdate=!0,t&&t(o))},i,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var c=0,h=0,u=e.length;h<u;++h)l(h);else s.load(e,function(e){var i=n._parser(e,!0);if(i.isCubemap)for(var r=i.mipmaps.length/i.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var l=0;l<i.mipmapCount;l++)a[s].mipmaps.push(i.mipmaps[s*i.mipmapCount+l]),a[s].format=i.format,a[s].width=i.width,a[s].height=i.height}else o.image.width=i.width,o.image.height=i.height,o.mipmaps=i.mipmaps;1===i.mipmapCount&&(o.minFilter=LinearFilter),o.format=i.format,o.needsUpdate=!0,t&&t(o)},i,r);return o},setPath:function(e){return this.path=e,this}}),Object.assign(DataTextureLoader.prototype,{load:function(e,t,i,r){var n=this,a=new DataTexture,o=new FileLoader(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(e,function(e){var i=n._parser(e);i&&(void 0!==i.image?a.image=i.image:void 0!==i.data&&(a.image.width=i.width,a.image.height=i.height,a.image.data=i.data),a.wrapS=void 0!==i.wrapS?i.wrapS:ClampToEdgeWrapping,a.wrapT=void 0!==i.wrapT?i.wrapT:ClampToEdgeWrapping,a.magFilter=void 0!==i.magFilter?i.magFilter:LinearFilter,a.minFilter=void 0!==i.minFilter?i.minFilter:LinearMipMapLinearFilter,a.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(a.format=i.format),void 0!==i.type&&(a.type=i.type),void 0!==i.mipmaps&&(a.mipmaps=i.mipmaps),1===i.mipmapCount&&(a.minFilter=LinearFilter),a.needsUpdate=!0,t&&t(a,i))},i,r),a},setPath:function(e){return this.path=e,this}}),Object.assign(ImageLoader.prototype,{crossOrigin:"anonymous",load:function(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var n=this,a=Cache.get(e);if(void 0!==a)return n.manager.itemStart(e),setTimeout(function(){t&&t(a),n.manager.itemEnd(e)},0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),Cache.add(e,this),t&&t(this),n.manager.itemEnd(e)}function l(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),r&&r(t),n.manager.itemError(e),n.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),n.manager.itemStart(e),o.src=e,o},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(CubeTextureLoader.prototype,{crossOrigin:"anonymous",load:function(e,t,i,r){var n=new CubeTexture,a=new ImageLoader(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(i){a.load(e[i],function(e){n.images[i]=e,6===++o&&(n.needsUpdate=!0,t&&t(n))},void 0,r)}for(var l=0;l<e.length;++l)s(l);return n},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(TextureLoader.prototype,{crossOrigin:"anonymous",load:function(e,t,i,r){var n=new Texture,a=new ImageLoader(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(i){n.image=i;var r=0<e.search(/\.jpe?g($|\?)/i)||0===e.search(/^data\:image\/jpeg/);n.format=r?RGBFormat:RGBAFormat,n.needsUpdate=!0,void 0!==t&&t(n)},i,r),n},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Curve.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var i=this.getUtoTmapping(e);return this.getPoint(i,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],i=0;i<=e;i++)t.push(this.getPoint(i/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,i,r=[],n=this.getPoint(0),a=0;for(r.push(0),i=1;i<=e;i++)a+=(t=this.getPoint(i/e)).distanceTo(n),r.push(a),n=t;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var i,r=this.getLengths(),n=0,a=r.length;i=t||e*r[a-1];for(var o,s=0,l=a-1;s<=l;)if(0>(o=r[n=Math.floor(s+(l-s)/2)]-i))s=n+1;else{if(!(0<o)){l=n;break}l=n-1}if(r[n=l]===i)return n/(a-1);var c=r[n];return(n+(i-c)/(r[n+1]-c))/(a-1)},getTangent:function(e){var t=e-1e-4,i=e+1e-4;0>t&&(t=0),1<i&&(i=1);var r=this.getPoint(t);return this.getPoint(i).clone().sub(r).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var i,r,n,a=new Vector3,o=[],s=[],l=[],c=new Vector3,h=new Matrix4;for(i=0;i<=e;i++)r=i/e,o[i]=this.getTangentAt(r),o[i].normalize();s[0]=new Vector3,l[0]=new Vector3;var u=Number.MAX_VALUE,d=Math.abs(o[0].x),p=Math.abs(o[0].y),m=Math.abs(o[0].z);for(d<=u&&(u=d,a.set(1,0,0)),p<=u&&(u=p,a.set(0,1,0)),m<=u&&a.set(0,0,1),c.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],c),l[0].crossVectors(o[0],s[0]),i=1;i<=e;i++)s[i]=s[i-1].clone(),l[i]=l[i-1].clone(),c.crossVectors(o[i-1],o[i]),c.length()>Number.EPSILON&&(c.normalize(),n=Math.acos(_Math.clamp(o[i-1].dot(o[i]),-1,1)),s[i].applyMatrix4(h.makeRotationAxis(c,n))),l[i].crossVectors(o[i],s[i]);if(!0===t)for(n=Math.acos(_Math.clamp(s[0].dot(s[e]),-1,1)),n/=e,0<o[0].dot(c.crossVectors(s[0],s[e]))&&(n=-n),i=1;i<=e;i++)s[i].applyMatrix4(h.makeRotationAxis(o[i],n*i)),l[i].crossVectors(o[i],s[i]);return{tangents:o,normals:s,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){return{metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"},arcLengthDivisions:this.arcLengthDivisions,type:this.type}},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),EllipseCurve.prototype=Object.create(Curve.prototype),EllipseCurve.prototype.constructor=EllipseCurve,EllipseCurve.prototype.isEllipseCurve=!0,EllipseCurve.prototype.getPoint=function(e,t){for(var i=t||new Vector2,r=2*Math.PI,n=this.aEndAngle-this.aStartAngle,a=Math.abs(n)<Number.EPSILON;0>n;)n+=r;for(;n>r;)n-=r;n<Number.EPSILON&&(n=a?0:r),!0!==this.aClockwise||a||(n===r?n=-r:n-=r);var o=this.aStartAngle+e*n,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),u=s-this.aX,d=l-this.aY;s=u*c-d*h+this.aX,l=u*h+d*c+this.aY}return i.set(s,l)},EllipseCurve.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},EllipseCurve.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},EllipseCurve.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ArcCurve.prototype=Object.create(EllipseCurve.prototype),ArcCurve.prototype.constructor=ArcCurve,ArcCurve.prototype.isArcCurve=!0;var tmp=new Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;function CatmullRomCurve3(e,t,i,r){Curve.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=i||"centripetal",this.tension=r||.5}function CatmullRom(e,t,i,r,n){var a=.5*(r-t),o=.5*(n-i),s=e*e;return(2*i-2*r+a+o)*(e*s)+(-3*i+3*r-2*a-o)*s+a*e+i}function QuadraticBezierP0(e,t){var i=1-e;return i*i*t}function QuadraticBezierP1(e,t){return 2*(1-e)*e*t}function QuadraticBezierP2(e,t){return e*e*t}function QuadraticBezier(e,t,i,r){return QuadraticBezierP0(e,t)+QuadraticBezierP1(e,i)+QuadraticBezierP2(e,r)}function CubicBezierP0(e,t){var i=1-e;return i*i*i*t}function CubicBezierP1(e,t){var i=1-e;return 3*i*i*e*t}function CubicBezierP2(e,t){return 3*(1-e)*e*e*t}function CubicBezierP3(e,t){return e*e*e*t}function CubicBezier(e,t,i,r,n){return CubicBezierP0(e,t)+CubicBezierP1(e,i)+CubicBezierP2(e,r)+CubicBezierP3(e,n)}function CubicBezierCurve(e,t,i,r){Curve.call(this),this.type="CubicBezierCurve",this.v0=e||new Vector2,this.v1=t||new Vector2,this.v2=i||new Vector2,this.v3=r||new Vector2}function CubicBezierCurve3(e,t,i,r){Curve.call(this),this.type="CubicBezierCurve3",this.v0=e||new Vector3,this.v1=t||new Vector3,this.v2=i||new Vector3,this.v3=r||new Vector3}function LineCurve(e,t){Curve.call(this),this.type="LineCurve",this.v1=e||new Vector2,this.v2=t||new Vector2}function LineCurve3(e,t){Curve.call(this),this.type="LineCurve3",this.v1=e||new Vector3,this.v2=t||new Vector3}function QuadraticBezierCurve(e,t,i){Curve.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Vector2,this.v1=t||new Vector2,this.v2=i||new Vector2}function QuadraticBezierCurve3(e,t,i){Curve.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Vector3,this.v1=t||new Vector3,this.v2=i||new Vector3}function SplineCurve(e){Curve.call(this),this.type="SplineCurve",this.points=e||[]}CatmullRomCurve3.prototype=Object.create(Curve.prototype),CatmullRomCurve3.prototype.constructor=CatmullRomCurve3,CatmullRomCurve3.prototype.isCatmullRomCurve3=!0,CatmullRomCurve3.prototype.getPoint=function(e,t){var i,r,n,a,o=t||new Vector3,s=this.points,l=s.length,c=(l-(this.closed?0:1))*e,h=Math.floor(c),u=c-h;if(this.closed?h+=0<h?0:(Math.floor(Math.abs(h)/l)+1)*l:0===u&&h===l-1&&(h=l-2,u=1),this.closed||0<h?i=s[(h-1)%l]:(tmp.subVectors(s[0],s[1]).add(s[0]),i=tmp),r=s[h%l],n=s[(h+1)%l],this.closed||h+2<l?a=s[(h+2)%l]:(tmp.subVectors(s[l-1],s[l-2]).add(s[l-1]),a=tmp),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(i.distanceToSquared(r),d),m=Math.pow(r.distanceToSquared(n),d),f=Math.pow(n.distanceToSquared(a),d);1e-4>m&&(m=1),1e-4>p&&(p=m),1e-4>f&&(f=m),px.initNonuniformCatmullRom(i.x,r.x,n.x,a.x,p,m,f),py.initNonuniformCatmullRom(i.y,r.y,n.y,a.y,p,m,f),pz.initNonuniformCatmullRom(i.z,r.z,n.z,a.z,p,m,f)}else"catmullrom"===this.curveType&&(px.initCatmullRom(i.x,r.x,n.x,a.x,this.tension),py.initCatmullRom(i.y,r.y,n.y,a.y,this.tension),pz.initCatmullRom(i.z,r.z,n.z,a.z,this.tension));return o.set(px.calc(u),py.calc(u),pz.calc(u)),o},CatmullRomCurve3.prototype.copy=function(e){Curve.prototype.copy.call(this,e),this.points=[];for(var t,i=0,r=e.points.length;i<r;i++)t=e.points[i],this.points.push(t.clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},CatmullRomCurve3.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);e.points=[];for(var t,i=0,r=this.points.length;i<r;i++)t=this.points[i],e.points.push(t.toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},CatmullRomCurve3.prototype.fromJSON=function(e){Curve.prototype.fromJSON.call(this,e),this.points=[];for(var t,i=0,r=e.points.length;i<r;i++)t=e.points[i],this.points.push((new Vector3).fromArray(t));return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},CubicBezierCurve.prototype=Object.create(Curve.prototype),CubicBezierCurve.prototype.constructor=CubicBezierCurve,CubicBezierCurve.prototype.isCubicBezierCurve=!0,CubicBezierCurve.prototype.getPoint=function(e,t){var i=t||new Vector2,r=this.v0,n=this.v1,a=this.v2,o=this.v3;return i.set(CubicBezier(e,r.x,n.x,a.x,o.x),CubicBezier(e,r.y,n.y,a.y,o.y)),i},CubicBezierCurve.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},CubicBezierCurve.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},CubicBezierCurve.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},CubicBezierCurve3.prototype=Object.create(Curve.prototype),CubicBezierCurve3.prototype.constructor=CubicBezierCurve3,CubicBezierCurve3.prototype.isCubicBezierCurve3=!0,CubicBezierCurve3.prototype.getPoint=function(e,t){var i=t||new Vector3,r=this.v0,n=this.v1,a=this.v2,o=this.v3;return i.set(CubicBezier(e,r.x,n.x,a.x,o.x),CubicBezier(e,r.y,n.y,a.y,o.y),CubicBezier(e,r.z,n.z,a.z,o.z)),i},CubicBezierCurve3.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},CubicBezierCurve3.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},CubicBezierCurve3.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},LineCurve.prototype=Object.create(Curve.prototype),LineCurve.prototype.constructor=LineCurve,LineCurve.prototype.isLineCurve=!0,LineCurve.prototype.getPoint=function(e,t){var i=t||new Vector2;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i},LineCurve.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},LineCurve.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},LineCurve.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},LineCurve.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},LineCurve.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},LineCurve3.prototype=Object.create(Curve.prototype),LineCurve3.prototype.constructor=LineCurve3,LineCurve3.prototype.isLineCurve3=!0,LineCurve3.prototype.getPoint=function(e,t){var i=t||new Vector3;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i},LineCurve3.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},LineCurve3.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},LineCurve3.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},LineCurve3.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},QuadraticBezierCurve.prototype=Object.create(Curve.prototype),QuadraticBezierCurve.prototype.constructor=QuadraticBezierCurve,QuadraticBezierCurve.prototype.isQuadraticBezierCurve=!0,QuadraticBezierCurve.prototype.getPoint=function(e,t){var i=t||new Vector2,r=this.v0,n=this.v1,a=this.v2;return i.set(QuadraticBezier(e,r.x,n.x,a.x),QuadraticBezier(e,r.y,n.y,a.y)),i},QuadraticBezierCurve.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},QuadraticBezierCurve.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},QuadraticBezierCurve.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},QuadraticBezierCurve3.prototype=Object.create(Curve.prototype),QuadraticBezierCurve3.prototype.constructor=QuadraticBezierCurve3,QuadraticBezierCurve3.prototype.isQuadraticBezierCurve3=!0,QuadraticBezierCurve3.prototype.getPoint=function(e,t){var i=t||new Vector3,r=this.v0,n=this.v1,a=this.v2;return i.set(QuadraticBezier(e,r.x,n.x,a.x),QuadraticBezier(e,r.y,n.y,a.y),QuadraticBezier(e,r.z,n.z,a.z)),i},QuadraticBezierCurve3.prototype.copy=function(e){return Curve.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},QuadraticBezierCurve3.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},QuadraticBezierCurve3.prototype.fromJSON=function(e){return Curve.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},SplineCurve.prototype=Object.create(Curve.prototype),SplineCurve.prototype.constructor=SplineCurve,SplineCurve.prototype.isSplineCurve=!0,SplineCurve.prototype.getPoint=function(e,t){var i=t||new Vector2,r=this.points,n=(r.length-1)*e,a=Math.floor(n),o=n-a,s=r[0===a?a:a-1],l=r[a],c=r[a>r.length-2?r.length-1:a+1],h=r[a>r.length-3?r.length-1:a+2];return i.set(CatmullRom(o,s.x,l.x,c.x,h.x),CatmullRom(o,s.y,l.y,c.y,h.y)),i},SplineCurve.prototype.copy=function(e){Curve.prototype.copy.call(this,e),this.points=[];for(var t,i=0,r=e.points.length;i<r;i++)t=e.points[i],this.points.push(t.clone());return this},SplineCurve.prototype.toJSON=function(){var e=Curve.prototype.toJSON.call(this);e.points=[];for(var t,i=0,r=this.points.length;i<r;i++)t=this.points[i],e.points.push(t.toArray());return e},SplineCurve.prototype.fromJSON=function(e){Curve.prototype.fromJSON.call(this,e),this.points=[];for(var t,i=0,r=e.points.length;i<r;i++)t=e.points[i],this.points.push((new Vector2).fromArray(t));return this};var Curves=Object.freeze({ArcCurve:ArcCurve,CatmullRomCurve3:CatmullRomCurve3,CubicBezierCurve:CubicBezierCurve,CubicBezierCurve3:CubicBezierCurve3,EllipseCurve:EllipseCurve,LineCurve:LineCurve,LineCurve3:LineCurve3,QuadraticBezierCurve:QuadraticBezierCurve,QuadraticBezierCurve3:QuadraticBezierCurve3,SplineCurve:SplineCurve});function CurvePath(){Curve.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Path(e){CurvePath.call(this),this.type="Path",this.currentPoint=new Vector2,e&&this.setFromPoints(e)}function Shape(e){Path.call(this,e),this.uuid=_Math.generateUUID(),this.type="Shape",this.holes=[]}function Light(e,t){Object3D.call(this),this.type="Light",this.color=new Color(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function HemisphereLight(e,t,i){Light.call(this,e,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.groundColor=new Color(t)}function LightShadow(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new Vector2(512,512),this.map=null,this.matrix=new Matrix4}function SpotLightShadow(){LightShadow.call(this,new PerspectiveCamera(50,1,.5,500))}function SpotLight(e,t,i,r,n,a){Light.call(this,e,t),this.type="SpotLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.target=new Object3D,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==n?n:0,this.decay=void 0!==a?a:1,this.shadow=new SpotLightShadow}function PointLight(e,t,i,r){Light.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==r?r:1,this.shadow=new LightShadow(new PerspectiveCamera(90,1,.5,500))}function OrthographicCamera(e,t,i,r,n,a){Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==i?i:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==n?n:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function DirectionalLightShadow(){LightShadow.call(this,new OrthographicCamera(-5,5,5,-5,.5,500))}function DirectionalLight(e,t){Light.call(this,e,t),this.type="DirectionalLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}function AmbientLight(e,t){Light.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function RectAreaLight(e,t,i,r){Light.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==i?i:10,this.height=void 0!==r?r:10}function MaterialLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.textures={}}CurvePath.prototype=Object.assign(Object.create(Curve.prototype),{constructor:CurvePath,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new LineCurve(t,e))},getPoint:function(e){for(var t=e*this.getLength(),i=this.getCurveLengths(),r=0;r<i.length;){if(i[r]>=t){var n=i[r]-t,a=this.curves[r],o=a.getLength(),s=0===o?0:1-n/o;return a.getPointAt(s)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,i=[],r=0,n=this.curves;r<n.length;r++)for(var a,o=n[r],s=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,l=o.getPoints(s),c=0;c<l.length;c++)a=l[c],t&&t.equals(a)||(i.push(a),t=a);return this.autoClose&&1<i.length&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(e){Curve.prototype.copy.call(this,e),this.curves=[];for(var t,i=0,r=e.curves.length;i<r;i++)t=e.curves[i],this.curves.push(t.clone());return this.autoClose=e.autoClose,this},toJSON:function(){var e=Curve.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t,i=0,r=this.curves.length;i<r;i++)t=this.curves[i],e.curves.push(t.toJSON());return e},fromJSON:function(e){Curve.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t,i=0,r=e.curves.length;i<r;i++)t=e.curves[i],this.curves.push((new Curves[t.type]).fromJSON(t));return this}}),Path.prototype=Object.assign(Object.create(CurvePath.prototype),{constructor:Path,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var i=new LineCurve(this.currentPoint.clone(),new Vector2(e,t));this.curves.push(i),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,i,r){var n=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(e,t),new Vector2(i,r));this.curves.push(n),this.currentPoint.set(i,r)},bezierCurveTo:function(e,t,i,r,n,a){var o=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(e,t),new Vector2(i,r),new Vector2(n,a));this.curves.push(o),this.currentPoint.set(n,a)},splineThru:function(e){var t=new SplineCurve([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,i,r,n,a){var o=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+o,t+s,i,r,n,a)},absarc:function(e,t,i,r,n,a){this.absellipse(e,t,i,i,r,n,a)},ellipse:function(e,t,i,r,n,a,o,s){var l=this.currentPoint.x,c=this.currentPoint.y;this.absellipse(e+l,t+c,i,r,n,a,o,s)},absellipse:function(e,t,i,r,n,a,o,s){var l=new EllipseCurve(e,t,i,r,n,a,o,s);if(0<this.curves.length){var c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);var h=l.getPoint(1);this.currentPoint.copy(h)},copy:function(e){return CurvePath.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=CurvePath.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return CurvePath.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Shape.prototype=Object.assign(Object.create(Path.prototype),{constructor:Shape,getPointsHoles:function(e){for(var t=[],i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Path.prototype.copy.call(this,e),this.holes=[];for(var t,i=0,r=e.holes.length;i<r;i++)t=e.holes[i],this.holes.push(t.clone());return this},toJSON:function(){var e=Path.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t,i=0,r=this.holes.length;i<r;i++)t=this.holes[i],e.holes.push(t.toJSON());return e},fromJSON:function(e){Path.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t,i=0,r=e.holes.length;i<r;i++)t=e.holes[i],this.holes.push((new Path).fromJSON(t));return this}}),Light.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Light,isLight:!0,copy:function(e){return Object3D.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=Object3D.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),HemisphereLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:HemisphereLight,isHemisphereLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(LightShadow.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),SpotLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:SpotLightShadow,isSpotLightShadow:!0,update:function(e){var t=this.camera,i=2*_Math.RAD2DEG*e.angle,r=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;i===t.fov&&r===t.aspect&&n===t.far||(t.fov=i,t.aspect=r,t.far=n,t.updateProjectionMatrix())}}),SpotLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:SpotLight,isSpotLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),PointLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:PointLight,isPointLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),OrthographicCamera.prototype=Object.assign(Object.create(Camera.prototype),{constructor:OrthographicCamera,isOrthographicCamera:!0,copy:function(e,t){return Camera.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,i,r,n,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2,n=i-e,a=i+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var l=this.zoom/(this.view.width/this.view.fullWidth),c=this.zoom/(this.view.height/this.view.fullHeight),h=(this.right-this.left)/this.view.width,u=(this.top-this.bottom)/this.view.height;a=(n+=h*(this.view.offsetX/l))+h*(this.view.width/l),s=(o-=u*(this.view.offsetY/c))-u*(this.view.height/c)}this.projectionMatrix.makeOrthographic(n,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Object3D.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),DirectionalLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:DirectionalLightShadow}),DirectionalLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:DirectionalLight,isDirectionalLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),AmbientLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:AmbientLight,isAmbientLight:!0}),RectAreaLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:RectAreaLight,isRectAreaLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Light.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Object.assign(MaterialLoader.prototype,{load:function(e,t,i,r){var n=this,a=new FileLoader(n.manager);a.setPath(n.path),a.load(e,function(e){t(n.parse(JSON.parse(e)))},i,r)},parse:function(e){var t=this.textures;function i(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new Materials[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearCoat&&(r.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(r.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.vertexColors&&(r.vertexColors=e.vertexColors),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(r.morphNormals=e.morphNormals),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.uniforms)for(var n in e.uniforms){var a=e.uniforms[n];switch(r.uniforms[n]={},a.type){case"t":r.uniforms[n].value=i(a.value);break;case"c":r.uniforms[n].value=(new Color).setHex(a.value);break;case"v2":r.uniforms[n].value=(new Vector2).fromArray(a.value);break;case"v3":r.uniforms[n].value=(new Vector3).fromArray(a.value);break;case"v4":r.uniforms[n].value=(new Vector4).fromArray(a.value);break;case"m3":r.uniforms[n].value=(new Matrix3).fromArray(a.value);case"m4":r.uniforms[n].value=(new Matrix4).fromArray(a.value);break;default:r.uniforms[n].value=a.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var o in e.extensions)r.extensions[o]=e.extensions[o];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=i(e.map)),void 0!==e.matcap&&(r.matcap=i(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=i(e.alphaMap),r.transparent=!0),void 0!==e.bumpMap&&(r.bumpMap=i(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=i(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new Vector2).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=i(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=i(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=i(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=i(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=i(e.specularMap)),void 0!==e.envMap&&(r.envMap=i(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=i(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=i(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=i(e.gradientMap)),r},setPath:function(e){return this.path=e,this},setTextures:function(e){return this.textures=e,this}});var LoaderUtils={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch(e){return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function InstancedBufferGeometry(){BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function InstancedBufferAttribute(e,t,i,r){"number"==typeof i&&(r=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),BufferAttribute.call(this,e,t,i),this.meshPerAttribute=r||1}function BufferGeometryLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}InstancedBufferGeometry.prototype=Object.assign(Object.create(BufferGeometry.prototype),{constructor:InstancedBufferGeometry,isInstancedBufferGeometry:!0,copy:function(e){return BufferGeometry.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=BufferGeometry.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}}),InstancedBufferAttribute.prototype=Object.assign(Object.create(BufferAttribute.prototype),{constructor:InstancedBufferAttribute,isInstancedBufferAttribute:!0,copy:function(e){return BufferAttribute.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=BufferAttribute.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),Object.assign(BufferGeometryLoader.prototype,{load:function(e,t,i,r){var n=this,a=new FileLoader(n.manager);a.setPath(n.path),a.load(e,function(e){t(n.parse(JSON.parse(e)))},i,r)},parse:function(e){var t=e.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,i=e.data.index;if(void 0!==i){var r=new TYPED_ARRAYS[i.type](i.array);t.setIndex(new BufferAttribute(r,1))}var n=e.data.attributes;for(var a in n){var o=n[a],s=(r=new TYPED_ARRAYS[o.type](o.array),new(o.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute)(r,o.itemSize,o.normalized));void 0!==o.name&&(s.name=o.name),t.addAttribute(a,s)}var l=e.data.morphAttributes;if(l)for(var a in l){for(var c=l[a],h=[],u=0,d=c.length;u<d;u++){o=c[u],s=new BufferAttribute(r=new TYPED_ARRAYS[o.type](o.array),o.itemSize,o.normalized);void 0!==o.name&&(s.name=o.name),h.push(s)}t.morphAttributes[a]=h}var p=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==p){u=0;for(var m,f=p.length;u!==f;++u)m=p[u],t.addGroup(m.start,m.count,m.materialIndex)}var g=e.data.boundingSphere;if(void 0!==g){var v=new Vector3;void 0!==g.center&&v.fromArray(g.center),t.boundingSphere=new Sphere(v,g.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t},setPath:function(e){return this.path=e,this}});var TYPED_ARRAYS={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function ObjectLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager,this.resourcePath=""}Object.assign(ObjectLoader.prototype,{crossOrigin:"anonymous",load:function(e,t,i,r){var n=this,a=void 0===this.path?LoaderUtils.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;var o=new FileLoader(n.manager);o.setPath(this.path),o.load(e,function(i){var a=null;try{a=JSON.parse(i)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?n.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e)},i,r)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var i=this.parseShape(e.shapes),r=this.parseGeometries(e.geometries,i),n=this.parseImages(e.images,function(){void 0!==t&&t(s)}),a=this.parseTextures(e.textures,n),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,r,o);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var i,r=0,n=e.length;r<n;r++)t[(i=(new Shape).fromJSON(e[r])).uuid]=i;return t},parseGeometries:function(e,t){var i={};if(void 0!==e)for(var r=new BufferGeometryLoader,n=0,a=e.length;n<a;n++){var o,s=e[n];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new Geometries[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new Geometries[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new Geometries[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new Geometries[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new Geometries[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new Geometries[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new Geometries[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new Geometries[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new Geometries[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new Geometries[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new Geometries[s.type]((new Curves[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new Geometries[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new Geometries[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var l=[],c=0,h=s.shapes.length;c<h;c++)u=t[s.shapes[c]],l.push(u);o=new Geometries[s.type](l,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":var u;for(l=[],c=0,h=s.shapes.length;c<h;c++)u=t[s.shapes[c]],l.push(u);var d=s.options.extrudePath;void 0!==d&&(s.options.extrudePath=(new Curves[d.type]).fromJSON(d)),o=new Geometries[s.type](l,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE)o=(new THREE.LegacyJSONLoader).parse(s,this.resourcePath).geometry;else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),i[s.uuid]=o}return i},parseMaterials:function(e,t){var i={},r={};if(void 0!==e){var n=new MaterialLoader;n.setTextures(t);for(var a,o=0,s=e.length;o<s;o++)if("MultiMaterial"===(a=e[o]).type){for(var l,c=[],h=0;h<a.materials.length;h++)void 0===i[(l=a.materials[h]).uuid]&&(i[l.uuid]=n.parse(l)),c.push(i[l.uuid]);r[a.uuid]=c}else void 0===i[a.uuid]&&(i[a.uuid]=n.parse(a)),r[a.uuid]=i[a.uuid]}return r},parseAnimations:function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i],n=AnimationClip.parse(r);void 0!==r.uuid&&(n.uuid=r.uuid),t.push(n)}return t},parseImages:function(e,t){var i=this,r={};function n(e){return i.manager.itemStart(e),a.load(e,function(){i.manager.itemEnd(e)},void 0,function(){i.manager.itemError(e),i.manager.itemEnd(e)})}if(void 0!==e&&0<e.length){var a=new ImageLoader(new LoadingManager(t));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=e.length;o<s;o++){var l=e[o],c=l.url;if(Array.isArray(c)){r[l.uuid]=[];for(var h=0,u=c.length;h<u;h++){var d=c[h],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:i.resourcePath+d;r[l.uuid].push(n(p))}}else{p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:i.resourcePath+l.url;r[l.uuid]=n(p)}}}return r},parseTextures:function(e,t){function i(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var n,a=0,o=e.length;a<o;a++){var s;void 0===(n=e[a]).image&&console.warn('THREE.ObjectLoader: No "image" specified for',n.uuid),void 0===t[n.image]&&console.warn("THREE.ObjectLoader: Undefined image",n.image),(s=Array.isArray(t[n.image])?new CubeTexture(t[n.image]):new Texture(t[n.image])).needsUpdate=!0,s.uuid=n.uuid,void 0!==n.name&&(s.name=n.name),void 0!==n.mapping&&(s.mapping=i(n.mapping,TEXTURE_MAPPING)),void 0!==n.offset&&s.offset.fromArray(n.offset),void 0!==n.repeat&&s.repeat.fromArray(n.repeat),void 0!==n.center&&s.center.fromArray(n.center),void 0!==n.rotation&&(s.rotation=n.rotation),void 0!==n.wrap&&(s.wrapS=i(n.wrap[0],TEXTURE_WRAPPING),s.wrapT=i(n.wrap[1],TEXTURE_WRAPPING)),void 0!==n.format&&(s.format=n.format),void 0!==n.type&&(s.type=n.type),void 0!==n.encoding&&(s.encoding=n.encoding),void 0!==n.minFilter&&(s.minFilter=i(n.minFilter,TEXTURE_FILTER)),void 0!==n.magFilter&&(s.magFilter=i(n.magFilter,TEXTURE_FILTER)),void 0!==n.anisotropy&&(s.anisotropy=n.anisotropy),void 0!==n.flipY&&(s.flipY=n.flipY),void 0!==n.premultiplyAlpha&&(s.premultiplyAlpha=n.premultiplyAlpha),void 0!==n.unpackAlignment&&(s.unpackAlignment=n.unpackAlignment),r[n.uuid]=s}return r},parseObject:function(e,t,i){var r;function n(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function a(e){if(void 0!==e){if(Array.isArray(e)){for(var t,r=[],n=0,a=e.length;n<a;n++)t=e[n],void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),r.push(i[t]);return r}return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),i[e]}}switch(e.type){case"Scene":r=new Scene,void 0!==e.background&&Number.isInteger(e.background)&&(r.background=new Color(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?r.fog=new Fog(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(r.fog=new FogExp2(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new PerspectiveCamera(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(r.focus=e.focus),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.filmGauge&&(r.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(r.filmOffset=e.filmOffset),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new AmbientLight(e.color,e.intensity);break;case"DirectionalLight":r=new DirectionalLight(e.color,e.intensity);break;case"PointLight":r=new PointLight(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new RectAreaLight(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new SpotLight(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new HemisphereLight(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=n(e.geometry),s=a(e.material);r=o.bones&&0<o.bones.length?new SkinnedMesh(o,s):new Mesh(o,s),void 0!==e.drawMode&&r.setDrawMode(e.drawMode);break;case"LOD":r=new LOD;break;case"Line":r=new Line(n(e.geometry),a(e.material),e.mode);break;case"LineLoop":r=new LineLoop(n(e.geometry),a(e.material));break;case"LineSegments":r=new LineSegments(n(e.geometry),a(e.material));break;case"PointCloud":case"Points":r=new Points(n(e.geometry),a(e.material));break;case"Sprite":r=new Sprite(a(e.material));break;case"Group":r=new Group;break;default:r=new Object3D}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(r.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(r.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(r.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&r.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(r.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.frustumCulled&&(r.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(r.renderOrder=e.renderOrder),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.layers&&(r.layers.mask=e.layers),void 0!==e.children)for(var l=e.children,c=0;c<l.length;c++)r.add(this.parseObject(l[c],t,i));if("LOD"===e.type)for(var h=e.levels,u=0;u<h.length;u++){var d=h[u],p=r.getObjectByProperty("uuid",d.object);void 0!==p&&r.addLevel(p,d.distance)}return r}});var TEXTURE_MAPPING={UVMapping:UVMapping,CubeReflectionMapping:CubeReflectionMapping,CubeRefractionMapping:CubeRefractionMapping,EquirectangularReflectionMapping:EquirectangularReflectionMapping,EquirectangularRefractionMapping:EquirectangularRefractionMapping,SphericalReflectionMapping:SphericalReflectionMapping,CubeUVReflectionMapping:CubeUVReflectionMapping,CubeUVRefractionMapping:CubeUVRefractionMapping},TEXTURE_WRAPPING={RepeatWrapping:RepeatWrapping,ClampToEdgeWrapping:ClampToEdgeWrapping,MirroredRepeatWrapping:MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter:NearestFilter,NearestMipMapNearestFilter:NearestMipMapNearestFilter,NearestMipMapLinearFilter:NearestMipMapLinearFilter,LinearFilter:LinearFilter,LinearMipMapNearestFilter:LinearMipMapNearestFilter,LinearMipMapLinearFilter:LinearMipMapLinearFilter};function ImageBitmapLoader(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:DefaultLoadingManager,this.options=void 0}function ShapePath(){this.type="ShapePath",this.color=new Color,this.subPaths=[],this.currentPath=null}function Font(e){this.type="Font",this.data=e}function createPaths(e,t,i){for(var r,n=Array.from?Array.from(e):(e+"").split(""),a=t/i.resolution,o=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*a,s=[],l=0,c=0,h=0;h<n.length;h++)if("\n"===(r=n[h]))l=0,c-=o;else{var u=createPath(r,a,l,c,i);l+=u.offsetX,s.push(u.path)}return s}function createPath(e,t,i,r,n){var a=n.glyphs[e]||n.glyphs["?"];if(a){var o,s,l,c,h,u,d,p,m=new ShapePath;if(a.o)for(var f=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,v=f.length;g<v;)switch(f[g++]){case"m":o=f[g++]*t+i,s=f[g++]*t+r,m.moveTo(o,s);break;case"l":o=f[g++]*t+i,s=f[g++]*t+r,m.lineTo(o,s);break;case"q":l=f[g++]*t+i,c=f[g++]*t+r,h=f[g++]*t+i,u=f[g++]*t+r,m.quadraticCurveTo(h,u,l,c);break;case"b":l=f[g++]*t+i,c=f[g++]*t+r,h=f[g++]*t+i,u=f[g++]*t+r,d=f[g++]*t+i,p=f[g++]*t+r,m.bezierCurveTo(h,u,d,p,l,c)}return{offsetX:a.ha*t,path:m}}}function FontLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function Loader(){}ImageBitmapLoader.prototype={constructor:ImageBitmapLoader,setOptions:function(e){return this.options=e,this},load:function(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var n=this,a=Cache.get(e);if(void 0!==a)return n.manager.itemStart(e),setTimeout(function(){t&&t(a),n.manager.itemEnd(e)},0),a;fetch(e).then(function(e){return e.blob()}).then(function(e){return void 0===n.options?createImageBitmap(e):createImageBitmap(e,n.options)}).then(function(i){Cache.add(e,i),t&&t(i),n.manager.itemEnd(e)}).catch(function(t){r&&r(t),n.manager.itemError(e),n.manager.itemEnd(e)}),n.manager.itemStart(e)},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(ShapePath.prototype,{moveTo:function(e,t){this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,i,r){this.currentPath.quadraticCurveTo(e,t,i,r)},bezierCurveTo:function(e,t,i,r,n,a){this.currentPath.bezierCurveTo(e,t,i,r,n,a)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function i(e){for(var t=[],i=0,r=e.length;i<r;i++){var n=e[i],a=new Shape;a.curves=n.curves,t.push(a)}return t}function r(e,t){for(var i=t.length,r=!1,n=i-1,a=0;a<i;n=a++){var o=t[n],s=t[a],l=s.x-o.x,c=s.y-o.y;if(Math.abs(c)>Number.EPSILON){if(0>c&&(o=t[a],l=-l,s=t[n],c=-c),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var h=c*(e.x-o.x)-l*(e.y-o.y);if(0===h)return!0;if(0>h)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var n=ShapeUtils.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===t)return i(a);var o,s,l,c=[];if(1===a.length)return s=a[0],(l=new Shape).curves=s.curves,c.push(l),c;var h=!n(a[0].getPoints());h=e?!h:h;var u,d=[],p=[],m=[],f=0;p[f]=void 0,m[f]=[];for(var g=0,v=a.length;g<v;g++)o=n(u=(s=a[g]).getPoints()),(o=e?!o:o)?(!h&&p[f]&&f++,p[f]={s:new Shape,p:u},p[f].s.curves=s.curves,h&&f++,m[f]=[]):m[f].push({h:s,p:u[0]});if(!p[0])return i(a);if(1<p.length){for(var y=!1,b=[],_=0,x=p.length;_<x;_++)d[_]=[];var w;for(_=0,x=p.length;_<x;_++){w=m[_];for(var S=0;S<w.length;S++){for(var T=w[S],A=!0,E=0;E<p.length;E++)r(T.p,p[E].p)&&(_!==E&&b.push({froms:_,tos:E,hole:S}),A?(A=!1,d[E].push(T)):y=!0);A&&d[_].push(T)}}0<b.length&&(y||(m=d))}g=0;for(var C,M=p.length;g<M;g++){l=p[g].s,c.push(l);for(var P=0,L=(C=m[g]).length;P<L;P++)l.holes.push(C[P].h)}return c}}),Object.assign(Font.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var i=[],r=createPaths(e,t,this.data),n=0,a=r.length;n<a;n++)Array.prototype.push.apply(i,r[n].toShapes());return i}}),Object.assign(FontLoader.prototype,{load:function(e,t,i,r){var n=this,a=new FileLoader(this.manager);a.setPath(this.path),a.load(e,function(e){var i;try{i=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(e.substring(65,e.length-2))}var r=n.parse(i);t&&t(r)},i,r)},parse:function(e){return new Font(e)},setPath:function(e){return this.path=e,this}}),Loader.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,i=0,r=t.length;i<r;i+=2){var n=t[i],a=t[i+1];if(n.test(e))return a}return null}},Object.assign(Loader.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,i){for(var r=[],n=0;n<e.length;++n)r[n]=this.createMaterial(e[n],t,i);return r},createMaterial:function(){var e={NoBlending:NoBlending,NormalBlending:NormalBlending,AdditiveBlending:AdditiveBlending,SubtractiveBlending:SubtractiveBlending,MultiplyBlending:MultiplyBlending,CustomBlending:CustomBlending},t=new Color,i=new TextureLoader,r=new MaterialLoader;return function(n,a,o){var s={};function l(e,t,r,n,l){var c,h=a+e,u=Loader.Handlers.get(h);null!==u?c=u.load(h):(i.setCrossOrigin(o),c=i.load(h)),void 0!==t&&(c.repeat.fromArray(t),1!==t[0]&&(c.wrapS=RepeatWrapping),1!==t[1]&&(c.wrapT=RepeatWrapping)),void 0!==r&&c.offset.fromArray(r),void 0!==n&&("repeat"===n[0]&&(c.wrapS=RepeatWrapping),"mirror"===n[0]&&(c.wrapS=MirroredRepeatWrapping),"repeat"===n[1]&&(c.wrapT=RepeatWrapping),"mirror"===n[1]&&(c.wrapT=MirroredRepeatWrapping)),void 0!==l&&(c.anisotropy=l);var d=_Math.generateUUID();return s[d]=c,d}var c={uuid:_Math.generateUUID(),type:"MeshLambertMaterial"};for(var h in n){var u=n[h];switch(h){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":c.name=u;break;case"blending":c.blending=e[u];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",h,"is no longer supported.");break;case"colorDiffuse":c.color=t.fromArray(u).getHex();break;case"colorSpecular":c.specular=t.fromArray(u).getHex();break;case"colorEmissive":c.emissive=t.fromArray(u).getHex();break;case"specularCoef":c.shininess=u;break;case"shading":"basic"===u.toLowerCase()&&(c.type="MeshBasicMaterial"),"phong"===u.toLowerCase()&&(c.type="MeshPhongMaterial"),"standard"===u.toLowerCase()&&(c.type="MeshStandardMaterial");break;case"mapDiffuse":c.map=l(u,n.mapDiffuseRepeat,n.mapDiffuseOffset,n.mapDiffuseWrap,n.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":c.emissiveMap=l(u,n.mapEmissiveRepeat,n.mapEmissiveOffset,n.mapEmissiveWrap,n.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":c.lightMap=l(u,n.mapLightRepeat,n.mapLightOffset,n.mapLightWrap,n.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":c.aoMap=l(u,n.mapAORepeat,n.mapAOOffset,n.mapAOWrap,n.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":c.bumpMap=l(u,n.mapBumpRepeat,n.mapBumpOffset,n.mapBumpWrap,n.mapBumpAnisotropy);break;case"mapBumpScale":c.bumpScale=u;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":c.normalMap=l(u,n.mapNormalRepeat,n.mapNormalOffset,n.mapNormalWrap,n.mapNormalAnisotropy);break;case"mapNormalFactor":c.normalScale=u;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":c.specularMap=l(u,n.mapSpecularRepeat,n.mapSpecularOffset,n.mapSpecularWrap,n.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":c.metalnessMap=l(u,n.mapMetalnessRepeat,n.mapMetalnessOffset,n.mapMetalnessWrap,n.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":c.roughnessMap=l(u,n.mapRoughnessRepeat,n.mapRoughnessOffset,n.mapRoughnessWrap,n.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":c.alphaMap=l(u,n.mapAlphaRepeat,n.mapAlphaOffset,n.mapAlphaWrap,n.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":c.side=BackSide;break;case"doubleSided":c.side=DoubleSide;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),c.opacity=u;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":c[h]=u;break;case"vertexColors":!0===u&&(c.vertexColors=VertexColors),"face"===u&&(c.vertexColors=FaceColors);break;default:console.error("THREE.Loader.createMaterial: Unsupported",h,u)}}return"MeshBasicMaterial"===c.type&&delete c.emissive,"MeshPhongMaterial"!==c.type&&delete c.specular,1>c.opacity&&(c.transparent=!0),r.setTextures(s),r.parse(c)}}()});var context,AudioContext={getContext:function(){return void 0===context&&(context=new(window.AudioContext||window.webkitAudioContext)),context},setContext:function(e){context=e}};function AudioLoader(e){this.manager=void 0!==e?e:DefaultLoadingManager}function SphericalHarmonics3(){this.coefficients=[];for(var e=0;9>e;e++)this.coefficients.push(new Vector3)}function LightProbe(e,t){Light.call(this,void 0,t),this.sh=void 0!==e?e:new SphericalHarmonics3}function HemisphereLightProbe(e,t,i){LightProbe.call(this,void 0,i);var r=(new Color).set(e),n=(new Color).set(t),a=new Vector3(r.r,r.g,r.b),o=new Vector3(n.r,n.g,n.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(l)}function AmbientLightProbe(e,t){LightProbe.call(this,void 0,t);var i=(new Color).set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}function StereoCamera(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Clock(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function AudioListener(){Object3D.call(this),this.type="AudioListener",this.context=AudioContext.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function Audio$1(e){Object3D.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function PositionalAudio(e){Audio$1.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function AudioAnalyser(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function PropertyMixer(e,t,i){this.binding=e,this.valueSize=i;var r,n=Float64Array;switch(t){case"quaternion":r=this._slerp;break;case"string":case"bool":n=Array,r=this._select;break;default:r=this._lerp}this.buffer=new n(4*i),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(AudioLoader.prototype,{load:function(e,t,i,r){var n=new FileLoader(this.manager);n.setResponseType("arraybuffer"),n.setPath(this.path),n.load(e,function(e){var i=e.slice(0);AudioContext.getContext().decodeAudioData(i,function(e){t(e)})},i,r)},setPath:function(e){return this.path=e,this}}),Object.assign(SphericalHarmonics3.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;9>t;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;9>e;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var i=e.x,r=e.y,n=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScale(a[1],.488603*r),t.addScale(a[2],.488603*n),t.addScale(a[3],.488603*i),t.addScale(a[4],i*r*1.092548),t.addScale(a[5],r*n*1.092548),t.addScale(a[6],.315392*(3*n*n-1)),t.addScale(a[7],i*n*1.092548),t.addScale(a[8],.546274*(i*i-r*r)),t},getIrradianceAt:function(e,t){var i=e.x,r=e.y,n=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScale(a[1],1.023328*r),t.addScale(a[2],1.023328*n),t.addScale(a[3],1.023328*i),t.addScale(a[4],.858086*i*r),t.addScale(a[5],.858086*r*n),t.addScale(a[6],.743125*n*n-.247708),t.addScale(a[7],.858086*i*n),t.addScale(a[8],.429043*(i*i-r*r)),t},add:function(e){for(var t=0;9>t;t++)this.coefficients[t].add(e.coefficients[t]);return this},scale:function(e){for(var t=0;9>t;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var i=0;9>i;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this},equals:function(e){for(var t=0;9>t;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e){for(var t=this.coefficients,i=0;9>i;i++)t[i].fromArray(e,3*i);return this},toArray:function(){for(var e=[],t=this.coefficients,i=0;9>i;i++)t[i].toArray(e,3*i);return e}}),Object.assign(SphericalHarmonics3,{getBasisAt:function(e,t){var i=e.x,r=e.y,n=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*n,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*n,t[6]=.315392*(3*n*n-1),t[7]=1.092548*i*n,t[8]=.546274*(i*i-r*r)}}),LightProbe.prototype=Object.assign(Object.create(Light.prototype),{constructor:LightProbe,isLightProbe:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return Light.prototype.toJSON.call(this,e)}}),HemisphereLightProbe.prototype=Object.assign(Object.create(LightProbe.prototype),{constructor:HemisphereLightProbe,isHemisphereLightProbe:!0,copy:function(e){return LightProbe.prototype.copy.call(this,e),this},toJSON:function(e){return LightProbe.prototype.toJSON.call(this,e)}}),AmbientLightProbe.prototype=Object.assign(Object.create(LightProbe.prototype),{constructor:AmbientLightProbe,isAmbientLightProbe:!0,copy:function(e){return LightProbe.prototype.copy.call(this,e),this},toJSON:function(e){return LightProbe.prototype.toJSON.call(this,e)}}),Object.assign(StereoCamera.prototype,{update:function(){var e,t,i,r,n,a,o,s,l=new Matrix4,c=new Matrix4;return function(h){if(e!==this||t!==h.focus||i!==h.fov||r!==h.aspect*this.aspect||n!==h.near||a!==h.far||o!==h.zoom||s!==this.eyeSep){e=this,t=h.focus,i=h.fov,r=h.aspect*this.aspect,n=h.near,a=h.far,o=h.zoom;var u,d,p=h.projectionMatrix.clone(),m=(s=this.eyeSep/2)*n/t,f=n*Math.tan(_Math.DEG2RAD*i*.5)/o;c.elements[12]=-s,l.elements[12]=s,u=-f*r+m,d=f*r+m,p.elements[0]=2*n/(d-u),p.elements[8]=(d+u)/(d-u),this.cameraL.projectionMatrix.copy(p),u=-f*r-m,d=f*r-m,p.elements[0]=2*n/(d-u),p.elements[8]=(d+u)/(d-u),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(h.matrixWorld).multiply(c),this.cameraR.matrixWorld.copy(h.matrixWorld).multiply(l)}}()}),Object.assign(Clock.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),AudioListener.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:AudioListener,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(){var e=new Vector3,t=new Quaternion,i=new Vector3,r=new Vector3,n=new Clock;return function(a){Object3D.prototype.updateMatrixWorld.call(this,a);var o=this.context.listener,s=this.up;if(this.timeDelta=n.getDelta(),this.matrixWorld.decompose(e,t,i),r.set(0,0,-1).applyQuaternion(t),o.positionX){var l=this.context.currentTime+this.timeDelta;o.positionX.linearRampToValueAtTime(e.x,l),o.positionY.linearRampToValueAtTime(e.y,l),o.positionZ.linearRampToValueAtTime(e.z,l),o.forwardX.linearRampToValueAtTime(r.x,l),o.forwardY.linearRampToValueAtTime(r.y,l),o.forwardZ.linearRampToValueAtTime(r.z,l),o.upX.linearRampToValueAtTime(s.x,l),o.upY.linearRampToValueAtTime(s.y,l),o.upZ.linearRampToValueAtTime(s.z,l)}else o.setPosition(e.x,e.y,e.z),o.setOrientation(r.x,r.y,r.z,s.x,s.y,s.z)}}()}),Audio$1.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Audio$1,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),PositionalAudio.prototype=Object.assign(Object.create(Audio$1.prototype),{constructor:PositionalAudio,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this},updateMatrixWorld:function(){var e=new Vector3,t=new Quaternion,i=new Vector3,r=new Vector3;return function(n){if(Object3D.prototype.updateMatrixWorld.call(this,n),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(e,t,i),r.set(0,0,1).applyQuaternion(t);var a=this.panner;if(a.positionX){var o=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(e.x,o),a.positionY.linearRampToValueAtTime(e.y,o),a.positionZ.linearRampToValueAtTime(e.z,o),a.orientationX.linearRampToValueAtTime(r.x,o),a.orientationY.linearRampToValueAtTime(r.y,o),a.orientationZ.linearRampToValueAtTime(r.z,o)}else a.setPosition(e.x,e.y,e.z),a.setOrientation(r.x,r.y,r.z)}}}()}),Object.assign(AudioAnalyser.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),i=0;i<t.length;i++)e+=t[i];return e/t.length}}),Object.assign(PropertyMixer.prototype,{accumulate:function(e,t){var i=this.buffer,r=this.valueSize,n=e*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)i[n+o]=i[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(i,n,0,s,r)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,i=this.buffer,r=e*t+t,n=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,1>n){var o=3*t;this._mixBufferRegion(i,r,o,1-n,t)}for(var s=t,l=t+t;s!==l;++s)if(i[s]!==i[s+t]){a.setValue(i,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,i=this.valueSize,r=3*i;e.getValue(t,r);for(var n=i,a=r;n!==a;++n)t[n]=t[r+n%i];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,i,r,n){if(.5<=r)for(var a=0;a!==n;++a)e[t+a]=e[i+a]},_slerp:function(e,t,i,r){Quaternion.slerpFlat(e,t,e,t,e,i,r)},_lerp:function(e,t,i,r,n){for(var a,o=1-r,s=0;s!==n;++s)e[a=t+s]=e[a]*o+e[i+s]*r}});var lineGeometry,coneGeometry,RESERVED_CHARS_RE="\\[\\]\\.:\\/";function Composite(e,t,i){var r=i||PropertyBinding.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function PropertyBinding(e,t,i){this.path=t,this.parsedPath=i||PropertyBinding.parseTrackName(t),this.node=PropertyBinding.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function AnimationObjectGroup(){this.uuid=_Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,i=arguments.length;t!==i;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function AnimationAction(e,t,i){this._mixer=e,this._clip=t,this._localRoot=i||null;for(var r,n=t.tracks,a=n.length,o=Array(a),s={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding},l=0;l!==a;++l)r=n[l].createInterpolant(null),o[l]=r,r.settings=s;this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function AnimationMixer(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Uniform(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function InstancedInterleavedBuffer(e,t,i){InterleavedBuffer.call(this,e,t),this.meshPerAttribute=i||1}function Raycaster(e,t,i,r){this.ray=new Ray(e,t),this.near=i||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function ascSort(e,t){return e.distance-t.distance}function intersectObject(e,t,i,r){if(!1!==e.visible&&(e.raycast(t,i),!0===r))for(var n=e.children,a=0,o=n.length;a<o;a++)intersectObject(n[a],t,i,!0)}function Spherical(e,t,i){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==i?i:0,this}function Cylindrical(e,t,i){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==i?i:0,this}function Box2(e,t){this.min=void 0!==e?e:new Vector2(1/0,1/0),this.max=void 0!==t?t:new Vector2(-1/0,-1/0)}function Line3(e,t){this.start=void 0!==e?e:new Vector3,this.end=void 0!==t?t:new Vector3}function ImmediateRenderObject(e){Object3D.call(this),this.material=e,this.render=function(){}}function VertexNormalsHelper(e,t,i,r){this.object=e,this.size=void 0!==t?t:1;var n=void 0!==i?i:16711680,a=void 0!==r?r:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=3*s.faces.length:s&&s.isBufferGeometry&&(o=s.attributes.normal.count);var l=new BufferGeometry,c=new Float32BufferAttribute(2*o*3,3);l.addAttribute("position",c),LineSegments.call(this,l,new LineBasicMaterial({color:n,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function SpotLightHelper(e,t){Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var i=new BufferGeometry,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],n=0,a=1;n<32;n++,a++){var o=n/32*Math.PI*2,s=a/32*Math.PI*2;r.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}i.addAttribute("position",new Float32BufferAttribute(r,3));var l=new LineBasicMaterial({fog:!1});this.cone=new LineSegments(i,l),this.add(this.cone),this.update()}function getBoneList(e){var t=[];e&&e.isBone&&t.push(e);for(var i=0;i<e.children.length;i++)t.push.apply(t,getBoneList(e.children[i]));return t}function SkeletonHelper(e){for(var t,i=getBoneList(e),r=new BufferGeometry,n=[],a=[],o=new Color(0,0,1),s=new Color(0,1,0),l=0;l<i.length;l++)(t=i[l]).parent&&t.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),a.push(o.r,o.g,o.b),a.push(s.r,s.g,s.b));r.addAttribute("position",new Float32BufferAttribute(n,3)),r.addAttribute("color",new Float32BufferAttribute(a,3));var c=new LineBasicMaterial({vertexColors:VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});LineSegments.call(this,r,c),this.root=e,this.bones=i,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function PointLightHelper(e,t,i){this.light=e,this.light.updateMatrixWorld(),this.color=i;var r=new SphereBufferGeometry(t,4,2),n=new MeshBasicMaterial({wireframe:!0,fog:!1});Mesh.call(this,r,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function RectAreaLightHelper(e,t){this.type="RectAreaLightHelper",this.light=e,this.color=t;var i=new BufferGeometry;i.addAttribute("position",new Float32BufferAttribute([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),i.computeBoundingSphere();var r=new LineBasicMaterial({fog:!1});Line.call(this,i,r);var n=new BufferGeometry;n.addAttribute("position",new Float32BufferAttribute([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),n.computeBoundingSphere(),this.add(new Mesh(n,new MeshBasicMaterial({side:BackSide,fog:!1}))),this.update()}function HemisphereLightHelper(e,t,i){Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;var r=new OctahedronBufferGeometry(t);r.rotateY(.5*Math.PI),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=VertexColors);var n=r.getAttribute("position"),a=new Float32Array(3*n.count);r.addAttribute("color",new BufferAttribute(a,3)),this.add(new Mesh(r,this.material)),this.update()}function LightProbeHelper(e,t){this.lightProbe=e,this.size=t;var i=new ShaderMaterial({defines:{GAMMA_OUTPUT:""},uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:["varying vec3 vNormal;","void main() {","\tvNormal = normalize( normalMatrix * normal );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI 0.318309886","vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {","\t// matrix is assumed to be orthogonal","\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );","}","vec3 linearToOutput( in vec3 a ) {","\t#ifdef GAMMA_OUTPUT","\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );","\t#else","\t\treturn a;","\t#endif","}","// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf","vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {","\t// normal is assumed to have unit length","\tfloat x = normal.x, y = normal.y, z = normal.z;","\t// band 0","\tvec3 result = shCoefficients[ 0 ] * 0.886227;","\t// band 1","\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;","\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;","\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;","\t// band 2","\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;","\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;","\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );","\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;","\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );","\treturn result;","}","uniform vec3 sh[ 9 ]; // sh coefficients","uniform float intensity; // light probe intensity","varying vec3 vNormal;","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );","\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;","\toutgoingLight = linearToOutput( outgoingLight );","\tgl_FragColor = vec4( outgoingLight, 1.0 );","}"].join("\n")}),r=new SphereBufferGeometry(1,32,16);Mesh.call(this,r,i),this.onBeforeRender()}function GridHelper(e,t,i,r){e=e||10,t=t||10,i=new Color(void 0!==i?i:4473924),r=new Color(void 0!==r?r:8947848);for(var n=t/2,a=e/t,o=e/2,s=[],l=[],c=0,h=0,u=-o;c<=t;c++,u+=a){s.push(-o,0,u,o,0,u),s.push(u,0,-o,u,0,o);var d=c===n?i:r;d.toArray(l,h),h+=3,d.toArray(l,h),h+=3,d.toArray(l,h),h+=3,d.toArray(l,h),h+=3}var p=new BufferGeometry;p.addAttribute("position",new Float32BufferAttribute(s,3)),p.addAttribute("color",new Float32BufferAttribute(l,3));var m=new LineBasicMaterial({vertexColors:VertexColors});LineSegments.call(this,p,m)}function PolarGridHelper(e,t,i,r,n,a){e=e||10,t=t||16,i=i||8,r=r||64,n=new Color(void 0!==n?n:4473924),a=new Color(void 0!==a?a:8947848);var o,s,l,c,h,u,d,p=[],m=[];for(c=0;c<=t;c++)l=c/t*(2*Math.PI),o=Math.sin(l)*e,s=Math.cos(l)*e,p.push(0,0,0),p.push(o,0,s),d=1&c?n:a,m.push(d.r,d.g,d.b),m.push(d.r,d.g,d.b);for(c=0;c<=i;c++)for(d=1&c?n:a,u=e-e/i*c,h=0;h<r;h++)l=h/r*(2*Math.PI),o=Math.sin(l)*u,s=Math.cos(l)*u,p.push(o,0,s),m.push(d.r,d.g,d.b),l=(h+1)/r*(2*Math.PI),o=Math.sin(l)*u,s=Math.cos(l)*u,p.push(o,0,s),m.push(d.r,d.g,d.b);var f=new BufferGeometry;f.addAttribute("position",new Float32BufferAttribute(p,3)),f.addAttribute("color",new Float32BufferAttribute(m,3));var g=new LineBasicMaterial({vertexColors:VertexColors});LineSegments.call(this,f,g)}function PositionalAudioHelper(e,t,i,r){this.audio=e,this.range=t||1,this.divisionsInnerAngle=i||16,this.divisionsOuterAngle=r||2;var n=new BufferGeometry,a=this.divisionsInnerAngle+2*this.divisionsOuterAngle,o=new Float32Array(3*(3*a+3));n.addAttribute("position",new BufferAttribute(o,3));var s=new LineBasicMaterial({color:65280}),l=new LineBasicMaterial({color:16776960});Line.call(this,n,[l,s]),this.update()}function FaceNormalsHelper(e,t,i,r){this.object=e,this.size=void 0!==t?t:1;var n=void 0!==i?i:16776960,a=void 0!==r?r:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new BufferGeometry,c=new Float32BufferAttribute(2*o*3,3);l.addAttribute("position",c),LineSegments.call(this,l,new LineBasicMaterial({color:n,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function DirectionalLightHelper(e,t,i){Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,void 0===t&&(t=1);var r=new BufferGeometry;r.addAttribute("position",new Float32BufferAttribute([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var n=new LineBasicMaterial({fog:!1});this.lightPlane=new Line(r,n),this.add(this.lightPlane),(r=new BufferGeometry).addAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line(r,n),this.add(this.targetLine),this.update()}function CameraHelper(e){var t=new BufferGeometry,i=new LineBasicMaterial({color:16777215,vertexColors:FaceColors}),r=[],n=[],a={},o=new Color(16755200),s=new Color(16711680),l=new Color(43775),c=new Color(16777215),h=new Color(3355443);function u(e,t,i){d(e,i),d(t,i)}function d(e,t){r.push(0,0,0),n.push(t.r,t.g,t.b),void 0===a[e]&&(a[e]=[]),a[e].push(r.length/3-1)}u("n1","n2",o),u("n2","n4",o),u("n4","n3",o),u("n3","n1",o),u("f1","f2",o),u("f2","f4",o),u("f4","f3",o),u("f3","f1",o),u("n1","f1",o),u("n2","f2",o),u("n3","f3",o),u("n4","f4",o),u("p","n1",s),u("p","n2",s),u("p","n3",s),u("p","n4",s),u("u1","u2",l),u("u2","u3",l),u("u3","u1",l),u("c","t",c),u("p","c",h),u("cn1","cn2",h),u("cn3","cn4",h),u("cf1","cf2",h),u("cf3","cf4",h),t.addAttribute("position",new Float32BufferAttribute(r,3)),t.addAttribute("color",new Float32BufferAttribute(n,3)),LineSegments.call(this,t,i),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function BoxHelper(e,t){this.object=e,void 0===t&&(t=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),n=new BufferGeometry;n.setIndex(new BufferAttribute(i,1)),n.addAttribute("position",new BufferAttribute(r,3)),LineSegments.call(this,n,new LineBasicMaterial({color:t})),this.matrixAutoUpdate=!1,this.update()}function Box3Helper(e,t){this.type="Box3Helper",this.box=e,t=t||16776960;var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new BufferGeometry;r.setIndex(new BufferAttribute(i,1)),r.addAttribute("position",new Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),LineSegments.call(this,r,new LineBasicMaterial({color:t})),this.geometry.computeBoundingSphere()}function PlaneHelper(e,t,i){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var r=void 0!==i?i:16776960,n=new BufferGeometry;n.addAttribute("position",new Float32BufferAttribute([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),n.computeBoundingSphere(),Line.call(this,n,new LineBasicMaterial({color:r}));var a=new BufferGeometry;a.addAttribute("position",new Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new Mesh(a,new MeshBasicMaterial({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function ArrowHelper(e,t,i,r,n,a){Object3D.call(this),void 0===e&&(e=new Vector3(0,0,1)),void 0===t&&(t=new Vector3(0,0,0)),void 0===i&&(i=1),void 0===r&&(r=16776960),void 0===n&&(n=.2*i),void 0===a&&(a=.2*n),void 0===lineGeometry&&((lineGeometry=new BufferGeometry).addAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),(coneGeometry=new CylinderBufferGeometry(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Line(lineGeometry,new LineBasicMaterial({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(coneGeometry,new MeshBasicMaterial({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,n,a)}function AxesHelper(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=new BufferGeometry;i.addAttribute("position",new Float32BufferAttribute(t,3)),i.addAttribute("color",new Float32BufferAttribute([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new LineBasicMaterial({vertexColors:VertexColors});LineSegments.call(this,i,r)}function Face4(e,t,i,r,n,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Face3(e,t,i,n,a,o)}Object.assign(Composite.prototype,{getValue:function(e,t){this.bind();var i=this._targetGroup.nCachedObjects_,r=this._bindings[i];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var i=this._bindings,r=this._targetGroup.nCachedObjects_,n=i.length;r!==n;++r)i[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}),Object.assign(PropertyBinding,{Composite:Composite,create:function(e,t,i){return e&&e.isAnimationObjectGroup?new PropertyBinding.Composite(e,t,i):new PropertyBinding(e,t,i)},sanitizeNodeName:function(){var e=/[\[\]\.:\/]/g;return function(t){return t.replace(/\s/g,"_").replace(e,"")}}(),parseTrackName:function(){var e="[^"+RESERVED_CHARS_RE+"]",t="[^"+RESERVED_CHARS_RE.replace("\\.","")+"]",i=/((?:WC+[\/:])*)/.source.replace("WC",e),r=/(WCOD+)?/.source.replace("WCOD",t),n=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",e),a=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",e),o=new RegExp("^"+i+r+n+a+"$"),s=["material","materials","bones"];return function(e){var t=o.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var n=i.nodeName.substring(r+1);-1!==s.indexOf(n)&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=n)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}}(),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var i=e.skeleton.getBoneByName(t);if(void 0!==i)return i}if(e.children){var r=function(e){for(var i,n=0;n<e.length;n++){if((i=e[n]).name===t||i.uuid===t)return i;var a=r(i.children);if(a)return a}return null},n=r(e.children);if(n)return n}return null}}),Object.assign(PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)e[t++]=i[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=e[t++]},function(e,t){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var i=this.resolvedProperty,r=0,n=i.length;r!==n;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,i=t.objectName,r=t.propertyName,n=t.propertyIndex;if(e||(e=PropertyBinding.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(i){var a=t.objectIndex;switch(i){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(void 0===e[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[i]}if(void 0!==a){if(void 0===e[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[a]}}var s=e[r];if(void 0!==s){var l=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==n){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(e.geometry.morphAttributes.position[o].name===n){n=o;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(e.geometry.morphTargets[o].name===n){n=o;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else{var h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(PropertyBinding.prototype,{_getValue_unbound:PropertyBinding.prototype.getValue,_setValue_unbound:PropertyBinding.prototype.setValue}),Object.assign(AnimationObjectGroup.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,i=this.nCachedObjects_,r=this._indicesByUUID,n=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,l=void 0,c=0,h=arguments.length;c!==h;++c){var u=arguments[c],d=u.uuid,p=r[d];if(void 0===p){p=t++,r[d]=p,e.push(u);for(var m=0,f=s;m!==f;++m)o[m].push(new PropertyBinding(u,n[m],a[m]))}else if(p<i){l=e[p];var g=--i,v=e[g];r[v.uuid]=p,e[p]=v,r[d]=g,e[g]=u;for(m=0,f=s;m!==f;++m){var y=o[m],b=y[g],_=y[p];y[p]=b,void 0===_&&(_=new PropertyBinding(u,n[m],a[m])),y[g]=_}}else e[p]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,i=this._indicesByUUID,r=this._bindings,n=r.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,c=i[l];if(void 0!==c&&c>=t){var h=t++,u=e[h];i[u.uuid]=c,e[c]=u,i[l]=h,e[h]=s;for(var d=0,p=n;d!==p;++d){var m=r[d],f=m[h],g=m[c];m[c]=f,m[h]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,i=this.nCachedObjects_,r=this._indicesByUUID,n=this._bindings,a=n.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o].uuid,c=r[l];if(void 0!==c)if(delete r[l],c<i){var h=--i,u=e[h],d=e[v=--t];r[u.uuid]=c,e[c]=u,r[d.uuid]=h,e[h]=d,e.pop();for(var p=0,m=a;p!==m;++p){var f=(y=n[p])[h],g=y[v];y[c]=f,y[h]=g,y.pop()}}else{var v;r[(d=e[v=--t]).uuid]=c,e[c]=d,e.pop();var y;for(p=0,m=a;p!==m;++p)(y=n[p])[c]=y[v],y.pop()}}this.nCachedObjects_=i},subscribe_:function(e,t){var i=this._bindingsIndicesByPath,r=i[e],n=this._bindings;if(void 0!==r)return n[r];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,h=Array(l);r=n.length,i[e]=r,a.push(e),o.push(t),n.push(h);for(var u,d=c,p=s.length;d!==p;++d)u=s[d],h[d]=new PropertyBinding(u,e,t);return h},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,i=t[e];if(void 0!==i){var r=this._paths,n=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=i,a[i]=s,a.pop(),n[i]=n[o],n.pop(),r[i]=r[o],r.pop()}}}),Object.assign(AnimationAction.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){var r=this._clip.duration,n=e._clip.duration,a=n/r,o=r/n;e.warp(1,a,t),this.warp(o,1,t)}return this},crossFadeTo:function(e,t,i){return e.crossFadeFrom(this,t,i)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,i){var r=this._mixer,n=r.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,l=a.sampleValues;return s[0]=n,s[1]=n+i,l[0]=e/o,l[1]=t/o,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,i,r){if(this.enabled){var n=this._startTime;if(null!==n){var a=(e-n)*i;if(0>a||0===i)return;this._startTime=null,t=i*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(0<s)for(var l=this._interpolants,c=this._propertyBindings,h=0,u=l.length;h!==u;++h)l[h].evaluate(o),c[h].accumulate(r,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var i=this._weightInterpolant;if(null!==i){var r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i)t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,i=this._clip.duration,r=this.loop,n=this._loopCount,a=r===LoopPingPong;if(0===e)return-1===n?t:a&&1==(1&n)?i-t:t;if(r===LoopOnce){-1===n&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=i)t=i;else{if(!(0>t)){this.time=t;break e}t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>e?-1:1})}}else{if(-1===n&&(0<=e?(n=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),t>=i||0>t){var o=Math.floor(t/i);t-=i*o,n+=Math.abs(o);var s=this.repetitions-n;if(0>=s)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=0<e?i:0,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1});else{if(1===s){var l=0>e;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=n,this.time=t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=t;if(a&&1==(1&n))return i-t}return t},_setEndings:function(e,t,i){var r=this._interpolantSettings;i?(r.endingStart=ZeroSlopeEnding,r.endingEnd=ZeroSlopeEnding):(r.endingStart=e?this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:WrapAroundEnding,r.endingEnd=t?this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:WrapAroundEnding)},_scheduleFading:function(e,t,i){var r=this._mixer,n=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=n,s[0]=t,o[1]=n+e,s[1]=i,this}}),AnimationMixer.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:AnimationMixer,_bindAction:function(e,t){var i=e._localRoot||this._root,r=e._clip.tracks,n=r.length,a=e._propertyBindings,o=e._interpolants,s=i.uuid,l=this._bindingsByRootAndName,c=l[s];void 0===c&&(c={},l[s]=c);for(var h=0;h!==n;++h){var u=r[h],d=u.name,p=c[d];if(void 0!==p)a[h]=p;else{if(void 0!==(p=a[h])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var m=t&&t._propertyBindings[h].binding.parsedPath;++(p=new PropertyMixer(PropertyBinding.create(i,d,m),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),a[h]=p}o[h].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,i=e._clip.uuid,r=this._actionsByClip[i];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,i,t)}for(var n,a=e._propertyBindings,o=0,s=a.length;o!==s;++o)0==(n=a[o]).useCount++&&(this._lendBinding(n),n.saveOriginalState());this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t,i=e._propertyBindings,r=0,n=i.length;r!==n;++r)0==--(t=i[r]).useCount&&(t.restoreOriginalState(),this._takeBackBinding(t));this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,i){var r=this._actions,n=this._actionsByClip,a=n[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[i]=e},_removeInactiveAction:function(e){var t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;var n=e._clip.uuid,a=this._actionsByClip,o=a[n],s=o.knownActions,l=s[s.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[n],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t,i=e._propertyBindings,r=0,n=i.length;r!==n;++r)0==--(t=i[r]).referenceCount&&this._removeInactiveBinding(t)},_lendAction:function(e){var t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,n=t[r];e._cacheIndex=r,t[r]=e,n._cacheIndex=i,t[i]=n},_takeBackAction:function(e){var t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,n=t[r];e._cacheIndex=r,t[r]=e,n._cacheIndex=i,t[i]=n},_addInactiveBinding:function(e,t,i){var r=this._bindingsByRootAndName,n=r[t],a=this._bindings;void 0===n&&(n={},r[t]=n),n[i]=e,e._cacheIndex=a.length,a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,i=e.binding,r=i.rootNode.uuid,n=i.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[n],0===Object.keys(o).length&&delete a[r]},_lendBinding:function(e){var t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,n=t[r];e._cacheIndex=r,t[r]=e,n._cacheIndex=i,t[i]=n},_takeBackBinding:function(e){var t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,n=t[r];e._cacheIndex=r,t[r]=e,n._cacheIndex=i,t[i]=n},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,i=e[t];return void 0===i&&((i=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=i),i},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,n=t[r];e.__cacheIndex=r,t[r]=e,n.__cacheIndex=i,t[i]=n},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var i=t||this._root,r=i.uuid,n="string"==typeof e?AnimationClip.findByName(i,e):e,a=null!==n?n.uuid:e,o=this._actionsByClip[a],s=null;if(void 0!==o){var l=o.actionByRoot[r];if(void 0!==l)return l;s=o.knownActions[0],null===n&&(n=s._clip)}if(null===n)return null;var c=new AnimationAction(this,n,t);return this._bindAction(c,s),this._addInactiveAction(c,a,r),c},existingAction:function(e,t){var i=t||this._root,r=i.uuid,n="string"==typeof e?AnimationClip.findByName(i,e):e,a=n?n.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,i=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var n=0;n!==t;++n)e[n].reset();for(n=0;n!==r;++n)i[n].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,i=this._nActiveActions,r=this.time+=e,n=Math.sign(e),a=this._accuIndex^=1,o=0;o!==i;++o)t[o]._update(r,e,n,a);var s=this._bindings,l=this._nActiveBindings;for(o=0;o!==l;++o)s[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,i=e.uuid,r=this._actionsByClip,n=r[i];if(void 0!==n){for(var a,o=n.knownActions,s=0,l=o.length;s!==l;++s){a=o[s],this._deactivateAction(a);var c=a._cacheIndex,h=t[t.length-1];a._cacheIndex=null,a._byClipCacheIndex=null,h._cacheIndex=c,t[c]=h,t.pop(),this._removeInactiveBindingsForAction(a)}delete r[i]}},uncacheRoot:function(e){var t=e.uuid,i=this._actionsByClip;for(var r in i){var n=i[r].actionByRoot[t];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}),Uniform.prototype.clone=function(){return new Uniform(void 0===this.value.clone?this.value:this.value.clone())},InstancedInterleavedBuffer.prototype=Object.assign(Object.create(InterleavedBuffer.prototype),{constructor:InstancedInterleavedBuffer,isInstancedInterleavedBuffer:!0,copy:function(e){return InterleavedBuffer.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Raycaster.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this._camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this._camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,i){var r=i||[];return intersectObject(e,this,r,t),r.sort(ascSort),r},intersectObjects:function(e,t,i){var r=i||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var n=0,a=e.length;n<a;n++)intersectObject(e[n],this,r,t);return r.sort(ascSort),r}}),Object.assign(Spherical.prototype,{set:function(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(_Math.clamp(t/this.radius,-1,1))),this}}),Object.assign(Cylindrical.prototype,{set:function(e,t,i){return this.radius=e,this.theta=t,this.y=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}}),Object.assign(Box2.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Vector2;return function(t,i){var r=e.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Vector2),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Vector2),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Vector2),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Vector2),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Vector2;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Line3.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Vector3),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Vector3),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Vector3),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new Vector3,t=new Vector3;return function(i,r){e.subVectors(i,this.start),t.subVectors(this.end,this.start);var n=t.dot(t),a=t.dot(e)/n;return r&&(a=_Math.clamp(a,0,1)),a}}(),closestPointToPoint:function(e,t,i){var r=this.closestPointToPointParameter(e,t);return void 0===i&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),i=new Vector3),this.delta(i).multiplyScalar(r).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),ImmediateRenderObject.prototype=Object.create(Object3D.prototype),ImmediateRenderObject.prototype.constructor=ImmediateRenderObject,ImmediateRenderObject.prototype.isImmediateRenderObject=!0,VertexNormalsHelper.prototype=Object.create(LineSegments.prototype),VertexNormalsHelper.prototype.constructor=VertexNormalsHelper,VertexNormalsHelper.prototype.update=function(){var e=new Vector3,t=new Vector3,i=new Matrix3;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);var n=this.object.matrixWorld,a=this.geometry.attributes.position,o=this.object.geometry;if(o&&o.isGeometry)for(var s,l=o.vertices,c=o.faces,h=0,u=0,d=c.length;u<d;u++)for(var p=0,m=(s=c[u]).vertexNormals.length;p<m;p++){var f=l[s[r[p]]],g=s.vertexNormals[p];e.copy(f).applyMatrix4(n),t.copy(g).applyMatrix3(i).normalize().multiplyScalar(this.size).add(e),a.setXYZ(h,e.x,e.y,e.z),h+=1,a.setXYZ(h,t.x,t.y,t.z),h+=1}else if(o&&o.isBufferGeometry){var v=o.attributes.position,y=o.attributes.normal;for(h=0,p=0,m=v.count;p<m;p++)e.set(v.getX(p),v.getY(p),v.getZ(p)).applyMatrix4(n),t.set(y.getX(p),y.getY(p),y.getZ(p)),t.applyMatrix3(i).normalize().multiplyScalar(this.size).add(e),a.setXYZ(h,e.x,e.y,e.z),h+=1,a.setXYZ(h,t.x,t.y,t.z),h+=1}a.needsUpdate=!0}}(),SpotLightHelper.prototype=Object.create(Object3D.prototype),SpotLightHelper.prototype.constructor=SpotLightHelper,SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},SpotLightHelper.prototype.update=function(){var e=new Vector3;return function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,i=t*Math.tan(this.light.angle);this.cone.scale.set(i,i,t),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),SkeletonHelper.prototype=Object.create(LineSegments.prototype),SkeletonHelper.prototype.constructor=SkeletonHelper,SkeletonHelper.prototype.updateMatrixWorld=function(){var e=new Vector3,t=new Matrix4,i=new Matrix4;return function(r){var n=this.bones,a=this.geometry,o=a.getAttribute("position");i.getInverse(this.root.matrixWorld);for(var s,l=0,c=0;l<n.length;l++)(s=n[l]).parent&&s.parent.isBone&&(t.multiplyMatrices(i,s.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(c,e.x,e.y,e.z),t.multiplyMatrices(i,s.parent.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(c+1,e.x,e.y,e.z),c+=2);a.getAttribute("position").needsUpdate=!0,Object3D.prototype.updateMatrixWorld.call(this,r)}}(),PointLightHelper.prototype=Object.create(Mesh.prototype),PointLightHelper.prototype.constructor=PointLightHelper,PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},PointLightHelper.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},RectAreaLightHelper.prototype=Object.create(Line.prototype),RectAreaLightHelper.prototype.constructor=RectAreaLightHelper,RectAreaLightHelper.prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var e=this.material.color,t=Math.max(e.r,e.g,e.b);1<t&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}},RectAreaLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()},HemisphereLightHelper.prototype=Object.create(Object3D.prototype),HemisphereLightHelper.prototype.constructor=HemisphereLightHelper,HemisphereLightHelper.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},HemisphereLightHelper.prototype.update=function(){var e=new Vector3,t=new Color,i=new Color;return function(){var r=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var n=r.geometry.getAttribute("color");t.copy(this.light.color),i.copy(this.light.groundColor);for(var a,o=0,s=n.count;o<s;o++)a=o<s/2?t:i,n.setXYZ(o,a.r,a.g,a.b);n.needsUpdate=!0}r.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),LightProbeHelper.prototype=Object.create(Mesh.prototype),LightProbeHelper.prototype.constructor=LightProbeHelper,LightProbeHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},LightProbeHelper.prototype.onBeforeRender=function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity},GridHelper.prototype=Object.assign(Object.create(LineSegments.prototype),{constructor:GridHelper,copy:function(e){return LineSegments.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}}),PolarGridHelper.prototype=Object.create(LineSegments.prototype),PolarGridHelper.prototype.constructor=PolarGridHelper,PositionalAudioHelper.prototype=Object.create(Line.prototype),PositionalAudioHelper.prototype.constructor=PositionalAudioHelper,PositionalAudioHelper.prototype.update=function(){var e,t,i=this.audio,r=this.range,n=this.divisionsInnerAngle,a=this.divisionsOuterAngle,o=_Math.degToRad(i.panner.coneInnerAngle),s=_Math.degToRad(i.panner.coneOuterAngle),l=o/2,c=s/2,h=0,u=0,d=this.geometry,p=d.attributes.position;function m(i,n,a,o){var s=(n-i)/a;for(p.setXYZ(h,0,0,0),u++,e=i;e<n;e+=s)t=h+u,p.setXYZ(t,Math.sin(e)*r,0,Math.cos(e)*r),p.setXYZ(t+1,Math.sin(Math.min(e+s,n))*r,0,Math.cos(Math.min(e+s,n))*r),p.setXYZ(t+2,0,0,0),u+=3;d.addGroup(h,u,o),h+=u,u=0}d.clearGroups(),m(-c,-l,a,0),m(-l,l,n,1),m(l,c,a,0),p.needsUpdate=!0,o===s&&(this.material[0].visible=!1)},PositionalAudioHelper.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()},FaceNormalsHelper.prototype=Object.create(LineSegments.prototype),FaceNormalsHelper.prototype.constructor=FaceNormalsHelper,FaceNormalsHelper.prototype.update=function(){var e=new Vector3,t=new Vector3,i=new Matrix3;return function(){this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,n=this.geometry.attributes.position,a=this.object.geometry,o=a.vertices,s=a.faces,l=0,c=0,h=s.length;c<h;c++){var u=s[c],d=u.normal;e.copy(o[u.a]).add(o[u.b]).add(o[u.c]).divideScalar(3).applyMatrix4(r),t.copy(d).applyMatrix3(i).normalize().multiplyScalar(this.size).add(e),n.setXYZ(l,e.x,e.y,e.z),l+=1,n.setXYZ(l,t.x,t.y,t.z),l+=1}n.needsUpdate=!0}}(),DirectionalLightHelper.prototype=Object.create(Object3D.prototype),DirectionalLightHelper.prototype.constructor=DirectionalLightHelper,DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},DirectionalLightHelper.prototype.update=function(){var e=new Vector3,t=new Vector3,i=new Vector3;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),i.subVectors(t,e),this.lightPlane.lookAt(t),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(t),this.targetLine.scale.z=i.length()}}(),CameraHelper.prototype=Object.create(LineSegments.prototype),CameraHelper.prototype.constructor=CameraHelper,CameraHelper.prototype.update=function(){var e,t,i=new Vector3,r=new Camera;function n(n,a,o,s){i.set(a,o,s).unproject(r);var l=t[n];if(void 0!==l)for(var c=e.getAttribute("position"),h=0,u=l.length;h<u;h++)c.setXYZ(l[h],i.x,i.y,i.z)}return function(){e=this.geometry,t=this.pointMap;r.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),n("c",0,0,-1),n("t",0,0,1),n("n1",-1,-1,-1),n("n2",1,-1,-1),n("n3",-1,1,-1),n("n4",1,1,-1),n("f1",-1,-1,1),n("f2",1,-1,1),n("f3",-1,1,1),n("f4",1,1,1),n("u1",.7,1.1,-1),n("u2",-.7,1.1,-1),n("u3",0,2,-1),n("cf1",-1,0,1),n("cf2",1,0,1),n("cf3",0,-1,1),n("cf4",0,1,1),n("cn1",-1,0,-1),n("cn2",1,0,-1),n("cn3",0,-1,-1),n("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),BoxHelper.prototype=Object.create(LineSegments.prototype),BoxHelper.prototype.constructor=BoxHelper,BoxHelper.prototype.update=function(){var e=new Box3;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var i=e.min,r=e.max,n=this.geometry.attributes.position,a=n.array;a[0]=r.x,a[1]=r.y,a[2]=r.z,a[3]=i.x,a[4]=r.y,a[5]=r.z,a[6]=i.x,a[7]=i.y,a[8]=r.z,a[9]=r.x,a[10]=i.y,a[11]=r.z,a[12]=r.x,a[13]=r.y,a[14]=i.z,a[15]=i.x,a[16]=r.y,a[17]=i.z,a[18]=i.x,a[19]=i.y,a[20]=i.z,a[21]=r.x,a[22]=i.y,a[23]=i.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),BoxHelper.prototype.setFromObject=function(e){return this.object=e,this.update(),this},BoxHelper.prototype.copy=function(e){return LineSegments.prototype.copy.call(this,e),this.object=e.object,this},BoxHelper.prototype.clone=function(){return(new this.constructor).copy(this)},Box3Helper.prototype=Object.create(LineSegments.prototype),Box3Helper.prototype.constructor=Box3Helper,Box3Helper.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Object3D.prototype.updateMatrixWorld.call(this,e))},PlaneHelper.prototype=Object.create(Line.prototype),PlaneHelper.prototype.constructor=PlaneHelper,PlaneHelper.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;1e-8>Math.abs(t)&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=0>t?BackSide:FrontSide,this.lookAt(this.plane.normal),Object3D.prototype.updateMatrixWorld.call(this,e)},ArrowHelper.prototype=Object.create(Object3D.prototype),ArrowHelper.prototype.constructor=ArrowHelper,ArrowHelper.prototype.setDirection=function(){var e,t=new Vector3;return function(i){.99999<i.y?this.quaternion.set(0,0,0,1):-.99999>i.y?this.quaternion.set(1,0,0,0):(t.set(i.z,0,-i.x).normalize(),e=Math.acos(i.y),this.quaternion.setFromAxisAngle(t,e))}}(),ArrowHelper.prototype.setLength=function(e,t,i){void 0===t&&(t=.2*e),void 0===i&&(i=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()},ArrowHelper.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},ArrowHelper.prototype.copy=function(e){return Object3D.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},ArrowHelper.prototype.clone=function(){return(new this.constructor).copy(this)},AxesHelper.prototype=Object.create(LineSegments.prototype),AxesHelper.prototype.constructor=AxesHelper;var LineStrip=0,LinePieces=1;function MeshFaceMaterial(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function MultiMaterial(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function PointCloud(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Points(e,t)}function Particle(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Sprite(e)}function ParticleSystem(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Points(e,t)}function PointCloudMaterial(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new PointsMaterial(e)}function ParticleBasicMaterial(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new PointsMaterial(e)}function ParticleSystemMaterial(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new PointsMaterial(e)}function Vertex(e,t,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Vector3(e,t,i)}function DynamicBufferAttribute(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new BufferAttribute(e,t).setDynamic(!0)}function Int8Attribute(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Int8BufferAttribute(e,t)}function Uint8Attribute(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Uint8BufferAttribute(e,t)}function Uint8ClampedAttribute(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Uint8ClampedBufferAttribute(e,t)}function Int16Attribute(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Int16BufferAttribute(e,t)}function Uint16Attribute(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Uint16BufferAttribute(e,t)}function Int32Attribute(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Int32BufferAttribute(e,t)}function Uint32Attribute(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Uint32BufferAttribute(e,t)}function Float32Attribute(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Float32BufferAttribute(e,t)}function Float64Attribute(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Float64BufferAttribute(e,t)}function ClosedSplineCurve3(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),CatmullRomCurve3.call(this,e),this.type="catmullrom",this.closed=!0}function SplineCurve3(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),CatmullRomCurve3.call(this,e),this.type="catmullrom"}function Spline(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),CatmullRomCurve3.call(this,e),this.type="catmullrom"}function AxisHelper(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new AxesHelper(e)}function BoundingBoxHelper(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new BoxHelper(e,t)}function EdgesHelper(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new LineSegments(new EdgesGeometry(e.geometry),new LineBasicMaterial({color:void 0!==t?t:16777215}))}function WireframeHelper(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new LineSegments(new WireframeGeometry(e.geometry),new LineBasicMaterial({color:void 0!==t?t:16777215}))}function XHRLoader(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new FileLoader(e)}function BinaryTextureLoader(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new DataTextureLoader(e)}Curve.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Curve.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(CurvePath.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t,i=new Geometry,r=0,n=e.length;r<n;r++)t=e[r],i.vertices.push(new Vector3(t.x,t.y,t.z||0));return i}}),Object.assign(Path.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),ClosedSplineCurve3.prototype=Object.create(CatmullRomCurve3.prototype),SplineCurve3.prototype=Object.create(CatmullRomCurve3.prototype),Spline.prototype=Object.create(CatmullRomCurve3.prototype),Object.assign(Spline.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),GridHelper.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},SkeletonHelper.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Loader.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),LoaderUtils.extractUrlBase(e)}}),Object.assign(ObjectLoader.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(Box2.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Box3.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Line3.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(_Math,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),_Math.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),_Math.ceilPowerOfTwo(e)}}),Object.assign(Matrix3.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Matrix4.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new Vector3),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,i,r,n,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,i,n,a)}}),Plane.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Quaternion.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Ray.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Triangle.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(Triangle,{barycoordFromPoint:function(e,t,i,r,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Triangle.getBarycoord(e,t,i,r,n)},normal:function(e,t,i,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Triangle.getNormal(e,t,i,r)}}),Object.assign(Shape.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ExtrudeGeometry(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ShapeGeometry(this,e)}}),Object.assign(Vector2.prototype,{fromAttribute:function(e,t,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Vector3.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Vector4.prototype,{fromAttribute:function(e,t,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Geometry.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(Object3D.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(Object3D.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(LOD.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Skeleton.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),SkinnedMesh.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Curve.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),PerspectiveCamera.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Light.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(BufferAttribute.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(BufferGeometry.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(BufferGeometry.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(ExtrudeBufferGeometry.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Uniform.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Material.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Color}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===FlatShading}}}),Object.defineProperties(MeshPhongMaterial.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(ShaderMaterial.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(WebGLRenderer.prototype,{clearTarget:function(e,t,i,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,i,r)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")}}),Object.defineProperties(WebGLRenderer.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(WebGLShadowMap.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(WebGLRenderTargetCube.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}}),Object.defineProperties(WebGLRenderTarget.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(WebVRManager.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),Audio$1.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new AudioLoader).load(e,function(e){t.setBuffer(e)}),this},AudioAnalyser.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},CubeCamera.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var GeometryUtils={merge:function(e,t,i){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,t=t.geometry),e.merge(t,r,i)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};function CanvasRenderer(){console.error("THREE.CanvasRenderer has been removed")}function JSONLoader(){console.error("THREE.JSONLoader has been removed.")}ImageUtils.crossOrigin=void 0,ImageUtils.loadTexture=function(e,t,i,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var n=new TextureLoader;n.setCrossOrigin(this.crossOrigin);var a=n.load(e,i,void 0,r);return t&&(a.mapping=t),a},ImageUtils.loadTextureCube=function(e,t,i,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var n=new CubeTextureLoader;n.setCrossOrigin(this.crossOrigin);var a=n.load(e,i,void 0,r);return t&&(a.mapping=t),a},ImageUtils.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},ImageUtils.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function LensFlare(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}var three_module={ACESFilmicToneMapping:ACESFilmicToneMapping,AddEquation:AddEquation,AddOperation:AddOperation,AdditiveBlending:AdditiveBlending,AlphaFormat:AlphaFormat,AlwaysDepth:AlwaysDepth,AmbientLight:AmbientLight,AmbientLightProbe:AmbientLightProbe,AnimationClip:AnimationClip,AnimationLoader:AnimationLoader,AnimationMixer:AnimationMixer,AnimationObjectGroup:AnimationObjectGroup,AnimationUtils:AnimationUtils,ArcCurve:ArcCurve,ArrayCamera:ArrayCamera,ArrowHelper:ArrowHelper,Audio:Audio$1,AudioAnalyser:AudioAnalyser,AudioContext:AudioContext,AudioListener:AudioListener,AudioLoader:AudioLoader,AxesHelper:AxesHelper,AxisHelper:AxisHelper,BackSide:BackSide,BasicDepthPacking:BasicDepthPacking,BasicShadowMap:BasicShadowMap,BinaryTextureLoader:BinaryTextureLoader,Bone:Bone,BooleanKeyframeTrack:BooleanKeyframeTrack,BoundingBoxHelper:BoundingBoxHelper,Box2:Box2,Box3:Box3,Box3Helper:Box3Helper,BoxBufferGeometry:BoxBufferGeometry,BoxGeometry:BoxGeometry,BoxHelper:BoxHelper,BufferAttribute:BufferAttribute,BufferGeometry:BufferGeometry,BufferGeometryLoader:BufferGeometryLoader,ByteType:ByteType,Cache:Cache,Camera:Camera,CameraHelper:CameraHelper,CanvasRenderer:CanvasRenderer,CanvasTexture:CanvasTexture,CatmullRomCurve3:CatmullRomCurve3,CineonToneMapping:CineonToneMapping,CircleBufferGeometry:CircleBufferGeometry,CircleGeometry:CircleGeometry,ClampToEdgeWrapping:ClampToEdgeWrapping,Clock:Clock,ClosedSplineCurve3:ClosedSplineCurve3,Color:Color,ColorKeyframeTrack:ColorKeyframeTrack,CompressedTexture:CompressedTexture,CompressedTextureLoader:CompressedTextureLoader,ConeBufferGeometry:ConeBufferGeometry,ConeGeometry:ConeGeometry,CubeCamera:CubeCamera,CubeGeometry:BoxGeometry,CubeReflectionMapping:CubeReflectionMapping,CubeRefractionMapping:CubeRefractionMapping,CubeTexture:CubeTexture,CubeTextureLoader:CubeTextureLoader,CubeUVReflectionMapping:CubeUVReflectionMapping,CubeUVRefractionMapping:CubeUVRefractionMapping,CubicBezierCurve:CubicBezierCurve,CubicBezierCurve3:CubicBezierCurve3,CubicInterpolant:CubicInterpolant,CullFaceBack:CullFaceBack,CullFaceFront:CullFaceFront,CullFaceFrontBack:CullFaceFrontBack,CullFaceNone:CullFaceNone,Curve:Curve,CurvePath:CurvePath,CustomBlending:CustomBlending,CylinderBufferGeometry:CylinderBufferGeometry,CylinderGeometry:CylinderGeometry,Cylindrical:Cylindrical,DataTexture:DataTexture,DataTexture2DArray:DataTexture2DArray,DataTexture3D:DataTexture3D,DataTextureLoader:DataTextureLoader,DefaultLoadingManager:DefaultLoadingManager,DepthFormat:DepthFormat,DepthStencilFormat:DepthStencilFormat,DepthTexture:DepthTexture,DirectionalLight:DirectionalLight,DirectionalLightHelper:DirectionalLightHelper,DirectionalLightShadow:DirectionalLightShadow,DiscreteInterpolant:DiscreteInterpolant,DodecahedronBufferGeometry:DodecahedronBufferGeometry,DodecahedronGeometry:DodecahedronGeometry,DoubleSide:DoubleSide,DstAlphaFactor:DstAlphaFactor,DstColorFactor:DstColorFactor,DynamicBufferAttribute:DynamicBufferAttribute,EdgesGeometry:EdgesGeometry,EdgesHelper:EdgesHelper,EllipseCurve:EllipseCurve,EqualDepth:EqualDepth,EquirectangularReflectionMapping:EquirectangularReflectionMapping,EquirectangularRefractionMapping:EquirectangularRefractionMapping,Euler:Euler,EventDispatcher:EventDispatcher,ExtrudeBufferGeometry:ExtrudeBufferGeometry,ExtrudeGeometry:ExtrudeGeometry,Face3:Face3,Face4:Face4,FaceColors:FaceColors,FaceNormalsHelper:FaceNormalsHelper,FileLoader:FileLoader,FlatShading:FlatShading,Float32Attribute:Float32Attribute,Float32BufferAttribute:Float32BufferAttribute,Float64Attribute:Float64Attribute,Float64BufferAttribute:Float64BufferAttribute,FloatType:FloatType,Fog:Fog,FogExp2:FogExp2,Font:Font,FontLoader:FontLoader,FrontFaceDirectionCCW:FrontFaceDirectionCCW,FrontFaceDirectionCW:FrontFaceDirectionCW,FrontSide:FrontSide,Frustum:Frustum,GammaEncoding:GammaEncoding,Geometry:Geometry,GeometryUtils:GeometryUtils,GreaterDepth:GreaterDepth,GreaterEqualDepth:GreaterEqualDepth,GridHelper:GridHelper,Group:Group,HalfFloatType:HalfFloatType,HemisphereLight:HemisphereLight,HemisphereLightHelper:HemisphereLightHelper,HemisphereLightProbe:HemisphereLightProbe,IcosahedronBufferGeometry:IcosahedronBufferGeometry,IcosahedronGeometry:IcosahedronGeometry,ImageBitmapLoader:ImageBitmapLoader,ImageLoader:ImageLoader,ImageUtils:ImageUtils,ImmediateRenderObject:ImmediateRenderObject,InstancedBufferAttribute:InstancedBufferAttribute,InstancedBufferGeometry:InstancedBufferGeometry,InstancedInterleavedBuffer:InstancedInterleavedBuffer,Int16Attribute:Int16Attribute,Int16BufferAttribute:Int16BufferAttribute,Int32Attribute:Int32Attribute,Int32BufferAttribute:Int32BufferAttribute,Int8Attribute:Int8Attribute,Int8BufferAttribute:Int8BufferAttribute,IntType:IntType,InterleavedBuffer:InterleavedBuffer,InterleavedBufferAttribute:InterleavedBufferAttribute,Interpolant:Interpolant,InterpolateDiscrete:InterpolateDiscrete,InterpolateLinear:InterpolateLinear,InterpolateSmooth:InterpolateSmooth,JSONLoader:JSONLoader,KeyframeTrack:KeyframeTrack,LOD:LOD,LatheBufferGeometry:LatheBufferGeometry,LatheGeometry:LatheGeometry,Layers:Layers,LensFlare:LensFlare,LessDepth:LessDepth,LessEqualDepth:LessEqualDepth,Light:Light,LightProbe:LightProbe,LightProbeHelper:LightProbeHelper,LightShadow:LightShadow,Line:Line,Line3:Line3,LineBasicMaterial:LineBasicMaterial,LineCurve:LineCurve,LineCurve3:LineCurve3,LineDashedMaterial:LineDashedMaterial,LineLoop:LineLoop,LinePieces:LinePieces,LineSegments:LineSegments,LineStrip:LineStrip,LinearEncoding:LinearEncoding,LinearFilter:LinearFilter,LinearInterpolant:LinearInterpolant,LinearMipMapLinearFilter:LinearMipMapLinearFilter,LinearMipMapNearestFilter:LinearMipMapNearestFilter,LinearToneMapping:LinearToneMapping,Loader:Loader,LoaderUtils:LoaderUtils,LoadingManager:LoadingManager,LogLuvEncoding:LogLuvEncoding,LoopOnce:LoopOnce,LoopPingPong:LoopPingPong,LoopRepeat:LoopRepeat,LuminanceAlphaFormat:LuminanceAlphaFormat,LuminanceFormat:LuminanceFormat,MOUSE:MOUSE,Material:Material,MaterialLoader:MaterialLoader,Math:_Math,Matrix3:Matrix3,Matrix4:Matrix4,MaxEquation:MaxEquation,Mesh:Mesh,MeshBasicMaterial:MeshBasicMaterial,MeshDepthMaterial:MeshDepthMaterial,MeshDistanceMaterial:MeshDistanceMaterial,MeshFaceMaterial:MeshFaceMaterial,MeshLambertMaterial:MeshLambertMaterial,MeshMatcapMaterial:MeshMatcapMaterial,MeshNormalMaterial:MeshNormalMaterial,MeshPhongMaterial:MeshPhongMaterial,MeshPhysicalMaterial:MeshPhysicalMaterial,MeshStandardMaterial:MeshStandardMaterial,MeshToonMaterial:MeshToonMaterial,MinEquation:MinEquation,MirroredRepeatWrapping:MirroredRepeatWrapping,MixOperation:MixOperation,MultiMaterial:MultiMaterial,MultiplyBlending:MultiplyBlending,MultiplyOperation:MultiplyOperation,NearestFilter:NearestFilter,NearestMipMapLinearFilter:NearestMipMapLinearFilter,NearestMipMapNearestFilter:NearestMipMapNearestFilter,NeverDepth:NeverDepth,NoBlending:NoBlending,NoColors:NoColors,NoToneMapping:NoToneMapping,NormalBlending:NormalBlending,NotEqualDepth:NotEqualDepth,NumberKeyframeTrack:NumberKeyframeTrack,Object3D:Object3D,ObjectLoader:ObjectLoader,ObjectSpaceNormalMap:ObjectSpaceNormalMap,OctahedronBufferGeometry:OctahedronBufferGeometry,OctahedronGeometry:OctahedronGeometry,OneFactor:OneFactor,OneMinusDstAlphaFactor:OneMinusDstAlphaFactor,OneMinusDstColorFactor:OneMinusDstColorFactor,OneMinusSrcAlphaFactor:OneMinusSrcAlphaFactor,OneMinusSrcColorFactor:OneMinusSrcColorFactor,OrthographicCamera:OrthographicCamera,PCFShadowMap:PCFShadowMap,PCFSoftShadowMap:PCFSoftShadowMap,ParametricBufferGeometry:ParametricBufferGeometry,ParametricGeometry:ParametricGeometry,Particle:Particle,ParticleBasicMaterial:ParticleBasicMaterial,ParticleSystem:ParticleSystem,ParticleSystemMaterial:ParticleSystemMaterial,Path:Path,PerspectiveCamera:PerspectiveCamera,Plane:Plane,PlaneBufferGeometry:PlaneBufferGeometry,PlaneGeometry:PlaneGeometry,PlaneHelper:PlaneHelper,PointCloud:PointCloud,PointCloudMaterial:PointCloudMaterial,PointLight:PointLight,PointLightHelper:PointLightHelper,Points:Points,PointsMaterial:PointsMaterial,PolarGridHelper:PolarGridHelper,PolyhedronBufferGeometry:PolyhedronBufferGeometry,PolyhedronGeometry:PolyhedronGeometry,PositionalAudio:PositionalAudio,PositionalAudioHelper:PositionalAudioHelper,PropertyBinding:PropertyBinding,PropertyMixer:PropertyMixer,QuadraticBezierCurve:QuadraticBezierCurve,QuadraticBezierCurve3:QuadraticBezierCurve3,Quaternion:Quaternion,QuaternionKeyframeTrack:QuaternionKeyframeTrack,QuaternionLinearInterpolant:QuaternionLinearInterpolant,REVISION:REVISION,RGBADepthPacking:RGBADepthPacking,RGBAFormat:RGBAFormat,RGBA_ASTC_10x10_Format:RGBA_ASTC_10x10_Format,RGBA_ASTC_10x5_Format:RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format:RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format:RGBA_ASTC_10x8_Format,RGBA_ASTC_12x10_Format:RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format:RGBA_ASTC_12x12_Format,RGBA_ASTC_4x4_Format:RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format:RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format:RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format:RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format:RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format:RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format:RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format:RGBA_ASTC_8x8_Format,RGBA_PVRTC_2BPPV1_Format:RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format:RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format:RGBA_S3TC_DXT1_Format,RGBA_S3TC_DXT3_Format:RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT5_Format:RGBA_S3TC_DXT5_Format,RGBDEncoding:RGBDEncoding,RGBEEncoding:RGBEEncoding,RGBEFormat:RGBEFormat,RGBFormat:RGBFormat,RGBM16Encoding:RGBM16Encoding,RGBM7Encoding:RGBM7Encoding,RGB_ETC1_Format:RGB_ETC1_Format,RGB_PVRTC_2BPPV1_Format:RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format:RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format:RGB_S3TC_DXT1_Format,RawShaderMaterial:RawShaderMaterial,Ray:Ray,Raycaster:Raycaster,RectAreaLight:RectAreaLight,RectAreaLightHelper:RectAreaLightHelper,RedFormat:RedFormat,ReinhardToneMapping:ReinhardToneMapping,RepeatWrapping:RepeatWrapping,ReverseSubtractEquation:ReverseSubtractEquation,RingBufferGeometry:RingBufferGeometry,RingGeometry:RingGeometry,Scene:Scene,SceneUtils:SceneUtils,ShaderChunk:ShaderChunk,ShaderLib:ShaderLib,ShaderMaterial:ShaderMaterial,ShadowMaterial:ShadowMaterial,Shape:Shape,ShapeBufferGeometry:ShapeBufferGeometry,ShapeGeometry:ShapeGeometry,ShapePath:ShapePath,ShapeUtils:ShapeUtils,ShortType:ShortType,Skeleton:Skeleton,SkeletonHelper:SkeletonHelper,SkinnedMesh:SkinnedMesh,SmoothShading:SmoothShading,Sphere:Sphere,SphereBufferGeometry:SphereBufferGeometry,SphereGeometry:SphereGeometry,Spherical:Spherical,SphericalHarmonics3:SphericalHarmonics3,SphericalReflectionMapping:SphericalReflectionMapping,Spline:Spline,SplineCurve:SplineCurve,SplineCurve3:SplineCurve3,SpotLight:SpotLight,SpotLightHelper:SpotLightHelper,SpotLightShadow:SpotLightShadow,Sprite:Sprite,SpriteMaterial:SpriteMaterial,SrcAlphaFactor:SrcAlphaFactor,SrcAlphaSaturateFactor:SrcAlphaSaturateFactor,SrcColorFactor:SrcColorFactor,StereoCamera:StereoCamera,StringKeyframeTrack:StringKeyframeTrack,SubtractEquation:SubtractEquation,SubtractiveBlending:SubtractiveBlending,TangentSpaceNormalMap:TangentSpaceNormalMap,TetrahedronBufferGeometry:TetrahedronBufferGeometry,TetrahedronGeometry:TetrahedronGeometry,TextBufferGeometry:TextBufferGeometry,TextGeometry:TextGeometry,Texture:Texture,TextureLoader:TextureLoader,TorusBufferGeometry:TorusBufferGeometry,TorusGeometry:TorusGeometry,TorusKnotBufferGeometry:TorusKnotBufferGeometry,TorusKnotGeometry:TorusKnotGeometry,Triangle:Triangle,TriangleFanDrawMode:TriangleFanDrawMode,TriangleStripDrawMode:TriangleStripDrawMode,TrianglesDrawMode:TrianglesDrawMode,TubeBufferGeometry:TubeBufferGeometry,TubeGeometry:TubeGeometry,UVMapping:UVMapping,Uint16Attribute:Uint16Attribute,Uint16BufferAttribute:Uint16BufferAttribute,Uint32Attribute:Uint32Attribute,Uint32BufferAttribute:Uint32BufferAttribute,Uint8Attribute:Uint8Attribute,Uint8BufferAttribute:Uint8BufferAttribute,Uint8ClampedAttribute:Uint8ClampedAttribute,Uint8ClampedBufferAttribute:Uint8ClampedBufferAttribute,Uncharted2ToneMapping:Uncharted2ToneMapping,Uniform:Uniform,UniformsLib:UniformsLib,UniformsUtils:UniformsUtils,UnsignedByteType:UnsignedByteType,UnsignedInt248Type:UnsignedInt248Type,UnsignedIntType:UnsignedIntType,UnsignedShort4444Type:UnsignedShort4444Type,UnsignedShort5551Type:UnsignedShort5551Type,UnsignedShort565Type:UnsignedShort565Type,UnsignedShortType:UnsignedShortType,Vector2:Vector2,Vector3:Vector3,Vector4:Vector4,VectorKeyframeTrack:VectorKeyframeTrack,Vertex:Vertex,VertexColors:VertexColors,VertexNormalsHelper:VertexNormalsHelper,VideoTexture:VideoTexture,WebGLMultisampleRenderTarget:WebGLMultisampleRenderTarget,WebGLRenderTarget:WebGLRenderTarget,WebGLRenderTargetCube:WebGLRenderTargetCube,WebGLRenderer:WebGLRenderer,WebGLUtils:WebGLUtils,WireframeGeometry:WireframeGeometry,WireframeHelper:WireframeHelper,WrapAroundEnding:WrapAroundEnding,XHRLoader:XHRLoader,ZeroCurvatureEnding:ZeroCurvatureEnding,ZeroFactor:ZeroFactor,ZeroSlopeEnding:ZeroSlopeEnding,sRGBEncoding:sRGBEncoding},OrbitControls=function(e,t){var i,r,n,a,o;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:MOUSE.LEFT,MIDDLE:MOUSE.MIDDLE,RIGHT:MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(l),s.update(),d=u.NONE},this.update=(i=new Vector3,r=(new Quaternion).setFromUnitVectors(e.up,new Vector3(0,1,0)),n=r.clone().inverse(),a=new Vector3,o=new Quaternion,function(){var e=s.object.position;return i.copy(e).sub(s.target),i.applyQuaternion(r),m.setFromVector3(i),s.autoRotate&&d===u.NONE&&P(2*Math.PI/60/60*s.autoRotateSpeed),m.theta+=f.theta,m.phi+=f.phi,m.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,m.theta)),m.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,m.phi)),m.makeSafe(),m.radius*=g,m.radius=Math.max(s.minDistance,Math.min(s.maxDistance,m.radius)),s.target.add(v),i.setFromSpherical(m),i.applyQuaternion(n),e.copy(s.target).add(i),s.object.lookAt(s.target),!0===s.enableDamping?(f.theta*=1-s.dampingFactor,f.phi*=1-s.dampingFactor,v.multiplyScalar(1-s.dampingFactor)):(f.set(0,0,0),v.set(0,0,0)),g=1,!!(y||a.distanceToSquared(s.object.position)>p||8*(1-o.dot(s.object.quaternion))>p)&&(s.dispatchEvent(l),a.copy(s.object.position),o.copy(s.object.quaternion),y=!1,!0)}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",W,!1),s.domElement.removeEventListener("mousedown",N,!1),s.domElement.removeEventListener("wheel",U,!1),s.domElement.removeEventListener("touchstart",H,!1),s.domElement.removeEventListener("touchend",j,!1),s.domElement.removeEventListener("touchmove",$,!1),document.removeEventListener("mousemove",z,!1),document.removeEventListener("mouseup",G,!1),window.removeEventListener("keydown",V,!1)};var s=this,l={type:"change"},c={type:"start"},h={type:"end"},u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},d=u.NONE,p=1e-6,m=new Spherical,f=new Spherical,g=1,v=new Vector3,y=!1,b=new Vector2,_=new Vector2,x=new Vector2,w=new Vector2,S=new Vector2,T=new Vector2,A=new Vector2,E=new Vector2,C=new Vector2;function M(){return Math.pow(.95,s.zoomSpeed)}function P(e){f.theta-=e}function L(e){f.phi-=e}var I,B=(I=new Vector3,function(e,t){I.setFromMatrixColumn(t,0),I.multiplyScalar(-e),v.add(I)}),R=function(){var e=new Vector3;return function(t,i){!0===s.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(s.object.up,e)),e.multiplyScalar(t),v.add(e)}}(),F=function(){var e=new Vector3;return function(t,i){var r=s.domElement===document?s.domElement.body:s.domElement;if(s.object.isPerspectiveCamera){var n=s.object.position;e.copy(n).sub(s.target);var a=e.length();a*=Math.tan(s.object.fov/2*Math.PI/180),B(2*t*a/r.clientHeight,s.object.matrix),R(2*i*a/r.clientHeight,s.object.matrix)}else s.object.isOrthographicCamera?(B(t*(s.object.right-s.object.left)/s.object.zoom/r.clientWidth,s.object.matrix),R(i*(s.object.top-s.object.bottom)/s.object.zoom/r.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function O(e){s.object.isPerspectiveCamera?g/=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function k(e){s.object.isPerspectiveCamera?g*=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function D(e){w.set(e.clientX,e.clientY)}function N(e){if(!1!==s.enabled){switch(e.preventDefault(),s.domElement.focus?s.domElement.focus():window.focus(),e.button){case s.mouseButtons.LEFT:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enablePan)return;D(e),d=u.PAN}else{if(!1===s.enableRotate)return;!function(e){b.set(e.clientX,e.clientY)}(e),d=u.ROTATE}break;case s.mouseButtons.MIDDLE:if(!1===s.enableZoom)return;!function(e){A.set(e.clientX,e.clientY)}(e),d=u.DOLLY;break;case s.mouseButtons.RIGHT:if(!1===s.enablePan)return;D(e),d=u.PAN}d!==u.NONE&&(document.addEventListener("mousemove",z,!1),document.addEventListener("mouseup",G,!1),s.dispatchEvent(c))}}function z(e){if(!1!==s.enabled)switch(e.preventDefault(),d){case u.ROTATE:if(!1===s.enableRotate)return;!function(e){_.set(e.clientX,e.clientY),x.subVectors(_,b).multiplyScalar(s.rotateSpeed);var t=s.domElement===document?s.domElement.body:s.domElement;P(2*Math.PI*x.x/t.clientHeight),L(2*Math.PI*x.y/t.clientHeight),b.copy(_),s.update()}(e);break;case u.DOLLY:if(!1===s.enableZoom)return;!function(e){E.set(e.clientX,e.clientY),C.subVectors(E,A),0<C.y?O(M()):0>C.y&&k(M()),A.copy(E),s.update()}(e);break;case u.PAN:if(!1===s.enablePan)return;!function(e){S.set(e.clientX,e.clientY),T.subVectors(S,w).multiplyScalar(s.panSpeed),F(T.x,T.y),w.copy(S),s.update()}(e)}}function G(e){!1!==s.enabled&&(document.removeEventListener("mousemove",z,!1),document.removeEventListener("mouseup",G,!1),s.dispatchEvent(h),d=u.NONE)}function U(e){!1===s.enabled||!1===s.enableZoom||d!==u.NONE&&d!==u.ROTATE||(e.preventDefault(),e.stopPropagation(),s.dispatchEvent(c),function(e){0>e.deltaY?k(M()):0<e.deltaY&&O(M()),s.update()}(e),s.dispatchEvent(h))}function V(e){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(e){var t=!1;switch(e.keyCode){case s.keys.UP:F(0,s.keyPanSpeed),t=!0;break;case s.keys.BOTTOM:F(0,-s.keyPanSpeed),t=!0;break;case s.keys.LEFT:F(s.keyPanSpeed,0),t=!0;break;case s.keys.RIGHT:F(-s.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),s.update())}(e)}function H(e){if(!1!==s.enabled){switch(e.preventDefault(),e.touches.length){case 1:if(!1===s.enableRotate)return;!function(e){b.set(e.touches[0].pageX,e.touches[0].pageY)}(e),d=u.TOUCH_ROTATE;break;case 2:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){if(s.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+i*i);A.set(0,r)}if(s.enablePan){var n=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);w.set(n,a)}}(e),d=u.TOUCH_DOLLY_PAN;break;default:d=u.NONE}d!==u.NONE&&s.dispatchEvent(c)}}function $(e){if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===s.enableRotate)return;if(d!==u.TOUCH_ROTATE)return;!function(e){_.set(e.touches[0].pageX,e.touches[0].pageY),x.subVectors(_,b).multiplyScalar(s.rotateSpeed);var t=s.domElement===document?s.domElement.body:s.domElement;P(2*Math.PI*x.x/t.clientHeight),L(2*Math.PI*x.y/t.clientHeight),b.copy(_),s.update()}(e);break;case 2:if(!1===s.enableZoom&&!1===s.enablePan)return;if(d!==u.TOUCH_DOLLY_PAN)return;!function(e){if(s.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+i*i);E.set(0,r),C.set(0,Math.pow(E.y/A.y,s.zoomSpeed)),O(C.y),A.copy(E)}if(s.enablePan){var n=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);S.set(n,a),T.subVectors(S,w).multiplyScalar(s.panSpeed),F(T.x,T.y),w.copy(S)}s.update()}(e);break;default:d=u.NONE}}function j(e){!1!==s.enabled&&(s.dispatchEvent(h),d=u.NONE)}function W(e){!1!==s.enabled&&e.preventDefault()}s.domElement.addEventListener("contextmenu",W,!1),s.domElement.addEventListener("mousedown",N,!1),s.domElement.addEventListener("wheel",U,!1),s.domElement.addEventListener("touchstart",H,!1),s.domElement.addEventListener("touchend",j,!1),s.domElement.addEventListener("touchmove",$,!1),window.addEventListener("keydown",V,!1),this.update()};OrbitControls.prototype=Object.create(EventDispatcher.prototype),OrbitControls.prototype.constructor=OrbitControls,Object.defineProperties(OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}});var OrbitControls$1={OrbitControls:OrbitControls},SimplexNoise=function(e){void 0==e&&(e=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(var t=0;256>t;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(t=0;512>t;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]};SimplexNoise.prototype.dot=function(e,t,i){return e[0]*t+e[1]*i},SimplexNoise.prototype.dot3=function(e,t,i,r){return e[0]*t+e[1]*i+e[2]*r},SimplexNoise.prototype.dot4=function(e,t,i,r,n){return e[0]*t+e[1]*i+e[2]*r+e[3]*n},SimplexNoise.prototype.noise=function(e,t){var i,r,n=(e+t)*(.5*(Math.sqrt(3)-1)),a=Math.floor(e+n),o=Math.floor(t+n),s=(3-Math.sqrt(3))/6,l=(a+o)*s,c=e-(a-l),h=t-(o-l);c>h?(i=1,r=0):(i=0,r=1);var u=c-i+s,d=h-r+s,p=c-1+2*s,m=h-1+2*s,f=255&a,g=255&o,v=this.perm[f+this.perm[g]]%12,y=this.perm[f+i+this.perm[g+r]]%12,b=this.perm[f+1+this.perm[g+1]]%12,_=.5-c*c-h*h,x=.5-u*u-d*d,w=.5-p*p-m*m;return 70*((0>_?0:(_*=_)*_*this.dot(this.grad3[v],c,h))+(0>x?0:(x*=x)*x*this.dot(this.grad3[y],u,d))+(0>w?0:(w*=w)*w*this.dot(this.grad3[b],p,m)))},SimplexNoise.prototype.noise3d=function(e,t,i){var r,n,a,o,s,l,c=(e+t+i)*(1/3),h=Math.floor(e+c),u=Math.floor(t+c),d=Math.floor(i+c),p=1/6,m=(h+u+d)*p,f=e-(h-m),g=t-(u-m),v=i-(d-m);f>=g?g>=v?(r=1,n=0,a=0,o=1,s=1,l=0):f>=v?(r=1,n=0,a=0,o=1,s=0,l=1):(r=0,n=0,a=1,o=1,s=0,l=1):g<v?(r=0,n=0,a=1,o=0,s=1,l=1):f<v?(r=0,n=1,a=0,o=0,s=1,l=1):(r=0,n=1,a=0,o=1,s=1,l=0);var y=f-r+p,b=g-n+p,_=v-a+p,x=f-o+2*p,w=g-s+2*p,S=v-l+2*p,T=f-1+.5,A=g-1+.5,E=v-1+.5,C=255&h,M=255&u,P=255&d,L=this.perm[C+this.perm[M+this.perm[P]]]%12,I=this.perm[C+r+this.perm[M+n+this.perm[P+a]]]%12,B=this.perm[C+o+this.perm[M+s+this.perm[P+l]]]%12,R=this.perm[C+1+this.perm[M+1+this.perm[P+1]]]%12,F=.6-f*f-g*g-v*v,O=.6-y*y-b*b-_*_,k=.6-x*x-w*w-S*S,D=.6-T*T-A*A-E*E;return 32*((0>F?0:(F*=F)*F*this.dot3(this.grad3[L],f,g,v))+(0>O?0:(O*=O)*O*this.dot3(this.grad3[I],y,b,_))+(0>k?0:(k*=k)*k*this.dot3(this.grad3[B],x,w,S))+(0>D?0:(D*=D)*D*this.dot3(this.grad3[R],T,A,E)))},SimplexNoise.prototype.noise4d=function(e,t,i,r){var n,a,o,s,l,c,h,u,d,p,m,f,g=this.grad4,v=this.simplex,y=this.perm,b=(Math.sqrt(5)-1)/4,_=(5-Math.sqrt(5))/20,x=(e+t+i+r)*b,w=Math.floor(e+x),S=Math.floor(t+x),T=Math.floor(i+x),A=Math.floor(r+x),E=(w+S+T+A)*_,C=e-(w-E),M=t-(S-E),P=i-(T-E),L=r-(A-E),I=(C>M?32:0)+(C>P?16:0)+(M>P?8:0)+(C>L?4:0)+(M>L?2:0)+(P>L?1:0),B=C-(n=3<=v[I][0]?1:0)+_,R=M-(a=3<=v[I][1]?1:0)+_,F=P-(o=3<=v[I][2]?1:0)+_,O=L-(s=3<=v[I][3]?1:0)+_,k=C-(l=2<=v[I][0]?1:0)+2*_,D=M-(c=2<=v[I][1]?1:0)+2*_,N=P-(h=2<=v[I][2]?1:0)+2*_,z=L-(u=2<=v[I][3]?1:0)+2*_,G=C-(d=1<=v[I][0]?1:0)+3*_,U=M-(p=1<=v[I][1]?1:0)+3*_,V=P-(m=1<=v[I][2]?1:0)+3*_,H=L-(f=1<=v[I][3]?1:0)+3*_,$=C-1+4*_,j=M-1+4*_,W=P-1+4*_,X=L-1+4*_,q=255&w,Y=255&S,Q=255&T,K=255&A,Z=y[q+y[Y+y[Q+y[K]]]]%32,J=y[q+n+y[Y+a+y[Q+o+y[K+s]]]]%32,ee=y[q+l+y[Y+c+y[Q+h+y[K+u]]]]%32,te=y[q+d+y[Y+p+y[Q+m+y[K+f]]]]%32,ie=y[q+1+y[Y+1+y[Q+1+y[K+1]]]]%32,re=.6-C*C-M*M-P*P-L*L,ne=.6-B*B-R*R-F*F-O*O,ae=.6-k*k-D*D-N*N-z*z,oe=.6-G*G-U*U-V*V-H*H,se=.6-$*$-j*j-W*W-X*X;return 27*((0>re?0:(re*=re)*re*this.dot4(g[Z],C,M,P,L))+(0>ne?0:(ne*=ne)*ne*this.dot4(g[J],B,R,F,O))+(0>ae?0:(ae*=ae)*ae*this.dot4(g[ee],k,D,N,z))+(0>oe?0:(oe*=oe)*oe*this.dot4(g[te],G,U,V,H))+(0>se?0:(se*=se)*se*this.dot4(g[ie],$,j,W,X)))};var SimplexNoise$1={SimplexNoise:SimplexNoise},LightningStrike=function(e){BufferGeometry.call(this),this.type="LightningStrike",e=e||{},this.init(LightningStrike.copyParameters(e,e)),this.createMesh()};LightningStrike.prototype=Object.create(BufferGeometry.prototype),LightningStrike.prototype.constructor=LightningStrike,LightningStrike.prototype.isLightningStrike=!0,LightningStrike.RAY_INITIALIZED=0,LightningStrike.RAY_UNBORN=1,LightningStrike.RAY_PROPAGATING=2,LightningStrike.RAY_STEADY=3,LightningStrike.RAY_VANISHING=4,LightningStrike.RAY_EXTINGUISHED=5,LightningStrike.COS30DEG=Math.cos(30*Math.PI/180),LightningStrike.SIN30DEG=Math.sin(30*Math.PI/180),LightningStrike.createRandomGenerator=function(){for(var e=[],t=0;t<2053;t++)e.push(Math.random());var i={currentSeed:0,random:function(){var t=e[i.currentSeed];return i.currentSeed=(i.currentSeed+1)%2053,t},getSeed:function(){return i.currentSeed/2053},setSeed:function(e){i.currentSeed=Math.floor(2053*e)%2053}};return i},LightningStrike.copyParameters=function(e,t){t=t||{};var i=function(i){return t===e?i:i.clone()};return(e=e||{}).sourceOffset=void 0!==t.sourceOffset?i(t.sourceOffset):new Vector3(0,100,0),e.destOffset=void 0!==t.destOffset?i(t.destOffset):new Vector3(0,0,0),e.timeScale=void 0!==t.timeScale?t.timeScale:1,e.roughness=void 0!==t.roughness?t.roughness:.9,e.straightness=void 0!==t.straightness?t.straightness:.7,e.up0=void 0!==t.up0?i(t.up0):new Vector3(0,0,1),e.up1=void 0!==t.up1?i(t.up1):new Vector3(0,0,1),e.radius0=void 0!==t.radius0?t.radius0:1,e.radius1=void 0!==t.radius1?t.radius1:1,e.radius0Factor=void 0!==t.radius0Factor?t.radius0Factor:.5,e.radius1Factor=void 0!==t.radius1Factor?t.radius1Factor:.2,e.minRadius=void 0!==t.minRadius?t.minRadius:.2,e.isEternal=void 0!==t.isEternal?t.isEternal:void 0===t.birthTime||void 0===t.deathTime,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.propagationTimeFactor=void 0!==t.propagationTimeFactor?t.propagationTimeFactor:.1,e.vanishingTimeFactor=void 0!==t.vanishingTimeFactor?t.vanishingTimeFactor:.9,e.subrayPeriod=void 0!==t.subrayPeriod?t.subrayPeriod:4,e.subrayDutyCycle=void 0!==t.subrayDutyCycle?t.subrayDutyCycle:.6,e.maxIterations=void 0!==t.maxIterations?t.maxIterations:9,e.isStatic=void 0!==t.isStatic&&t.isStatic,e.ramification=void 0!==t.ramification?t.ramification:5,e.maxSubrayRecursion=void 0!==t.maxSubrayRecursion?t.maxSubrayRecursion:3,e.recursionProbability=void 0!==t.recursionProbability?t.recursionProbability:.6,e.generateUVs=void 0!==t.generateUVs&&t.generateUVs,e.randomGenerator=t.randomGenerator,e.noiseSeed=t.noiseSeed,e.onDecideSubrayCreation=t.onDecideSubrayCreation,e.onSubrayCreation=t.onSubrayCreation,e},LightningStrike.prototype.update=function(e){this.isStatic||(this.rayParameters.isEternal||this.rayParameters.birthTime<=e&&e<=this.rayParameters.deathTime?(this.updateMesh(e),e<this.subrays[0].endPropagationTime?this.state=LightningStrike.RAY_PROPAGATING:e>this.subrays[0].beginVanishingTime?this.state=LightningStrike.RAY_VANISHING:this.state=LightningStrike.RAY_STEADY,this.visible=!0):(this.visible=!1,e<this.rayParameters.birthTime?this.state=LightningStrike.RAY_UNBORN:this.state=LightningStrike.RAY_EXTINGUISHED))},LightningStrike.prototype.init=function(e){this.rayParameters=e,this.maxIterations=void 0!==e.maxIterations?Math.floor(e.maxIterations):9,e.maxIterations=this.maxIterations,this.isStatic=void 0!==e.isStatic&&e.isStatic,e.isStatic=this.isStatic,this.ramification=void 0!==e.ramification?Math.floor(e.ramification):5,e.ramification=this.ramification,this.maxSubrayRecursion=void 0!==e.maxSubrayRecursion?Math.floor(e.maxSubrayRecursion):3,e.maxSubrayRecursion=this.maxSubrayRecursion,this.recursionProbability=void 0!==e.recursionProbability?e.recursionProbability:.6,e.recursionProbability=this.recursionProbability,this.generateUVs=void 0!==e.generateUVs&&e.generateUVs,e.generateUVs=this.generateUVs,void 0!==e.randomGenerator?(this.randomGenerator=e.randomGenerator,this.seedGenerator=e.randomGenerator,void 0!==e.noiseSeed&&this.seedGenerator.setSeed(e.noiseSeed)):(this.randomGenerator=LightningStrike.createRandomGenerator(),this.seedGenerator=Math),void 0!==e.onDecideSubrayCreation?this.onDecideSubrayCreation=e.onDecideSubrayCreation:(this.createDefaultSubrayCreationCallbacks(),void 0!==e.onSubrayCreation&&(this.onSubrayCreation=e.onSubrayCreation)),this.state=LightningStrike.RAY_INITIALIZED,this.maxSubrays=Math.ceil(1+Math.pow(this.ramification,Math.max(0,this.maxSubrayRecursion-1))),e.maxSubrays=this.maxSubrays,this.maxRaySegments=2*(1<<this.maxIterations),this.subrays=[];for(var t=0;t<this.maxSubrays;t++)this.subrays.push(this.createSubray());this.raySegments=[];for(t=0;t<this.maxRaySegments;t++)this.raySegments.push(this.createSegment());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this.generateUVs?this.createTriangleVerticesWithUVs:this.createTriangleVerticesWithoutUVs,this.numSubrays=0,this.currentSubray=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.vertices=null,this.uvs=null,this.indices=null,this.positionAttribute=null,this.uvsAttribute=null,this.simplexX=new SimplexNoise(this.seedGenerator),this.simplexY=new SimplexNoise(this.seedGenerator),this.simplexZ=new SimplexNoise(this.seedGenerator),this.forwards=new Vector3,this.forwardsFill=new Vector3,this.side=new Vector3,this.down=new Vector3,this.middlePos=new Vector3,this.middleLinPos=new Vector3,this.newPos=new Vector3,this.vPos=new Vector3,this.cross1=new Vector3},LightningStrike.prototype.createMesh=function(){var e=1<<this.maxIterations,t=3*(e+1)*this.maxSubrays,i=18*e*this.maxSubrays;this.vertices=new Float32Array(3*t),this.indices=new Uint32Array(i),this.generateUVs&&(this.uvs=new Float32Array(2*t)),this.fillMesh(0),this.setIndex(new Uint32BufferAttribute(this.indices,1)),this.positionAttribute=new Float32BufferAttribute(this.vertices,3),this.addAttribute("position",this.positionAttribute),this.generateUVs&&(this.uvsAttribute=new Float32BufferAttribute(new Float32Array(this.uvs),2),this.addAttribute("uv",this.uvsAttribute)),this.isStatic||(this.index.dynamic=!0,this.positionAttribute.dynamic=!0,this.generateUVs&&(this.uvsAttribute.dynamic=!0)),this.vertices=this.positionAttribute.array,this.indices=this.index.array,this.generateUVs&&(this.uvs=this.uvsAttribute.array)},LightningStrike.prototype.updateMesh=function(e){this.fillMesh(e),this.drawRange.count=this.currentIndex,this.index.needsUpdate=!0,this.positionAttribute.needsUpdate=!0,this.generateUVs&&(this.uvsAttribute.needsUpdate=!0)},LightningStrike.prototype.fillMesh=function(e){var t=this;this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.fractalRay(e,function(i){var r=t.currentSubray;e<r.birthTime||(this.rayParameters.isEternal&&0==t.currentSubray.recursion?(t.createPrism(i),t.onDecideSubrayCreation(i,t)):e<r.endPropagationTime?t.timeFraction>=i.fraction0*r.propagationTimeFactor&&(t.createPrism(i),t.onDecideSubrayCreation(i,t)):e<r.beginVanishingTime?(t.createPrism(i),t.onDecideSubrayCreation(i,t)):(t.timeFraction<=r.vanishingTimeFactor+i.fraction1*(1-r.vanishingTimeFactor)&&t.createPrism(i),t.onDecideSubrayCreation(i,t)))})},LightningStrike.prototype.addNewSubray=function(e){return this.subrays[this.numSubrays++]},LightningStrike.prototype.initSubray=function(e,t){e.pos0.copy(t.sourceOffset),e.pos1.copy(t.destOffset),e.up0.copy(t.up0),e.up1.copy(t.up1),e.radius0=t.radius0,e.radius1=t.radius1,e.birthTime=t.birthTime,e.deathTime=t.deathTime,e.timeScale=t.timeScale,e.roughness=t.roughness,e.straightness=t.straightness,e.propagationTimeFactor=t.propagationTimeFactor,e.vanishingTimeFactor=t.vanishingTimeFactor,e.maxIterations=this.maxIterations,e.seed=void 0!==t.noiseSeed?t.noiseSeed:0,e.recursion=0},LightningStrike.prototype.fractalRay=function(e,t){this.time=e,this.currentSegmentCallback=t,this.numSubrays=0,this.initSubray(this.addNewSubray(),this.rayParameters);for(var i,r=0;r<this.numSubrays;r++){i=this.subrays[r],this.currentSubray=i,this.randomGenerator.setSeed(i.seed),i.endPropagationTime=_Math.lerp(i.birthTime,i.deathTime,i.propagationTimeFactor),i.beginVanishingTime=_Math.lerp(i.deathTime,i.birthTime,1-i.vanishingTimeFactor);var n=this.randomGenerator.random;i.linPos0.set(n(),n(),n()).multiplyScalar(1e3),i.linPos1.set(n(),n(),n()).multiplyScalar(1e3),this.timeFraction=(e-i.birthTime)/(i.deathTime-i.birthTime),this.currentSegmentIndex=0,this.isInitialSegment=!0;var a=this.getNewSegment();a.iteration=0,a.pos0.copy(i.pos0),a.pos1.copy(i.pos1),a.linPos0.copy(i.linPos0),a.linPos1.copy(i.linPos1),a.up0.copy(i.up0),a.up1.copy(i.up1),a.radius0=i.radius0,a.radius1=i.radius1,a.fraction0=0,a.fraction1=1,a.positionVariationFactor=1-i.straightness,this.subrayProbability=this.ramification*Math.pow(this.recursionProbability,i.recursion)/(1<<i.maxIterations),this.fractalRayRecursive(a)}this.currentSegmentCallback=null,this.currentSubray=null},LightningStrike.prototype.fractalRayRecursive=function(e){if(e.iteration>=this.currentSubray.maxIterations)this.currentSegmentCallback(e);else{this.forwards.subVectors(e.pos1,e.pos0);var t=this.forwards.length();1e-6>t&&(this.forwards.set(0,0,.01),t=this.forwards.length());var i=.5*(e.radius0+e.radius1),r=.5*(e.fraction0+e.fraction1),n=this.time*this.currentSubray.timeScale*Math.pow(2,e.iteration);this.middlePos.lerpVectors(e.pos0,e.pos1,.5),this.middleLinPos.lerpVectors(e.linPos0,e.linPos1,.5);var a=this.middleLinPos;this.newPos.set(this.simplexX.noise4d(a.x,a.y,a.z,n),this.simplexY.noise4d(a.x,a.y,a.z,n),this.simplexZ.noise4d(a.x,a.y,a.z,n)),this.newPos.multiplyScalar(e.positionVariationFactor*t),this.newPos.add(this.middlePos);var o=this.getNewSegment();o.pos0.copy(e.pos0),o.pos1.copy(this.newPos),o.linPos0.copy(e.linPos0),o.linPos1.copy(this.middleLinPos),o.up0.copy(e.up0),o.up1.copy(e.up1),o.radius0=e.radius0,o.radius1=i,o.fraction0=e.fraction0,o.fraction1=r,o.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,o.iteration=e.iteration+1;var s=this.getNewSegment();s.pos0.copy(this.newPos),s.pos1.copy(e.pos1),s.linPos0.copy(this.middleLinPos),s.linPos1.copy(e.linPos1),this.cross1.crossVectors(e.up0,this.forwards.normalize()),s.up0.crossVectors(this.forwards,this.cross1).normalize(),s.up1.copy(e.up1),s.radius0=i,s.radius1=e.radius1,s.fraction0=r,s.fraction1=e.fraction1,s.positionVariationFactor=e.positionVariationFactor*this.currentSubray.roughness,s.iteration=e.iteration+1,this.fractalRayRecursive(o),this.fractalRayRecursive(s)}},LightningStrike.prototype.createPrism=function(e){this.forwardsFill.subVectors(e.pos1,e.pos0).normalize(),this.isInitialSegment&&(this.currentCreateTriangleVertices(e.pos0,e.up0,this.forwardsFill,e.radius0,0),this.isInitialSegment=!1),this.currentCreateTriangleVertices(e.pos1,e.up0,this.forwardsFill,e.radius1,e.fraction1),this.createPrismFaces()},LightningStrike.prototype.createTriangleVerticesWithoutUVs=function(e,t,i,r){this.side.crossVectors(t,i).multiplyScalar(r*LightningStrike.COS30DEG),this.down.copy(t).multiplyScalar(-r*LightningStrike.SIN30DEG);var n=this.vPos,a=this.vertices;n.copy(e).sub(this.side).add(this.down),a[this.currentCoordinate++]=n.x,a[this.currentCoordinate++]=n.y,a[this.currentCoordinate++]=n.z,n.copy(e).add(this.side).add(this.down),a[this.currentCoordinate++]=n.x,a[this.currentCoordinate++]=n.y,a[this.currentCoordinate++]=n.z,n.copy(t).multiplyScalar(r).add(e),a[this.currentCoordinate++]=n.x,a[this.currentCoordinate++]=n.y,a[this.currentCoordinate++]=n.z,this.currentVertex+=3},LightningStrike.prototype.createTriangleVerticesWithUVs=function(e,t,i,r,n){this.side.crossVectors(t,i).multiplyScalar(r*LightningStrike.COS30DEG),this.down.copy(t).multiplyScalar(-r*LightningStrike.SIN30DEG);var a=this.vPos,o=this.vertices,s=this.uvs;a.copy(e).sub(this.side).add(this.down),o[this.currentCoordinate++]=a.x,o[this.currentCoordinate++]=a.y,o[this.currentCoordinate++]=a.z,s[this.currentUVCoordinate++]=n,s[this.currentUVCoordinate++]=0,a.copy(e).add(this.side).add(this.down),o[this.currentCoordinate++]=a.x,o[this.currentCoordinate++]=a.y,o[this.currentCoordinate++]=a.z,s[this.currentUVCoordinate++]=n,s[this.currentUVCoordinate++]=.5,a.copy(t).multiplyScalar(r).add(e),o[this.currentCoordinate++]=a.x,o[this.currentCoordinate++]=a.y,o[this.currentCoordinate++]=a.z,s[this.currentUVCoordinate++]=n,s[this.currentUVCoordinate++]=1,this.currentVertex+=3},LightningStrike.prototype.createPrismFaces=function(e,t){var i=this.indices;e=this.currentVertex-6;i[this.currentIndex++]=e+1,i[this.currentIndex++]=e+2,i[this.currentIndex++]=e+5,i[this.currentIndex++]=e+1,i[this.currentIndex++]=e+5,i[this.currentIndex++]=e+4,i[this.currentIndex++]=e+0,i[this.currentIndex++]=e+1,i[this.currentIndex++]=e+4,i[this.currentIndex++]=e+0,i[this.currentIndex++]=e+4,i[this.currentIndex++]=e+3,i[this.currentIndex++]=e+2,i[this.currentIndex++]=e+0,i[this.currentIndex++]=e+3,i[this.currentIndex++]=e+2,i[this.currentIndex++]=e+3,i[this.currentIndex++]=e+5},LightningStrike.prototype.createDefaultSubrayCreationCallbacks=function(){var e=this.randomGenerator.random;this.onDecideSubrayCreation=function(t,i){var r=i.currentSubray,n=i.rayParameters.subrayPeriod,a=i.rayParameters.subrayDutyCycle,o=i.rayParameters.isEternal&&0==r.recursion?-e()*n:_Math.lerp(r.birthTime,r.endPropagationTime,t.fraction0)-e()*n,s=i.time-o,l=Math.floor(s/n),c=e()*(l+1),h=0;if(s%n<=a*n&&(h=i.subrayProbability),r.recursion<i.maxSubrayRecursion&&i.numSubrays<i.maxSubrays&&e()<h){var u=i.addNewSubray(),d=i.randomGenerator.getSeed();u.seed=c,i.randomGenerator.setSeed(c),u.recursion=r.recursion+1,u.maxIterations=Math.max(1,r.maxIterations-1),u.linPos0.set(e(),e(),e()).multiplyScalar(1e3),u.linPos1.set(e(),e(),e()).multiplyScalar(1e3),u.up0.copy(r.up0),u.up1.copy(r.up1),u.radius0=t.radius0*i.rayParameters.radius0Factor,u.radius1=Math.min(i.rayParameters.minRadius,t.radius1*i.rayParameters.radius1Factor),u.birthTime=o+l*n,u.deathTime=u.birthTime+n*a,i.rayParameters.isEternal||0!=r.recursion||(u.birthTime=Math.max(u.birthTime,r.birthTime),u.deathTime=Math.min(u.deathTime,r.deathTime)),u.timeScale=2*r.timeScale,u.roughness=r.roughness,u.straightness=r.straightness,u.propagationTimeFactor=r.propagationTimeFactor,u.vanishingTimeFactor=r.vanishingTimeFactor,i.onSubrayCreation(t,r,u,i),i.randomGenerator.setSeed(d)}};var t=new Vector3,i=new Vector3,r=new Vector3,n=new Vector3;this.onSubrayCreation=function(e,t,i,r){r.subrayCylinderPosition(e,t,i,.5,.6,.2)},this.subrayConePosition=function(a,o,s,l,c,h){s.pos0.copy(a.pos0),t.subVectors(o.pos1,o.pos0),i.copy(t).normalize(),t.multiplyScalar(a.fraction0+(1-a.fraction0)*(e()*l));var u=t.length();r.crossVectors(o.up0,i);var d=2*Math.PI*e();r.multiplyScalar(Math.cos(d)),n.copy(o.up0).multiplyScalar(Math.sin(d)),s.pos1.copy(r).add(n).multiplyScalar(u*c*(h+e()*(1-h))).add(t).add(o.pos0)},this.subrayCylinderPosition=function(a,o,s,l,c,h){s.pos0.copy(a.pos0),t.subVectors(o.pos1,o.pos0),i.copy(t).normalize(),t.multiplyScalar(a.fraction0+(1-a.fraction0)*((2*e()-1)*l));var u=t.length();r.crossVectors(o.up0,i);var d=2*Math.PI*e();r.multiplyScalar(Math.cos(d)),n.copy(o.up0).multiplyScalar(Math.sin(d)),s.pos1.copy(r).add(n).multiplyScalar(u*c*(h+e()*(1-h))).add(t).add(o.pos0)}},LightningStrike.prototype.createSubray=function(){return{seed:0,maxIterations:0,recursion:0,pos0:new Vector3,pos1:new Vector3,linPos0:new Vector3,linPos1:new Vector3,up0:new Vector3,up1:new Vector3,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}},LightningStrike.prototype.createSegment=function(){return{iteration:0,pos0:new Vector3,pos1:new Vector3,linPos0:new Vector3,linPos1:new Vector3,up0:new Vector3,up1:new Vector3,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}},LightningStrike.prototype.getNewSegment=function(){return this.raySegments[this.currentSegmentIndex++]},LightningStrike.prototype.copy=function(e){return BufferGeometry.prototype.copy.call(this,e),this.init(LightningStrike.copyParameters({},e.rayParameters)),this},LightningStrike.prototype.clone=function(){return new this.constructor(LightningStrike.copyParameters({},this.rayParameters))};var LightningStrike$1={LightningStrike:LightningStrike},LightningStorm=function(e){Object3D.call(this),e=e||{},this.stormParams=e,e.size=void 0!==e.size?e.size:1e3,e.minHeight=void 0!==e.minHeight?e.minHeight:80,e.maxHeight=void 0!==e.maxHeight?e.maxHeight:100,e.maxSlope=void 0!==e.maxSlope?e.maxSlope:1.1,e.maxLightnings=void 0!==e.maxLightnings?e.maxLightnings:3,e.lightningMinPeriod=void 0!==e.lightningMinPeriod?e.lightningMinPeriod:3,e.lightningMaxPeriod=void 0!==e.lightningMaxPeriod?e.lightningMaxPeriod:7,e.lightningMinDuration=void 0!==e.lightningMinDuration?e.lightningMinDuration:1,e.lightningMaxDuration=void 0!==e.lightningMaxDuration?e.lightningMaxDuration:2.5,this.lightningParameters=LightningStrike.copyParameters(e.lightningParameters,e.lightningParameters),this.lightningParameters.isEternal=!1,this.lightningMaterial=void 0!==e.lightningMaterial?e.lightningMaterial:new MeshBasicMaterial({color:11599871}),void 0!==e.onRayPosition?this.onRayPosition=e.onRayPosition:this.onRayPosition=function(t,i){i.set((Math.random()-.5)*e.size,0,(Math.random()-.5)*e.size);var r=_Math.lerp(e.minHeight,e.maxHeight,Math.random());t.set(e.maxSlope*(2*Math.random()-1),1,e.maxSlope*(2*Math.random()-1)).multiplyScalar(r).add(i)},this.onLightningDown=e.onLightningDown,this.inited=!1,this.nextLightningTime=0,this.lightningsMeshes=[],this.deadLightningsMeshes=[];for(var t=0;t<this.stormParams.maxLightnings;t++){var i=new Mesh(new LightningStrike(LightningStrike.copyParameters({},this.lightningParameters)),this.lightningMaterial);this.deadLightningsMeshes.push(i)}};LightningStorm.prototype=Object.create(Object3D.prototype),LightningStorm.prototype.constructor=LightningStorm,LightningStorm.prototype.isLightningStorm=!0,LightningStorm.prototype.update=function(e){if(this.inited||(this.nextLightningTime=this.getNextLightningTime(e)*Math.random(),this.inited=!0),e>=this.nextLightningTime){var t=this.deadLightningsMeshes.pop();if(t){var i=LightningStrike.copyParameters(t.geometry.rayParameters,this.lightningParameters);i.birthTime=e,i.deathTime=e+_Math.lerp(this.stormParams.lightningMinDuration,this.stormParams.lightningMaxDuration,Math.random()),this.onRayPosition(i.sourceOffset,i.destOffset),i.noiseSeed=Math.random(),this.add(t),this.lightningsMeshes.push(t)}this.nextLightningTime=this.getNextLightningTime(e)}for(var r=0,n=this.lightningsMeshes.length;r<n;){var a=this.lightningsMeshes[r],o=a.geometry,s=o.state;o.update(e),s===LightningStrike.RAY_PROPAGATING&&o.state>s&&this.onLightningDown&&this.onLightningDown(o),o.state===LightningStrike.RAY_EXTINGUISHED?(this.lightningsMeshes.splice(this.lightningsMeshes.indexOf(a),1),this.deadLightningsMeshes.push(a),this.remove(a),n--):r++}},LightningStorm.prototype.getNextLightningTime=function(e){return e+_Math.lerp(this.stormParams.lightningMinPeriod,this.stormParams.lightningMaxPeriod,Math.random())/(this.stormParams.maxLightnings+1)},LightningStorm.prototype.copy=function(e){return Object3D.prototype.copy.call(this,e),this.stormParams.size=e.stormParams.size,this.stormParams.minHeight=e.stormParams.minHeight,this.stormParams.maxHeight=e.stormParams.maxHeight,this.stormParams.maxSlope=e.stormParams.maxSlope,this.stormParams.maxLightnings=e.stormParams.maxLightnings,this.stormParams.lightningMinPeriod=e.stormParams.lightningMinPeriod,this.stormParams.lightningMaxPeriod=e.stormParams.lightningMaxPeriod,this.stormParams.lightningMinDuration=e.stormParams.lightningMinDuration,this.stormParams.lightningMaxDuration=e.stormParams.lightningMaxDuration,this.lightningParameters=LightningStrike.copyParameters({},e.lightningParameters),this.lightningMaterial=e.stormParams.lightningMaterial,this.onLightningDown=e.onLightningDown,this},LightningStrike.prototype.clone=function(){return new this.constructor(this.stormParams).copy(this)};var LightningStorm$1={LightningStorm:LightningStorm},CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")},CopyShader$1={CopyShader:CopyShader};function Pass(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(Pass.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),Pass.FullScreenQuad=function(){var e=new OrthographicCamera(-1,1,1,-1,0,1),t=new PlaneBufferGeometry(2,2),i=function(e){this._mesh=new Mesh(t,e)};return Object.defineProperty(i.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(i.prototype,{render:function(t){t.render(this._mesh,e)}}),i}();var Pass$1={Pass:Pass},ShaderPass=function(e,t){Pass.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=UniformsUtils.clone(e.uniforms),this.material=new ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Pass.FullScreenQuad(this.material)};ShaderPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:ShaderPass,render:function(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}});var ShaderPass$1={ShaderPass:ShaderPass},MaskPass=function(e,t){Pass.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1};MaskPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:MaskPass,render:function(e,t,i){var r,n,a=e.context,o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),this.inverse?(r=0,n=1):(r=1,n=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.buffers.stencil.setFunc(a.ALWAYS,r,4294967295),o.buffers.stencil.setClear(n),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setFunc(a.EQUAL,1,4294967295),o.buffers.stencil.setOp(a.KEEP,a.KEEP,a.KEEP)}});var ClearMaskPass=function(){Pass.call(this),this.needsSwap=!1};ClearMaskPass.prototype=Object.create(Pass.prototype),Object.assign(ClearMaskPass.prototype,{render:function(e){e.state.buffers.stencil.setTest(!1)}});var MaskPass$1={MaskPass:MaskPass,ClearMaskPass:ClearMaskPass},EffectComposer=function(e,t){if(this.renderer=e,void 0===t){var i={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat,stencilBuffer:!1},r=e.getSize(new Vector2);this._pixelRatio=e.getPixelRatio(),this._width=r.width,this._height=r.height,(t=new WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,i)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===CopyShader&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===ShaderPass&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new ShaderPass(CopyShader),this.clock=new Clock};Object.assign(EffectComposer.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e);var t=this.renderer.getDrawingBufferSize(new Vector2);e.setSize(t.width,t.height)},insertPass:function(e,t){this.passes.splice(t,0,e)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){void 0===e&&(e=this.clock.getDelta());var t,i,r=this.renderer.getRenderTarget(),n=!1,a=this.passes.length;for(i=0;i<a;i++)if(!1!==(t=this.passes[i]).enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),t.needsSwap){if(n){var o=this.renderer.context;o.stencilFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),o.stencilFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==MaskPass&&(t instanceof MaskPass?n=!0:t instanceof ClearMaskPass&&(n=!1))}this.renderer.setRenderTarget(r)},reset:function(e){if(void 0===e){var t=this.renderer.getSize(new Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this._width=e,this._height=t;var i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(var n=0;n<this.passes.length;n++)this.passes[n].setSize(i,r)},setPixelRatio:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}});var Pass$2=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(Pass$2.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),Pass$2.FullScreenQuad=function(){var e=new OrthographicCamera(-1,1,1,-1,0,1),t=new PlaneBufferGeometry(2,2),i=function(e){this._mesh=new Mesh(t,e)};return Object.defineProperty(i.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(i.prototype,{render:function(t){t.render(this._mesh,e)}}),i}();var EffectComposer$1={EffectComposer:EffectComposer,Pass:Pass$2},OutlinePass=function(e,t,i,r){this.renderScene=t,this.renderCamera=i,this.selectedObjects=void 0!==r?r:[],this.visibleEdgeColor=new Color(1,1,1),this.hiddenEdgeColor=new Color(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,Pass.call(this),this.resolution=void 0!==e?new Vector2(e.x,e.y):new Vector2(256,256);var n={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat},a=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.maskBufferMaterial=new MeshBasicMaterial({color:16777215}),this.maskBufferMaterial.side=DoubleSide,this.renderTargetMaskBuffer=new WebGLRenderTarget(this.resolution.x,this.resolution.y,n),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new MeshDepthMaterial,this.depthMaterial.side=DoubleSide,this.depthMaterial.depthPacking=RGBADepthPacking,this.depthMaterial.blending=NoBlending,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=DoubleSide,this.prepareMaskMaterial.fragmentShader=function(e,t){var i=t.isPerspectiveCamera?"perspective":"orthographic";return e.replace(/DEPTH_TO_VIEW_Z/g,i+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new WebGLRenderTarget(this.resolution.x,this.resolution.y,n),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new WebGLRenderTarget(a,o,n),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new WebGLRenderTarget(a,o,n),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new WebGLRenderTarget(Math.round(a/2),Math.round(o/2),n),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new WebGLRenderTarget(a,o,n),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new WebGLRenderTarget(Math.round(a/2),Math.round(o/2),n),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value=new Vector2(a,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value=new Vector2(Math.round(a/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===CopyShader&&console.error("OutlinePass relies on CopyShader");var s=CopyShader;this.copyUniforms=UniformsUtils.clone(s.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,blending:NoBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new Color,this.oldClearAlpha=1,this.fsQuad=new Pass.FullScreenQuad(null),this.tempPulseColor1=new Color,this.tempPulseColor2=new Color,this.textureMatrix=new Matrix4};OutlinePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:OutlinePass,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(e,t){this.renderTargetMaskBuffer.setSize(e,t);var i=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(i,r),this.renderTargetBlurBuffer1.setSize(i,r),this.renderTargetEdgeBuffer1.setSize(i,r),this.separableBlurMaterial1.uniforms.texSize.value=new Vector2(i,r),i=Math.round(i/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(i,r),this.renderTargetEdgeBuffer2.setSize(i,r),this.separableBlurMaterial2.uniforms.texSize.value=new Vector2(i,r)},changeVisibilityOfSelectedObjects:function(e){function t(t){t.isMesh&&(e?(t.visible=t.userData.oldVisible,delete t.userData.oldVisible):(t.userData.oldVisible=t.visible,t.visible=e))}for(var i=0;i<this.selectedObjects.length;i++)this.selectedObjects[i].traverse(t)},changeVisibilityOfNonSelectedObjects:function(e){var t=[];function i(e){e.isMesh&&t.push(e)}for(var r=0;r<this.selectedObjects.length;r++)this.selectedObjects[r].traverse(i);this.renderScene.traverse(function(i){if(i.isMesh||i.isLine||i.isSprite){for(var r=!1,n=0;n<t.length;n++)if(t[n].id===i.id){r=!0;break}if(!r){var a=i.visible;e&&!i.bVisible||(i.visible=e),i.bVisible=a}}})},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(e,t,i,r,n){if(0<this.selectedObjects.length){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var a=e.autoClear;e.autoClear=!1,n&&e.context.disable(e.context.STENCIL_TEST),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var o=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value=new Vector2(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=o,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),0<this.pulsePeriod){var s=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(s),this.tempPulseColor2.multiplyScalar(s)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value=new Vector2(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=OutlinePass.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=OutlinePass.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=OutlinePass.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=OutlinePass.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,n&&e.context.enable(e.context.STENCIL_TEST),e.setRenderTarget(i),this.fsQuad.render(e),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=a}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=i.texture,e.setRenderTarget(null),this.fsQuad.render(e))},getPrepareMaskMaterial:function(){return new ShaderMaterial({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new Vector2(.5,.5)},textureMatrix:{value:new Matrix4}},vertexShader:["varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\tvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new ShaderMaterial({uniforms:{maskTexture:{value:null},texSize:{value:new Vector2(.5,.5)},visibleEdgeColor:{value:new Vector3(1,1,1)},hiddenEdgeColor:{value:new Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(e){return new ShaderMaterial({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new Vector2(.5,.5)},direction:{value:new Vector2(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\t\t\t\t}"})},getOverlayMaterial:function(){return new ShaderMaterial({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}}),OutlinePass.BlurDirectionX=new Vector2(1,0),OutlinePass.BlurDirectionY=new Vector2(0,1);var OutlinePass$1={OutlinePass:OutlinePass},RenderPass=function(e,t,i,r,n){Pass.call(this),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=r,this.clearAlpha=void 0!==n?n:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};RenderPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:RenderPass,render:function(e,t,i){var r,n,a=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(r=e.getClearColor().getHex(),n=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(r,n),this.scene.overrideMaterial=null,e.autoClear=a}});var RenderPass$1={RenderPass:RenderPass},LuminosityHighPassShader={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Color(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},LuminosityHighPassShader$1={LuminosityHighPassShader:LuminosityHighPassShader},UnrealBloomPass=function(e,t,i,r){Pass.call(this),this.strength=void 0!==t?t:1,this.radius=i,this.threshold=r,this.resolution=void 0!==e?new Vector2(e.x,e.y):new Vector2(256,256),this.clearColor=new Color(0,0,0);var n={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var a=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new WebGLRenderTarget(a,o,n),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var s,l=0;l<this.nMips;l++){(s=new WebGLRenderTarget(a,o,n)).texture.name="UnrealBloomPass.h"+l,s.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(s);var c=new WebGLRenderTarget(a,o,n);c.texture.name="UnrealBloomPass.v"+l,c.texture.generateMipmaps=!1,this.renderTargetsVertical.push(c),a=Math.round(a/2),o=Math.round(o/2)}void 0===LuminosityHighPassShader&&console.error("UnrealBloomPass relies on LuminosityHighPassShader");var h=LuminosityHighPassShader;this.highPassUniforms=UniformsUtils.clone(h.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var u=[3,5,7,9,11];for(a=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2),l=0;l<this.nMips;l++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(u[l])),this.separableBlurMaterials[l].uniforms.texSize.value=new Vector2(a,o),a=Math.round(a/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===CopyShader&&console.error("UnrealBloomPass relies on CopyShader");var d=CopyShader;this.copyUniforms=UniformsUtils.clone(d.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new Color,this.oldClearAlpha=1,this.basic=new MeshBasicMaterial,this.fsQuad=new Pass.FullScreenQuad(null)};UnrealBloomPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:UnrealBloomPass,dispose:function(){for(var e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()},setSize:function(e,t){var i=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(i,r);for(var n=0;n<this.nMips;n++)this.renderTargetsHorizontal[n].setSize(i,r),this.renderTargetsVertical[n].setSize(i,r),this.separableBlurMaterials[n].uniforms.texSize.value=new Vector2(i,r),i=Math.round(i/2),r=Math.round(r/2)},render:function(e,t,i,r,n){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var a=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),n&&e.context.disable(e.context.STENCIL_TEST),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);for(var o=this.renderTargetBright,s=0;s<this.nMips;s++)this.fsQuad.material=this.separableBlurMaterials[s],this.separableBlurMaterials[s].uniforms.colorTexture.value=o.texture,this.separableBlurMaterials[s].uniforms.direction.value=UnrealBloomPass.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[s]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[s].uniforms.colorTexture.value=this.renderTargetsHorizontal[s].texture,this.separableBlurMaterials[s].uniforms.direction.value=UnrealBloomPass.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[s]),e.clear(),this.fsQuad.render(e),o=this.renderTargetsVertical[s];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,n&&e.context.enable(e.context.STENCIL_TEST),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(i),this.fsQuad.render(e)),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=a},getSeperableBlurMaterial:function(e){return new ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new Vector2(.5,.5)},direction:{value:new Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})},getCompositeMaterial:function(e){return new ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),UnrealBloomPass.BlurDirectionX=new Vector2(1,0),UnrealBloomPass.BlurDirectionY=new Vector2(0,1);var UnrealBloomPass$1={UnrealBloomPass:UnrealBloomPass},FXAAShader={uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")},FXAAShader$1={FXAAShader:FXAAShader},support={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};function isDataView(e){return e&&DataView.prototype.isPrototypeOf(e)}if(support.arrayBuffer)var viewClasses=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],isArrayBufferView=ArrayBuffer.isView||function(e){return e&&-1<viewClasses.indexOf(Object.prototype.toString.call(e))};function normalizeName(e){if("string"!=typeof e&&(e+=""),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function normalizeValue(e){return"string"!=typeof e&&(e+=""),e}function iteratorFor(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return support.iterable&&(t[Symbol.iterator]=function(){return t}),t}function Headers(e){this.map={},e instanceof Headers?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function consumed(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function fileReaderReady(e){return new Promise(function(t,i){e.onload=function(){t(e.result)},e.onerror=function(){i(e.error)}})}function readBlobAsArrayBuffer(e){var t=new FileReader,i=fileReaderReady(t);return t.readAsArrayBuffer(e),i}function readBlobAsText(e){var t=new FileReader,i=fileReaderReady(t);return t.readAsText(e),i}function readArrayBufferAsText(e){for(var t=new Uint8Array(e),i=Array(t.length),r=0;r<t.length;r++)i[r]=String.fromCharCode(t[r]);return i.join("")}function bufferClone(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:support.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:support.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:support.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():support.arrayBuffer&&support.blob&&isDataView(e)?(this._bodyArrayBuffer=bufferClone(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):support.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||isArrayBufferView(e))?this._bodyArrayBuffer=bufferClone(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):support.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},support.blob&&(this.blob=function(){var e=consumed(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?consumed(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var e=consumed(this);if(e)return e;if(this._bodyBlob)return readBlobAsText(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},support.formData&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}Headers.prototype.append=function(e,t){e=normalizeName(e),t=normalizeValue(t);var i=this.map[e];this.map[e]=i?i+", "+t:t},Headers.prototype.delete=function(e){delete this.map[normalizeName(e)]},Headers.prototype.get=function(e){return e=normalizeName(e),this.has(e)?this.map[e]:null},Headers.prototype.has=function(e){return this.map.hasOwnProperty(normalizeName(e))},Headers.prototype.set=function(e,t){this.map[normalizeName(e)]=normalizeValue(t)},Headers.prototype.forEach=function(e,t){for(var i in this.map)this.map.hasOwnProperty(i)&&e.call(t,this.map[i],i,this)},Headers.prototype.keys=function(){var e=[];return this.forEach(function(t,i){e.push(i)}),iteratorFor(e)},Headers.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),iteratorFor(e)},Headers.prototype.entries=function(){var e=[];return this.forEach(function(t,i){e.push([i,t])}),iteratorFor(e)},support.iterable&&(Headers.prototype[Symbol.iterator]=Headers.prototype.entries);var methods=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function normalizeMethod(e){var t=e.toUpperCase();return-1<methods.indexOf(t)?t:e}function Request(e,t){var i=(t=t||{}).body;if(e instanceof Request){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new Headers(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=e+"";if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new Headers(t.headers)),this.method=normalizeMethod(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function decode(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var i=e.split("="),r=i.shift().replace(/\+/g," "),n=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(n))}}),t}function parseHeaders(e){var t=new Headers;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var i=e.split(":"),r=i.shift().trim();if(r){var n=i.join(":").trim();t.append(r,n)}}),t}function Response(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&300>this.status,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new Headers(t.headers),this.url=t.url||"",this._initBody(e)}Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})},Body.call(Request.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})},Response.error=function(){var e=new Response(null,{status:0,statusText:""});return e.type="error",e};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(e,t){if(-1===redirectStatuses.indexOf(t))throw new RangeError("Invalid status code");return new Response(null,{status:t,headers:{location:e}})};var DOMException=self.DOMException;try{new DOMException}catch(e){(DOMException=function(e,t){this.message=e,this.name=t;var i=Error(e);this.stack=i.stack}).prototype=Object.create(Error.prototype),DOMException.prototype.constructor=DOMException}function fetch$1(e,t){return new Promise(function(i,r){var n=new Request(e,t);if(n.signal&&n.signal.aborted)return r(new DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function o(){a.abort()}a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:parseHeaders(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;i(new Response(t,e))},a.onerror=function(){r(new TypeError("Network request failed"))},a.ontimeout=function(){r(new TypeError("Network request failed"))},a.onabort=function(){r(new DOMException("Aborted","AbortError"))},a.open(n.method,n.url,!0),"include"===n.credentials?a.withCredentials=!0:"omit"===n.credentials&&(a.withCredentials=!1),"responseType"in a&&support.blob&&(a.responseType="blob"),n.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),n.signal&&(n.signal.addEventListener("abort",o),a.onreadystatechange=function(){4===a.readyState&&n.signal.removeEventListener("abort",o)}),a.send(void 0===n._bodyInit?null:n._bodyInit)})}fetch$1.polyfill=!0,self.fetch||(self.fetch=fetch$1,self.Headers=Headers,self.Request=Request,self.Response=Response);var fetch$2={Headers:Headers,Request:Request,Response:Response,get DOMException(){return DOMException},fetch:fetch$1};const textAlign={center:new Vector2(0,0),left:new Vector2(1,0),top:new Vector2(0,-1),topLeft:new Vector2(1,-1),topRight:new Vector2(-1,-1),right:new Vector2(-1,0),bottom:new Vector2(0,1),bottomLeft:new Vector2(1,1),bottomRight:new Vector2(-1,1)},fontHeightCache={},emojiSpriteCache={},getFontHeight=e=>{var t=fontHeightCache[e];if(!t){var i=document.getElementsByTagName("body")[0],r=document.createElement("div"),n=document.createTextNode("Mq");r.appendChild(n),r.setAttribute("style",`font:${e};position:absolute;top:0;left:0`),i.appendChild(r),t=r.offsetHeight,fontHeightCache[e]=t,i.removeChild(r)}return t};class CanvasText{constructor(){this.textWidth=null,this.textHeight=null,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}get width(){return this.canvas.width}get height(){return this.canvas.height}drawText(e,t){this.ctx.font=t.font;const i=getFontHeight(t.font),r=(e||"").toString().split("\n");this.textWidth=Math.max.apply(null,r.map(e=>Math.ceil(this.ctx.measureText(e).width))),this.textHeight=i+i*t.lineHeight*(r.length-1),this.canvas.width=Math.max(2,_Math.ceilPowerOfTwo(this.textWidth)),this.canvas.height=Math.max(2,_Math.ceilPowerOfTwo(this.textHeight)),this.ctx.font=t.font,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle=t.fillStyle,1===t.align.x?this.ctx.textAlign="left":0===t.align.x?this.ctx.textAlign="center":this.ctx.textAlign="right",this.ctx.textBaseline="top",this.ctx.shadowColor=t.shadowColor,this.ctx.shadowBlur=t.shadowBlur,this.ctx.shadowOffsetX=t.shadowOffsetX,this.ctx.shadowOffsetY=t.shadowOffsetY;const n=this.textWidth*(.5-.5*t.align.x);for(let e=0;e<r.length;e++)this.ctx.fillText(r[e],n,i*t.lineHeight*e+28);return this.canvas}}class Text2D extends Object3D{constructor(e,t){super(),this._align=new Vector2,this._font=t.font||"164px Arial",this._fillStyle=t.fillStyle||"#FFFFFF",this._shadowColor=t.shadowColor||"rgba(0, 0, 0, 0)",this._shadowBlur=t.shadowBlur||0,this._shadowOffsetX=t.shadowOffsetX||0,this._shadowOffsetY=t.shadowOffsetY||0,this._lineHeight=t.lineHeight||1.2,this.canvas=new CanvasText,this.align=t.align||textAlign.center,this.side=t.side||DoubleSide,this.antialias=void 0===t.antialias||t.antialias,this.text=e}get width(){return this.canvas.textWidth}get height(){return this.canvas.textHeight}get text(){return this._text}set text(e){this._text!==e&&(this._text=e,this.updateText())}get font(){return this._font}set font(e){this._font!==e&&(this._font=e,this.updateText())}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle!==e&&(this._fillStyle=e,this.updateText())}get align(){return this._align}set align(e){this._align.copy(e)}cleanUp(){this.texture&&this.texture.dispose()}applyAntiAlias(){!1===this.antialias&&(this.texture.magFilter=NearestFilter,this.texture.minFilter=LinearMipMapLinearFilter)}}class SpriteText2D extends Text2D{raycast(){return this.sprite.raycast.apply(this.sprite,arguments)}updateText(){this.canvas.drawText(this._text,{font:this._font,fillStyle:this._fillStyle,shadowBlur:this._shadowBlur,shadowColor:this._shadowColor,shadowOffsetX:this._shadowOffsetX,shadowOffsetY:this._shadowOffsetY,lineHeight:this._lineHeight,align:this.align}),this.cleanUp(),this.texture=new Texture(this.canvas.canvas),this.texture.needsUpdate=!0,this.applyAntiAlias(),this.material?this.material.map=this.texture:this.material=new SpriteMaterial({map:this.texture}),this.sprite||(this.sprite=new Sprite(this.material),this.add(this.sprite)),this.sprite.scale.set(this.canvas.width/12,this.canvas.height/12,1),this.sprite.updateMatrix(),this.updateAlign()}updateAlign(){this.sprite&&(this.sprite.center.x=(.5-.5*this._align.x)*this.canvas.textWidth/this.canvas.width,this.sprite.center.y=1-(.5*this._align.y+.5)*this.canvas.textHeight/this.canvas.height)}get align(){return this._align}set align(e){this._align.copy(e),this.updateAlign()}}async function PerformDelayedCaching(e,t,i){for(var r=0;r<e.length;r++)await new Promise(e=>setTimeout(e,i&&i.slow?1500:1e3)),Get2DEmoji(e[r],t)}const CacheEmojisInBackground=(e,t,i)=>{PerformDelayedCaching(e,t,i)},Get2DEmoji=(e,t)=>{let i=e;return t&&(i=e+t),emojiSpriteCache[i]?emojiSpriteCache[i]:(emojiSpriteCache[i]=new SpriteText2D(e,{align:textAlign.center,font:t||"64px Arial",fillStyle:"#000000"}),emojiSpriteCache[i])};var oap2dEmojis={CacheEmojisInBackground:CacheEmojisInBackground,Get2DEmoji:Get2DEmoji};const fontMeshCache={},fontGeometryCache={};let forceSlow=!1,isAndroid=null;function _getTextGeometryCore(e,t,i){let r,n=new TextGeometry(e,r=i.large?{font:t,size:600<window.innerWidth?10:8,height:600<window.innerWidth?1.2:.6,curveSegments:600<window.innerWidth?12:10,bevelEnabled:!0,bevelThickness:600<window.innerWidth?.15:.2,bevelSize:600<window.innerWidth?.15:.1,bevelOffset:600<window.innerWidth?.25:.2,bevelSegments:(window.innerWidth,5)}:{font:t,size:600<window.innerWidth?5.5:4.5,height:600<window.innerWidth?1.5:.5,curveSegments:600<window.innerWidth?8:6,bevelEnabled:!0,bevelThickness:600<window.innerWidth?.2:.1,bevelSize:600<window.innerWidth?.4:.3,bevelOffset:0,bevelSegments:(window.innerWidth,6)});return n.computeBoundingBox(),n.computeVertexNormals(),n.center(),n}async function _getTextGeometry(e,t,i){let r=_getTextGeometryCore(e,t,i);return r=BufferGeometry().fromGeometry(r)}function _getTextGeometrySync(e,t,i){return(new BufferGeometry).fromGeometry(_getTextGeometryCore(e,t,i))}const isSlow=e=>forceSlow||e&&e.slow,getDelay=e=>{if(null===isAndroid){var t=navigator.userAgent.toLowerCase();isAndroid=-1<t.indexOf("android")}return isAndroid?1.2*e:e};async function PerformEarlyDelayedFontCaching(e,t){for(var i=15;0<=i;i--)await new Promise(e=>setTimeout(e,(isSlow(t),getDelay(1e3)))),GetTextGeometry(i,e,{large:!0,isCaching:!0})}async function PerformCacheWelcomeTexts(e,t){for(var i=0;i<e.length;i++)await new Promise(e=>setTimeout(e,500)),GetTextGeometry(e[i].title,t,{large:!0,isCaching:!0})}async function PerformDelayedFontCaching(e,t){GetTextGeometry("cp",e,{large:!0,isCaching:!0}),await new Promise(e=>setTimeout(e,isSlow(t)?getDelay(900):getDelay(300))),GetTextGeometry("+",e,{large:!1,isCaching:!0}),await new Promise(e=>setTimeout(e,isSlow(t)?getDelay(900):getDelay(300))),GetTextGeometry("-",e,{large:!1,isCaching:!0}),await new Promise(e=>setTimeout(e,isSlow(t)?getDelay(900):getDelay(300)));for(var i=130;75<=i;i--)await new Promise(e=>setTimeout(e,isSlow(t)?getDelay(900):getDelay(300))),GetTextGeometry(i,e,{large:!0,isCaching:!0});for(i=32;0<=i;i--)await new Promise(e=>setTimeout(e,isSlow(t)?getDelay(900):getDelay(300))),GetTextGeometry(i,e,{large:!1,isCaching:!0});for(i=74;0<=i;i--)await new Promise(e=>setTimeout(e,isSlow(t)?getDelay(900):getDelay(300))),GetTextGeometry(i,e,{large:!0,isCaching:!0});for(i=165;129<=i;i--)await new Promise(e=>setTimeout(e,isSlow(t)?getDelay(900):getDelay(300))),GetTextGeometry(i,e,{large:!0,isCaching:!0})}const StartEarlyDelayedFontCaching=e=>{PerformEarlyDelayedFontCaching(e,{large:!0,isCaching:!0})},StartPerformCacheWelcomeTexts=(e,t)=>{PerformCacheWelcomeTexts(e,t)},SetForceSlowOnFontCaching=()=>{forceSlow=!0},StartDelayedFontCaching=(e,t)=>{PerformDelayedFontCaching(e,t)},GetTextMesh=(e,t,i)=>{if(fontMeshCache[e+i.large])return fontMeshCache[e+i.large];{let n;n=(i&&i.isCaching,_getTextGeometrySync(e,t,i));var r=[new MeshPhongMaterial({color:16733986,flatShading:!0}),new MeshPhongMaterial({color:16733986})];return fontMeshCache[e+i.large]=new Mesh(n,r),fontMeshCache[e+i.large]}},GetTextGeometry=(e,t,i)=>{if(fontGeometryCache[e+i.large])return fontGeometryCache[e+i.large];{let r;return r=(i&&i.isCaching,_getTextGeometrySync(e,t,i)),fontGeometryCache[e+i.large]=r,fontGeometryCache[e+i.large]}};var oapCachedTextGeometry={StartEarlyDelayedFontCaching:StartEarlyDelayedFontCaching,StartPerformCacheWelcomeTexts:StartPerformCacheWelcomeTexts,SetForceSlowOnFontCaching:SetForceSlowOnFontCaching,StartDelayedFontCaching:StartDelayedFontCaching,GetTextMesh:GetTextMesh,GetTextGeometry:GetTextGeometry};class CountDownTimer3D{constructor(e,t,i,r,n,a,o,s,l,c,h){this.scene=e,this.camera=t,this.renderer=i,this.composer=r,this.width=c,this.height=h,this.font3d=a,this.r=0,this.inCountDown=!1,this.quizComponent=o,this.welcomeTexts=s,this.configFromServer=l,this.completedTextTweens=0,this.secondsLeft=15,this.clock=n,this.currentTime=0,this.init(),this.winPoints=5,setTimeout(()=>{this.cacheWinPoints()},100)}init(){this.roughness=.3;this.directionalLight=new DirectionalLight(16777215,.95),this.directionalLight.position.setScalar(100),this.scene.add(this.directionalLight),this.ambientLight=new AmbientLight(16777215,1.97),this.scene.add(this.ambientLight),this.pointLight2=new PointLight(16777215,.8),this.camera.add(this.pointLight2);const e=new ShaderPass(FXAAShader);e.uniforms.resolution.value.set(1/this.width,1/this.height),this.bloomPass=new UnrealBloomPass(new Vector2(this.width,this.height),1.5,.4,.85),this.bloomPass.threshold=.12,this.bloompassInitialStrength=4.3,this.bloomPass.strength=this.bloompassInitialStrength,this.bloomPass.radius=1.1,this.bloomPass.renderToScreen=!0,this.composer.addPass(e),this.composer.addPass(this.bloomPass),this.renderer.gammaInput=!0,this.renderer.gammaOutput=!0,this.renderer.toneMappingExposure=Math.pow(.9,4),this.material=new MeshStandardMaterial({color:16711680,side:BackSide,transparent:!0,opacity:.3}),this.colorArray=Object.values(this.configFromServer.client_config.moduleTypeColorLookup),this.countDownMesh=new LineSegments(this.getCountDownOutlineGeometry(),new LineBasicMaterial({color:this.colorArray[Math.floor(Math.random()*this.colorArray.length)]})),this.countDownMesh.visible=!1,this.countDownMesh.scale.set(1,2,1),this.countdownDigitGroup=new Group,this.countdownDigitGroup.add(this.countDownMesh),this.countdownDigitGroup.position.z=-22,this.countdownDigitGroup.position.y=-2,this.countdownDigitGroup.position.x=0,this.scene.add(this.countdownDigitGroup)}cleanupIntro(){this.welcomeFontMeshes=[],this.scene.remove(this.logoSprite),setTimeout(()=>{},2e4)}cacheWinPoints(){this.cacheWinPointsGeometry=GetTextGeometry("+"+this.winPoints,this.font3d,{large:!0})}getLeftOfCamera(){let e;e=450>window.innerWidth?8:950>window.innerWidth?-8:-16;var t=this.camera.fov/180*Math.PI/2,i=this.camera.position.distanceTo(this.scene.position);return-(Math.tan(t)*i*this.camera.aspect+e)}showWinPoints(){this.winPointsMesh||(this.winPointsMaterial=new MeshStandardMaterial({color:65280,roughness:.4,metalness:.92,side:DoubleSide}),this.winPointsMesh=new Mesh(this.cacheWinPointsGeometry?this.cacheWinPointsGeometry:GetTextGeometry("+"+this.winPoints,this.font3d,{large:!0}),this.winPointsMaterial),this.winPointsMesh.position.x=-50,this.winPointsMesh.position.y=7.2,this.winPointsMesh.position.z=-300,this.scene.add(this.winPointsMesh));let e=100,t=10;600>window.innerWidth&&(e=36,t=20);const i=.069*(600>window.innerWidth?window.innerWidth:600);this.winPointsMesh.visible=!0,this.winPointsTween=new Tween(this.winPointsMesh.position).to({x:i+t,y:this.winPointsMesh.position.y,z:-40},3e3).delay(0).on("complete",()=>{this.winPointsMesh.position.x=-50,this.winPointsMesh.position.z=-300,this.pointLight2.intensity=.1,this.winPointsMesh.visible=!1,this.winPointsTween=null}).start()}startCountDown(){this.secondsLeft=15,this.startEmoji2DTween&&(this.startEmoji2DTween.stop(),this.startEmoji2DTween=null);Math.random(),Math.random();this.countDownMesh.position.z=-1350,600>window.innerWidth?this.countDownMesh.position.y=13.5:this.countDownMesh.position.y=16.5,this.countdownDigitGroup.visible=!0,this.countDownMesh.visible=!0;Date.now();this.inCountDown=!0,this.doCountDown(),this.countdownTween3=new Tween(this.countDownMesh.position).to({z:-185},2e3).easing(this.getRandomEasing()).delay(0).on("complete",()=>{this.countdownTween3=null}).start()}getRandomEasing(){const e=[Easing.Circular.Out,Easing.Cubic.Out,Easing.Quintic.Out,Easing.Quadratic.Out,Easing.Quartic.Out,Easing.Sinusoidal.Out];return e[Math.floor(Math.random()*e.length)]}stopCountDownWin(){this.stopCountDown(),this.bloomPass.strength=.2,this.countdownTween3=new Tween(this.countDownMesh.position).to({y:70},2e3).easing(Easing.Elastic.Out).delay(0).on("complete",()=>{this.countdownTween3=null,this.resetAfterStop()}).start()}stopCountDownFail(){this.stopCountDown(),this.bloomPass.strength=.2,this.countdownTween3=new Tween(this.countDownMesh.position).to({y:70},2e3).easing(Easing.Bounce.InOut).delay(0).on("complete",()=>{this.countdownTween3=null,this.resetAfterStop()}).start()}stopCountDown(){this.inCountDown=!1,this.timeout&&clearTimeout(this.timeout),this.countDownMeshRotation&&(this.countDownMeshRotation.stop(),this.countDownMeshRotation=null),this.countdownTween3&&(this.countdownTween3.stop(),this.countdownTween3=null),this.countdownTween4&&(this.countdownTween4.stop(),this.countdownTween4=null),this.opacityEmoji2DTween&&(this.opacityEmoji2DTween.stop(),this.opacityEmoji2DTween=null),this.startEmojiSprite&&(this.startEmojiSprite.visible=!1),this.countdownDigitGroup.visible=!1}getCountDownOutlineGeometry(){return new EdgesGeometry(GetTextGeometry(this.secondsLeft.toString(),this.font3d,{large:!0}))}resetAfterStop(){this.secondsLeft=15,this.bloomPass.strength=this.bloompassInitialStrength,this.roughness=.1,this.countDownMesh.geometry=this.getCountDownOutlineGeometry(),this.countDownMesh.material=new LineBasicMaterial({color:this.colorArray[Math.floor(Math.random()*this.colorArray.length)]})}doCountDown(){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.timeout=null,this.inCountDown&&(0<this.secondsLeft?(this.secondsLeft-=1,this.countDownMesh.geometry=this.getCountDownOutlineGeometry(),8>this.secondsLeft&&(this.countDownMeshRotation&&(this.countDownMeshRotation.stop(),this.countDownMeshRotation=null),this.countDownMeshRotation=new Tween(this.countDownMesh.rotation).to({y:"-"+this.countDownMesh.rotation.y+2*Math.PI},1e3-(500-200*this.secondsLeft)).delay(0).on("complete",()=>{this.countDownMeshRotation=null,this.countDownMesh.rotation.y=0}).start()),this.doCountDown()):(this.stopCountDownFail(),this.quizComponent.ranOutOfTime()))},1e3)}set visible(e){!0===e?(this.pointLight1.visible=!0,this.pointLight2.visible=!0,this.pointLight3.visible=!0):(this.pointLight1.visible=!1,this.pointLight2.visible=!1,this.pointLight3.visible=!1),this.countdownDigitGroup&&(this.countdownDigitGroup.visible=e)}get visible(){return this.countdownDigitGroup.visible}getMaterial(){return this.material}update(){}}const CreateCountDownTimer3D=(e,t,i,r,n,a,o,s,l,c,h)=>new CountDownTimer3D(e,t,i,r,n,a,o,s,l,c,h);var oapCountdownTimer3d={CreateCountDownTimer3D:CreateCountDownTimer3D};const fragmentShader=()=>"\n    float scaleLinear(float value, vec2 valueDomain) {\n      return (value - valueDomain.x) / (valueDomain.y - valueDomain.x);\n    }\n\n    float scaleLinear(float value, vec2 valueDomain, vec2 valueRange) {\n      return mix(valueRange.x, valueRange.y, scaleLinear(value, valueDomain));\n    }\n\n    varying vec4 vColor;\n    varying float lifeLeft;\n    varying vec2 vUv;\n\n    uniform sampler2D tSprite;\n\n    void main() {\n\n      float alpha = 0.;\n\n      if( lifeLeft > .995 ) {\n        alpha = scaleLinear( lifeLeft, vec2(1., .995), vec2(0., 1.));//mix( 0., 1., ( lifeLeft - .95 ) * 100. ) * .75;\n      } else {\n        alpha = lifeLeft * .75;\n      }\n\n      vec4 tex = texture2D( tSprite, gl_PointCoord );\n\n      gl_FragColor = vec4( vColor.rgb * tex.a, alpha * tex.a );\n    }\n  ".toString(),vertexShader=()=>"\n    precision highp float;\n    const vec4 bitSh = vec4(256. * 256. * 256., 256. * 256., 256., 1.);\n    const vec4 bitMsk = vec4(0.,vec3(1./256.0));\n    const vec4 bitShifts = vec4(1.) / bitSh;\n\n    #define FLOAT_MAX  1.70141184e38\n    #define FLOAT_MIN  1.17549435e-38\n\n    lowp vec4 encode_float(highp float v) {\n      highp float av = abs(v);\n\n      //Handle special cases\n      if(av < FLOAT_MIN) {\n        return vec4(0.0, 0.0, 0.0, 0.0);\n      } else if(v > FLOAT_MAX) {\n        return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n      } else if(v < -FLOAT_MAX) {\n        return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n      }\n\n      highp vec4 c = vec4(0,0,0,0);\n\n      //Compute exponent and mantissa\n      highp float e = floor(log2(av));\n      highp float m = av * pow(2.0, -e) - 1.0;\n\n      //Unpack mantissa\n      c[1] = floor(128.0 * m);\n      m -= c[1] / 128.0;\n      c[2] = floor(32768.0 * m);\n      m -= c[2] / 32768.0;\n      c[3] = floor(8388608.0 * m);\n\n      //Unpack exponent\n      highp float ebias = e + 127.0;\n      c[0] = floor(ebias / 2.0);\n      ebias -= c[0] * 2.0;\n      c[1] += floor(ebias) * 128.0;\n\n      //Unpack sign bit\n      c[0] += 128.0 * step(0.0, -v);\n\n      //Scale back to range\n      return c / 255.0;\n    }\n\n    vec4 pack(const in float depth)\n    {\n        const vec4 bit_shift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n        const vec4 bit_mask  = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n        vec4 res = fract(depth * bit_shift);\n        res -= res.xxyz * bit_mask;\n        return res;\n    }\n\n    float unpack(const in vec4 rgba_depth)\n    {\n        const vec4 bit_shift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n        float depth = dot(rgba_depth, bit_shift);\n        return depth;\n    }\n\n    uniform float uTime;\n    uniform float uScale;\n    uniform sampler2D tNoise;\n\n    attribute vec4 particlePositionsStartTime;\n    attribute vec4 particleVelColSizeLife;\n\n    varying vec4 vColor;\n    varying float lifeLeft;\n\n    varying vec2 vUv;\n\n    void main() {\n\n      // unpack things from our attributes\n      vColor = encode_float( particleVelColSizeLife.y );\n\n      // convert our velocity back into a value we can use\n      vec4 velTurb = encode_float( particleVelColSizeLife.x );\n      vec3 velocity = vec3( velTurb.xyz );\n      float turbulence = velTurb.w;\n      vUv = uv;\n\n      vec3 newPosition;\n\n      float timeElapsed = uTime - particlePositionsStartTime.a;\n\n      lifeLeft = 1. - (timeElapsed / particleVelColSizeLife.w);\n\n      gl_PointSize = ( uScale * particleVelColSizeLife.z ) * lifeLeft;\n\n      velocity.x = ( velocity.x - .5 ) * 3.;\n      velocity.y = ( velocity.y - .5 ) * 3.;\n      velocity.z = ( velocity.z - .5 ) * 3.;\n\n      newPosition = particlePositionsStartTime.xyz + ( velocity * 10. ) * ( uTime - particlePositionsStartTime.a );\n\n      vec3 noise = texture2D( tNoise, vec2( newPosition.x * .015 + (uTime * .05), newPosition.y * .02 + (uTime * .015) )).rgb;\n      vec3 noiseVel = ( noise.rgb - .5 ) * 30.;\n\n      newPosition = mix(newPosition, newPosition + vec3(noiseVel * ( turbulence * 5. ) ), (timeElapsed / particleVelColSizeLife.a) );\n\n      // if( velocity.x < -.5 || velocity.y < -1. ) {\n      //   lifeLeft = 0.;\n      //   // newPosition = vec3(10000., 10000., 10000.);\n      // }\n      //\n      if( velocity.y > 0. && velocity.y < .05 ) {\n        lifeLeft = 0.;\n      }\n\n      if( velocity.x < -1.45 ) {\n        lifeLeft = 0.;\n      }\n\n      if( timeElapsed > 0. ) {\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );\n      } else {\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        lifeLeft = 0.;\n        gl_PointSize = 0.;\n      }\n    }\n  ".toString(),GPUParticleSystem=function(e){var t=this;e=e||{};t.PARTICLE_COUNT=e.maxParticles||1e6,t.PARTICLE_CONTAINERS=e.containerCount||1,t.PARTICLES_PER_CONTAINER=Math.ceil(t.PARTICLE_COUNT/t.PARTICLE_CONTAINERS),t.PARTICLE_CURSOR=0,t.time=0,t.rand=[];for(var i=1e5;0<i;i--)t.rand.push(Math.random()-.5);t.random=function(){return++i>=t.rand.length?t.rand[i=1]:t.rand[i]},t.particleNoiseTex=ImageUtils.loadTexture("/src/components/3d-utils/perlin-512.png"),t.particleNoiseTex.wrapS=t.particleNoiseTex.wrapT=RepeatWrapping,t.particleSpriteTex=ImageUtils.loadTexture("/src/components/3d-utils/particle2.png"),t.particleSpriteTex.wrapS=t.particleSpriteTex.wrapT=RepeatWrapping,t.particleShaderMat=new ShaderMaterial({transparent:!0,depthWrite:!1,uniforms:{uTime:{type:"f",value:0},uScale:{type:"f",value:1},tNoise:{type:"t",value:t.particleNoiseTex},tSprite:{type:"t",value:t.particleSpriteTex}},blending:AdditiveBlending,vertexShader:vertexShader(),fragmentShader:fragmentShader()}),t.particleShaderMat.defaultAttributeValues.particlePositionsStartTime=[0,0,0,0],t.particleShaderMat.defaultAttributeValues.particleVelColSizeLife=[0,0,0,0],t.particleContainers=[],Object3D.apply(this,arguments),this.getMaterial=function(){return t.particleShaderMat},this.init=function(){for(var e,i=0;i<t.PARTICLE_CONTAINERS;i++)e=new GPUParticleContainer(t.PARTICLES_PER_CONTAINER,t),t.particleContainers.push(e),t.add(e)},this.spawnParticle=function(e){t.PARTICLE_CURSOR++,t.PARTICLE_CURSOR>=t.PARTICLE_COUNT&&(t.PARTICLE_CURSOR=1),t.particleContainers[Math.floor(t.PARTICLE_CURSOR/t.PARTICLES_PER_CONTAINER)].spawnParticle(e)},this.update=function(e){for(var i=0;i<t.PARTICLE_CONTAINERS;i++)t.particleContainers[i].update(e)},this.init()};GPUParticleSystem.prototype=Object.create(Object3D.prototype),GPUParticleSystem.prototype.constructor=GPUParticleSystem;const GPUParticleContainer=function(e,t){var i=this;i.PARTICLE_COUNT=e||1e5,i.PARTICLE_CURSOR=0,i.time=0,i.DPR=window.devicePixelRatio,i.GPUParticleSystem=t;Math.floor(i.PARTICLE_COUNT/i.MAX_ATTRIBUTES);Object3D.apply(this,arguments);var r=new Uint8Array(4),n=new Float32Array(r.buffer);function a(e,t,i,a){return r[0]=Math.floor(a),r[1]=Math.floor(i),r[2]=Math.floor(t),r[3]=Math.floor(e),n[0]}i.particles=[],i.deadParticles=[],i.particlesAvailableSlot=[],i.particleUpdate=!1,i.particleShaderGeo=new BufferGeometry,i.particleVertices=new Float32Array(3*i.PARTICLE_COUNT),i.particlePositionsStartTime=new Float32Array(4*i.PARTICLE_COUNT),i.particleVelColSizeLife=new Float32Array(4*i.PARTICLE_COUNT);for(var o=0;o<i.PARTICLE_COUNT;o++)i.particlePositionsStartTime[4*o+0]=100,i.particlePositionsStartTime[4*o+1]=0,i.particlePositionsStartTime[4*o+2]=0,i.particlePositionsStartTime[4*o+3]=0,i.particleVertices[3*o+0]=0,i.particleVertices[3*o+1]=0,i.particleVertices[3*o+2]=0,i.particleVelColSizeLife[4*o+0]=a(128,128,0,0),i.particleVelColSizeLife[4*o+1]=a(0,254,0,254),i.particleVelColSizeLife[4*o+2]=1,i.particleVelColSizeLife[4*o+3]=0;i.particleShaderGeo.addAttribute("position",new BufferAttribute(i.particleVertices,3)),i.particleShaderGeo.addAttribute("particlePositionsStartTime",new DynamicBufferAttribute(i.particlePositionsStartTime,4)),i.particleShaderGeo.addAttribute("particleVelColSizeLife",new DynamicBufferAttribute(i.particleVelColSizeLife,4)),i.posStart=i.particleShaderGeo.getAttribute("particlePositionsStartTime"),i.velCol=i.particleShaderGeo.getAttribute("particleVelColSizeLife"),i.particleShaderMat=i.GPUParticleSystem.getMaterial(),this.init=function(){i.particleSystem=new Points(i.particleShaderGeo,i.particleShaderMat),i.particleSystem.frustumCulled=!1,this.add(i.particleSystem)};var s=new Vector3,l=new Vector3,c=0,h=0,u=16777215,d=0,p=0,m=0,f=0;this.offset=0,this.count=0,this.spawnParticle=function(e){s=void 0!==(e=e||{}).position?s.copy(e.position):s.set(0,0,0),l=void 0!==e.velocity?l.copy(e.velocity):l.set(0,0,0),c=void 0!==e.positionRandomness?e.positionRandomness:0,h=void 0!==e.velocityRandomness?e.velocityRandomness:0,u=void 0!==e.color?e.color:16777215,d=void 0!==e.colorRandomness?e.colorRandomness:1,w=void 0!==e.turbulence?e.turbulence:1,p=void 0!==e.lifetime?e.lifetime:5,m=void 0!==e.size?e.size:10,f=void 0!==e.sizeRandomness?e.sizeRandomness:0;var r=void 0!==e.smoothPosition&&e.smoothPosition;void 0!==i.DPR&&(m*=i.DPR),o=i.PARTICLE_CURSOR,i.posStart.array[4*o+0]=s.x+t.random()*c,i.posStart.array[4*o+1]=s.y+t.random()*c,i.posStart.array[4*o+2]=s.z+t.random()*c,i.posStart.array[4*o+3]=i.time+.02*t.random(),!0===r&&(i.posStart.array[4*o+0]+=-l.x*t.random(),i.posStart.array[4*o+1]+=-l.y*t.random(),i.posStart.array[4*o+2]+=-l.z*t.random());var n,g,v,y,b=l.x+t.random()*h,_=l.y+t.random()*h,x=l.z+t.random()*h,w=Math.floor(254*w);b=Math.floor((b- -2)/4*250),_=Math.floor((_- -2)/4*250),x=Math.floor((x- -2)/4*250),i.velCol.array[4*o+0]=a(b,_,x,w);for(var S=(g=void 0,v=void 0,y=void 0,v=(65280&(n=u))>>8,y=255&n,0<(g=n>>16)&&g--,0<v&&v--,0<y&&y--,[g,v,y]),T=0;T<S.length;T++)S[T]=Math.floor(S[T]+t.random()*d*254),254<S[T]&&(S[T]=254),0>S[T]&&(S[T]=0);i.velCol.array[4*o+1]=a(S[0],S[1],S[2],254),i.velCol.array[4*o+2]=m+t.random()*f,i.velCol.array[4*o+3]=p,0==this.offset&&(this.offset=i.PARTICLE_CURSOR),i.count++,i.PARTICLE_CURSOR++,i.PARTICLE_CURSOR>=i.PARTICLE_COUNT&&(i.PARTICLE_CURSOR=0),i.particleUpdate=!0},this.update=function(e){i.time=e,i.particleShaderMat.uniforms.uTime.value=e,this.geometryUpdate()},this.geometryUpdate=function(){1==i.particleUpdate&&(i.particleUpdate=!1,i.offset+i.count<i.PARTICLE_COUNT?(i.posStart.updateRange.offset=i.velCol.updateRange.offset=4*i.offset,i.posStart.updateRange.count=i.velCol.updateRange.count=4*i.count):(i.posStart.updateRange.offset=0,i.posStart.updateRange.count=i.velCol.updateRange.count=4*i.PARTICLE_COUNT),i.posStart.needsUpdate=!0,i.velCol.needsUpdate=!0,i.offset=0,i.count=0)},this.init()};GPUParticleContainer.prototype=Object.create(Object3D.prototype),GPUParticleContainer.prototype.constructor=GPUParticleContainer;let fireworkCounter=0;class Firework{constructor(e){for(this.particleSystem=e,this.startTime=-1,this.lifespan=2,this.color=4473924,this.particleRate=10,this.smokeRate=1e3,this.position=new Vector3,this.velocity=new Vector3,this.gravity=new Vector3(0,-50,0),this.alive=!0,this.spherePoint=new Vector3,this.i=1e4,this.randomSpherePoints=[],this.i=1e4;0<this.i;this.i--)this.randomSpherePoints.push(this.randomSpherePoint(1));this.prevTime=this.startTime,this.delta=0,this.velDelta=new Vector3,this.pos=new Vector3,this.vel=new Vector3,this.explosionSounds=["fireworks_01.ogg","fireworks_02.ogg","fireworks_03.ogg","fireworks_04.ogg"],fireworkCounter++}randomSpherePoint(e){var t=Math.random(),i=Math.random(),r=2*Math.PI*t,n=Math.acos(2*i-1),a=e*Math.sin(n)*Math.cos(r),o=e*Math.sin(n)*Math.sin(r),s=e*Math.cos(n);return this.spherePoint.set(a,o,s).normalize().multiplyScalar(2),this.spherePoint.clone()}getRandomSpherePoint(){return++this.i>=this.randomSpherePoints.length?this.randomSpherePoints[this.i=1]:this.randomSpherePoints[this.i]}update(e){if(this.delta=e,this.lifespan-=this.delta,0<this.lifespan){this.velDelta.copy(this.gravity).multiplyScalar(this.delta),this.velocity.add(this.velDelta),this.velDelta.copy(this.velocity).multiplyScalar(this.delta),this.position.add(this.velDelta);for(var t=0;t<this.smokeRate*this.delta;t++)this.pos.addVectors((new Vector3).copy(this.velDelta).multiplyScalar(Math.random()),this.position),this.particleSystem.spawnParticle({position:this.pos,positionRandomness:.125,smoothPosition:!0,velocityRandomness:.65,size:12.5,sizeRandomness:15,turbulence:.25,colorRandomness:.05,lifetime:1,color:this.color})}else{var i=16777215*Math.random();for(t=0;t<this.particleRate;t++)this.pos.addVectors((new Vector3).copy(this.velDelta).multiplyScalar(Math.random()),this.position),this.particleSystem.spawnParticle({position:this.pos,positionRandomness:.85,velocityRandomness:0,size:12.5,sizeRandomness:15,turbulence:.052,colorRandomness:.05,lifetime:1.25,color:16755319});var r={position:this.position,positionRandomness:0,velocity:this.spherePoint,velocityRandomness:.4,size:12,sizeRandomness:1,turbulence:.075,colorRandomness:.3,lifetime:2,color:i};for(t=0;t<15*this.particleRate;t++)r.velocity=this.getRandomSpherePoint(),this.particleSystem.spawnParticle(r);var n={position:this.position,positionRandomness:.12,velocity:this.spherePoint.multiplyScalar(.32),velocityRandomness:0,size:6,sizeRandomness:0,turbulence:.025,colorRandomness:.1,lifetime:.95,color:16777215},a=new Vector3;for(t=0;t<2*this.particleRate;t++)a.copy(this.getRandomSpherePoint()),n.velocity=a.multiplyScalar(.32),this.particleSystem.spawnParticle(n);var o={position:this.position,positionRandomness:1,velocityRandomness:1,size:90,sizeRandomness:0,turbulence:.5,colorRandomness:0,lifetime:4,color:526344};for(t=0;t<this.particleRate;t++)this.particleSystem.spawnParticle(o);this.alive=!1}}}class GPUFireworks3D{constructor(e,t,i,r,n,a,o){600>window.innerWidth?(this.MAX_PARTICLES=2e3,this.MAX_FIREWORKS=2):(this.MAX_PARTICLES=25e4,this.MAX_FIREWORKS=7),this.scene=e,this.camera=t,this.renderer=i,this.composer=r,this.width=a,this.height=o,this.clock=n,this.tick=0,this.effects=[],this.sourcePos=new Vector3,this.fireworks=[],this.init(),this.particleSystem=new GPUParticleSystem({maxParticles:this.MAX_PARTICLES?this.MAX_PARTICLES:25e4,containerCount:this.PARTICLE_CONTAINERS?this.PARTICLE_CONTAINERS:1}),this.particleSystem.position.x=0,this.particleSystem.position.y=-5,this.particleSystem.position.z=-10,this.particleSystem.visible=!1,this.scene.add(this.particleSystem)}init(){this.renderer.gammaInput=!0,this.renderer.gammaOutput=!0,this.setupScene()}set visible(e){this.particleSystem.visible=e}get visible(){return this.particleSystem.visible}set opacity(e){this.particleSystem.materia.opacity=e}get material(){return this.particleSystem.getMaterial()}setupScene(){}spawnFirework(){var e=new Firework(this.particleSystem);e.position.y=-35,e.velocity.set(20*(Math.random()-.5),2.5*Math.random()+70,20*(Math.random()-.5)),e.lifespan=1.3*Math.random()+1,this.fireworks.push(e)}update(){var e;if(e=1*this.clock.getDelta(),this.tick+=e,0<e){this.fireworks.length<this.MAX_FIREWORKS&&this.spawnFirework();for(var t=[],i=0;i<this.fireworks.length;i++)this.fireworks[i].update(e),this.fireworks[i].alive||t.push(this.fireworks[i]);for(i=0;i<t.length;i++)this.fireworks.splice(this.fireworks.indexOf(t[i]),1)}this.particleSystem.update(this.tick)}}const CreateGPUFireworks3D=(e,t,i,r,n,a,o)=>new GPUFireworks3D(e,t,i,r,n,a,o);var oapFireworks3d={CreateGPUFireworks3D:CreateGPUFireworks3D};class Lightning3D{constructor(e,t,i,r,n,a,o){this.scene=e,this.camera=t,this.renderer=i,this.composer=r,this.width=a,this.height=o,this.clock=n,this.raycaster=new Raycaster,this.currentTime=0,this.init()}init(){this.renderer.gammaInput=!0,this.renderer.gammaOutput=!0,this.setupScene()}set visible(e){!0===e?this.addRenderPass():this.removeRenderPass(),this.storm.visible=e}get visible(){return this.storm.visible}set opacity(e){this.scene.userData.lightningMaterial.opacity=e}get material(){return this.scene.userData.lightningMaterial}getEdgeGlow(){return this.edgeGlow}getOutLinePass(){return this.outlinePass}removeStorm(){this.scene.remove(this.storm)}setupScene(){this.scene.userData.canGoBackwardsInTime=!1,this.scene.userData.camera=this.camera,this.scene.userData.lightningColor=new Color(16766384),this.scene.userData.outlineColor=new Color(16711680),this.scene.userData.lightningMaterial=new MeshBasicMaterial({color:this.scene.userData.lightningColor});var e=new Vector3(0,-1,0),t=0,i=new Vector3,r=new Vector3;this.scene.userData.rayParams={radius0:1,radius1:.5,minRadius:.3,maxIterations:7,timeScale:.5,propagationTimeFactor:.2,vanishingTimeFactor:.9,subrayPeriod:4,subrayDutyCycle:.6,maxSubrayRecursion:3,ramification:3,recursionProbability:.4,roughness:.6,straightness:.65,onSubrayCreation:function(n,a,o,s){s.subrayConePosition(n,a,o,.6,.6,.5),t=s.rayParameters.sourceOffset.y,i.subVectors(o.pos1,s.rayParameters.sourceOffset);var l=e.dot(i);r.copy(e).multiplyScalar(l),i.sub(r);var c=.5<l/t?t/l:1;r.multiplyScalar(c),i.add(r),o.pos1.addVectors(i,s.rayParameters.sourceOffset)}};this.storm=new LightningStorm({size:64,minHeight:100,maxHeight:300,maxSlope:.7,maxLightnings:15,lightningParameters:this.scene.userData.rayParams,lightningMaterial:this.scene.userData.lightningMaterial,onLightningDown:function(e){}}),this.scene.userData.timeRate=1,this.storm.position.z=-350,this.storm.position.y=-50,this.storm.position.x=0,this.scene.add(this.storm),this.createRenderPasses(),this.composer.addPass(this.outlinePass),this.outlinePass.enabled=!1,this.storm.visible=!1}addRenderPass(){this.outlinePass.enabled=!0}removeRenderPass(){this.outlinePass.enabled=!1}createRenderPasses(){this.outlinePass=new OutlinePass(new Vector2(this.width,this.height),this.scene,this.scene.userData.camera,this.storm.lightningsMeshes),this.outlinePass.edgeStrength=2.5,this.outlinePass.edgeGlow=.7,this.outlinePass.edgeThickness=2.8,this.outlinePass.visibleEdgeColor=this.scene.userData.outlineColor,this.outlinePass.hiddenEdgeColor.set(0),this.outlinePass.renderToScreen=!0,this.scene.userData.outlineEnabled=!0}update(){this.currentTime+=this.scene.userData.timeRate*this.clock.getDelta(),0>this.currentTime&&(this.currentTime=0),this.storm.update(this.currentTime)}}const CreateLightning3D=(e,t,i,r,n,a,o)=>new Lightning3D(e,t,i,r,n,a,o);var oapLightning3d={CreateLightning3D:CreateLightning3D};const vertexShader$1=()=>"\n  \t#include <common>\n\n\t\tuniform float speed;\n\t\tuniform float time;\n\t\tuniform float timeOffset;\n\t\tvarying vec2 vUv;\n\t\tvarying float vAlpha;\n\n\t\tvoid main() {\n\n\t\t\tvec3 pos = position;\n\n\t\t\tfloat l = ( time * speed * 0.01 ) + timeOffset;\n\t\t\tfloat f = fract( l ); // linear time factor [0,1)\n\t\t\tfloat a = f * f; // quadratic time factor [0,1)\n\n\t\t\t// slightly animate the vertices of light shaft if necessary\n\n\t\t\t// pos.x += cos( l * 20.0 ) * sin( l * 10.0 );\n\n\t\t\tvAlpha = saturate( 0.7 + min( 1.0, a * 10.0 ) * ( sin( a * 40.0 ) * 0.25 ) );\n\n\t\t  vUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( pos, 1.0 );\n\t\t}\n  ".toString(),fragmentShader$1=()=>"\n    uniform float attenuation;\n    uniform vec3 color;\n    uniform sampler2D colorTexture;\n\n    varying vec2 vUv;\n    varying float vAlpha;\n\n    void main() {\n      vec4 textureColor = texture2D( colorTexture, vUv );\n      gl_FragColor = vec4( textureColor.rgb * color.rgb, textureColor.a * vAlpha );\n      gl_FragColor.a *= pow( gl_FragCoord.z, attenuation );\n    }\n  ".toString();class LightShaft3D{constructor(e,t,i,r,n,a,o,s,l){this.scene=e,this.camera=t,this.renderer=i,this.composer=r,this.width=s,this.height=l,this.font3d=a,this.component=o,this.gameColors=[],Object.values(this.component.configFromServer.client_config.moduleTypeColorLookup).forEach(e=>{this.gameColors.push(e)}),this.clock=n,this.currentTime=0,this.init()}init(){const e=(new TextureLoader).load("https://open-active-policy-public.s3-eu-west-1.amazonaws.com/make-your-constitution+/clientAssets/3d/textures/lightShaft.png");this.uniforms={attenuation:{value:1},speed:{value:2},color:{value:new Color(14343327)},colorTexture:{value:e},time:{value:0},timeOffset:{value:0}},this.lightShaftMaterial=new ShaderMaterial({uniforms:this.uniforms,vertexShader:vertexShader$1(),fragmentShader:fragmentShader$1(),blending:AdditiveBlending,depthWrite:!1,transparent:!0,side:DoubleSide});var t=new PlaneBufferGeometry(.5,5);this.lightShafts=[],this.shaftGroup=new Group;for(var i=0;5>i;i++){let e=new Mesh(t,this.lightShaftMaterial);e.position.x=.15*Math.sign(i%2)-1,e.position.y=0,e.position.z=.5*i-1.5,e.position.z+=40,e.rotation.y=0,e.rotation.z=Math.PI*-(.15+.1*Math.random()),e.lightShaftRotationTwean=new Tween(e.rotation).to({y:2*Math.PI},18e4).delay(0).on("complete",()=>{e.rotation.y=0,e.lightShaftRotationTwean.start()}).start(),this.shaftGroup.add(e),this.lightShafts.push(e)}setTimeout(()=>{this.scene.add(this.shaftGroup),this.cycleThroughGameColors()},500)}async cycleThroughGameColors(){for(var e=0;e<this.gameColors.length;e++){if(e<this.gameColors.length){const t=new Color(this.gameColors[e]);this.colorTwean=new Tween({r:this.uniforms.color.value.r,g:this.uniforms.color.value.g,b:this.uniforms.color.value.b}).to({r:t.r,g:t.g,b:t.b},15e3).delay(0).on("update",e=>{this.uniforms.color.value=new Color(e.r,e.g,e.b),console.log()}).on("complete",()=>{this.colorTwean=null}).start()}await new Promise(e=>setTimeout(e,15e3))}this.shaftGroup.visible&&this.cycleThroughGameColors()}set visible(e){this.shaftGroup&&(this.shaftGroup.visible=e)}get visible(){return this.shaftGroup.visible}remove(){this.shaftGroup.visible=!1,this.scene.remove(this.shaftGroup)}getMaterial(){return this.lightShaftMaterial}update(){const e=this.clock.getDelta();this.uniforms.time.value+=e}}const CreateLightShaft3D=(e,t,i,r,n,a,o,s,l)=>new LightShaft3D(e,t,i,r,n,a,o,s,l);var oapLightshaft3d={CreateLightShaft3D:CreateLightShaft3D};function pidCrypt(){function e(e){e||(e=8);for(var t=Array(e),i=[],r=0;256>r;r++)i[r]=r;for(r=0;r<t.length;r++)t[r]=i[Math.floor(Math.random()*i.length)];return t}this.setDefaults=function(){this.params.nBits=256,this.params.salt=e(8),this.params.salt=pidCryptUtil.byteArray2String(this.params.salt),this.params.salt=pidCryptUtil.convertToHex(this.params.salt),this.params.blockSize=16,this.params.UTF8=!0,this.params.A0_PAD=!0},this.debug=!0,this.params={},this.params.dataIn="",this.params.dataOut="",this.params.decryptIn="",this.params.decryptOut="",this.params.encryptIn="",this.params.encryptOut="",this.params.key="",this.params.iv="",this.params.clear=!0,this.setDefaults(),this.errors="",this.warnings="",this.infos="",this.debugMsg="",this.setParams=function(e){for(var t in e||(e={}),e)this.params[t]=e[t]},this.getParams=function(){return this.params},this.getParam=function(e){return this.params[e]||""},this.clearParams=function(){this.params={}},this.getNBits=function(){return this.params.nBits},this.getOutput=function(){return this.params.dataOut},this.setError=function(e){this.error=e},this.appendError=function(e){return this.errors+=e,""},this.getErrors=function(){return this.errors},this.isError=function(){return 0<this.errors.length},this.appendInfo=function(e){return this.infos+=e,""},this.getInfos=function(){return this.infos},this.setDebug=function(e){this.debug=e},this.appendDebug=function(e){return this.debugMsg+=e,""},this.isDebug=function(){return this.debug},this.getAllMessages=function(e){var t={lf:"\n",clr_mes:!1,verbose:15};for(var i in e||(e=t),t)void 0===e[i]&&(e[i]=t[i]);var r="",n="";for(var a in this.params){switch(a){case"encryptOut":n=pidCryptUtil.toByteArray(this.params[a].toString()),n=pidCryptUtil.fragment(n.join(),64,e.lf);break;case"key":case"iv":n=pidCryptUtil.formatHex(this.params[a],48);break;default:n=pidCryptUtil.fragment(this.params[a].toString(),64,e.lf)}r+="<p><b>"+a+"</b>:<pre>"+n+"</pre></p>"}return this.debug&&(r+="debug: "+this.debug+e.lf),0<this.errors.length&&1==(1&e.verbose)&&(r+="Errors:"+e.lf+this.errors+e.lf),0<this.warnings.length&&2==(2&e.verbose)&&(r+="Warnings:"+e.lf+this.warnings+e.lf),0<this.infos.length&&4==(4&e.verbose)&&(r+="Infos:"+e.lf+this.infos+e.lf),this.debug&&8==(8&e.verbose)&&(r+="Debug messages:"+e.lf+this.debugMsg+e.lf),e.clr_mes&&(this.errors=this.infos=this.warnings=this.debug=""),r},this.getRandomBytes=function(t){return e(t)}}var pidCryptUtil={};function Stream(e,t){e instanceof Stream?(this.enc=e.enc,this.pos=e.pos):(this.enc=e,this.pos=t)}pidCryptUtil.encodeBase64=function(e,t){e||(e="");var i,r,n,a,o,s,l,c,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=[],d="";if(0<(s=(l=(t=void 0!==t&&t)?pidCryptUtil.encodeUTF8(e):e).length%3))for(;3>s++;)d+="=",l+="\0";for(s=0;s<l.length;s+=3)r=63&(i=l.charCodeAt(s)<<16|l.charCodeAt(s+1)<<8|l.charCodeAt(s+2))>>18,n=63&i>>12,a=63&i>>6,o=63&i,u[s/3]=h.charAt(r)+h.charAt(n)+h.charAt(a)+h.charAt(o);return c=(c=u.join("")).slice(0,c.length-d.length)+d},pidCryptUtil.decodeBase64=function(e,t){e||(e="");var i,r,n,a,o,s,l,c,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=[];c=(t=void 0!==t&&t)?pidCryptUtil.decodeUTF8(e):e;for(var d=0;d<c.length;d+=4)i=255&(s=h.indexOf(c.charAt(d))<<18|h.indexOf(c.charAt(d+1))<<12|(a=h.indexOf(c.charAt(d+2)))<<6|(o=h.indexOf(c.charAt(d+3))))>>>16,r=255&s>>>8,n=255&s,u[d/4]=String.fromCharCode(i,r,n),64==o&&(u[d/4]=String.fromCharCode(i,r)),64==a&&(u[d/4]=String.fromCharCode(i));return l=u.join(""),l=t?pidCryptUtil.decodeUTF8(l):l},pidCryptUtil.encodeUTF8=function(e){return e||(e=""),e=(e=e.replace(/[\u0080-\u07ff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(192|t>>6,128|63&t)})).replace(/[\u0800-\uffff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(224|t>>12,128|63&t>>6,128|63&t)})},pidCryptUtil.decodeUTF8=function(e){return e||(e=""),e=(e=e.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){var t=(31&e.charCodeAt(0))<<6|63&e.charCodeAt(1);return String.fromCharCode(t)})).replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){var t=(15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2);return String.fromCharCode(t)})},pidCryptUtil.convertToHex=function(e){e||(e="");for(var t="",i="",r=0;r<e.length;r++)t+=1==(i=e.charCodeAt(r).toString(16)).length?"0"+i:i;return t},pidCryptUtil.convertFromHex=function(e){e||(e="");for(var t="",i=0;i<e.length;i+=2)t+=String.fromCharCode(parseInt(e.substring(i,i+2),16));return t},pidCryptUtil.stripLineFeeds=function(e){e||(e="");return e.replace(/\n/g,"").replace(/\r/g,"")},pidCryptUtil.toByteArray=function(e){e||(e="");for(var t=[],i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t},pidCryptUtil.fragment=function(e,t,i){if(e||(e=""),!t||t>=e.length)return e;i||(i="\n");for(var r="",n=0;n<e.length;n+=t)r+=e.substr(n,t)+i;return r},pidCryptUtil.formatHex=function(e,t){e||(e=""),t||(t=45);for(var i="",r=e.toLowerCase(),n=0;n<r.length;n+=2)i+=r.substr(n,2)+":";return r=this.fragment(i,t)},pidCryptUtil.byteArray2String=function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},Stream.prototype.parseStringHex=function(e,t){void 0===t&&(t=this.enc.length);for(var i,r="",n=e;n<t;++n)i=this.get(n),r+=this.hexDigits.charAt(i>>4)+this.hexDigits.charAt(15&i);return r},Stream.prototype.get=function(e){if(void 0==e&&(e=this.pos++),e>=this.enc.length)throw"Requesting byte offset "+e+" on a stream of length "+this.enc.length;return this.enc[e]},Stream.prototype.hexDigits="0123456789ABCDEF",Stream.prototype.hexDump=function(e,t){for(var i,r="",n=e;n<t;++n)i=this.get(n),r+=this.hexDigits.charAt(i>>4)+this.hexDigits.charAt(15&i),7==(15&n)&&(r+=" "),r+=15==(15&n)?"\n":" ";return r},Stream.prototype.parseStringISO=function(e,t){for(var i="",r=e;r<t;++r)i+=String.fromCharCode(this.get(r));return i},Stream.prototype.parseStringUTF=function(e,t){for(var i="",r=0,n=e;n<t;)i+=128>(r=this.get(n++))?String.fromCharCode(r):191<r&&224>r?String.fromCharCode((31&r)<<6|63&this.get(n++)):String.fromCharCode((15&r)<<12|(63&this.get(n++))<<6|63&this.get(n++));return i},Stream.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,Stream.prototype.parseTime=function(e,t){var i=this.parseStringISO(e,t),r=this.reTime.exec(i);return r?(i=r[1]+"-"+r[2]+"-"+r[3]+" "+r[4],r[5]&&(i+=":"+r[5],r[6]&&(i+=":"+r[6],r[7]&&(i+="."+r[7]))),r[8]&&(i+=" UTC","Z"!=r[8]&&(i+=r[8],r[9]&&(i+=":"+r[9]))),i):"Unrecognized time: "+i},Stream.prototype.parseInteger=function(e,t){if(!(4<t-e)){for(var i=0,r=e;r<t;++r)i=i<<8|this.get(r);return i}},Stream.prototype.parseOID=function(e,t){for(var i,r,n=0,a=0,o=e;o<t;++o)n=n<<7|127&(r=this.get(o)),a+=7,128&r||(void 0==i?i=parseInt(n/40)+"."+n%40:i+="."+(31<=a?"big":n),n=a=0),i+=String.fromCharCode();return i},void 0!==pidCrypt&&(pidCrypt.ASN1=function(e,t,i,r,n){this.stream=e,this.header=t,this.length=i,this.tag=r,this.sub=n},pidCrypt.ASN1.prototype.toHexTree=function(){var e={type:this.typeName()};if("SEQUENCE"!=e.type&&(e.value=this.stream.parseStringHex(this.posContent(),this.posEnd())),null!=this.sub){e.sub=[];for(var t=0,i=this.sub.length;t<i;++t)e.sub[t]=this.sub[t].toHexTree()}return e},pidCrypt.ASN1.prototype.typeName=function(){if(void 0==this.tag)return"unknown";var e=this.tag>>6,t=(this.tag,31&this.tag);switch(e){case 0:switch(t){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+t.toString(16)}case 1:return"Application_"+t.toString(16);case 2:return"["+t+"]";case 3:return"Private_"+t.toString(16)}},pidCrypt.ASN1.prototype.content=function(){if(void 0==this.tag)return null;if(0!=this.tag>>6)return null;var e=31&this.tag,t=this.posContent(),i=Math.abs(this.length);switch(e){case 1:return 0==this.stream.get(t)?"false":"true";case 2:return this.stream.parseInteger(t,t+i);case 6:return this.stream.parseOID(t,t+i);case 12:return this.stream.parseStringUTF(t,t+i);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(t,t+i);case 23:case 24:return this.stream.parseTime(t,t+i)}return null},pidCrypt.ASN1.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null==this.sub?"null":this.sub.length)+"]"},pidCrypt.ASN1.prototype.print=function(e){if(void 0==e&&(e=""),document.writeln(e+this),null!=this.sub){e+="  ";for(var t=0,i=this.sub.length;t<i;++t)this.sub[t].print(e)}},pidCrypt.ASN1.prototype.toPrettyString=function(e){void 0==e&&(e="");var t=e+this.typeName()+" @"+this.stream.pos;if(0<=this.length&&(t+="+"),t+=this.length,32&this.tag?t+=" (constructed)":3!=this.tag&&4!=this.tag||null==this.sub||(t+=" (encapsulates)"),t+="\n",null!=this.sub){e+="  ";for(var i=0,r=this.sub.length;i<r;++i)t+=this.sub[i].toPrettyString(e)}return t},pidCrypt.ASN1.prototype.toDOM=function(){var e=document.createElement("div");e.className="node",e.asn1=this;var t=document.createElement("div");t.className="head";var i=this.typeName();t.innerHTML=i,e.appendChild(t),this.head=t;var r=document.createElement("div");r.className="value",i="Offset: "+this.stream.pos+"<br/>",i+="Length: "+this.header+"+",0<=this.length?i+=this.length:i+=-this.length+" (undefined)",32&this.tag?i+="<br/>(constructed)":3!=this.tag&&4!=this.tag||null==this.sub||(i+="<br/>(encapsulates)");var n=this.content();if(null!=n&&(i+="<br/>Value:<br/><b>"+n+"</b>","object"==typeof oids&&6==this.tag)){var a=oids[n];a&&(a.d&&(i+="<br/>"+a.d),a.c&&(i+="<br/>"+a.c),a.w&&(i+="<br/>(warning!)"))}r.innerHTML=i,e.appendChild(r);var o=document.createElement("div");if(o.className="sub",null!=this.sub)for(var s=0,l=this.sub.length;s<l;++s)o.appendChild(this.sub[s].toDOM());return e.appendChild(o),t.switchNode=e,t.onclick=function(){var e=this.switchNode;e.className="node collapsed"==e.className?"node":"node collapsed"},e},pidCrypt.ASN1.prototype.posStart=function(){return this.stream.pos},pidCrypt.ASN1.prototype.posContent=function(){return this.stream.pos+this.header},pidCrypt.ASN1.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},pidCrypt.ASN1.prototype.toHexDOM_sub=function(e,t,i,r,n){if(!(r>=n)){var a=document.createElement("span");a.className=t,a.appendChild(document.createTextNode(i.hexDump(r,n))),e.appendChild(a)}},pidCrypt.ASN1.prototype.toHexDOM=function(){var e=document.createElement("span");if(e.className="hex",this.head.hexNode=e,this.head.onmouseover=function(){this.hexNode.className="hexCurrent"},this.head.onmouseout=function(){this.hexNode.className="hex"},this.toHexDOM_sub(e,"tag",this.stream,this.posStart(),this.posStart()+1),this.toHexDOM_sub(e,0<=this.length?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent()),null==this.sub)e.appendChild(document.createTextNode(this.stream.hexDump(this.posContent(),this.posEnd())));else if(0<this.sub.length){var t=this.sub[0],i=this.sub[this.sub.length-1];this.toHexDOM_sub(e,"intro",this.stream,this.posContent(),t.posStart());for(var r=0,n=this.sub.length;r<n;++r)e.appendChild(this.sub[r].toHexDOM());this.toHexDOM_sub(e,"outro",this.stream,i.posEnd(),this.posEnd())}return e},pidCrypt.ASN1.decodeLength=function(e){var t=e.get(),i=127&t;if(i==t)return i;if(3<i)throw"Length over 24 bits not supported at position "+(e.pos-1);if(0==i)return-1;t=0;for(var r=0;r<i;++r)t=t<<8|e.get();return t},pidCrypt.ASN1.hasContent=function(e,t,i){if(32&e)return!0;if(3>e||4<e)return!1;var r=new Stream(i);if(3==e&&r.get(),1&r.get()>>6)return!1;try{var n=pidCrypt.ASN1.decodeLength(r);return r.pos-i.pos+n==t}catch(e){return!1}},pidCrypt.ASN1.decode=function(e){e instanceof Stream||(e=new Stream(e,0));var t=new Stream(e),i=e.get(),r=pidCrypt.ASN1.decodeLength(e),n=e.pos-t.pos,a=null;if(pidCrypt.ASN1.hasContent(i,r,e)){var o=e.pos;if(3==i&&e.get(),a=[],0<=r){for(var s=o+r;e.pos<s;)a[a.length]=pidCrypt.ASN1.decode(e);if(e.pos!=s)throw"Content size is not correct for container starting at offset "+o}else try{for(;;){var l=pidCrypt.ASN1.decode(e);if(0==l.tag)break;a[a.length]=l}r=o-e.pos}catch(e){throw"Exception while decoding undefined length content: "+e}}else e.pos+=r;return new pidCrypt.ASN1(t,n,r,i,a)},pidCrypt.ASN1.test=function(){for(var e=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650}],t=0,i=e.length;t<i;++t){var r=new Stream(e[t].value,0),n=pidCrypt.ASN1.decodeLength(r);n!=e[t].expected&&document.write("In test["+t+"] expected "+e[t].expected+" got "+n+"\n")}});var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);function BigInteger(e,t,i){null!=e&&("number"==typeof e?this.fromNumber(e,t,i):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function nbi(){return new BigInteger(null)}function am1(e,t,i,r,n,a){for(;0<=--a;){var o=t*this[e++]+i[r]+n;n=Math.floor(o/67108864),i[r++]=67108863&o}return n}function am2(e,t,i,r,n,a){for(var o=32767&t,s=t>>15;0<=--a;){var l=32767&this[e],c=this[e++]>>15,h=s*l+c*o;n=((l=o*l+((32767&h)<<15)+i[r]+(1073741823&n))>>>30)+(h>>>15)+s*c+(n>>>30),i[r++]=1073741823&l}return n}function am3(e,t,i,r,n,a){for(var o=16383&t,s=t>>14;0<=--a;){var l=16383&this[e],c=this[e++]>>14,h=s*l+c*o;n=((l=o*l+((16383&h)<<14)+i[r]+n)>>28)+(h>>14)+s*c,i[r++]=268435455&l}return n}j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var rr,vv,BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=[];for(rr="0".charCodeAt(0),vv=0;9>=vv;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;function int2char(e){return BI_RM.charAt(e)}function intAt(e,t){var i=BI_RC[e.charCodeAt(t)];return null==i?-1:i}function bnpCopyTo(e){for(var t=this.t-1;0<=t;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function bnpFromInt(e){this.t=1,this.s=0>e?-1:0,0<e?this[0]=e:-1>e?this[0]=e+DV:this.t=0}function nbv(e){var t=nbi();return t.fromInt(e),t}function bnpFromString(e,t){var i;if(16==t)i=4;else if(8==t)i=3;else if(256==t)i=8;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return void this.fromRadix(e,t);i=2}this.t=0,this.s=0;for(var r=e.length,n=!1,a=0;0<=--r;){var o=8==i?255&e[r]:intAt(e,r);0>o?"-"==e.charAt(r)&&(n=!0):(n=!1,0==a?this[this.t++]=o:a+i>this.DB?(this[this.t-1]|=(o&(1<<this.DB-a)-1)<<a,this[this.t++]=o>>this.DB-a):this[this.t-1]|=o<<a,(a+=i)>=this.DB&&(a-=this.DB))}8==i&&0!=(128&e[0])&&(this.s=-1,0<a&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),n&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var e=this.s&this.DM;0<this.t&&this[this.t-1]==e;)--this.t}function bnToString(e){if(0>this.s)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var i,r=(1<<t)-1,n=!1,a="",o=this.t,s=this.DB-o*this.DB%t;if(0<o--)for(s<this.DB&&0<(i=this[o]>>s)&&(n=!0,a=int2char(i));0<=o;)s<t?(i=(this[o]&(1<<s)-1)<<t-s,i|=this[--o]>>(s+=this.DB-t)):(i=this[o]>>(s-=t)&r,0>=s&&(s+=this.DB,--o)),0<i&&(n=!0),n&&(a+=int2char(i));return n?a:"0"}function bnNegate(){var e=nbi();return BigInteger.ZERO.subTo(this,e),e}function bnAbs(){return 0>this.s?this.negate():this}function bnCompareTo(e){var t=this.s-e.s;if(0!=t)return t;var i=this.t;if(0!=(t=i-e.t))return t;for(;0<=--i;)if(0!=(t=this[i]-e[i]))return t;return 0}function nbits(e){var t,i=1;return 0!=(t=e>>>16)&&(e=t,i+=16),0!=(t=e>>8)&&(e=t,i+=8),0!=(t=e>>4)&&(e=t,i+=4),0!=(t=e>>2)&&(e=t,i+=2),0!=(t=e>>1)&&(e=t,i+=1),i}function bnBitLength(){return 0>=this.t?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(e,t){var i;for(i=this.t-1;0<=i;--i)t[i+e]=this[i];for(i=e-1;0<=i;--i)t[i]=0;t.t=this.t+e,t.s=this.s}function bnpDRShiftTo(e,t){for(var i=e;i<this.t;++i)t[i-e]=this[i];t.t=Math.max(this.t-e,0),t.s=this.s}function bnpLShiftTo(e,t){var i,r=e%this.DB,n=this.DB-r,a=(1<<n)-1,o=Math.floor(e/this.DB),s=this.s<<r&this.DM;for(i=this.t-1;0<=i;--i)t[i+o+1]=this[i]>>n|s,s=(this[i]&a)<<r;for(i=o-1;0<=i;--i)t[i]=0;t[o]=s,t.t=this.t+o+1,t.s=this.s,t.clamp()}function bnpRShiftTo(e,t){t.s=this.s;var i=Math.floor(e/this.DB);if(i>=this.t)t.t=0;else{var r=e%this.DB,n=this.DB-r,a=(1<<r)-1;t[0]=this[i]>>r;for(var o=i+1;o<this.t;++o)t[o-i-1]|=(this[o]&a)<<n,t[o-i]=this[o]>>r;0<r&&(t[this.t-i-1]|=(this.s&a)<<n),t.t=this.t-i,t.clamp()}}function bnpSubTo(e,t){for(var i=0,r=0,n=Math.min(e.t,this.t);i<n;)r+=this[i]-e[i],t[i++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;i<this.t;)r+=this[i],t[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<e.t;)r-=e[i],t[i++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=0>r?-1:0,-1>r?t[i++]=this.DV+r:0<r&&(t[i++]=r),t.t=i,t.clamp()}function bnpMultiplyTo(e,t){var i=this.abs(),r=e.abs(),n=i.t;for(t.t=n+r.t;0<=--n;)t[n]=0;for(n=0;n<r.t;++n)t[n+i.t]=i.am(0,r[n],t,n,0,i.t);t.s=0,t.clamp(),this.s!=e.s&&BigInteger.ZERO.subTo(t,t)}function bnpSquareTo(e){for(var t=this.abs(),i=e.t=2*t.t;0<=--i;)e[i]=0;for(i=0;i<t.t-1;++i){var r=t.am(i,t[i],e,2*i,0,1);(e[i+t.t]+=t.am(i+1,2*t[i],e,2*i+1,r,t.t-i-1))>=t.DV&&(e[i+t.t]-=t.DV,e[i+t.t+1]=1)}0<e.t&&(e[e.t-1]+=t.am(i,t[i],e,2*i,0,1)),e.s=0,e.clamp()}function bnpDivRemTo(e,t,i){var r=e.abs();if(!(0>=r.t)){var n=this.abs();if(n.t<r.t)return null!=t&&t.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=nbi());var a=nbi(),o=this.s,s=e.s,l=this.DB-nbits(r[r.t-1]);0<l?(r.lShiftTo(l,a),n.lShiftTo(l,i)):(r.copyTo(a),n.copyTo(i));var c=a.t,h=a[c-1];if(0!=h){var u=h*(1<<this.F1)+(1<c?a[c-2]>>this.F2:0),d=this.FV/u,p=(1<<this.F1)/u,m=1<<this.F2,f=i.t,g=f-c,v=null==t?nbi():t;for(a.dlShiftTo(g,v),0<=i.compareTo(v)&&(i[i.t++]=1,i.subTo(v,i)),BigInteger.ONE.dlShiftTo(c,v),v.subTo(a,a);a.t<c;)a[a.t++]=0;for(;0<=--g;){var y=i[--f]==h?this.DM:Math.floor(i[f]*d+(i[f-1]+m)*p);if((i[f]+=a.am(0,y,i,g,0,c))<y)for(a.dlShiftTo(g,v),i.subTo(v,i);i[f]<--y;)i.subTo(v,i)}null!=t&&(i.drShiftTo(c,t),o!=s&&BigInteger.ZERO.subTo(t,t)),i.t=c,i.clamp(),0<l&&i.rShiftTo(l,i),0>o&&BigInteger.ZERO.subTo(i,i)}}}function bnMod(e){var t=nbi();return this.abs().divRemTo(e,null,t),0>this.s&&0<t.compareTo(BigInteger.ZERO)&&e.subTo(t,t),t}function Classic(e){this.m=e}function cConvert(e){return 0>e.s||0<=e.compareTo(this.m)?e.mod(this.m):e}function cRevert(e){return e}function cReduce(e){e.divRemTo(this.m,null,e)}function cMulTo(e,t,i){e.multiplyTo(t,i),this.reduce(i)}function cSqrTo(e,t){e.squareTo(t),this.reduce(t)}function bnpInvDigit(){if(1>this.t)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return 0<(t=(t=65535&(t=255&(t=15&t*(2-(15&e)*t))*(2-(255&e)*t))*(2-(65535&(65535&e)*t)))*(2-e*t%this.DV)%this.DV)?this.DV-t:-t}function Montgomery(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function montConvert(e){var t=nbi();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),0>e.s&&0<t.compareTo(BigInteger.ZERO)&&this.m.subTo(t,t),t}function montRevert(e){var t=nbi();return e.copyTo(t),this.reduce(t),t}function montReduce(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var i=32767&e[t],r=i*this.mpl+((i*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[i=t+this.m.t]+=this.m.am(0,r,e,t,0,this.m.t);e[i]>=e.DV;)e[i]-=e.DV,e[++i]++}e.clamp(),e.drShiftTo(this.m.t,e),0<=e.compareTo(this.m)&&e.subTo(this.m,e)}function montSqrTo(e,t){e.squareTo(t),this.reduce(t)}function montMulTo(e,t,i){e.multiplyTo(t,i),this.reduce(i)}function bnpIsEven(){return 0==(0<this.t?1&this[0]:this.s)}function bnpExp(e,t){if(4294967295<e||1>e)return BigInteger.ONE;var i=nbi(),r=nbi(),n=t.convert(this),a=nbits(e)-1;for(n.copyTo(i);0<=--a;)if(t.sqrTo(i,r),0<(e&1<<a))t.mulTo(r,n,i);else{var o=i;i=r,r=o}return t.revert(i)}function bnModPowInt(e,t){var i;return i=256>e||t.isEven()?new Classic(t):new Montgomery(t),this.exp(e,i)}function bnClone(){var e=nbi();return this.copyTo(e),e}function bnIntValue(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function bnSigNum(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1}function bnpToRadix(e){if(null==e&&(e=10),0==this.signum()||2>e||36<e)return"0";var t=this.chunkSize(e),i=Math.pow(e,t),r=nbv(i),n=nbi(),a=nbi(),o="";for(this.divRemTo(r,n,a);0<n.signum();)o=(i+a.intValue()).toString(e).substr(1)+o,n.divRemTo(r,n,a);return a.intValue().toString(e)+o}function bnpFromRadix(e,t){this.fromInt(0),null==t&&(t=10);for(var i,r=this.chunkSize(t),n=Math.pow(t,r),a=!1,o=0,s=0,l=0;l<e.length;++l)0>(i=intAt(e,l))?"-"==e.charAt(l)&&0==this.signum()&&(a=!0):(s=t*s+i,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0));0<o&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(s,0)),a&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(e,t,i){if("number"==typeof t)if(2>e)this.fromInt(1);else for(this.fromNumber(e,i),this.testBit(e-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(e-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(BigInteger.ONE.shiftLeft(e-1),this);else{var r=[],n=7&e;r.length=1+(e>>3),t.nextBytes(r),0<n?r[0]&=(1<<n)-1:r[0]=0,this.fromString(r,256)}}function bnToByteArray(){var e=this.t,t=[];t[0]=this.s;var i,r=this.DB-e*this.DB%8,n=0;if(0<e--)for(r<this.DB&&(i=this[e]>>r)!=(this.s&this.DM)>>r&&(t[n++]=i|this.s<<this.DB-r);0<=e;)8>r?(i=(this[e]&(1<<r)-1)<<8-r,i|=this[--e]>>(r+=this.DB-8)):(i=255&this[e]>>(r-=8),0>=r&&(r+=this.DB,--e)),0!=(128&i)&&(i|=-256),0==n&&(128&this.s)!=(128&i)&&++n,(0<n||i!=this.s)&&(t[n++]=i);return t}function bnEquals(e){return 0==this.compareTo(e)}function bnMin(e){return 0>this.compareTo(e)?this:e}function bnMax(e){return 0<this.compareTo(e)?this:e}function bnpBitwiseTo(e,t,i){var r,n,a=Math.min(e.t,this.t);for(r=0;r<a;++r)i[r]=t(this[r],e[r]);if(e.t<this.t){for(n=e.s&this.DM,r=a;r<this.t;++r)i[r]=t(this[r],n);i.t=this.t}else{for(n=this.s&this.DM,r=a;r<e.t;++r)i[r]=t(n,e[r]);i.t=e.t}i.s=t(this.s,e.s),i.clamp()}function op_and(e,t){return e&t}function bnAnd(e){var t=nbi();return this.bitwiseTo(e,op_and,t),t}function op_or(e,t){return e|t}function bnOr(e){var t=nbi();return this.bitwiseTo(e,op_or,t),t}function op_xor(e,t){return e^t}function bnXor(e){var t=nbi();return this.bitwiseTo(e,op_xor,t),t}function op_andnot(e,t){return e&~t}function bnAndNot(e){var t=nbi();return this.bitwiseTo(e,op_andnot,t),t}function bnNot(){for(var e=nbi(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e}function bnShiftLeft(e){var t=nbi();return 0>e?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function bnShiftRight(e){var t=nbi();return 0>e?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function lbit(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function bnGetLowestSetBit(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+lbit(this[e]);return 0>this.s?this.t*this.DB:-1}function cbit(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function bnBitCount(){for(var e=0,t=this.s&this.DM,i=0;i<this.t;++i)e+=cbit(this[i]^t);return e}function bnTestBit(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)}function bnpChangeBit(e,t){var i=BigInteger.ONE.shiftLeft(e);return this.bitwiseTo(i,t,i),i}function bnSetBit(e){return this.changeBit(e,op_or)}function bnClearBit(e){return this.changeBit(e,op_andnot)}function bnFlipBit(e){return this.changeBit(e,op_xor)}function bnpAddTo(e,t){for(var i=0,r=0,n=Math.min(e.t,this.t);i<n;)r+=this[i]+e[i],t[i++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;i<this.t;)r+=this[i],t[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<e.t;)r+=e[i],t[i++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=0>r?-1:0,0<r?t[i++]=r:-1>r&&(t[i++]=this.DV+r),t.t=i,t.clamp()}function bnAdd(e){var t=nbi();return this.addTo(e,t),t}function bnSubtract(e){var t=nbi();return this.subTo(e,t),t}function bnMultiply(e){var t=nbi();return this.multiplyTo(e,t),t}function bnDivide(e){var t=nbi();return this.divRemTo(e,t,null),t}function bnRemainder(e){var t=nbi();return this.divRemTo(e,null,t),t}function bnDivideAndRemainder(e){var t=nbi(),i=nbi();return this.divRemTo(e,t,i),[t,i]}function bnpDMultiply(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(e,t){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}function NullExp(){}function nNop(e){return e}function nMulTo(e,t,i){e.multiplyTo(t,i)}function nSqrTo(e,t){e.squareTo(t)}function bnPow(e){return this.exp(e,new NullExp)}function bnpMultiplyLowerTo(e,t,i){var r,n=Math.min(this.t+e.t,t);for(i.s=0,i.t=n;0<n;)i[--n]=0;for(r=i.t-this.t;n<r;++n)i[n+this.t]=this.am(0,e[n],i,n,0,this.t);for(r=Math.min(e.t,t);n<r;++n)this.am(0,e[n],i,n,0,t-n);i.clamp()}function bnpMultiplyUpperTo(e,t,i){--t;var r=i.t=this.t+e.t-t;for(i.s=0;0<=--r;)i[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)i[this.t+r-t]=this.am(t-r,e[r],i,0,0,this.t+r-t);i.clamp(),i.drShiftTo(1,i)}function Barrett(e){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function barrettConvert(e){if(0>e.s||e.t>2*this.m.t)return e.mod(this.m);if(0>e.compareTo(this.m))return e;var t=nbi();return e.copyTo(t),this.reduce(t),t}function barrettRevert(e){return e}function barrettReduce(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>e.compareTo(this.r2);)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);0<=e.compareTo(this.m);)e.subTo(this.m,e)}function barrettSqrTo(e,t){e.squareTo(t),this.reduce(t)}function barrettMulTo(e,t,i){e.multiplyTo(t,i),this.reduce(i)}function bnModPow(e,t){var i,r,n=e.bitLength(),a=nbv(1);if(0>=n)return a;i=18>n?1:48>n?3:144>n?4:768>n?5:6,r=8>n?new Classic(t):t.isEven()?new Barrett(t):new Montgomery(t);var o=[],s=3,l=i-1,c=(1<<i)-1;if(o[1]=r.convert(this),1<i){var h=nbi();for(r.sqrTo(o[1],h);s<=c;)o[s]=nbi(),r.mulTo(h,o[s-2],o[s]),s+=2}var u,d,p=e.t-1,m=!0,f=nbi();for(n=nbits(e[p])-1;0<=p;){for(n>=l?u=e[p]>>n-l&c:(u=(e[p]&(1<<n+1)-1)<<l-n,0<p&&(u|=e[p-1]>>this.DB+n-l)),s=i;0==(1&u);)u>>=1,--s;if(0>(n-=s)&&(n+=this.DB,--p),m)o[u].copyTo(a),m=!1;else{for(;1<s;)r.sqrTo(a,f),r.sqrTo(f,a),s-=2;0<s?r.sqrTo(a,f):(d=a,a=f,f=d),r.mulTo(f,o[u],a)}for(;0<=p&&0==(e[p]&1<<n);)r.sqrTo(a,f),d=a,a=f,f=d,0>--n&&(n=this.DB-1,--p)}return r.revert(a)}function bnGCD(e){var t=0>this.s?this.negate():this.clone(),i=0>e.s?e.negate():e.clone();if(0>t.compareTo(i)){var r=t;t=i,i=r}var n=t.getLowestSetBit(),a=i.getLowestSetBit();if(0>a)return t;for(n<a&&(a=n),0<a&&(t.rShiftTo(a,t),i.rShiftTo(a,i));0<t.signum();)0<(n=t.getLowestSetBit())&&t.rShiftTo(n,t),0<(n=i.getLowestSetBit())&&i.rShiftTo(n,i),0<=t.compareTo(i)?(t.subTo(i,t),t.rShiftTo(1,t)):(i.subTo(t,i),i.rShiftTo(1,i));return 0<a&&i.lShiftTo(a,i),i}function bnpModInt(e){if(0>=e)return 0;var t=this.DV%e,i=0>this.s?e-1:0;if(0<this.t)if(0==t)i=this[0]%e;else for(var r=this.t-1;0<=r;--r)i=(t*i+this[r])%e;return i}function bnModInverse(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return BigInteger.ZERO;for(var i=e.clone(),r=this.clone(),n=nbv(1),a=nbv(0),o=nbv(0),s=nbv(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),t?(n.isEven()&&a.isEven()||(n.addTo(this,n),a.subTo(e,a)),n.rShiftTo(1,n)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);for(;r.isEven();)r.rShiftTo(1,r),t?(o.isEven()&&s.isEven()||(o.addTo(this,o),s.subTo(e,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);0<=i.compareTo(r)?(i.subTo(r,i),t&&n.subTo(o,n),a.subTo(s,a)):(r.subTo(i,r),t&&o.subTo(n,o),s.subTo(a,s))}return 0!=r.compareTo(BigInteger.ONE)?BigInteger.ZERO:0<=s.compareTo(e)?s.subtract(e):0>s.signum()?(s.addTo(e,s),0>s.signum()?s.add(e):s):s}Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(e){var t,i=this.abs();if(1==i.t&&i[0]<=lowprimes[lowprimes.length-1]){for(t=0;t<lowprimes.length;++t)if(i[0]==lowprimes[t])return!0;return!1}if(i.isEven())return!1;for(t=1;t<lowprimes.length;){for(var r=lowprimes[t],n=t+1;n<lowprimes.length&&r<lplim;)r*=lowprimes[n++];for(r=i.modInt(r);t<n;)if(0==r%lowprimes[t++])return!1}return i.millerRabin(e)}function bnpMillerRabin(e){var t=this.subtract(BigInteger.ONE),i=t.getLowestSetBit();if(0>=i)return!1;var r=t.shiftRight(i);(e=e+1>>1)>lowprimes.length&&(e=lowprimes.length);for(var n=nbi(),a=0;a<e;++a){n.fromInt(lowprimes[a]);var o=n.modPow(r,this);if(0!=o.compareTo(BigInteger.ONE)&&0!=o.compareTo(t)){for(var s=1;s++<i&&0!=o.compareTo(t);)if(0==(o=o.modPowInt(2,this)).compareTo(BigInteger.ONE))return!1;if(0!=o.compareTo(t))return!1}}return!0}function SecureRandom(){if(this.rng_state,this.rng_pool,this.rng_pptr,this.rng_seed_int=function(e){this.rng_pool[this.rng_pptr++]^=255&e,this.rng_pool[this.rng_pptr++]^=255&e>>8,this.rng_pool[this.rng_pptr++]^=255&e>>16,this.rng_pool[this.rng_pptr++]^=255&e>>24,this.rng_pptr>=rng_psize&&(this.rng_pptr-=rng_psize)},this.rng_seed_time=function(){this.rng_seed_int((new Date).getTime())},null==this.rng_pool){var e;if(this.rng_pool=[],this.rng_pptr=0,"Netscape"==navigator.appName&&"5">navigator.appVersion&&window.crypto){var t=window.crypto.random(32);for(e=0;e<t.length;++e)this.rng_pool[this.rng_pptr++]=255&t.charCodeAt(e)}for(;this.rng_pptr<rng_psize;)e=Math.floor(65536*Math.random()),this.rng_pool[this.rng_pptr++]=e>>>8,this.rng_pool[this.rng_pptr++]=255&e;this.rng_pptr=0,this.rng_seed_time()}this.rng_get_byte=function(){if(null==this.rng_state){for(this.rng_seed_time(),this.rng_state=prng_newstate(),this.rng_state.init(this.rng_pool),this.rng_pptr=0;this.rng_pptr<this.rng_pool.length;++this.rng_pptr)this.rng_pool[this.rng_pptr]=0;this.rng_pptr=0}return this.rng_state.next()},this.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=this.rng_get_byte()}}function Arcfour(){this.i=0,this.j=0,this.S=[]}function ARC4init(e){var t,i,r;for(t=0;256>t;++t)this.S[t]=t;for(i=0,t=0;256>t;++t)i=255&i+this.S[t]+e[t%e.length],r=this.S[t],this.S[t]=this.S[i],this.S[i]=r;this.i=0,this.j=0}function ARC4next(){var e;return this.i=255&this.i+1,this.j=255&this.j+this.S[this.i],e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[255&e+this.S[this.i]]}function prng_newstate(){return new Arcfour}BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,Arcfour.prototype.init=ARC4init,Arcfour.prototype.next=ARC4next;var rng_psize=256;if(void 0!==pidCrypt&&void 0!==BigInteger&&void 0!==SecureRandom&&void 0!==Arcfour){function parseBigInt(e,t){return new BigInteger(e,t)}function linebrk(e,t){for(var i="",r=0;r+t<e.length;)i+=e.substring(r,r+t)+"\n",r+=t;return i+e.substring(r,e.length)}function byte2Hex(e){return 16>e?"0"+e.toString(16):e.toString(16)}function pkcs1unpad2(e,t){for(var i=e.toByteArray(),r=0;r<i.length&&0==i[r];)++r;if(i.length-r!=t-1||2!=i[r])return null;for(++r;0!=i[r];)if(++r>=i.length)return null;for(var n="";++r<i.length;)n+=String.fromCharCode(i[r]);return n}function pkcs1pad2(e,t){if(t<e.length+11)return alert("Message too long for RSA"),null;for(var i=[],r=e.length-1;0<=r&&0<t;)i[--t]=e.charCodeAt(r--);i[--t]=0;for(var n=new SecureRandom,a=[];2<t;){for(a[0]=0;0==a[0];)n.nextBytes(a);i[--t]=a[0]}return i[--t]=2,i[--t]=0,new BigInteger(i)}pidCrypt.RSA=function(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null},pidCrypt.RSA.prototype.doPrivate=function(e){if(null==this.p||null==this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),i=e.mod(this.q).modPow(this.dmq1,this.q);0>t.compareTo(i);)t=t.add(this.p);return t.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)},pidCrypt.RSA.prototype.setPublic=function(e,t,i){void 0===i&&(i=16),null!=e&&null!=t&&0<e.length&&0<t.length?(this.n=parseBigInt(e,i),this.e=parseInt(t,i)):alert("Invalid RSA public key")},pidCrypt.RSA.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},pidCrypt.RSA.prototype.encryptRaw=function(e){var t=pkcs1pad2(e,this.n.bitLength()+7>>3);if(null==t)return null;var i=this.doPublic(t);if(null==i)return null;var r=i.toString(16);return 0==(1&r.length)?r:"0"+r},pidCrypt.RSA.prototype.encrypt=function(e){return e=pidCryptUtil.encodeBase64(e),this.encryptRaw(e)},pidCrypt.RSA.prototype.decryptRaw=function(e){var t=parseBigInt(e,16),i=this.doPrivate(t);return null==i?null:pkcs1unpad2(i,this.n.bitLength()+7>>3)},pidCrypt.RSA.prototype.decrypt=function(e){var t=this.decryptRaw(e);return t=t?pidCryptUtil.decodeBase64(t):""},pidCrypt.RSA.prototype.setPrivate=function(e,t,i,r){void 0===r&&(r=16),null!=e&&null!=t&&0<e.length&&0<t.length?(this.n=parseBigInt(e,r),this.e=parseInt(t,r),this.d=parseBigInt(i,r)):alert("Invalid RSA private key")},pidCrypt.RSA.prototype.setPrivateEx=function(e,t,i,r,n,a,o,s,l){void 0===l&&(l=16),null!=e&&null!=t&&0<e.length&&0<t.length?(this.n=parseBigInt(e,l),this.e=parseInt(t,l),this.d=parseBigInt(i,l),this.p=parseBigInt(r,l),this.q=parseBigInt(n,l),this.dmp1=parseBigInt(a,l),this.dmq1=parseBigInt(o,l),this.coeff=parseBigInt(s,l)):alert("Invalid RSA private key")},pidCrypt.RSA.prototype.generate=function(e,t){var i=new SecureRandom,r=e>>1;this.e=parseInt(t,16);for(var n=new BigInteger(t,16);;){for(;this.p=new BigInteger(e-r,1,i),0!=this.p.subtract(BigInteger.ONE).gcd(n).compareTo(BigInteger.ONE)||!this.p.isProbablePrime(10););for(;this.q=new BigInteger(r,1,i),0!=this.q.subtract(BigInteger.ONE).gcd(n).compareTo(BigInteger.ONE)||!this.q.isProbablePrime(10););if(0>=this.p.compareTo(this.q)){var a=this.p;this.p=this.q,this.q=a}var o=this.p.subtract(BigInteger.ONE),s=this.q.subtract(BigInteger.ONE),l=o.multiply(s);if(0==l.gcd(n).compareTo(BigInteger.ONE)){this.n=this.p.multiply(this.q),this.d=n.modInverse(l),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(s),this.coeff=this.q.modInverse(this.p);break}}},pidCrypt.RSA.prototype.getASNData=function(e){var t=[],i=0;if(e.value&&"INTEGER"==e.type&&(t[i++]=e.value),e.sub)for(var r=0;r<e.sub.length;r++)t=t.concat(this.getASNData(e.sub[r]));return t},pidCrypt.RSA.prototype.setKeyFromASN=function(e,t){var i=["N","E","D","P","Q","DP","DQ","C"],r={},n=this.getASNData(t);switch(e){case"Public":case"public":for(var a=0;a<n.length;a++)r[i[a]]=n[a].toLowerCase();this.setPublic(r.N,r.E,16);break;case"Private":case"private":for(a=1;a<n.length;a++)r[i[a-1]]=n[a].toLowerCase();this.setPrivateEx(r.N,r.E,r.D,r.P,r.Q,r.DP,r.DQ,r.C,16)}},pidCrypt.RSA.prototype.setPublicKeyFromASN=function(e){this.setKeyFromASN("public",e)},pidCrypt.RSA.prototype.setPrivateKeyFromASN=function(e){this.setKeyFromASN("private",e)},pidCrypt.RSA.prototype.getParameters=function(){var e={};return null!=this.n&&(e.n=this.n),e.e=this.e,null!=this.d&&(e.d=this.d),null!=this.p&&(e.p=this.p),null!=this.q&&(e.q=this.q),null!=this.dmp1&&(e.dmp1=this.dmp1),null!=this.dmq1&&(e.dmq1=this.dmq1),null!=this.coeff&&(e.c=this.coeff),e}}const certParser=function(e){for(var t=e.split("\n"),i=!1,r=!1,n="",a={info:"",salt:"",b64:"",aes:!1,mode:"",bits:0},o=0;o<t.length;o++)switch(n=t[o].substr(0,9),1==o&&"Proc-Type"!=n&&0==n.indexOf("M")&&(r=!0),n){case"-----BEGI":i=!0;break;case"Proc-Type":i&&(a.info=t[o]);break;case"DEK-Info:":if(i){var s=t[o].split(","),l=s[0].split(": ")[1].split("-");a.aes="AES"==l[0],a.mode=l[2],a.bits=parseInt(l[1]),a.salt=s[1].substr(0,16),a.iv=s[1]}break;case"":i&&(r=!0);break;case"-----END ":i&&(r=!1,i=!1);break;default:i&&r&&(a.b64+=pidCryptUtil.stripLineFeeds(t[o]))}return a},fire=function(e,t){const i=new CustomEvent(e,{detail:t});document.dispatchEvent(i)};function encryptVote(e,t){if(!e)return fire("oav-error-localize",["error_public_key_not_found"]),null;var i=certParser(e);if(!i.b64)return fire("oav-error-localize",["error_invalid_public_key"]),null;try{var r=pidCryptUtil.decodeBase64(i.b64),n=new pidCrypt.RSA,a=pidCrypt.ASN1.decode(pidCryptUtil.toByteArray(r)).toHexTree();n.setPublicKeyFromASN(a);var o=n.encrypt(JSON.stringify(t));return pidCryptUtil.fragment(pidCryptUtil.encodeBase64(pidCryptUtil.convertFromHex(o)),64)}catch(e){return fire("oav-error-localize",["error_encryption","err",e]),null}}var ballotEncryptionBehavior={encryptVote:encryptVote};const OapCountryCreationStyles=css`

  :host {
    width: 100%;
    height: 100%;
  }

  .header {
    font-size: 24px;
    margin-top: 16px;
    margin-bottom: 8px;
    font-weight: bold;
    background-color: var(--app-country-header-background-color, #000);
    color: var(--app-country-header-color, #FFF);
    max-width: 100%;
    margin-left: 0;
    margin-right: 0;
    padding-top: 2px;
    text-align: center;
  }

  .subHeader {
    font-size: 20px;
    margin-top: 12px;
    margin-bottom: 16px;
    padding-left: 16px;
    padding-right: 16px;
    font-weight: bold;
  }

  .subHeader.noBottom {
    margin-bottom: 0;
  }

  .topContainer {
    max-width: 600px;
    width: 600px;
    background-color: #000;
    color: #FFF;
    padding-top: 16px;
    padding-bottom: 42px;
    padding-left: 0;
    padding-right: 0;
    margin-left: auto;
    margin-right: auto;
  }

  .flexRow {
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;

    flex-wrap: wrap;
    -ms-flex-wrap: wrap;
    -webkit-flex-wrap: wrap;

    -ms-flex-direction: row;
    -webkit-flex-direction: row;
    flex-direction: row;

    justify-content: center;
    width: 100%;
    margin-top: 24px;
    margin-bottom: 8px;
  }

  .basicInfo {
    padding-top: 24px;
  }

  .column {
    margin-left: 16px;
    margin-right: 16px;
    padding-left: 8px;
    padding-right: 8px;
  }

  paper-button {
    background-color: #000;
    color: #FFF;
    border: 1px solid #FFF;
    margin-left: auto;
    margin-right: auto;
    margin-top: 24px;
  }

  paper-button[disabled] {
    background-color: #888;
  }

  .sliderHeader {
    margin-top: 12px;
    font-size: 18px;
  }

  .sliderHeader {
    font-size: 18px;
  }

  .rawStats {
    margin-top: 24px;
  }

  .emoji {
    margin-right: 8px;
    margin-left: 16px;
    font-size: 32px;
    margin-bottom: 0;
    padding-bottom: 0;
  }

  .emojiResources {
    margin-left: 8px;
    margin-right: 8px;
  }

  paper-input {
    padding-left: 16px;
    padding-right: 16px;
    color: #000;
    --paper-input-container-color: #000;
    --paper-input-container-focus-color: #000;
    --paper-input-container-input-color: #000;
  }

  paper-textarea {
    padding-left: 16px;
    padding-right: 16px;
    --paper-input-container-color: #000;
    --paper-input-container-focus-color: #000;
    --paper-input-container-input-color: #000;
    color: #000;
  }

  paper-slider {
    --paper-slider-container-color: #333;
    --paper-slider-active-color: var(--app-create-country-slider-active-color, #333);
    --paper-slider-knob-color: var(--app-create-country-slider-active-color, #333);
    --paper-slider-font-color: var(--app-create-country-slider-active-color, #333);
    color: #333;
    --paper-input-container-color:  var(--app-create-country-slider-active-color, #333);
    --paper-input-container-focus-color: var(--app-create-country-slider-active-color, #333);
    --paper-input-container-input-color: var(--app-create-country-slider-active-color, #333);
    --paper-slider-disabled-active-color:  var(--app-create-country-slider-active-color, #333);
    --paper-input-disabled-color:  var(--app-create-country-slider-active-color, #333);
    --paper-slider-disabled-knob-color: var(--app-create-country-slider-active-color, #333);
    --paper-slider-secondary-color: : var(--app-create-country-slider-active-color, #333);
    --paper-slider-height: 2px;
  }

  .dropDownContainer {
    margin-left: 16px;
    margin-right: 16px;
  }

  paper-dropdown-menu {
    --paper-input-container-color:  var(--app-create-country-slider-active-color, #fff);
    --paper-input-container-focus-color: var(--app-create-country-slider-active-color, #fff);
    --paper-input-container-input-color: var(--app-create-country-slider-active-color, #fff);
    --paper-slider-disabled-active-color:  var(--app-create-country-slider-active-color, #fff);
    --paper-input-disabled-color:  var(--app-create-country-slider-active-color, #fff);
    --paper-input-container-input: {
      font-size: 30px;
    };
    --paper-dropdown-menu-input: {
      --paper-input-container-input: {
        font-size: 30px;
      }
    }
    color: #FFF;
    width: 100%;
  }

  .nextToTop {
    background-color: #fff;
    color: #000;
    padding-left: 8px;
    padding-right: 8px;
    padding-bottom: 24px;
    border-radius: 8px;
  }

  .attituteSlider {
    width: 240px;
  }

  .cultural {
    margin-top: 24px;
    margin-bottom: 8px !important;
  }

  .cultRow {
    margin-top: 0;
  }

  .welcomeLogo {
    max-width: 120px;
    max-height: 120px;
    width: 120px;
    height: 120px;
    margin-left: auto;
    margin-right: auto;
    text-align: center;
  }

  @media (max-width: 600px) {
    .topContainer {
      max-width: 100%;
      margin-left: 8px;
      margin-right: 8px;
      width: 100%;
      height: 100%;
      margin-bottom: 32px;
      padding-top: 32px;
    }

    paper-input {
      max-width: 300px;
    }

    paper-textarea {
      max-width: 300px;
    }

    .attituteSlider {
      width: 100%;
    }

    paper-slider {
      width: 100%;
    }

    .cultural {
      margin-top: 32px;
    }

    .header {
      font-size: 20px;
    }
  }


  [hidden] {
    display: none !important;
  }
`;var oapCountryCreationStyles={OapCountryCreationStyles:OapCountryCreationStyles};window.IntlMessageFormat=MessageFormat;class OapBaseElement extends LitElement{static get properties(){return{wide:{type:Boolean,value:!1},language:{type:String}}}constructor(){super()}activity(e,t){this.sendToGoogleAnalytics("send","event",t,e)}sendToGoogleAnalytics(e,t,i,r){"function"==typeof ga?i&&r?ga(e,t,i,r):ga(e,t):console.warn("Google analytics message not sent for type:"+e+" parameterA:"+t+" parameterB:"+i+" parameterC:"+r)}formatNumber(e,t){return t||(t=""),e?t+e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):t+"0"}localize(){var e=arguments[0];if(!(e&&window.localeResources&&this.language&&window.language))return e;var t=window.localeResources[e];if(!t)return e;var i=e+t,r=window.__localizationCache.messages[i];r||(r=new MessageFormat(t,this.language,{}),window.__localizationCache.messages[i]=r);for(var n={},a=1;a<arguments.length;a+=2)n[arguments[a]]=arguments[a+1];return r.format(n)}updated(e){super.updated(e),e.has("language")}firstUpdated(){super.firstUpdated(),installMediaQueryWatcher$1("(min-width: 1024px)",e=>{this.wide=e})}$$(e){return this.shadowRoot.querySelector(e)}fire(e,t){const i=new CustomEvent(e,{detail:t,bubbles:!0,composed:!0});this.dispatchEvent(i)}}var oapBaseElement={OapBaseElement:OapBaseElement};class OapPageViewElement extends OapBaseElement{shouldUpdate(){return this.active}static get properties(){return{active:{type:Boolean}}}}var oapPageViewElement={OapPageViewElement:OapPageViewElement};const OapFlexLayout=css`
      .layout {
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;
      };

      .layout-inline {
        display: -ms-inline-flexbox;
        display: -webkit-inline-flex;
        display: inline-flex;
      };

      .horizontal {
        -ms-flex-direction: row;
        -webkit-flex-direction: row;
        flex-direction: row;
      };

      .horizontal-reverse {
        -ms-flex-direction: row-reverse;
        -webkit-flex-direction: row-reverse;
        flex-direction: row-reverse;
      };

      .vertical {
        -ms-flex-direction: column;
        -webkit-flex-direction: column;
        flex-direction: column;
      };

      .vertical-reverse {
        -ms-flex-direction: column-reverse;
        -webkit-flex-direction: column-reverse;
        flex-direction: column-reverse;
      };

      .wrap {
        -ms-flex-wrap: wrap;
        -webkit-flex-wrap: wrap;
        flex-wrap: wrap;
      };

      .wrap-reverse {
        -ms-flex-wrap: wrap-reverse;
        -webkit-flex-wrap: wrap-reverse;
        flex-wrap: wrap-reverse;
      };

      .flex-auto {
        -ms-flex: 1 1 auto;
        -webkit-flex: 1 1 auto;
        flex: 1 1 auto;
      };

      .flex-none {
        -ms-flex: none;
        -webkit-flex: none;
        flex: none;
      };

      .flex {
        -ms-flex: 1 1 0.000000001px;
        -webkit-flex: 1;
        flex: 1;
        -webkit-flex-basis: 0.000000001px;
        flex-basis: 0.000000001px;
      };

      /* alignment in cross axis */
      .start {
        -ms-flex-align: start;
        -webkit-align-items: flex-start;
        align-items: flex-start;
      };

      .center {
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
      };

      .end {
        -ms-flex-align: end;
        -webkit-align-items: flex-end;
        align-items: flex-end;
      };

      .baseline {
        -ms-flex-align: baseline;
        -webkit-align-items: baseline;
        align-items: baseline;
      };

      /* alignment in main axis */
      .start-justified {
        -ms-flex-pack: start;
        -webkit-justify-content: flex-start;
        justify-content: flex-start;
      };

      .center-justified {
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
      };

      .end-justified {
        -ms-flex-pack: end;
        -webkit-justify-content: flex-end;
        justify-content: flex-end;
      };

      .around-justified {
        -ms-flex-pack: distribute;
        -webkit-justify-content: space-around;
        justify-content: space-around;
      };

      .justified {
        -ms-flex-pack: justify;
        -webkit-justify-content: space-between;
        justify-content: space-between;
      };

      .center-center {
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
      };

      /* self alignment */
      .self-start {
        -ms-align-self: flex-start;
        -webkit-align-self: flex-start;
        align-self: flex-start;
      };

      .self-center {
        -ms-align-self: center;
        -webkit-align-self: center;
        align-self: center;
      };

      .self-end {
        -ms-align-self: flex-end;
        -webkit-align-self: flex-end;
        align-self: flex-end;
      };

      .self-stretch {
        -ms-align-self: stretch;
        -webkit-align-self: stretch;
        align-self: stretch;
      };

      .self-baseline {
        -ms-align-self: baseline;
        -webkit-align-self: baseline;
        align-self: baseline;
      };

      /* multi-line alignment in main axis */
      .start-aligned {
        -ms-flex-line-pack: start;  /* IE10 */
        -ms-align-content: flex-start;
        -webkit-align-content: flex-start;
        align-content: flex-start;
      };

      .end-aligned {
        -ms-flex-line-pack: end;  /* IE10 */
        -ms-align-content: flex-end;
        -webkit-align-content: flex-end;
        align-content: flex-end;
      };

      .center-aligned {
        -ms-flex-line-pack: center;  /* IE10 */
        -ms-align-content: center;
        -webkit-align-content: center;
        align-content: center;
      };

      .between-aligned {
        -ms-flex-line-pack: justify;  /* IE10 */
        -ms-align-content: space-between;
        -webkit-align-content: space-between;
        align-content: space-between;
      };

      .around-aligned {
        -ms-flex-line-pack: distribute;  /* IE10 */
        -ms-align-content: space-around;
        -webkit-align-content: space-around;
        align-content: space-around;
      };
      /*******************************
                Other Layout
      *******************************/
      .block {
        display: block;
      };
      .invisible {
        visibility: hidden !important;
      };
      .relative {
        position: relative;
      };
      .fit {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      };
      .scroll {
        -webkit-overflow-scrolling: touch;
        overflow: auto;
      };
      .fullbleed {
        margin: 0;
        height: 100vh;
      };
      /* fixed position */
      .fixed-top {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
      };
      .fixed-right {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
      };
      .fixed-bottom {
        position: fixed;
        right: 0;
        bottom: 0;
        left: 0;
      };
      .fixed-left {
        position: fixed;
        top: 0;
        bottom: 0;
        left: 0;
      };
`;var oapFlexLayout={OapFlexLayout:OapFlexLayout};const OapShadowStyles=css`
  .shadow-transition {
     transition: box-shadow 0.28s cubic-bezier(0.4, 0, 0.2, 1);
   }

  .shadow-elevation-2dp {
    box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),
                0 1px 5px 0 rgba(0, 0, 0, 0.12),
                0 3px 1px -2px rgba(0, 0, 0, 0.2);
  }

  .shadow-elevation-3dp {
    box-shadow: 0 3px 4px 0 rgba(0, 0, 0, 0.14),
                0 1px 8px 0 rgba(0, 0, 0, 0.12),
                0 3px 3px -2px rgba(0, 0, 0, 0.4);
  }

  .shadow-elevation-4dp {
    box-shadow: 0 4px 5px 0 rgba(0, 0, 0, 0.14),
                0 1px 10px 0 rgba(0, 0, 0, 0.12),
                0 2px 4px -1px rgba(0, 0, 0, 0.4);
  }

  .shadow-elevation-6dp {
    box-shadow: 0 6px 10px 0 rgba(0, 0, 0, 0.14),
                0 1px 18px 0 rgba(0, 0, 0, 0.12),
                0 3px 5px -1px rgba(0, 0, 0, 0.4);
  }

  .shadow-elevation-8dp {
    box-shadow: 0 8px 10px 1px rgba(0, 0, 0, 0.14),
                0 3px 14px 2px rgba(0, 0, 0, 0.12),
                0 5px 5px -3px rgba(0, 0, 0, 0.4);

  }
  .shadow-elevation-12dp {
    box-shadow: 0 12px 16px 1px rgba(0, 0, 0, 0.14),
                0 4px 22px 3px rgba(0, 0, 0, 0.12),
                0 6px 7px -4px rgba(0, 0, 0, 0.4);
  }

  .shadow-elevation-16dp {
    box-shadow: 0 16px 24px 2px rgba(0, 0, 0, 0.14),
                0  6px 30px 5px rgba(0, 0, 0, 0.12),
                0  8px 10px -5px rgba(0, 0, 0, 0.4);
  }
  .shadow-elevation-24dp {
    box-shadow: 0 24px 38px 3px rgba(0, 0, 0, 0.14),
                0 9px 46px 8px rgba(0, 0, 0, 0.12),
                0 11px 15px -7px rgba(0, 0, 0, 0.4);
  }
`;var oapShadowStyles={OapShadowStyles:OapShadowStyles};class OapCountryCreation extends OapPageViewElement{static get properties(){return{country:Object,customCountry:Boolean,submitDisabled:Boolean,configFromServer:Object}}static get styles(){return[OapCountryCreationStyles,OapFlexLayout,OapShadowStyles]}constructor(){super(),this.reset()}reset(){this.customCountry=null,this.submitDisabled=!0,this.country={name:"",description:"",population:"",geographicalSize:"",naturalResourceWealth:0,borderDensity:0,hostilityNeighboringCountries:0,barrieresToCitizenship:0,culturalAttitutes:{authority:0,liberty:0,science:0,tradition:0,collective:0,independence:0,privacy:0,lawAndOrder:0,progressivism:0}}}render(){return html$1`
    <div class="layout vertical center-center">
      <div class="topContainer shadow-animation shadow-elevation-3dp">
        <div class="welcomeLogoContainer layout center-center">
          <img aria-label="welcome/velkomin" class="welcomeLogo" src="${this.configFromServer.client_config.ballotBudgetLogo}"></img>
        </div>
        ${this.countryList&&this.country?html$1`
          <div class="layout-inline vertical" style="width: 100%;">
            <div class="header"><div style="padding: 8px">${this.localize("createYourCountry")}</div></div>

            <div class="dropDownContainer">
              <paper-dropdown-menu .label="${this.localize("choose_a_country")}" @selected-item-changed="${this.countrySelected}">
                  <paper-listbox slot="dropdown-content">
                    ${this.countryList.map((e,t)=>html$1`
                        <paper-item data-id="${t}">${e.name}</paper-item>
                      `)}
                  </paper-listbox>
                </paper-dropdown-menu>
            </div>

            <div class="hiddenDiv nextToTop" ?hidden="${null===this.customCountry}">
              <div class="subHeader noBottom basicInfo">${this.localize("basicInformation")}</div>

              <paper-input id="name"
                          name="name"
                          type="text"
                          label="${this.localize("countryName")}"
                          .value="${this.country.name}"
                          @value-changed="${this.setName}"
                          ?hidden="${!this.customCountry}"
                          maxlength="50"
                          char-counter>
              </paper-input>

              <paper-textarea id="description"
                              name="description"
                              .value="${this.country.description}"
                              ?always-float-label="${this.country&&this.country.description}"
                              label="${this.localize("countryDescription")}"
                              char-counter
                              @value-changed="${this.setDescription}"
                              ?char-counter="${this.customCountry}"
                              rows="2"
                              max-rows="5"
                              maxlength="500">
              </paper-textarea>

              <div class="subHeader cultural">
                ${this.localize("culturalAttitude")}
                <paper-icon-button icon="help-outline" @click="${this.culturalHelp}"></paper-icon-button>
              </div>

              <div id="culturalAttitudes" class="flexRow cultRow">
                <div class="column">
                  <div class="sliderHeader">
                    <span class="emoji"></span>${this.localize("authority")}:
                    <span class="cultPercent">${this.getCulturalPercent(this.country.culturalAttitutes.authority)}</span>
                  </div>
                  <paper-slider class="attituteSlider"
                    @value-changed="${e=>{this.changeAttitute("authority",e)}}"
                    .value="${this.country.culturalAttitutes.authority}"
                    max="9" ?hidden="${!this.customCountry}"
                    >
                </paper-slider>

                <div class="sliderHeader">
                  <span class="emoji"></span>${this.localize("science")}:
                  <span class="cultPercent">${this.getCulturalPercent(this.country.culturalAttitutes.science)}</span>
                </div>
                <paper-slider class="attituteSlider"
                    @value-changed="${e=>{this.changeAttitute("science",e)}}"
                    .value="${this.country.culturalAttitutes.science}"
                    max="9" ?hidden="${!this.customCountry}"
                    >
                </paper-slider>

                <div class="sliderHeader">
                  <span class="emoji"></span>${this.localize("collective")}:
                  <span class="cultPercent">${this.getCulturalPercent(this.country.culturalAttitutes.collective)}</span>
                </div>
                <paper-slider class="attituteSlider"
                  @value-changed="${e=>{this.changeAttitute("collective",e)}}"
                  .value="${this.country.culturalAttitutes.collective}"
                    max="9" ?hidden="${!this.customCountry}"
                    >
                </paper-slider>

                <div class="sliderHeader">
                  <span class="emoji"></span>${this.localize("privacy")}:
                  <span class="cultPercent">${this.getCulturalPercent(this.country.culturalAttitutes.privacy)}</span>
                </div>
                <paper-slider class="attituteSlider"
                  @value-changed="${e=>{this.changeAttitute("privacy",e)}}"
                .value="${this.country.culturalAttitutes.privacy}"
                  max="9" ?hidden="${!this.customCountry}"
                  >
                </paper-slider>

                <div class="sliderHeader">
                  <span class="emoji"></span>${this.localize("progressivism")}:
                  <span class="cultPercent">${this.getCulturalPercent(this.country.culturalAttitutes.progressivism)}</span>
                </div>
                <paper-slider class="attituteSlider"
                    @value-changed="${e=>{this.changeAttitute("progressivism",e)}}"
                    .value="${this.country.culturalAttitutes.progressivism}"
                    max="9" ?hidden="${!this.customCountry}"
                    >
                </paper-slider>
              </div>

              <div class="column">
                  <div class="sliderHeader">
                    <span class="emoji"></span>${this.localize("liberty")}:
                    <span class="cultPercent">${this.getCulturalPercent(this.country.culturalAttitutes.liberty)}</span>
                  </div>
                  <paper-slider class="attituteSlider"
                    @value-changed="${e=>{this.changeAttitute("liberty",e)}}"
                    .value="${this.country.culturalAttitutes.liberty}"
                    max="9" ?hidden="${!this.customCountry}"
                    >
                  </paper-slider>

                  <div class="sliderHeader">
                    <span class="emoji"></span>${this.localize("tradition")}:
                    <span class="cultPercent">${this.getCulturalPercent(this.country.culturalAttitutes.tradition)}</span>
                  </div>
                  <paper-slider class="attituteSlider"
                    @value-changed="${e=>{this.changeAttitute("tradition",e)}}"
                    .value="${this.country.culturalAttitutes.tradition}"
                    max="9" ?hidden="${!this.customCountry}"
                    >
                  </paper-slider>

                  <div class="sliderHeader">
                    <span class="emoji"></span>${this.localize("independence")}:
                    <span class="cultPercent">${this.getCulturalPercent(this.country.culturalAttitutes.independence)}</span>
                  </div>
                  <paper-slider class="attituteSlider"
                    @value-changed="${e=>{this.changeAttitute("independence",e)}}"
                    .value="${this.country.culturalAttitutes.independence}"
                    max="9" ?hidden="${!this.customCountry}"
                    >
                  </paper-slider>

                  <div class="sliderHeader">
                    <span class="emoji"></span>${this.localize("lawAndOrder")}:
                    <span class="cultPercent">${this.getCulturalPercent(this.country.culturalAttitutes.lawAndOrder)}</span>
                  </div>
                  <paper-slider class="attituteSlider"
                    @value-changed="${e=>{this.changeAttitute("lawAndOrder",e)}}"
                    .value="${this.country.culturalAttitutes.lawAndOrder}"
                    max="9" ?hidden="${!this.customCountry}"
                    >
                  </paper-slider>

                </div>
              </div>

              <div class="subHeader noBottom rawStats">${this.localize("countryRawStats")}</div>

              <paper-input id="population"
                          name="population"
                          type="text"
                          label="${this.localize("populationSize")}"
                          .value="${this.country.population}"
                          maxlength="8"
                          @value-changed="${this.setPopulation}"
                          char-counter>
              </paper-input>

              <paper-input id="geographicalSize"
                          name="geographicalSize"
                          type="text"
                          label="${this.localize("geographicalSize")}"
                          .value="${this.country.geographicalSize}"
                          @value-changed="${this.setGeographicalSize}"
                          maxlength="8"
                          char-counter>
              </paper-input>

              <div class="flexRow">
                <div class="column">
                  <div class="sliderHeader">
                    <span class="emoji emojiResources"></span>${this.localize("naturalResourceWealth")}:
                    <span class="cultPercent">${this.getCulturalPercent(this.country.naturalResourceWealth)}</span>
                  </div>
                  <paper-slider
                      @value-changed="${e=>{this.changeStats("naturalResourceWealth",e)}}"
                      .value="${this.country.naturalResourceWealth}"
                      max="9" ?hidden="${!this.customCountry}"
                      >
                    </paper-slider>

                  <div class="sliderHeader">
                    <span class="emoji"></span>${this.localize("borderDensity")}:
                    <span class="cultPercent">${this.getCulturalPercent(this.country.borderDensity)}</span>
                  </div>
                  <paper-slider
                      @value-changed="${e=>{this.changeStats("borderDensity",e)}}"
                      .value="${this.country.borderDensity}"
                      max="9" ?hidden="${!this.customCountry}"
                      >
                    </paper-slider>
                  </div>
                <div class="column">
                  <div class="sliderHeader">
                    <span class="emoji"></span>${this.localize("hostilityNeighboringCountries")}:
                    <span class="cultPercent">${this.getCulturalPercent(this.country.hostilityNeighboringCountries)}</span>
                  </div>
                  <paper-slider
                    @value-changed="${e=>{this.changeStats("hostilityNeighboringCountries",e)}}"
                    .value="${this.country.hostilityNeighboringCountries}"
                    max="9" ?hidden="${!this.customCountry}"
                    >
                  </paper-slider>

                  <div class="sliderHeader">
                    <span class="emoji"></span>${this.localize("barrieresToCitizenship")}:
                    <span class="cultPercent">${this.getCulturalPercent(this.country.barrieresToCitizenship)}</span>
                  </div>
                  <paper-slider
                    @value-changed="${e=>{this.changeStats("barrieresToCitizenship",e)}}"
                    .value="${this.country.barrieresToCitizenship}"
                    max="9" ?hidden="${!this.customCountry}"
                    >
                  </paper-slider>
                </div>
              </div>

            </div>
            <div class="layout horizontal center-center">
              <paper-button raised id="submitButton" ?hidden="${null===this.customCountry}" ?disabled="${this.submitDisabled}" class="buttton" @click="${()=>{this.fire("oap-country-created",this.country)}}">${this.localize("buildConstitutionForCountry")}</paper-button>
            </div>

          </div>

        `:html$1``}

      </div>

    </div>
    `}getCulturalPercent(e){return 10*parseInt(e)+"%"}countrySelected(e){if(e.detail.value){const t=e.detail.value.dataset.id;this.country=this.countryList[e.detail.value.dataset.id],9==t?(this.customCountry=!0,this.country.name="",this.submitDisabled=!0,this.checkIfOkToProceed()):(this.countryList[9].name="Custom country",this.customCountry=!1,this.submitDisabled=!1),this.haveOpenedTutorial||(setTimeout(()=>{this.fire("oap-start-cultural-attitutes-tutorial")}),this.haveOpenedTutorial=!0)}}checkIfOkToProceed(){1<this.country.name.length&&1<this.country.description.length&&0<this.country.population.length&&0<this.country.geographicalSize.length&&(this.submitDisabled=!1)}setName(e){e.detail.value&&this.customCountry&&(this.country.name=e.detail.value,this.checkIfOkToProceed())}setDescription(e){e.detail.value&&this.customCountry&&(this.country.description=e.detail.value,this.checkIfOkToProceed())}setPopulation(e){e.detail.value&&this.customCountry&&(this.country.population=e.detail.value,this.checkIfOkToProceed())}changeStats(e,t){t.detail.value&&this.customCountry&&(this.country[e]=t.detail.value,this.requestUpdate())}changeAttitute(e,t){t.detail.value&&this.customCountry&&(this.country.culturalAttitutes[e]=t.detail.value,this.requestUpdate())}setGeographicalSize(e){e.detail.value&&this.customCountry&&(this.country.geographicalSize=e.detail.value,this.checkIfOkToProceed())}culturalHelp(){let e;e=this.configFromServer.client_config.helpPageLocales[this.language]?this.b64DecodeUnicode(this.configFromServer.client_config.cultureHelpPageLocales[this.language].b64text):this.configFromServer.client_config.helpPageLocales.en?this.b64DecodeUnicode(this.configFromServer.client_config.cultureHelpPageLocales.en.b64text):"No help page found for selected language!",this.fire("oap-open-help",e)}b64DecodeUnicode(e){return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}updated(e){super.updated(e),e.has("configFromServer")&&this.configFromServer&&(this.countryList=this.configFromServer.client_config.languages[this.language].countryList)}}window.customElements.define("oap-country-creation",OapCountryCreation);const OapFilterArticlesStyles=css`

  :host {
    width: 100%;
  }

  .completed {
    margin-top: 32px;
  }

  .continueButton {
    margin-top: 24px;
    background-color: #000;
    border: 1px solid #FFF;
    color: #FFF;
    width: 100%;
    margin-left: 32px;
    margin-right: 32px;
  }

  .topContainer {
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    background-color: var(--quiz-background-color, #000);
    color: var(--quiz-color, #FFF);
    padding-bottom: 16px;
    margin-top: 32px;
  }

  .completeHeader {
    padding: 16px;
  }


  [hidden] {
    display: none !important;
  }
`;var oapFilterArticlesStyles={OapFilterArticlesStyles:OapFilterArticlesStyles};const OapSwipableCardsStyles=css`
  /*------ CSS Use Case Example START ------*/

  body {
      font-family: 'Roboto', sans-serif;
      font-size: 12px;
      margin: 0 15px;
  }

  .background-0 { background: #C87D26; }
  .background-1 { background: #569D99; }
  .background-2 { background: #740039; }
  .background-3 { background: #839FC5; }
  .background-4 { background: #6A4F76; }
  .background-5 { background: #57636D; }
  .background-6 { background: #6D5242; }
  .background-7 { background: #4F5051; }

  .background-0,
  .background-1,
  .background-2,
  .background-3,
  .background-4,
  .background-5,
  .background-6,
  .background-7 {
    transition: all 400ms ease;
  }

  :host {
    width: 100%;
    height: 100%;
  }

  .toppestContainer {
    width: 100%;
    height: 100%;
  }
  /* class created only for a better preview*/
  .stage {
      padding-top: 24px;
      position: absolute;
      opacity: 1;
      max-width: 335px;
      top: 0;
      left: 50%;
      -webkit-transform: translate(-50%, 0%);
          -ms-transform: translate(-50%, 0%);
              transform: translate(-50%, 0%);
  }

  .stage.hidden {
    opacity: 0;
    transition: all 400ms ease;
  }

  @media screen and (max-width: 600px) {
      .stage {
          max-width: 100%;
        }
    }

  h1, h2, h3 {
    margin: 0;
  }

  h1 {
    font-size: 32px;
    font-weight: 400;
  }

  h2 {
    font-size: 24px;
    font-weight: 100;
    color: #FFF;
    text-align: center;
  }

  h3 {
    font-size: 18px;
    font-weight: 300;
    color: #BFBFBE;
    margin-top: 10px;
  }

  .title {
      width: 100%;
      text-align: center;
      font-weight: 700;
      font-size: 18px;
      margin-bottom: 12px;
      margin-top: 24px;
      color: #fff !important;
  }

  .speedSlider {
    opacity: 0.0;
    margin-top: 4px;
    text-align: center;
    margin-left: auto;
    margin-right: auto;
    --paper-slider-active-color: var(--app-create-country-slider-active-color, #aaa);
    --paper-slider-knob-color: var(--app-create-country-slider-active-color, #aaa);
    --paper-slider-container-color: #333;
    transition: opacity 0.7s;
    -moz-transition: opacity 0.7s;
    -webkit-transition: opacity 0.7s;
    -o-transition: opacity 0.7s;
  }

  .speedSlider[auto] {
    opacity: 1.0;
    transition: opacity 0.5s;
    -moz-transition: opacity 0.5s;
    -webkit-transition: opacity 0.5s;
    -o-transition: opacity 0.5s;
  }

  .speedSliderInfo {
    opacity: 0.0;
    text-align: center;
    margin-left: auto;
    margin-right: auto;
    font-size: 12px;
    color: #999;
    margin-top: -6px;
  }

  .speedSliderInfo[auto] {
    opacity: 1.0;
    transition: opacity 0.5s;
    -moz-transition: opacity 0.5s;
    -webkit-transition: opacity 0.5s;
    -o-transition: opacity 0.5s;
  }

  .card-content {
    position: relative;
    color: #fff;
    padding: 5px;
  }

  .card-image {
    width: 100%;
    height: 100%;
  }
  .card-image img {
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
    -o-object-fit: cover;
        object-fit: cover;
    width: 100%;
    height: 100%;
    min-height: 330px;
  }

  .card-titles {
    position: absolute;
    bottom: 0;
    padding: 40px 30px;
  }

  .card-footer {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-pack: center;
        -ms-flex-pack: center;
            justify-content: center;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
    padding: 25px 35px;
  }

  .popular-destinations-text {
    font-size: 16px;
    font-weight: 400;
    color: #8E9AA4;
    width: 100%;
    min-width: 110px;
  }

  .popular-destinations-images {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-pack: end;
          -ms-flex-pack: end;
              justify-content: flex-end;
      width: 100%;
  }

  .circle {
      width: 40px;
      height: 40px;
      border-radius:  50%;
      background: #fff;
      margin-left: 8px;
  }

  .circle img {
      border-radius: 50%
  }

  /* global actions buttons*/
  .global-actions {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: center;
          -ms-flex-align: center;
              align-items: center;
      -webkit-box-pack: center;
          -ms-flex-pack: center;
              justify-content: center;
      padding-top: 12px;
      min-width: 200px;
      margin-top: -32px;
  }

  .top-action,
  .right-action,
  .left-action {
      border-radius: 50%;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
      -webkit-box-pack: center;
          -ms-flex-pack: center;
              justify-content: center;
      background: #fff;
    -webkit-box-shadow: 0 3px 4px 0px rgba(0,0,0,0.5);
            box-shadow: 0 3px 4px 0px rgba(0,0,0,0.5);
  }
  .right-action,
  .left-action {
      width: 60px;
      height: 60px;
  }

  .top-action {
      width: 40px;
      height: 40px;
      margin: 0 20px;
  }

  .final-state.active {
    position: absolute;
    opacity: 1;
    top: 0;
    left: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
    transition: all 400ms ease;
  }

  .final-state.hidden {
    opacity: 0;
  }


  /*------ CSS Use Case Example END ------*/

  /*----- Stacked Cards component css START -----*/
  body {
      overflow-x: hidden;
  }

  .no-transition {
    -webkit-transition: none ! important;
    transition: none ! important;
  }

  .stackedcards-overflow {
      overflow-y: hidden !important;
  }

  .stackedcards.init {
      opacity: 0;/* set the opacity to 0 if you want a fade-in effect to stacked cards on page load */
  }

  .stackedcards {
      position: relative;
  }

  .stackedcards * {
      -webkit-user-select: none;
              -moz-user-select: none;
                -ms-user-select: none;
            user-select: none;
  }

  .stackedcards--animatable {
      -webkit-transition: all 400ms ease;
              -o-transition: all 400ms ease;
              transition: all 400ms ease;
  }

  .stackedcards .stackedcards-container > *,
  .stackedcards-overlay {
      position: absolute;
      width: 100%; /* set 100% */
      height: 100%; /* set 100% */
      will-change: transform, opacity;
      top: 0;
      border-radius: 10px;
      min-width: 265px;
  }

  .stackedcards-overlay.left > div,
  .stackedcards-overlay.right > div,
  .stackedcards-overlay.top > div {
      width: 100%;
      height: 100%;
      -webkit-box-align: center;
          -ms-flex-align: center;
              align-items: center;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-pack: center;
          -ms-flex-pack: center;
              justify-content: center;
  }

  .stackedcards-overlay.left,
  .stackedcards-overlay.right,
  .stackedcards-overlay.top {
      -webkit-box-align: center;
          -ms-flex-align: center;
              align-items: center;
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-pack: center;
          -ms-flex-pack: center;
              justify-content: center;
      left: 0;
      opacity: 0;
      top: 0;
      height: 100%;
  }

  .stackedcards-overlay.top,
  .stackedcards-overlay.right,
  .stackedcards-overlay.left {
      background: #fff;
  }

  .stackedcards-overlay.left:empty,
  .stackedcards-overlay.right:empty,
  .stackedcards-overlay.top:empty {
    display: none !important;
  }

  .stackedcards-overlay-hidden {
      display: none;
  }

  .stackedcards-origin-bottom {
      -webkit-transform-origin: bottom;
              -ms-transform-origin: bottom;
          transform-origin: bottom;
  }

  .stackedcards-origin-top {
      -webkit-transform-origin: top;
              -ms-transform-origin: top;
          transform-origin: top;
  }

  .stackedcards-bottom,
  .stackedcards-top,
  .stackedcards-none {
      background: #fff; /* set card background background */
      box-shadow: 0 6px 12px 0 rgba(0,0,0,0.30);
      height: 100%;
  }

  .stackedcards .stackedcards-container > :nth-child(1) {
      position: relative;
      display: block;
  }

  .welcomeLogo {
    max-width: 120px;
    margin-left: auto;
    margin-right: auto;
    text-align: center;
    margin-top: 12px;
    -webkit-transform: scaleX(-1);
    transform: scaleX(-1);
  }

  .description {
    font-size: 14px;
    color: #000;
    margin: 8px;
    margin-top: 0;
    margin-bottom: 32px;
    height: 120px;
    overflow-y: hidden;
  }

  .description[exlusive] {
    height: 97px;
  }

  .moduleName {
    margin-bottom: 8px;
    margin-top: 8px;
  }

  .description[module-type] {
    font-size: 16px;
    margin-bottom: 0px;
    color: #FFF;
    margin-left: 32px;
    margin-right: 32px;
    font-style: italic;
  }

  .description[module-type] > em {
    text-align: left;
    font-style: normal;
  }

  .name {
    font-size: 17px;
    color: #000;
    font-weight: bold;
    margin: 8px;
    text-align: left;
    padding-top: 2px;
    margin-top: 0;
    margin-bottom: 2px;
    line-height: 1.15;
  }

  .name[module-type] {
    text-align: center;
    font-size: 25px;
    margin-bottom: 12px;
    color: #FFF;
  }

  .cardTitles[module-type] {
    margin-top: 72px;
    text-align: center;
  }

  .cardImage {
    width: 324px;
    height: 218px;
    transition: height 0.5s;
    -moz-transition: height 0.5s;
    -webkit-transition: height 0.5s;
    -o-transition: height 0.5s;
  }

  .moduleLine {
    max-height: 4px;
    height: 4px;
    margin: 0;
    padding: 0;
    width: 324px;
    margin-top: -4px;
  }

  paper-icon-button {
    color: #000;
    width: 55px;
    height: 55px;
  }

  .innerHideContainer {
    text-align: center;
  }

  .card-content {
    height: 410px;
    width: 330px;
    overflow-y: auto;
  }

  .hideUnhideContainer {
    position: absolute;
    bottom: 18px;
    margin-bottom: 0;
    width: 100%;
  }

  #contentType {
    position: absolute;
    bottom: 10px;
    left: 13px;
    font-size: 11px;
    color: #bbb;
  }

  paper-icon-button {
    margin-bottom: -6px;
    padding-bottom: 0;
  }

  .imageCollapsed {
    height: 0px;
    overflow: hidden;
    transition: height 0.5s;
    -moz-transition: height 0.5s;
    -webkit-transition: height 0.5s;
    -o-transition: height 0.5s;
  }

  .fullsizeDescription {
    height: 100%;
  }

  .mainNavigator {
    height: 6px;
    max-height: 6px !important;
    margin: 8px;
    padding: 0;
    padding-top: 16px;
    width: 100%;
    vertical-align: bottom;
  }

  #moduleContentType {
    font-weight: 900;
    padding-right: 4px;
  }

  .mainNavigator.div {
    float: right;
  }

  .typeButtons {
    background-color: #FFF;
    color: #000;
    border: 1px solid #FFF;
    text-align: center;
    margin: 8px;
    font-size: 16px;
    width: 105px;
  }

  .moduleSelectionTitle {
    margin-top: 16px;
    font-size: 18px;
    font-weight: bold;
  }

  .winInfo {
    font-style: italic;
    font-size: 10px;
    margin-top: -3px;
    width: 105px;
    margin-left: 8px;
    text-align: center;
  }

  .actionButtonContainer {
    width: 100%;
    margin-top: 0px;
    text-align: center;
  }

  .actionButtonInnerContainer {
    text-align: center;
    margin-left: 42px;
  }

  .exclusiveCardTitle {
    margin-left: 0px;
    margin-right: 6px;
    padding: 3px;
    padding-left: 8px;
    font-size: 9px;
    margin-bottom: 4px;
    margin-top: 4px;
    color: #FFF;
    font-size: 14px;
  }

  .subHeader {
    position: absolute;
    bottom: 4px;
    left: 50%;
    border-radius: 6px;
    padding: 3px;
    transform: translateX(-50%);
    margin-left: auto;
    margin-right: auto;
    font-size: 16px;
    background-color: rgba(255, 255, 255, 0.9);
    color: #333;
  }

  .subHeader[module-type] {
    display: none;
  }

  [hidden] {
    display: none !important;
  }
/*----- Stacked Cards component css END -----*/
`;var oapSwipableCardsStyles={OapSwipableCardsStyles:OapSwipableCardsStyles};const template$e=html`<iron-iconset-svg size="24" name="icons">
  <svg><defs>
    <g id="chat-bubble-outline"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"></path></g>
    <g id="mode-edit"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></g>
    <g id="keyboard-arrow-down"><path d="M7.41 7.84L12 12.42l4.59-4.58L18 9.25l-6 6-6-6z"></path></g>
    <g id="keyboard-arrow-up"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></g>
    <g id="add"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></g>
    <g id="arrow-downward"><path d="M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"></path></g>
    <g id="arrow-upward"><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"></path></g>
    <g id="closeExit"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></g>
    <g id="description"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"></path></g>
    <g id="favorite"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path></g>
    <g id="favorite-border"><path d="M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"></path></g>
    <g id="help-outline"><path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"></path></g>
    <g id="info"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"></path></g>
    <g id="info-outline"><path d="M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z"></path></g>
    <g id="menu"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></g>
    <g id="remove"><path d="M19 13H5v-2h14v2z"></path></g>
    <g id="thumb-down"><path d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v1.91l.01.01L1 14c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z"></path></g>
    <g id="thumb-up"><path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-1.91l-.01-.01L23 10z"></path></g>
    <g id="verified-user"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"></path></g>
    <g id="photo"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"></path></g>
    <g id="picture-as-pdf"><path d="M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5v1zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5v3zm4-3H19v1h1.5V11H19v2h-1.5V7h3v1.5zM9 9.5h1v-1H9v1zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm10 5.5h1v-3h-1v3z"></path></g>
    <g id="place"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"></path></g>
    <g id="do-not-disturb"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8 0-1.85.63-3.55 1.69-4.9L16.9 18.31C15.55 19.37 13.85 20 12 20zm6.31-3.1L7.1 5.69C8.45 4.63 10.15 4 12 4c4.42 0 8 3.58 8 8 0 1.85-.63 3.55-1.69 4.9z"></path></g>
    <g id="star"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></g>
    <g id="star-border"><path d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"></path></g>
    <g id="keyboard-arrow-down"><path d="M7.41 7.84L12 12.42l4.59-4.58L18 9.25l-6 6-6-6z"></path></g>
    <g id="keyboard-arrow-up"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></g>
      </defs></svg>
</iron-iconset-svg>`;document.head.appendChild(template$e.content);const BONUS_FOR_HIGH=8,BONUS_FOR_MEDIUM=5,BONUS_FOR_LOW=2,PENALTY_FOR_HIGH=8,PENALTY_FOR_MEDIUM=5,PENALTY_FOR_LOW=2,runningBonusPenaltyInfo={allBonuses:[],allBonusesByCulturalAttitute:{},sumBonusesByCulturalAttitute:{},allBonusesByLevel:{},allPenalties:[],allPenaltiesByCulturalAttitute:{},sumPenaltiesByCulturalAttitute:{},allPenaltiesByLevel:{},totalBonuses:0,totalPenalties:0,totalBonusesCount:0,totalPenaltiesCount:0},saveItemForReview=(e,t,i,r)=>{t.push(e),"bonus"==e.type?i.push(e):r.push(e)},saveItemToObject=(e,t)=>{"bonus"==t.type?(e.totalBonusesCount+=1,e.totalBonuses+=t.value,e.allBonuses.push(t),e.allBonusesByCulturalAttitute[t.attitute]||(e.allBonusesByCulturalAttitute[t.attitute]=[]),e.sumBonusesByCulturalAttitute[t.attitute]||(e.sumBonusesByCulturalAttitute[t.attitute]=0),e.allBonusesByCulturalAttitute[t.attitute].push(t),e.sumBonusesByCulturalAttitute[t.attitute]+=t.value,e.allBonusesByLevel[t.level]||(e.allBonusesByLevel[t.level]=[]),e.allBonusesByLevel[t.level].push(t)):(e.totalPenaltiesCount+=1,e.totalPenalties+=t.value,e.allPenalties.push(t),e.allPenaltiesByCulturalAttitute[t.attitute]||(e.allPenaltiesByCulturalAttitute[t.attitute]=[]),e.sumPenaltiesByCulturalAttitute[t.attitute]||(e.sumPenaltiesByCulturalAttitute[t.attitute]=[]),e.allPenaltiesByCulturalAttitute[t.attitute].push(t),e.sumPenaltiesByCulturalAttitute[t.attitute]+=t.value,e.allPenaltiesByLevel[t.level]||(e.allPenaltiesByLevel[t.level]=[]),e.allPenaltiesByLevel[t.level].push(t))},attitutes=["lawAndOrder","progressivism","authority","science","collective","privacy","liberty","tradition","independence"],analyseBonusPenaltiesForAttitutes=e=>{const t={};let i="";return attitutes.forEach(r=>{let n,a=0;const o=e.sumBonusesByCulturalAttitute[r]?e.sumBonusesByCulturalAttitute[r]:0,s=e.sumPenaltiesByCulturalAttitute[r]?e.sumPenaltiesByCulturalAttitute[r]:0;o||s?(n=0>(a=o-s)?"highPenalty":"highBonus",10>=Math.abs(a)&&(n="breakEven")):n="breakEven",t[r]=n,i+="Bonus/Penalty test: "+r+" - bonuses: "+o+"\n",i+="Bonus/Penalty test: "+r+" - penalties: "+s+"\n",i+="Bonus/Penalty test: "+r+" - profitLoss: "+a+"\n",i+="Bonus/Penalty test: "+r+" - verdict: "+n+"\n"}),t.debugText=i,t},GetCompletionScoreByModuleType=(e,t)=>{const i={};let r=0,n=0;return e.forEach(e=>{"ModuleTypeCard"==e.module_type?i[e.module_type_index]={name:e.name,status:"weak",totalCount:0,counted:0,completedPercent:0}:e.authorshipPercent&&(i[e.module_type_index].totalCount+=parseInt(e.authorshipPercent),r+=parseInt(e.authorshipPercent))}),t.forEach(e=>{e.authorshipPercent&&(i[e.module_type_index].counted+=parseInt(e.authorshipPercent),i[e.module_type_index].completedPercent=i[e.module_type_index].counted/i[e.module_type_index].totalCount,15<=i[e.module_type_index].counted&&(i[e.module_type_index].status="viable"),n+=parseInt(e.authorshipPercent))}),i},GetResultsForReview=(e,t,i,r,n)=>{const a={};let o;const s={allBonuses:[],allBonusesByCulturalAttitute:{},sumBonusesByCulturalAttitute:{},allBonusesByLevel:{},allPenalties:[],allPenaltiesByCulturalAttitute:{},sumPenaltiesByCulturalAttitute:{},allPenaltiesByLevel:{},totalBonuses:0,totalPenalties:0,totalBonusesCount:0,totalPenaltiesCount:0};e.forEach(e=>{GetBonusesAndPenaltiesForItem(e,i).bonusesAndPenalties.forEach(e=>{saveItemToObject(s,e)})}),console.log("bonusPenaltyInfo"),console.log(s),console.log("runningBonusPenaltyInfo"),console.log(runningBonusPenaltyInfo);const l=analyseBonusPenaltiesForAttitutes(s);let c=l.debugText;attitutes.forEach(e=>{let t;t=6<i.culturalAttitutes[e]?"high":2<i.culturalAttitutes[e]?"medium":"low",a[e]=r[e][l[e]][t]});const h=s.totalBonuses-s.totalPenalties;let u;u=0>h?"highNetPenalties":"highNetBonuses",15>=Math.abs(h)&&(u="breakEven");const d=GetCompletionScoreByModuleType(t,e);let p=!0,m=0;return Object.keys(d).forEach(e=>{"weak"==d[e].status&&(p=!1,m+=1)}),p||(1<m?u="highNetPenalties":"highNetBonuses"==u&&(u="breakEven")),c+="Total bonsues: "+s.totalBonuses+"\n",c+="Total penalties: "+s.totalPenalties+"\n",c+="Total verdict: "+u+"\n",i.reviews&&(o=i.reviews[u]),{attituteReviewParagraphs:a,countryReviewParagraph:o,completionScore:d,isConstitutionViable:p,debugText:c}},fixupRules=e=>e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.toLowerCase()).replace(/\n/g,"")).trim()).replace("law/order","lawAndOrder")).replace("law and order","lawAndOrder")).replace("law & order","lawAndOrder")).replace("progressivisim","progressivism")).replace("progrevissim","progressivism")).replace("social progress","progressivism")).replace("sovreignty","independence")).replace("collectivism","collective"),GetBonusesAndPenaltiesForItem=(e,t)=>{let i=[],r=[],n=[],a=0,o=0,s=e.bonus?e.bonus.split(","):[];s=s.map(e=>(e=fixupRules(e),console.info("BONUES:"+e),e));let l=e.penalty?e.penalty.split(","):[];return l=l.map(e=>(e=fixupRules(e),console.info("PENALTY:"+e),e.toLowerCase().replace("law/order","lawAndOrder").replace("law and order","lawAndOrder").replace("social progress","progressivism").replace("collectivism","collective").replace("\n",""))),s.forEach(o=>{const s=o.split(" "),l=s[0],c=s[1];if(console.error("attitute:"+c+" nr: "+t.culturalAttitutes[c]+" level: "+l),t.culturalAttitutes[c]){if("bonus"===l);else if("high"===l){if(7<=t.culturalAttitutes[c]){const t={id:e.id,type:"bonus",value:8,attitute:c,level:l};saveItemForReview(t,i,r,n),a+=1}}else if("medium"===l){if(3<=t.culturalAttitutes[c]&&7>t.culturalAttitutes[c]){const t={id:e.id,type:"bonus",value:5,attitute:c,level:l};saveItemForReview(t,i,r,n),a+=1}}else if("low"===l&&0<=t.culturalAttitutes[c]&&3>t.culturalAttitutes[c]){const t={id:e.id,type:"bonus",value:2,attitute:c,level:l};saveItemForReview(t,i,r,n),a+=1}}else console.warn("Can't find attitute for: "+c)}),l.forEach(a=>{const s=a.split(" "),l=s[0],c=s[1];if("bonus"===l)console.error("Wrong level");else if("high"===l){if(7<=t.culturalAttitutes[c]){const t={id:e.id,type:"penalty",value:8,attitute:c,level:l};saveItemForReview(t,i,r,n),o+=1}}else if("medium"===l){if(3<=t.culturalAttitutes[c]&&7>t.culturalAttitutes[c]){const t={id:e.id,type:"penalty",value:5,attitute:c,level:l};saveItemForReview(t,i,r,n),o+=1}}else if("low"===l&&0<=t.culturalAttitutes[c]&&3>t.culturalAttitutes[c]){const t={id:e.id,type:"penalty",value:2,attitute:c,level:l};saveItemForReview(t,i,r,n),o+=1}}),{bonusesAndPenalties:i,bonusCount:a,penaltyCount:o,bonuses:r,penalties:n}},GetEmojiFromAttitute=e=>{return{authority:"",liberty:"",science:"",tradition:"",collective:"",independence:"",privacy:"",lawAndOrder:"",progressivism:"",naturalResourceWealth:"",borderDensity:"",hostilityNeighboringCountries:"",barrieresToCitizenship:""}[e]};var oapBonusesAndPenalties={GetCompletionScoreByModuleType:GetCompletionScoreByModuleType,GetResultsForReview:GetResultsForReview,fixupRules:fixupRules,GetBonusesAndPenaltiesForItem:GetBonusesAndPenaltiesForItem,GetEmojiFromAttitute:GetEmojiFromAttitute};class OapSwipableCards extends OapBaseElement{static get properties(){return{stackedOptions:String,rotate:Boolean,items:Array,selectedItems:Array,filteredItems:Array,itemsLeft:Array,visibleItems:Array,elementsMargin:Number,useOverlays:Boolean,maxElements:Number,currentPosition:Number,currentItemsPosition:Number,currentItem:Object,isFirstTime:Boolean,elementHeight:Number,velocity:Number,topObj:Object,rightObj:Object,leftObj:Object,listElNodesObj:Object,listElNodesWidth:Object,currentElementObj:Object,stackedCardsObj:Object,obj:Object,elTrans:Object,startTime:Number,startX:Number,startY:Number,translateX:Number,translateY:Number,currentX:Number,currentY:Number,timeTaken:Number,rightOpacity:Number,leftOpacity:Number,touchingElement:Boolean,disableUpSwipe:Boolean,hiddenImageIds:Object,rendering:Boolean,configFromServer:Object,automaticSelectionActive:Boolean,country:Object,autoSliderTime:String,automaticFlipSpeed:Number}}static get styles(){return[OapSwipableCardsStyles,OapFlexLayout]}render(){return html$1`
      <div class="toppestContainer">
        <div class="stage">
          <div id="stacked-cards-block" class="stackedcards stackedcards--animatable init">
            <div class="stackedcards-container">
              ${repeat(this.visibleItems,e=>e.id,(e,t)=>html$1`
                  <div class="card" id="card${e.id}" style="${this.getCardStyle(e)}">
                    <div class="card-content">
                      <div id="imageContainer${e.id}" ?hidden="${"ModuleTypeCard"==e.module_type}" class="card-imagse"><img id="image${e.id}" class="cardImage" src="${e.image_url}"/></div>
                      ${this.isExclusive(e)?html$1`
                          <div class="exclusiveCardTitle" style="${this.getExclusiveStyle(e)}">${e.name.split(":")[0]} ${this.exclusiveNumberOf(e)}</div>
                          `:html$1``}
                      <div class="cardTitles" ?module-type="${"ModuleTypeCard"==e.module_type}">
                        <div class="moduleName name"
                          title="${e.module_content_type}"
                          ?module-type="${"ModuleTypeCard"==e.module_type}"
                          ?is-exclusive="${this.isExclusive(e)}">
                            ${this.isExclusive(e)?e.name.split(":")[1]:e.name}
                          </div>
                        <div class="subHeader layout horizontal" ?module-type="${"ModuleTypeCard"==e.module_type}" style="${this.getSubCategoryStyle(e)}">
                         ${this.getBonusesAndPenalties(e)}
                        </div>
                        <div id="description${e.id}" ?exlusive="${this.isExclusive(e)}" class="description" ?module-type="${"ModuleTypeCard"==e.module_type}">${unsafeHTML(e.description)}</div>
                           ${280<e.description.length?html$1`
                            <div class="hideUnhideContainer">
                              <div class="innerHideContainer">
                                ${1==this.isImageHidden(e.id)?html$1`
                                  <paper-icon-button @click="${()=>{this.unhideImage(e.id)}}" icon="keyboard-arrow-down"></paper-icon-button>
                                `:html$1`
                                  <paper-icon-button @click="${()=>{this.hideImage(e.id)}}" icon="keyboard-arrow-up"></paper-icon-button>
                                `}
                              </div>
                            </div>
                          `:html$1``}
                      </div>
                    ${"ModuleTypeCard"===e.module_type?html$1`
                      <div style="text-align:center" class="global-asctions vertical center-center actionButtonContainer">
                        <div class="moduleSelectionTitle">${this.localize("moduleSelection")}</div>
                        <div class="layout  horizontal actionButtonInnerContainer">
                          <div class="right-actionx vertical">
                            <paper-button id="manualSelectionButton" class="typeButtons" @click="${this.startManualSelection}">${this.localize("manualSelection")}</paper-button>
                            <div class="winInfo">${this.localize("win")} 10 ${this.localize("points")}</div>
                          </div>
                          <div class="left-actionx vertical">
                            <paper-button id="autoSelectionButton" class="typeButtons" @click="${this.startAutoSelection}">${this.localize("allCardSelection")}</paper-button>
                            <div class="winInfo">${this.localize("winAllCards")}</div>
                          </div>
                        </div>
                      </div>
                      `:html$1``}
                    </div>
                  </div>
                `)}
            </div>
            <div class="stackedcards--animatable stackedcards-overlay top"><img src="https://image.ibb.co/m1ykYS/rank_army_star_2_3x.png"  width="auto" height="auto"/></div>
            <div class="stackedcards--animatable stackedcards-overlay right"><img src="https://image.ibb.co/m1ykYS/rank_army_star_2_3x.png" width="100" height="100"/></div>
            <div class="stackedcards--animatable stackedcards-overlay left"><img src="https://image.ibb.co/heTxf7/20_status_close_3x.png" width="auto" height="auto"/></div>
          </div>
          <div id="navigator" class="mainNavigator layout horizontal"></div>
          <paper-slider hidden
              class="speedSlider" ?auto="${this.automaticSelectionActive}" @value-changed="${e=>{this.changeSpeed(e)}}"
              .value="${this.speedSettings}"
              max="10">
          </paper-slider>
          <div class="speedSliderInfo" hidden ?auto="${this.automaticSelectionActive}">${this.autoSliderTime}</div>
          <div class="global-actions" style="margin-top: 0px;" ?hidden="${!0===this.automaticSelectionActive||this.currentItem&&"ModuleTypeCard"===this.currentItem.module_type}">
            <div class="left-action"><img src="https://image.ibb.co/heTxf7/20_status_close_3x.png" width="26" height="26"/>
            </div>
            <div hidden>
              <div ?hidden="${this.disableUpSwipe}" class="top-action"><img src="https://image.ibb.co/m1ykYS/rank_army_star_2_3x.png" width="18" height="16"/>
              </div>
            </div>
            <div style="width: 100px;">
              </div>
            <div class="right-action"><img src="https://image.ibb.co/m1ykYS/rank_army_star_2_3x.png" width="30" height="28"/></div>
          </div>
        </div>
        <div class="final-state hidden"><h2>${this.localize("filterArticlesDone")}</h2></div>
      </div>
    `}constructor(){super(),this.reset()}isExclusive(e){return e.exclusive_ids&&""!=e.exclusive_ids}getBonusPlurar(e){return 1<e.length?this.localize("bonuses"):this.localize("bonus")}getPenaltyPlurar(e){return 1<e.length?this.localize("penalties"):this.localize("penalty")}getBonusesAndPenalties(e){let t=GetBonusesAndPenaltiesForItem(e,this.country).bonusesAndPenalties,i=[],r=[],n=!1,a=!1;if(!(0<t.length))return"";{t.forEach(e=>{if("bonus"===e.type){let t=GetEmojiFromAttitute(e.attitute);-1<!i.indexOf(t)&&(i.push({emoji:t,title:this.localize(e.attitute)}),n=!0)}else if("penalty"===e.type){let t=GetEmojiFromAttitute(e.attitute);-1<!r.indexOf(t)&&(r.push({emoji:t,title:this.localize(e.attitute)}),a=!0)}});let e,o=html$1``;if(n&&(o=html$1`${i.map(e=>html$1`<div style="margin-left: 5px;" title="${e.title}">${e.emoji}</div>`)}`),a&&(e=html$1`${r.map(e=>html$1`<div style="margin-left: 5px;" title="${e.title}">${e.emoji}</div>`)}`),n&&a)return html$1`<div style="">${this.getBonusPlurar(i)} </div>${o}
          <div class="flex"></div> <div style="margin-left: 16px;">${this.getPenaltyPlurar(r)} </div>${e}`;if(n)return html$1`<div style="">${this.getBonusPlurar(i)} </div>${o}`;if(a)return html$1`<div style="">${this.getPenaltyPlurar(r)} </div>${e}`;console.error("Wrong state of penalties")}}exclusiveNumberOf(e){const t=e.exclusive_ids.split(",");let i;return t.forEach((t,r)=>{e.id==t&&(i=r+1)}),i+" "+this.localize("of")+" "+t.length}changeSpeed(e){null!==e.detail.value&&(this.automaticFlipSpeed=this.speedLookup[e.detail.value],console.log("Set flip speed: "+this.automaticFlipSpeed))}disconnectedCallback(){this.removeEventListeners(),super.disconnectedCallback()}getCardStyle(e){if("ModuleTypeCard"===e.module_type){return"color: #FFF;font-size: 20px;background-color:"+this.configFromServer.client_config.moduleTypeColorLookup[e.module_content_type]}return""}getExclusiveStyle(e){return"color: #FFF;background-color:"+this.configFromServer.client_config.moduleTypeColorLookup[e.module_content_type]}getSubCategoryStyle(e){return""}startAutomaticSelection(){this.automaticallySelectNext(),this.removeEventListeners()}startManualSelection(){this.$$("#manualSelectionButton").disabled=!0,this.fire("oap-bonus-points",10),this.onActionTop(!0),this.addEventListeners(),setTimeout(()=>{this.$$("#manualSelectionButton")&&(this.$$("#manualSelectionButton").disabled=!1)},750)}startAutoSelection(){this.$$("#autoSelectionButton").disabled=!0,setTimeout(()=>{this.$$("#autoSelectionButton")&&(this.$$("#autoSelectionButton").disabled=!1)},750),this.automaticallySelectNext()}automaticallySelectNext(){let e,t;if(this.currentItemsPosition<this.items.length-1&&(e=this.items[this.currentItemsPosition].module_type,t="ModuleTypeCard"===this.items[this.currentItemsPosition].module_type),t&&!this.automaticSelectionActive||this.items[this.currentItemsPosition]&&"ModuleTypeCard"!==e){this.automaticSelectionActive=!0;Math.floor(2*Math.random());GetBonusesAndPenaltiesForItem(this.items[this.currentItemsPosition],this.country).bonusCount;t?this.onActionTop(!0):this.onActionRight(),setTimeout(()=>{this.automaticallySelectNext()},this.automaticFlipSpeed)}else this.automaticSelectionActive=!1}updated(e){super.updated(e),e.has("automaticFlipSpeed")&&(this.autoSliderTime="Swipe speed "+this.automaticFlipSpeed/1e3+" seconds"),e.has("currentItem")&&this.currentItem&&"ModuleTypeCard"===this.currentItem.module_type&&this.removeEventListeners(),e.has("items")&&this.items&&0<this.items.length&&(0===this.currentItemsPosition&&(this.currentItem=this.items[0]),this.itemsLeft=[...this.items],(this.selectedItems&&0<this.selectedItems.length||this.filteredItems&&0<this.filteredItems.length)&&(this.itemsLeft=this.itemsLeft.filter(e=>{let t=!0;return this.selectedItems&&-1<this.selectedItems.indexOf(e)&&(t=!1),this.filteredItems&&-1<this.filteredItems.indexOf(e)&&(t=!1),t})),window.debugOn&&(this.itemsLeft=[...this.items]),this.fire("item-selected",this.items[0]),this.visibleItems=this.itemsLeft.slice(0,5),this.itemsLeft.shift(),this.itemsLeft.shift(),this.itemsLeft.shift(),this.itemsLeft.shift(),this.itemsLeft.shift(),this.requestUpdate(),this.updateComplete.then(()=>{this.activate(),this.updateNavigator()}))}updateNavigator(){this.configFromServer.client_config.moduleTypeColorLookup[this.items[this.currentItemsPosition].module_content_type];if(this.$$("#navigator")){const e=this.$$("#navigator");for(;e.firstChild;)e.removeChild(e.firstChild);let t;t=0<this.itemsLeft.length?this.visibleItems.concat(this.itemsLeft):this.visibleItems.slice(1,Math.abs(6-this.currentPosition));const i=310/this.items.length;t.forEach((t,r)=>{const n=document.createElement("span");n.style.backgroundColor=this.configFromServer.client_config.moduleTypeColorLookup[t.module_content_type],0===r?(n.style.width=i+5+"px",n.style.height="8px",n.title=t.name):(n.style.width=i+"px",n.style.height="8px",n.title=t.module_content_type),n.onclick=(e=>{}),e.appendChild(n)})}else console.error("No module name in updateNavigator")}reset(){this.stackedOptions="Top",this.rotate=!0,this.elementsMargin=7,this.currentPosition=0,this.currentItemsPosition=0,this.currentItem=null,this.useOverlays=!1,this.velocity=.3,this.isFirstTime=!0,this.touchingElement=!1,this.visibleItems=[],this.disableUpSwipe=!0,this.hiddenImageIds={},this.rendering=!0,this.automaticSelectionActive=!1,this.speedLookup={0:15e3,1:12500,2:10500,3:7500,4:5500,5:3500,6:2e3,7:1200,8:900,9:500,10:310},this.automaticFlipSpeed=310,this.speedSettings=10}activate(){this.obj=this.$$("#stacked-cards-block"),this.refresh(),this.useOverlays?(this.leftObj.style.transform="translateX(0px) translateY("+this.elTrans+"px) translateZ(0px) rotate(0deg)",this.leftObj.style.webkitTransform="translateX(0px) translateY("+this.elTrans+"px) translateZ(0px) rotate(0deg)",this.rightObj.style.transform="translateX(0px) translateY("+this.elTrans+"px) translateZ(0px) rotate(0deg)",this.rightObj.style.webkitTransform="translateX(0px) translateY("+this.elTrans+"px) translateZ(0px) rotate(0deg)",this.topObj.style.transform="translateX(0px) translateY("+this.elTrans+"px) translateZ(0px) rotate(0deg)",this.topObj.style.webkitTransform="translateX(0px) translateY("+this.elTrans+"px) translateZ(0px) rotate(0deg)"):this.leftObj&&(this.leftObj.className="",this.rightObj.className="",this.topObj.className="",this.leftObj.classList.add("stackedcards-overlay-hidden"),this.rightObj.classList.add("stackedcards-overlay-hidden"),this.topObj.classList.add("stackedcards-overlay-hidden")),setTimeout(function(){this.obj.classList.remove("init")}.bind(this),250)}isImageHidden(e){return null!=this.hiddenImageIds[e]}hideImage(e){const t=this.$$("#image"+e);if(t){t.classList.add("imageCollapsed"),this.hiddenImageIds[e]=!0,this.$$("#description"+e).classList.add("fullsizeDescription"),this.requestUpdate()}}unhideImage(e){const t=this.$$("#image"+e);if(t){t.classList.remove("imageCollapsed"),this.hiddenImageIds[e]=null,this.$$("#description"+e).classList.remove("fullsizeDescription"),this.requestUpdate()}}refresh(){this.stackedCardsObj=this.obj.querySelector(".stackedcards-container"),this.listElNodesObj=this.stackedCardsObj.children,this.topObj=this.obj.querySelector(".stackedcards-overlay.top"),this.rightObj=this.obj.querySelector(".stackedcards-overlay.right"),this.leftObj=this.obj.querySelector(".stackedcards-overlay.left"),this.countElements(),this.setCurrentElement(),this.changeBackground(),this.listElNodesWidth=this.stackedCardsObj.offsetWidth,this.currentElementObj=this.listElNodesObj[0],this.updateUi();var e,t=this.elementsMargin*(this.visibleItems.length-1)+"px";if("Top"===this.stackedOptions){for(e=this.visibleItems.length;e<this.maxElements;e++)this.listElNodesObj[e].classList.add("stackedcards-top","stackedcards--animatable","stackedcards-origin-top");this.elTrans=this.elementsMargin*(this.visibleItems.length-1),this.stackedCardsObj.style.marginBottom=t}else if("Bottom"===this.stackedOptions){for(e=this.visibleItems.length;e<this.maxElements;e++)this.listElNodesObj[e].classList.add("stackedcards-bottom","stackedcards--animatable","stackedcards-origin-bottom");this.elTrans=0,this.stackedCardsObj.style.marginBottom=t}else if("None"===this.stackedOptions){for(e=this.visibleItems.length;e<this.maxElements;e++)this.listElNodesObj[e].classList.add("stackedcards-none","stackedcards--animatable");this.elTrans=0}for(e=this.visibleItems.length;e<this.maxElements;e++)this.listElNodesObj[e].style.zIndex=0,this.listElNodesObj[e].style.opacity=0,this.listElNodesObj[e].style.webkitTransform="scale("+(1-.04*this.visibleItems.length)+") translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.listElNodesObj[e].style.transform="scale("+(1-.04*this.visibleItems.length)+") translateX(0) translateY("+this.elTrans+"px) translateZ(0)";this.listElNodesObj[this.currentPosition]&&this.listElNodesObj[this.currentPosition].classList.add("stackedcards-active"),setTimeout(function(){this.obj.classList.remove("init")}.bind(this),250)}addEventListeners(){this.gestureStartHandler=this.gestureStart.bind(this),this.gestureMoveHandler=this.gestureMove.bind(this),this.gestureEndHandler=this.gestureEnd.bind(this),this.$$("#stacked-cards-block").addEventListener("touchstart",this.gestureStartHandler,{passive:!0}),this.$$("#stacked-cards-block").addEventListener("touchmove",this.gestureMoveHandler,{passive:!0}),this.$$("#stacked-cards-block").addEventListener("touchend",this.gestureEndHandler,{passive:!0});var e=this.$$(".left-action"),t=this.$$(".top-action"),i=this.$$(".right-action");e.addEventListener("click",this.onActionLeft.bind(this),!1),this.disableUpSwipe||t.addEventListener("click",this.onActionTop.bind(this),!1),i.addEventListener("click",this.onActionRight.bind(this),!1)}removeEventListeners(){this.gestureStartHandler&&(this.$$("#stacked-cards-block").removeEventListener("touchstart",this.gestureStartHandler,{passive:!0}),this.$$("#stacked-cards-block").removeEventListener("touchmove",this.gestureMoveHandler,{passive:!0}),this.$$("#stacked-cards-block").removeEventListener("touchend",this.gestureEndHandler,{passive:!0}),this.gestureStartHandler=null,this.gestureMoveHandler=null,this.gestureEndHandler=null,console.error("Remove eventlisteners DONE"));var e=this.$$(".left-action"),t=this.$$(".top-action"),i=this.$$(".right-action");e?(e.removeEventListener("click",this.onActionLeft.bind(this),!1),this.disableUpSwipe||t.removeEventListener("click",this.onActionTop.bind(this),!1),i.removeEventListener("click",this.onActionRight.bind(this),!1)):console.error("No buttons to detach from")}backToMiddle(){this.removeNoTransition(),this.transformUi(0,0,1,this.currentElementObj),this.useOverlays&&(this.transformUi(0,0,0,this.leftObj),this.transformUi(0,0,0,this.rightObj),this.transformUi(0,0,0,this.topObj)),this.setZindex(5),this.currentPosition>=this.maxElements||this.currentPosition+1<this.maxElements&&(this.listElNodesObj[this.currentPosition+1].style.opacity=".8")}countElements(){this.maxElements=this.listElNodesObj.length,this.visibleItems.length>this.maxElements&&(this.visibleItems.length=this.maxElements)}setCurrentElement(){this.currentElementObj=this.listElNodesObj[this.currentPosition]}changeBackground(){this.classList.add("background-"+this.currentPosition)}changeStages(){this.currentPosition==this.maxElements&&(this.fire("completed"),this.listElNodesObj[this.maxElements-1].addEventListener("transitionend",function(){this.classList.add("background-7"),this.$$(".stage").classList.add("hidden"),this.$$(".final-state").classList.remove("hidden"),this.$$(".final-state").classList.add("active"),this.listElNodesObj[this.maxElements-1].removeEventListener("transitionend",null,!1)}.bind(this)))}onActionLeft(){this.temporaryDisableLeft||(this.currentPosition>=this.maxElements||(this.useOverlays&&(this.leftObj.classList.remove("no-transition"),this.topObj.classList.remove("no-transition"),this.leftObj.style.zIndex="8",this.transformUi(0,0,1,this.leftObj)),setTimeout(function(){this.onSwipeLeft(),this.resetOverlayLeft()}.bind(this),300)),this.temporaryDisableLeft=!0,setTimeout(()=>{this.temporaryDisableLeft=!1},310))}onActionRight(){this.temporaryDisableRight||(this.currentPosition>=this.maxElements||(this.useOverlays&&(this.rightObj.classList.remove("no-transition"),this.topObj.classList.remove("no-transition"),this.rightObj.style.zIndex="8",this.transformUi(0,0,1,this.rightObj)),setTimeout(function(){this.onSwipeRight(),this.resetOverlayRight()}.bind(this),300)),this.temporaryDisableRight=!0,setTimeout(()=>{this.temporaryDisableRight=!1},310))}onActionTop(e){this.currentPosition>=this.maxElements||(this.useOverlays&&(this.leftObj.classList.remove("no-transition"),this.rightObj.classList.remove("no-transition"),this.topObj.classList.remove("no-transition"),this.topObj.style.zIndex="8",this.transformUi(0,0,1,this.topObj)),setTimeout(function(){this.onSwipeTop(e),this.resetOverlays()}.bind(this),300))}onSwipeLeft(){this.removeNoTransition(),this.transformUi(-1e3,0,0,this.currentElementObj),this.useOverlays&&(this.transformUi(-1e3,0,0,this.leftObj),this.transformUi(-1e3,0,0,this.topObj),this.resetOverlayLeft()),this.fire("item-discarded",this.items[this.currentItemsPosition]),this.currentPosition=this.currentPosition+1,this.currentItemsPosition=this.currentItemsPosition+1,this.currentItem=this.items[this.currentItemsPosition],this.updateFromMainItemsList(),this.activity("swipeLeft","filtering")}updateFromMainItemsList(){this.updateUi(),this.setCurrentElement(),this.changeBackground(),this.changeStages(),this.setActiveHidden(),setTimeout(()=>{this.requestUpdate(),this.updateComplete.then(()=>{0<this.itemsLeft.length&&(this.visibleItems.push(this.itemsLeft.shift()),this.visibleItems.shift(),this.currentPosition=0,this.requestUpdate(),this.updateComplete.then(()=>{"ModuleTypeCard"==this.visibleItems[this.currentPosition].module_type&&this.fire("item-selected",this.visibleItems[0]),this.refresh(),this.updateNavigator(),this.requestUpdate()}))})},300)}firstUpdated(){super.firstUpdated()}onSwipeRight(){this.removeNoTransition(),this.transformUi(1e3,0,0,this.currentElementObj),this.useOverlays&&(this.transformUi(1e3,0,0,this.rightObj),this.transformUi(1e3,0,0,this.topObj),this.resetOverlayRight()),this.fire("item-selected",this.items[this.currentItemsPosition]),this.currentPosition=this.currentPosition+1,this.currentItemsPosition=this.currentItemsPosition+1,this.currentItem=this.items[this.currentItemsPosition],this.updateUi(),this.setCurrentElement(),this.updateFromMainItemsList(),this.activity("swipeRight","filtering")}onSwipeTop(e){this.disableUpSwipe&&!e||(this.removeNoTransition(),this.transformUi(0,-1e3,0,this.currentElementObj),this.useOverlays&&(this.transformUi(0,-1e3,0,this.leftObj),this.transformUi(0,-1e3,0,this.rightObj),this.transformUi(0,-1e3,0,this.topObj),this.resetOverlays()),this.fire("item-bookmarked",this.items[this.currentItemsPosition]),this.currentPosition=this.currentPosition+1,this.currentItemsPosition=this.currentItemsPosition+1,this.currentItem=this.items[this.currentItemsPosition],this.updateUi(),this.setCurrentElement(),this.updateFromMainItemsList(),this.activity("swipeUp","filtering"))}removeNoTransition(){this.listElNodesObj[this.currentPosition]&&(this.useOverlays&&(this.leftObj.classList.remove("no-transition"),this.rightObj.classList.remove("no-transition"),this.topObj.classList.remove("no-transition")),this.listElNodesObj[this.currentPosition].classList.remove("no-transition"),this.listElNodesObj[this.currentPosition].style.zIndex=6)}resetOverlayLeft(){this.currentPosition>=this.maxElements||this.useOverlays&&(setTimeout(function(){"Top"===this.stackedOptions?this.elTrans=this.elementsMargin*(this.visibleItems.length-1):"Bottom"!==this.stackedOptions&&"None"!==this.stackedOptions||(this.elTrans=0),this.isFirstTime||(this.leftObj.classList.add("no-transition"),this.topObj.classList.add("no-transition")),requestAnimationFrame(function(){this.leftObj.style.transform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.leftObj.style.webkitTransform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.leftObj.style.opacity="0",this.topObj.style.transform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.topObj.style.webkitTransform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.topObj.style.opacity="0"}.bind(this))}.bind(this),300),this.isFirstTime=!1)}resetOverlayRight(){this.currentPosition>=this.maxElements||this.useOverlays&&(setTimeout(function(){"Top"===this.stackedOptions?this.elTrans=this.elementsMargin*(this.visibleItems.length-1):"Bottom"!==this.stackedOptions&&"None"!==this.stackedOptions||(this.elTrans=0),this.isFirstTime||(this.rightObj.classList.add("no-transition"),this.topObj.classList.add("no-transition")),requestAnimationFrame(function(){this.rightObj.style.transform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.rightObj.style.webkitTransform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.rightObj.style.opacity="0",this.topObj.style.transform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.topObj.style.webkitTransform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.topObj.style.opacity="0"}.bind(this))}.bind(this),300),this.isFirstTime=!1)}resetOverlays(){this.currentPosition>=this.maxElements||this.useOverlays&&(setTimeout(function(){"Top"===this.stackedOptions?this.elTrans=this.elementsMargin*(this.visibleItems.length-1):"Bottom"!==this.stackedOptions&&"None"!==this.stackedOptions||(this.elTrans=0),this.isFirstTime||(this.leftObj.classList.add("no-transition"),this.rightObj.classList.add("no-transition"),this.topObj.classList.add("no-transition")),requestAnimationFrame(function(){this.leftObj.style.transform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.leftObj.style.webkitTransform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.leftObj.style.opacity="0",this.rightObj.style.transform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.rightObj.style.webkitTransform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.rightObj.style.opacity="0",this.topObj.style.transform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.topObj.style.webkitTransform="translateX(0) translateY("+this.elTrans+"px) translateZ(0)",this.topObj.style.opacity="0"}.bind(this))}.bind(this),300),this.isFirstTime=!1)}setActiveHidden(){this.currentPosition>=this.maxElements||(this.listElNodesObj[this.currentPosition-1].classList.remove("stackedcards-active"),this.listElNodesObj[this.currentPosition-1].classList.add("stackedcards-hidden"),this.listElNodesObj[this.currentPosition].classList.add("stackedcards-active"))}setZindex(e){this.listElNodesObj[this.currentPosition]&&(this.listElNodesObj[this.currentPosition].style.zIndex=e)}removeElement(){this.currentElementObj.remove(),this.currentPosition>=this.maxElements||this.listElNodesObj[this.currentPosition].classList.add("stackedcards-active")}transformUi(e,t,i,r){requestAnimationFrame(function(){var n,a,o=r;n=this.rotate?15<(a=e)/10?15:-15>a/10?-15:a/10:0,"Top"===this.stackedOptions?(this.elTrans=5*this.elementsMargin,o&&(o.style.webkitTransform="translateX("+e+"px) translateY("+(t+this.elTrans)+"px) translateZ(0) rotate("+n+"deg)",o.style.transform="translateX("+e+"px) translateY("+(t+this.elTrans)+"px) translateZ(0) rotate("+n+"deg)",o.style.opacity=i)):"Bottom"!==this.stackedOptions&&"None"!==this.stackedOptions||o&&(o.style.webkitTransform="translateX("+e+"px) translateY("+t+"px) translateZ(0) rotate("+n+"deg)",o.style.transform="translateX("+e+"px) translateY("+t+"px) translateZ(0) rotate("+n+"deg)",o.style.opacity=i)}.bind(this))}updateUi(){requestAnimationFrame(function(){this.elTrans=0;var e,t=5,i=1,r=1,n=this.visibleItems.length,a=this.elementsMargin;for(e=this.currentPosition;e<this.currentPosition+this.visibleItems.length;e++)this.listElNodesObj[e]&&("Top"===this.stackedOptions?(3<e?this.listElNodesObj[e].classList.add("stackedcards-top","no-transition","stackedcards-origin-top"):this.listElNodesObj[e].classList.add("stackedcards-top","stackedcards--animatable","stackedcards-origin-top"),this.useOverlays&&(this.leftObj.classList.add("stackedcards-origin-top"),this.rightObj.classList.add("stackedcards-origin-top"),this.topObj.classList.add("stackedcards-origin-top")),this.elTrans=a*n,n--):"Bottom"===this.stackedOptions?(this.listElNodesObj[e].classList.add("stackedcards-bottom","stackedcards--animatable","stackedcards-origin-bottom"),this.useOverlays&&(this.leftObj.classList.add("stackedcards-origin-bottom"),this.rightObj.classList.add("stackedcards-origin-bottom"),this.topObj.classList.add("stackedcards-origin-bottom")),this.elTrans=this.elTrans+a):"None"===this.stackedOptions&&(this.listElNodesObj[e].classList.add("stackedcards-none","stackedcards--animatable"),this.elTrans=this.elTrans+a),this.listElNodesObj[e].style.transform="scale("+i+") translateX(0) translateY("+(this.elTrans-a)+"px) translateZ(0)",this.listElNodesObj[e].style.webkitTransform="scale("+i+") translateX(0) translateY("+(this.elTrans-a)+"px) translateZ(0)",this.listElNodesObj[e].style.opacity=r,this.listElNodesObj[e].style.zIndex=t,i-=.04,r-=1/this.visibleItems.length,t--)}.bind(this))}setOverlayOpacity(){this.topOpacity=(this.translateY+this.elementHeight/2)/100*-1,this.rightOpacity=this.translateX/100,this.leftOpacity=this.translateX/100*-1,1<this.topOpacity&&(this.topOpacity=1),1<this.rightOpacity&&(this.rightOpacity=1),1<this.leftOpacity&&(this.leftOpacity=1)}gestureStart(e){this.startTime=(new Date).getTime(),this.startX=e.changedTouches[0].clientX,this.startY=e.changedTouches[0].clientY,this.currentX=this.startX,this.currentY=this.startY,this.setOverlayOpacity(),this.touchingElement=!0,this.currentPosition>=this.maxElements||this.listElNodesObj[this.currentPosition]&&(this.listElNodesObj[this.currentPosition].classList.add("no-transition"),this.setZindex(6),this.useOverlays&&(this.leftObj.classList.add("no-transition"),this.rightObj.classList.add("no-transition"),this.topObj.classList.add("no-transition")),this.currentPosition+1<this.maxElements&&(this.listElNodesObj[this.currentPosition+1].style.opacity="1"),this.elementHeight=this.listElNodesObj[this.currentPosition].offsetHeight/3)}gestureMove(e){this.currentX=e.changedTouches[0].pageX,this.currentY=e.changedTouches[0].pageY,this.translateX=this.currentX-this.startX,this.translateY=this.currentY-this.startY,this.setOverlayOpacity(),this.currentPosition>=this.maxElements||(this.transformUi(this.translateX,this.translateY,1,this.currentElementObj),this.useOverlays&&(this.transformUi(this.translateX,this.translateY,this.topOpacity,this.topObj),0>this.translateX?(this.transformUi(this.translateX,this.translateY,this.leftOpacity,this.leftObj),this.transformUi(0,0,0,this.rightObj)):0<this.translateX&&(this.transformUi(this.translateX,this.translateY,this.rightOpacity,this.rightObj),this.transformUi(0,0,0,this.leftObj)),this.useOverlays&&(this.leftObj.style.zIndex=8,this.rightObj.style.zIndex=8,this.topObj.style.zIndex=7)))}gestureEnd(e){this.touchingElement&&(this.translateX=this.currentX-this.startX,this.translateY=this.currentY-this.startY,this.timeTaken=(new Date).getTime()-this.startTime,this.touchingElement=!1,this.currentPosition>=this.maxElements||(this.translateY<-1*this.elementHeight&&this.translateX>this.listElNodesWidth/2*-1&&this.translateX<this.listElNodesWidth/2?this.translateY<-1*this.elementHeight||Math.abs(this.translateY)/this.timeTaken>this.velocity?this.disableUpSwipe?this.backToMiddle():this.onSwipeTop():this.backToMiddle():0>this.translateX?this.translateX<this.listElNodesWidth/2*-1||Math.abs(this.translateX)/this.timeTaken>this.velocity?this.onSwipeLeft():this.backToMiddle():0<this.translateX&&(this.translateX>this.listElNodesWidth/2||Math.abs(this.translateX)/this.timeTaken>this.velocity?this.onSwipeRight():this.backToMiddle())))}}window.customElements.define("oap-swipable-cards",OapSwipableCards);class OapFilterArticles extends OapPageViewElement{static get properties(){return{allItems:Array,completed:Boolean,configFromServer:Object,country:Object,selectedItems:Array,filteredItems:Array}}static get styles(){return[OapFilterArticlesStyles,OapShadowStyles]}constructor(){super(),this.completed=!1}render(){return html$1`
      ${this.completed?html$1`
        <div class="layout vertical center-center topContainer shadow-animation shadow-elevation-3d" style="width: 100%;">
          <div class="completeHeader">
            ${this.localize("youHaveCompletedTheFiltering")}
          </div>
          <div class="buttonContainer">
            <paper-button raised class="continueButton" @click="${()=>{this.fire("oap-filtering-finished")}}">${this.localize("continueToSelection")}</paper-button>
          </div>
        </div>
    `:html$1`
        <oap-swipable-cards
          .country="${this.country}"
          .selectedItems="${this.selectedItems}"
          .filteredItems="${this.filteredItems}"
          .configFromServer="${this.configFromServer}"
          .language="${this.language}"
          @completed="${this.setCompleted}"
          .disableUpSwipe="true"
          .items="${this.allItems}">
        </oap-swipable-cards>
      `}

    `}setCompleted(){this.fire("oap-filtering-finished"),this.fire("oap-open-selection-info-dialog")}updated(e){super.updated(e),e.has("allItems")&&this.allItems&&this.fire("oap-open-filter-info-dialog")}}window.customElements.define("oap-filter-articles",OapFilterArticles);const OapAppStyles=css`
  :host {
    display: block;
    box-sizing: border-box;
  }

  section {
    padding: 24px;
    background: var(--app-section-odd-color);
  }

  section > * {
    max-width: 600px;
    margin-right: auto;
    margin-left: auto;
  }

  section:nth-of-type(even) {
    background: var(--app-section-even-color);
  }

  app-header {
    z-index: 5000;
  }

  :host {
    display: block;
    --app-primary-color: #000;
    --app-secondary-color: black;
    --app-main-backround-color: var(-app-outside-main-background-color, #000);
    --app-accent-color: var(--paper-orange-a700);
    --app-accent-color-light: var(--paper-orange-a200);
    --app-text-color: #ffffff;

    --paper-tabs-selection-bar-color: #aaa;
    --paper-tabs-selection-bar: {
      color: #aaa;
      border-bottom: 3px solid !important;
      border-bottom-color: #aaa;
    };

    --primary-color-more-darker: var(--app-main-backround-color, #333);
    --primary-color: var(--app-main-backround-color, #333);

    color: var(--app-text-color);

    --app-header-background-color: #000;
    --app-header-text-color: var(--app-text-color);
    --app-header-selected-color: #000;
    --paper-icon-button-ink-color: var(--app-text-color);
  }

  app-header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    text-align: center;
    background-color: var(--app-header-background-color, #000);
    color: var(--app-header-text-color, #FFF);
    border-bottom: 1px solid #000;
    outline: none;
  }

  app-header[wide-and-ballot] {
    height: var(--app-budget-container-height, 184px);
    width: 100%;
    background-size: 1920px 184px;
    background-repeat: no-repeat;
    background-position: center;
    background-position-y: top;
    background-image: var(--app-budget-container-background-image);
  }

  [main-title] {
    font-size: 30px;
    /* In the narrow layout, the toolbar is offset by the width of the
    drawer button, and the text looks not centered. Add a padding to
    match that button */
    padding-right: 44px;
  }

  main {
    display: block;
  }

  .main-content {
  }

  .main-content[has-ballot] {
    padding-top: 170px;
  }

  .main-content[has-ballot][wide] {
    padding-top: 150px;
  }

  .page {
    display: none;
  }

  .page[active] {
    display: block;
  }

  .toolbar-top {
    background-color: var(--app-toolbar-top-color, #000);
  }


  @media (min-width: 1024px) {
    .toolbar-list {
      display: block;
    }
    .menu-btn {
      display: none;
    }

    .main-content[has-ballot] {
      padding-top: 188px;
    }

    /* The drawer button isn't shown in the wide layout, so we don't
    need to offset the title */
    [main-title] {
      padding-right: 0px;
    }
  }

  app-toolbar {
    border-bottom: 0px;
  }

  .title {
    font-size: 24px;
  }

  paper-icon-button {
    width: 50px;
    height: 50px;
  }

  paper-icon-button.closeButton {
    width: 58px;
    height: 58px;
  }

  @media (max-width: 640px) {
    paper-icon-button {
      width: 40px;
      height: 40px;
    }

    paper-icon-button.closeButton {
      width: 46px;
      height: 46px;
    }
  }

  @media (max-width: 1024px) {
    .title {
      font-size: 17px;
    }
  }

  .exitIconInBudget {
    position: absolute;
    top: 0;
    left: 0;
    color: #fff;
  }

  .helpIconInBudget  {
    position: absolute;
    top: 2px;
    right: 0;
    color: #fff;
  }

  .choicePoints {
    position: absolute;
    top: 0;
    left: 0;
    color: #fff;
  }

  #helpContent h1 {
    line-height: 1em;
    font-size: 1.5em;
  }

  #helpContent h2 {
    margin-bottom: 0;
    margin-top: 24px;
  }

  #savedGameDialog {
    background-color: #000;
    color: #FFF;
  }

  .savedGameContent {
    font-size: 20px;
    padding: 16px;
    margin-right: 16px;
    margin-left: 16px;
    padding-bottom: 0;
  }

  .savedGameButton {
    background-color: #000;
    color: #FFF;
    width: 100%;
    text-align: center;
    border: 1px solid #FFF;
    margin-bottom: 16px;
  }

  .smallQuotes {
    color: #999;
  }

  #favoriteIcon {
    color: var(--app-facvorite-icon-color, rgb(255,215,0));
    background-color: transparent;
    width: 50px;
    height: 50px;
    z-index: 2720;
    -webkit-filter: drop-shadow( 1px 1px 10px #5f5f5f );
    filter: drop-shadow( 1px 1px 10px #5f5f5f );
  }

  @media (max-width: 640px) {
    #favoriteIcon {
      width: 40px;
      height: 40px;
    }
  }

  .buttons {
    margin-top: 16px;
  }

  .budgetContainer {
  }

  .largeSpinner {
    position: fixed; /* or absolute */
    top: 50%;
    left: 50%;
    width: 50px;
    height: 50px;
  }

  [hidden] {
    display: none !important;
  }

  paper-dialog {
    background-color: var(--primary-background-color);
  }

  .masterDialog {
    font-size: 22px;
    max-width: 420px;
    width: 420px;
    padding: 8px;
    padding-top: 0;
    line-height: 1.3;
    margin: 8px;
    width: 100%;
    margin: 0 !important;
    padding: 0 !important;
  }

  .masterDialog > .heading {
    text-align: center;
  }

  .masterDialog > .buttons {
    text-align: center;
  }

  .welcomeText {
    width: 420px;
    max-width: 420px;
    font-size: 16px;
    margin-top: 8px;
    color: #FFF;
  }

  .welcomeLogo {
    padding: 0;
    margin: 0;
    margin-top: 8px;
    max-width: 200px;
    width: 200px;
    height: 200px;
  }

  .masterLogoContainer {
    margin-left: auto;
    margin-right: auto;
    text-align: center;
  }

  #masterDialog {
    background-color: #000;
    color: #FFF;
  }

  paper-button.continueButton {
    background-color: #000;
    color: #fff;
    border: 1px solid #eaeaea;
    margin: 8px;
    margin-bottom: 8px;
    font-size: 18px;
  }

  paper-button.generalButton {
    color: var(--app-accent-color);
    background-color: #fff;
    margin: 8px;
  }

  .heading {
      font-size: 28px;
      font-weight: bold;
      color: #fff;
    }

  @media (max-width: 600px) {
    .masterDialog {
      font-size: 16px;
      padding: 8px;
      padding-top: 0;
      width: 100%;
    }

    .headingNoImage {
      margin-top: 64px;
    }

    paper-dialog {
      position: absolute;
      display: block;
      top: 0;
      bottom: 0;
      margin: 0;
      min-width: 360px;
      max-width: 1024px;
      width: 100%;
    }

    .heading {
      font-size: 22px;
    }

    .welcomeText {
      width: 100%;
    }
    paper-button.continueButton {
      font-size: 16px;
    }
    .welcomeLogo {
      width: 200px;
      height: 200px;
    }
  }

  @media (max-width: 340px) {
    .masterDialog {
      font-size: 13px;
    }
    .heading {
      font-size: 20px;
    }
    paper-button.continueButton {
      font-size: 16px;
    }
    .welcomeLogo {
      margin-left: 16px;
      display: none;
    }
    .welcomeLogologoContainer {
      display: none;
    }
    paper-button.continueButton {
      margin-top: 0;
    }
  }

  .masterLogoContainer {
  }

  paper-dialog {
    z-index: 1000000;
  }

  .langSelectionText {
    font-size: 16px;
    margin-top: 24px;
    margin-bottom: 24px;
  }

  .langSelect {
    cursor: pointer;
    margin-left: 4px;
  }

  .langSelect[is-selected] {
    text-decoration: underline;
  }

  .choicePoints {
    margin-left: 8px;
    margin-top: 4px;
    color: var(--app-accent-color, #000);
    font-weight: bold;
  }
`;var oapAppStyles={OapAppStyles:OapAppStyles};class SnackBar extends LitElement{static get properties(){return{active:{type:Boolean}}}static get styles(){return[css`
        :host {
          display: block;
          position: fixed;
          top: 100%;
          left: 0;
          right: 0;
          padding: 12px;
          background-color: var(--app-secondary-color);
          color: white;
          box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
          text-align: center;
          will-change: transform;
          transform: translate3d(0, 0, 0);
          transition-property: visibility, transform;
          transition-duration: 0.2s;
          visibility: hidden;
          z-index: 6 !important;
        }

        :host([active]) {
          visibility: visible;
          transform: translate3d(0, -100%, 0);
        }

        @media (min-width: 460px) {
          :host {
            width: 320px;
            margin: auto;
          }
        }
      `]}render(){return html$1`
      <slot></slot>
    `}}window.customElements.define("snack-bar",SnackBar);const OapPolicyQuizStyles=css`

  :host {
    width: 100%;
    height: 100%;
  }

  .question {
    width: 566px;
    padding: 16px;
    font-size: 23px;
    background-color: #000;
    background:rgba(0,0,0,0.5);
    color: #FFF;
    border-radius: 12px;
    margin-top: 0;
    text-align: center;
    margin-bottom: 32px;
    border: 1px solid #999;
    -webkit-transition: opacity 2.0s ease-in-out;
    -moz-transition: opacity 2.0s ease-in-out;
    -ms-transition: opacity 2.0s ease-in-out;
    -o-transition: opacity 2.0s ease-in-out;
    box-shadow: 0 0 10px #fff, inset 0 0 4px #fff;
  }

  .answerButton {
    background-color: var(--app-quiz-answer-button-background-color, #000);
    color: #eee;
    border: 1px solid #eee;
    padding: 16px;
    width: 100%;
    margin: 0;
    width: 600px;
    margin-bottom: 16px;
  }

  .wrongAnswer {
    -webkit-transition: opacity, color, border 0.6s ease-in-out;
    -moz-transition: opacity, color, border 0.6s ease-in-out;
    -ms-transition: opacity, color, border 0.6s ease-in-out;
    -o-transition: opacity, color, border 0.6s ease-in-out;
    opacity: 0.6;
    color: #FF0000;
    border: 1px solid #FF0000;
  }

  .rightAnswer {
    font-weight: bold;
    color: #fff;
    border: 1px solid #00ff00;
  }

  .buttonContainer {
    width: 100%;
    background: transparent;
    -webkit-transition: opacity 2.0s ease-in-out;
    -moz-transition: opacity 2.0s ease-in-out;
    -ms-transition: opacity 2.0s ease-in-out;
    -o-transition: opacity 2.0s ease-in-out;
  }

  @media (max-width: 340px) {
    top: 300px;
  }

  .topContainer {
    width: 600px;
    margin-left: auto;
    margin-right: auto;
    background: transparent;
    color: var(--quiz-color, #FFF);
    height: 100%;
    padding-bottom: 42px;
    position: absolute;
    top: 175px;
    left: 0;
    right: 0;
    padding: 0;
  }

  .infoBar {
    margin: 16px;
    font-size: 18px;
    text-align: right;
    width: 100%;
    margin-bottom: 8px;
  }

  .progress {
    font-size: 18px;
    color: #bbb;
    padding: 16px;
    position: absolute;
    top: 0;
    left: 0;
    right: 24px;
    -webkit-transition: opacity 2.0s ease-in-out;
    -moz-transition: opacity 2.0s ease-in-out;
    -ms-transition: opacity 2.0s ease-in-out;
    -o-transition: opacity 2.0s ease-in-out;
    max-width: 600px;padding-left: 36px;margin-left: auto; margin-right:auto;
  }

  .middle {
    width: 100%;
  }

  .textRight {
    text-align: right;
  }

  .textLeft {
    text-align: left;
  }

  #canvas3d {
    width: 100%;
    height: 300px;
    top: 0;
  }


  .completedQuiz {
    margin-left: auto;
    margin-right: auto;
    max-width: 600px;
    padding: 16px;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
  }

  .completeHeader {
    font-weight: bold;
    margin-bottom: 16px;
  }

$
  .continueButton {
    margin-top: 24px;
  }

  @media (max-width: 600px) {
    .topContainer {
      max-width: 100%;
      width: 100%;
      height: 100%;
      text-align: center;
    }

    :host {
      height: 100%;
    }

    .image {
      width: 100%;
    }

    .buttonContainer {
      width: 100%;
    }

    .answerButton {
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
    }

    .question {
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
      font-size: 19px;
    }


    #canvas3d {
      width: 100%;
      height: 250px;
    }

    .progress {
      padding-left: 16px;
    }

  }

  [intro-mode] {
    opacity: 0.0;
    -webkit-transition: opacity 2.0s ease-in-out;
    -moz-transition: opacity 2.0s ease-in-out;
    -ms-transition: opacity 2.0s ease-in-out;
    -o-transition: opacity 2.0s ease-in-out;
  }


  [hidden] {
    display: none !important;
  }
`;var oapPolicyQuizStyles={OapPolicyQuizStyles:OapPolicyQuizStyles};class OapPolicyQuiz extends OapPageViewElement{static get properties(){return{questions:Array,currentQuestionIndex:Number,correctAnswers:Number,incorrectAnswers:Number,nickname:String,configFromServer:Object,savedBackgroundColor:String,shapes3d:Object,renderer:Object,scene:Object,camera:Object,font3d:Object,dirLightOne:Object,dirLightTwo:Object,submitDisabled:Boolean,totalChoicePoints:Number,introMode:Boolean}}static get styles(){return[OapPolicyQuizStyles,OapFlexLayout,OapShadowStyles]}constructor(){super(),this.currentIndex=null,this.shapes3d=[],this.submitDisabled=!1,this.updateLighting3d=!1,this.updateFireworks3d=!1,this.introMode=!1}startIntro(){this.introMode=!1,this.startCountDown()}disableLightShaft(){this.lightShaft3d.remove(),this.updateLightShaft3d=!1}disableLightShaftAfterNextAnswer(){this.disableLightShaftAfterNext=!0}introFinished(){this.introMode=!1,setTimeout(()=>{this.startCountDown()},10)}start(){this.reset();var e=window.innerWidth;setTimeout(()=>{this.scene=new Scene,this.camera=new PerspectiveCamera(20,window.innerWidth/window.innerHeight,1,1e3),this.camera.position.set(0,0,50),this.scene.add(this.camera),this.dirLightOne=new DirectionalLight(1922440,2),this.dirLightOne.position.x=-500,this.dirLightOne.position.y=500,this.camera.add(this.dirLightOne),this.dirLightTwo=new DirectionalLight(1922440,1),this.dirLightTwo.position.x=500,this.dirLightTwo.position.y=-500,this.dirLightTwo.position.z=-150,this.camera.add(this.dirLightTwo),this.scene.background=new Color("#000"),this.savedBackgroundColor=this.$$("#button0").style.backgroundColor;var t=new TextGeometry("?",{font:this.font3d,size:180,height:20,curveSegments:32,bevelEnabled:!0,bevelThickness:9,bevelSize:5,bevelOffset:0,bevelSegments:18});t.computeBoundingBox(),t.computeVertexNormals(),t.center(),t=(new BufferGeometry).fromGeometry(t);var i=[new MeshPhongMaterial({color:16777215,flatShading:!0}),new MeshPhongMaterial({color:16777215})];600>=window.innerWidth&&(e=window.innerWidth);for(var r=-e/2;r<e/2;r+=30+60*Math.random())for(var n=0;n<300;n+=30+60*Math.random())this.addShape(t,i,"#aaaaaa",r,n,0,.8*Math.random(),.8*Math.random(),Math.PI,.1+.3*Math.random());this.renderer=new WebGLRenderer({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(e,300),this.$$("#canvas3d").appendChild(this.renderer.domElement),this.composer=new EffectComposer(this.renderer),this.clock=new Clock,this.composer.setSize(e,300),this.composer.passes=[],this.renderPass=new RenderPass(this.scene,this.camera),this.composer.addPass(this.renderPass),this.renderCanvas3d(),setTimeout(()=>{this.countdownTimer3d=CreateCountDownTimer3D(this.scene,this.camera,this.renderer,this.composer,this.clock,this.font3d,this,this.configFromServer.client_config.welcomeTexts,this.configFromServer,e,300),this.updateCountDown3dTimer=!0}),setTimeout(()=>{this.lightning3d=CreateLightning3D(this.scene,this.camera,this.renderer,this.composer,this.clock,e,300)},500),setTimeout(()=>{this.fireworks3d=CreateGPUFireworks3D(this.scene,this.camera,this.renderer,this.composer,this.clock,e,300),this.updateFireworks3d=!0},700)},1)}addShape(e,t,i,r,n,a,o,s,l,c){}stop(){for(;0<this.scene.children.length;)console.error(this.scene.children[0]),this.scene.remove(this.scene.children[0]);this.scene.remove()}animate(){this.shapes3d.forEach(e=>{e.shape.rotation.x+=.05*e.x,e.shape.rotation.y+=.05*e.y,e.shape.rotation.z+=.05*e.z})}renderCanvas3d(){requestAnimationFrame(this.renderCanvas3d.bind(this)),update(),this.lightning3d&&this.updateLighting3d&&this.lightning3d.update(),this.fireworks3d&&this.updateFireworks3d&&this.fireworks3d.update(),this.countdownTimer3d&&this.updateCountDown3dTimer&&this.countdownTimer3d.update(),this.lightShaft3d&&this.updateLightShaft3d&&this.lightShaft3d.update(),this.composer.render(this.clock.getDelta())}reset(){this.completed=!1,this.correctAnswers=0,this.incorrectAnswers=0,this.currentIndex=0,this.submitDisabled=!1}render(){return html$1`
      <div id="canvas3d"></div>
      <div class="layout-inline vertical center-center" class="topTop">
          <div class="layout horizontal progress" ?intro-mode="${this.introMode}">
              <div class="middle textLeft">${this.localize("question")} ${this.currentIndex+1}/${this.questions.length}</div>
              <div class="middle textRight">${this.totalChoicePoints} ${this.localize("choicePoints").toLowerCase()}</div>
            </div>
        <div class="topContainer">
          ${null!==this.currentIndex?html$1`
            <div class="question" ?intro-mode="${this.introMode}">${this.questions[this.currentIndex].question}</div>
            <div class="buttonContainer" ?intro-mode="${this.introMode}">
              <paper-button raised ?disabled="${this.submitDisabled}" id="button0" class="answerButton flex" @click="${()=>{this.submitAnswer(0)}}">${this.questions[this.currentIndex].answers[0]}</paper-button>
              <paper-button raised ?disabled="${this.submitDisabled}" id="button1" class="answerButton flex" @click="${()=>{this.submitAnswer(1)}}">${this.questions[this.currentIndex].answers[1]}</paper-button>
              <paper-button raised ?disabled="${this.submitDisabled}" id="button2" class="answerButton flex" @click="${()=>{this.submitAnswer(2)}}">${this.questions[this.currentIndex].answers[2]}</paper-button>
              <paper-button raised ?disabled="${this.submitDisabled}" id="button3" class="answerButton flex" @click="${()=>{this.submitAnswer(3)}}">${this.questions[this.currentIndex].answers[3]}</paper-button>
            </div>
          `:html$1``}
        </div>
        ${this.completed?html$1`
          <div class="vertical center-center completedQuiz">
            <div class="completeHeader">
              ${this.localize("youHaveCompletedTheQuiz")}
            </div>
            <div>
              ${this.localize("correctQuizAnswers")}: ${this.correctAnswers}
            </div>
            <div>
              ${this.localize("incorrectQuizAnswers")}: ${this.incorrectAnswers}
            </div>
            <div class="buttonContainer">
              <paper-button raised class="answerButton continueButton" @click="${this.quizFinished}">${this.localize("continueToCountryCreation")}</paper-button>
            </div>
          </div>
        `:html$1``}
      </div>
    `}quizFinished(){this.fire("oap-quiz-finished"),this.stop()}correctAnswerColorAnimation(){let e=new Color("#39FF14");[this.dirLightOne,this.dirLightTwo].forEach(t=>{new Tween(t.color).to({r:e.r,g:e.g,b:e.b},25).delay(0).easing(Easing.Quadratic.InOut).on("complete",()=>{e=new Color("#1d5588"),new Tween(t.color).to({r:e.r,g:e.g,b:e.b},450).delay(1200).easing(Easing.Quadratic.InOut).on("complete",()=>{}).start()}).start()}),this.fireworks3d&&(this.fireworks3d.visible=!0,this.fireworks3d.material.opacity=1,this.updateFireworks3d=!0,setTimeout(()=>{this.fireworks3d.material.transparent=!0,new Tween(this.fireworks3d.material).to({opacity:0},1e3).on("complete",()=>{this.fireworks3d.visible=!1,this.updateFireworks3d=!1}).start()},2200))}wrongAnswerColorAnimation(){let e=new Color("#d6483d");[this.dirLightOne,this.dirLightTwo].forEach(t=>{new Tween(t.color).to({r:e.r,g:e.g,b:e.b},25).delay(0).on("complete",()=>{e=new Color("#1d5588"),new Tween(t.color).to({r:e.r,g:e.g,b:e.b},320).delay(1350).on("complete",()=>{}).start()}).start()}),this.lightning3d&&(this.lightning3d.visible=!0,this.lightning3d.outlinePass.edgeGlow=.7,this.lightning3d.outlinePass.edgeStrength=2.5,this.lightning3d.outlinePass.edgeThickness=2.8,this.lightning3d.material.opacity=1),setTimeout(()=>{this.lightning3d.material.transparent=!0,new Tween(this.lightning3d.material).to({opacity:0},600).on("complete",()=>{this.lightning3d.material.transparent=!1,this.lightning3d.visible=!1,this.updateLighting3d=!1}).start(),new Tween(this.lightning3d.outlinePass).to({edgeGlow:0,edgeStrength:0,edgeThickness:0},600).on("complete",()=>{}).start()},2e3)}ranOutOfTime(){null!==this.currentIndex&&this.submitAnswer("blah"),console.log("Ran out of time")}submitAnswer(e){this.submitDisabled=!0;let t=!1;const i=this.questions[this.currentIndex].correctAnswer;e==i?(t=!0,this.correctAnswerColorAnimation(),this.correctAnswers+=1,this.countdownTimer3d.stopCountDownWin(),this.fire("oap-process-correct-quiz-answer"),this.countdownTimer3d&&this.countdownTimer3d.showWinPoints()):(this.fire("oap-overlay",{html:html$1`${this.localize("incorrectAnswer")}`,soundEffect:"",duration:300}),this.countdownTimer3d.stopCountDownFail(),this.wrongAnswerColorAnimation(),this.incorrectAnswers+=1,this.activity("answerSubmitted","quiz")),window.requestAnimationFrame(()=>{this.$$("#button"+i).classList.add("rightAnswer"),[0,1,2,3].filter(e=>e!==i).forEach(e=>{this.$$("#button"+e).classList.add("wrongAnswer")})}),setTimeout(()=>{this.resetAllButtons(),this.currentIndex<this.questions.length-1?(this.currentIndex+=1,this.countdownTimer3d.startCountDown(),this.requestUpdate()):(this.currentIndex=null,this.completed=!0,this.quizFinished(),this.requestUpdate(),this.fire("oap-sound-effect","quizCompleted")),this.submitDisabled=!1},!0===window.debugOn?100:t?3300:2700),this.disableLightShaftAfterNext&&(this.disableLightShaftAfterNext=!1,setTimeout(()=>{this.disableLightShaft()},50))}startCountDown(){this.countdownTimer3d?this.countdownTimer3d.startCountDown():config.error("No countdownTimer3d")}resetAllButtons(){[0,1,2,3].forEach(e=>{this.$$("#button"+e).style.backgroundColor=this.savedBackgroundColor,this.$$("#button"+e).selected=!1,this.$$("#button"+e).focused=!1,this.$$("#button"+e).classList.remove("wrongAnswer","rightAnswer")})}updated(e){super.updated(e),e.has("questions")&&this.questions&&this.reset(),e.has("font3d")&&this.font3d&&(this.start(),StartEarlyDelayedFontCaching(this.font3d))}}window.customElements.define("oap-policy-quiz",OapPolicyQuiz);const OapBallotStyles=css`

  :host {
    position: relative;
  }

  iron-list {
    margin-top: 24px;
    padding-bottom: 16px;
    background-color: var(--app-main-background-color);
  }

  .finalItems {
    flex-flow: column wrap; /* Shorthand  you could use flex-direction: column and flex-wrap: wrap instead */
    justify-content: flex-start;
    align-items: flex-start;
    display: flex;
    margin: 0 auto;
  }

  .name {
    font-size: 19px;
    padding: 8px;
  }

  .description {
    padding-left: 8px;
  }

  .price {
    font-size: 20px;
    position: absolute;
    bottom: 4px;
    left: 8px;
  }

  .itemContainer {
    margin-top: 8px;
    margin-bottom: 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
    background-color: var(-app-item-container, #000 !important);
  }

  oap-article-item {
    outline: 0px;
    transition: all 1s ease-in-out;
    -webkit-transition: all 750ms ease-in-out;
    -moz-transition: all 750ms ease-in-out;
    -o-transition: all 750ms ease-in-out;
    -ms-transition: all 750ms ease-in-out;
  }


  .sendToTop {
    transform: translate(0,-2000px);
    -webkit-transform: translate(0,-2000px);
    -moz-transform: translate(0,-2000px);
    -o-transform: translate(0,-2000px);
    -ms-transform: translate(0,-2000px);
  }

  paper-button.addButton {
    position: absolute;
    bottom: 16px;
    outline: 0px;
    right: 8px;
    background-color: var(--app-ballot-add-button-background-color, #F00);
    color: var(--app-ballot-add-button-color, #FFF);
  }


  #submitButtonContainer {
    width: 100%;
    text-align: center;
    margin-bottom: 16px;
    margin-top: 12px;
  }

  #submitButtonContainerTwo {
    width: 100%;
    text-align: center;
    margin-bottom: 16px;
    margin-top: 24px;
  }

  #submitButton {
    color: #FFF;
    background-color: #000;
    border: 1px solid #FFF;
    margin-left: auto;
    margin-right: auto;
    max-width: 300px;
    width: 270px;
  }

  .tabsContainer {
    z-index: 9000;
    background: transparent;
    cursor: pointer;
    position: fixed;
    top: 166px;
    left: 32px;
    display: block;
  }

  .favTab {
    z-index: 9001;
    display: inline;
    transition: opacity 250ms ease-in-out;
  }

  .selectedTab {
    display: inline;
    z-index: 9001;
  }

  .tab {
    background: transparent;
    font-size: 18px;
    padding-left: 12px;
    padding-right: 12px;
    color: #999;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    -o-user-select: none;
     user-select: none;
   }

  .tab[selected] {
    color: #d0d0d0;
    padding-bottom: 1px;
    border-bottom: 2px solid #ddd;
  }

  .favOpacityDown {
    transition: opacity 250ms ease-in-out;
    opacity: 0.47;
  }

  @keyframes colorani {
    0%   {color: var(--oap-active-selection-original-color);
          border-color: var(--oap-active-selection-original-color);}
    50%  {color: var(--oap-active-selection-color);
          border-color: var(--oap-active-selection-color);}
    100% {color: var(--oap-active-selection-original-color);
      border-color: var(--oap-active-selection-original-color);}
  }



  .selectedTabAnimation {
    animation-name: colorani;
    animation-duration: 1.4s;
  }

  paper-button[disabled] {
    background-color: #555;
  }

  .budgetContainer {
  }

  .votingButtonContainer {
    position: absolute;
    bottom: 24px;
  }

  .topContainer {
    background-color: var(--app-main-background-color);
    color: var(--app-ballot-color, #333);
    margin-top: 24px;
  }

  @media (max-width: 1000px) {
    .topContainer {
      margin-top: 30px;
    }
  }

  @media (max-width: 600px) {
    .topContainer {
      margin-top: 32px;
    }
  }

  .finalHeader {
    padding: 8px;
    font-size: 24px;
    margin: 8px;
    text-align: center;
    color: #FFF;
    font-weight: bold;
    margin-bottom: 12px;
    margin-top: 12px;
  }

  paper-tabs {
    margin: 8px;
    margin-right: 16px;
    margin-left: 16px;
    color: #FFF;
  }

  paper-tab {
    font-size: 18px;
    margin-left: 32px;
    margin-right: 32px;
    font-size: 17px;
    width: 100px;
  }

  @media (max-width: 1045px) {
    paper-tab {
      font-size: 15px !important;
      margin-left: 16px;
      margin-right: 16px;
    }
  }

  @media (max-width: 360px) {
    paper-tab {
      font-size: 14px !important;
      margin-left: 16px;
      margin-right: 16px;
    }
  }

  .headerContainer {
    color: #aaa;
    font-size: 24px;
    padding: 8px;
    margin: 8px;
    text-align: center;
    margin-bottom: 0;
  }

  .countryHeader {
    color: #FFF;
    font-size: 26px;
    font-weight: bold;
  }

  [hidden] {
    display: none !important;
  }
`;var oapBallotStyles={OapBallotStyles:OapBallotStyles};const OapArticleItemStyles=css`

  .leftColor {
    width: 4px;
    max-width: 4px;
    margin: 0;
    padding: 0;
  }

  #closeButton {
    position: absolute;
    right: 2px;
    bottom: -32px;
    text-transform: uppercase;
    text-align: center;
    font-weight: bold;
    margin-bottom: 4px;
    cursor: pointer;
    color: #FFF;
  }

  .itemContent {
    position: relative;
    width: 300px;
    height: 70px;
    margin: 8px;
    cursor: pointer;
  }

  .name {
    max-width: 220px;
  }

  .name[exclusive-active] {
    position: absolute;
    font-size: 14px;
    top: 50%;
    transform: translateY(-50%);
    left: 0;
  }

  .name[module-type] {
    position: absolute;
    font-size: 22px;
    top: 50%;
    transform: translateY(-50%);
    color: #FFF;
    left: 0;
    right: 0;
    margin-left: auto;
    margin-right: auto;
    text-align: center;
  }

  .itemContent[small] {
    width: 260px !important;
    height: 277px;
    margin: 0;
  }

  .itemContent[small][tiny] {
    width: 220px !important;
    height: 220px;
  }

  .itemSelectedFrame {
    background: transparent;
    border: none;
    width: 296px;
    height: 316px;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 4;
  }

  .itemSelectedFrame[small] {
    width: 254px;
    height: 271px;
  }

  .itemSelectedFrame[tiny] {
    width: 214px;
    height: 214px;
  }

  .buttons {
    z-index: 5;
  }

  .itemSelectedFrame[selected] {
    background: transparent;
    border: solid 2px;
    border-color: var(--app-accent-color);
  }

  iron-image {
    width: 300px;
    height: 201px;
  }

  iron-image[small] {
    width: 260px;
    height: 175px;
  }

  iron-image[small][tiny] {
    width: 220px;
    height: 148px;
  }

  .descriptionContainer {
    height: 100%;
    width: 300px;
    margin: 0;
    overflow: hidden;
    font-size: 14px;
    font-weight: bold;
    text-align: left;
    background-color: var(--app-ballot-item-description-background-color, #333);
    color: var(--app-ballot-item-description-color, #FFF);
    margin-bottom: 7px;
  }

  .descriptionContainer[small] {
    width: 260px;
    height: 146px;
    font-size: 12px;
    text-align: left;
  }

  .descriptionContainer[small][tiny] {
    width: 220px;
    height: 124px;
    font-size: 11px;
  }

  .name {
    font-size: var(--app-item-name-font-size, 14px);
    padding: 8px;
    color: var(--app-ballot-item-name-color, #000);
  }

  .name[small] {
    font-size: var(--app-item-name-font-size-small, 13px);
    padding-top: 4px;
    padding-right: 4px;
    padding-top: 4px;
  }

  .name[small][tiny] {
    font-size: 14px;
  }

  .price {
    font-size: 25px;
    position: absolute;
    bottom: 8px;
    left: 92px;
    color: var(--app-accent-color);
  }

  .price[no-millions] {
    left: 108px;
  }

  .price[small] {
    left: 70px;
  }

  .price[no-millions][small] {
    left: 95px;
  }

  .price[small][tiny] {
    left: 42px;
  }

  .priceCurrency {
    font-size: 23px;
    color: var(--app-accent-color);
  }


  .description {
    padding: 8px;
    font-size: 13px;
    padding-right: 12px;
    padding-left: 12px;
  }

  .cardImage {
    width: 300px;
    height: 201px;
  }

  .itemContent[inbudget] {
    position: relative;
    height: 100%;
  }

  .name[in-budget-selection]:not([exclusive-active]):not([module-type]) {
    text-decoration: underline;
  }

  .name[inbudget] {
    font-size: 20px;
    font-weight: bold;
    width: 100%;
    max-width: 100%;
    padding-top: 0;
    padding-bottom: 0;
    padding-right: 16px;
  }

  .subCategory {
    position: absolute;
    bottom: 4px;
    left: 8px;
    color: #656565;
    font-size: 12px;
  }

  #addToBudgetButton[exclusive-active] {
    -webkit-transition: transform 1400ms ease;
    -o-transition: transform 1400ms ease;
    transition: transform 1400ms ease;
    -webkit-transform: scale(0.1);
    -o-transform: scale(0.1);
    transform: scale(0.1);
  }

  #addToBudgetButton[exclusive-selected] {
    -webkit-transform: scale(1.0);
    -o-transform: scale(1.0);
    transform: scale(1.0);
  }

  #topContainer {
    /*cursor: pointer;*/
    border-radius: 5px;
  }

  .addRemoveButton {
    position: absolute;
    bottom: 11px;
    right: 5px;
    font-size: 18px;
    margin: 0;
    width: 36px;
    height: 32px;
    margin-right: 6px;
    border-radius: 3px;
    padding: 8px;
    text-align: center;
    cursor: pointer;
    background-color: var(--app-accent-color);
    color: var(--app-ballot-item-button-color, #fff);
  }

  .exclusiveName {
    position: absolute;
    top: 24px;
    left: 8px;
    font-size: 14px;
    font-weight: 500;
    max-width: 218px;
  }

  .editExclusiveMenuButton {
    position: absolute;
    bottom: 2px;
    right: 5px;
    text-align: center;
  }

  .editExclusiveButton {
    font-size: 18px;
    margin: 0;
    width: 50px;
    height: 50px;
    border-radius: 3px;
    padding: 12px;
    text-align: center;
    cursor: pointer;
    background-color: var(--app-accent-color);
    color: var(--app-ballot-item-button-color, #fff);
  }

  .priceText {
    margin-top: 6px;
  }

  .addRemoveButton[disabled] {
    cursor: default;
    background-color: #b7b7b7;
  }

  #isBlockedByInfo {
    position: absolute;
    /*
    top: 50%;
    transform: translateY(-50%);
    */
    bottom: 6px;
    left: 0;
    right: 0;
    text-align: center;
    font-size: 16px;
    margin-left: 8px;
    margin-right: 8px;
  }

  .removeButton {
    background-color: #fff !important;
    color: var(--app-accent-color) !important;
    position: static;
    margin-bottom: 12px;
    margin-left: auto;
    margin-right: auto;

  }

  .shareIcon {
    position: absolute;
    bottom: 6px;
    left: 0;
    --paper-share-button-icon-color: var(--app-accent-color-light);
    --paper-share-button-icon-height: 46px;
    --paper-share-button-icon-width: 46px;
    -webkit-filter: drop-shadow( 1px 1px 10px #555 );
    filter: drop-shadow( 1px 1px 10px #555 );
  }

  .shareIcon[small] {
    display: none;
  }

  .budgetContainer {
  }

  .itemContent {
    color: var(--app-ballot-item-content-color, #222);
    background-color: var(--app-ballot-item-content-background-color, #fbfbfb);
  }

  .addRemoveButton {

  }

  .infoIcon {
    color: var(--app-accent-color-light);
    width: 32px;
    height: 32px;
    padding: 0;
    margin-right: 4px;
  }

  .infoLinks {
    position: absolute;
    top: 118px;
    right: 0px;
    z-index: 2;
  }

  .stateDropdown {
    color: var(--app-accent-color-light);
    position: absolute;
    top: 60px;
    right: 0;
    z-index: 2;
    padding-right: 0;
    margin-right: 0;
  }

  .dropdownMenuButton {
    position: absolute;
    top: 8px;
    right: 8px;
  }

  .dropdownButton {
    background-color: var(--app-accent-color);
    opacity: 0.8;
    color: var(--app-ballot-item-button-color, #fff);
    padding: 2px;
    width: 32px;
    height: 26px;
  }

  .infoLinks[small] {
    top: 98px;
  }

  .infoLinks[small][tiny] {
    top: 78px;
  }

  .externalInfoIcon {
    color: var(--app-ballot-item-extinfo-icon-color, #999);
    width: 45px;
    height: 45px;
  }

  .externalIconContainer {
    position: absolute;
    bottom: 4px;
    left: 0px;
    z-index: 2;
  }

  .favoriteButtons {
  }

  .cost {
    padding-left: 8px;
    position: relative;
    bottom: 12px;
    font-weight: bold;
    font-size: 20px;
    left: 120px;
    color: var(--app-accent-color, #F00);
  }

  #opacityLayer {
    display: none;
    position: absolute;
    background-color: #FF1744;
    top: 0;
    right: 0;
    width: 300px;
    height: 70px;
    z-index: 2000;
  }

  #opacityLayer.cover {
    opacity: 1;
  }


  [hidden] {
    display: none !important;
  }
`;var oapArticleItemStyles={OapArticleItemStyles:OapArticleItemStyles};class OapArticleItem extends OapBaseElement{static get properties(){return{item:{type:Object},elevation:Number,selected:Boolean,ballotElement:{type:Object},selectedInBudget:{type:Boolean},hideClose:Boolean,isBookmarked:{type:Boolean},toExpensive:{type:Boolean},isExcluded:{type:Boolean},isBlockedBy:{type:Object},isFavorite:{type:Boolean},browsingMode:{type:Boolean},imageTabSelected:{type:Boolean},descriptionTabSelected:{type:Boolean},descriptionPdfLink:{type:String},small:{type:Boolean},tiny:{type:Boolean},imageLoaded:{type:Boolean,value:!1},inBudgetSelection:Boolean,configFromServer:Object,listBoxSelection:Number,selectedExclusiveId:String,onlyDisplay:Boolean}}static get styles(){return[OapArticleItemStyles,OapShadowStyles,OapFlexLayout]}getName(){return this.item.exclusiveOptions?this.item.name.split(": ")[0]:this.item.name}render(){return html$1`
      <div id="topContainer"
           @click="${this.topClick}"
           ?module-type="${"ModuleTypeCard"==this.item.module_type}"
           class="itemContent shadow-animation shadow-elevation-3dp layout horizontal"
           ?inbudget="${this.selected}" ?blocked-by="${this.isBlockedBy}">
        <div id="opacityLayer"></div>
        <div id="innerContainer" ?hidden="${this.item.hideInnerContainer}">
          <div id="leftColor" class="leftColor" ?hidden="${this.selected}"></div>
          <div class="layout-inline vertical">
            <div class="layout horizontal">
              <div class="image" ?hidden="${!this.selected}"><img class="cardImage" src="${this.item.image_url}"/></div>
            </div>
            <div class="name"
              ?exclusive-active="${this.item.exclusiveOptions&&!this.selectedExclusiveId}"
              ?module-type="${"ModuleTypeCard"==this.item.module_type}"
              ?in-budget-selection="${this.inBudgetSelection}"
              ?inbudget="${this.selected}">
              ${this.getName()}
            </div>
            <div class="exclusiveName" ?hidden="${this.selected||!this.selectedExclusiveId}">${this.item.name.split(": ")[1]}</div>
            <div class="layout-inline vertical" ?hidden="${"ModuleTypeCard"==this.item.module_type}">
              <div class="description" ?hidden="${!this.selected}">${this.item.description}</div>
              <div class="buttons" ?hidden="${!0==!this.onlyDisplay}">
                <div id="closeButton" ?hidden="${this.hideClose}" class="shadow-animation shadow-elevation-2dp" @click="${()=>{this.fire("oap-close-master-dialog")}}" title="${this.localize("close")}">
                   ${this.localize("close")}
                </div>
              </div>
              <div class="buttons" ?hidden="${this.item.exclusive_ids&&!this.selectedExclusiveId||!0===this.onlyDisplay}">
                <div id="addToBudgetButton" class="shadow-animation shadow-elevation-2dp addRemoveButton"
                          ?hidden="${this.selected}"
                          ?exclusive-active="${this.item.exclusiveOptions}"
                          ?exclusive-selected="${this.selectedExclusiveId}"
                          ?disabled="${this.toExpensive||this.isExcluded}" title="${this.localize("add_to_budget")}" icon="add" @click="${this._toggleInBudget}">
                  <div class="priceText">+${this.item.price}</div>
                </div>
                <div raised elevation="5" class="addRemoveButton removeButton shadow-animation  shadow-elevation-4dp" ?hidden="${!this.selected}"
                          title="${this.localize("remove_from_budget")}" icon="remove" @click="${this._toggleInBudget}">
                  <div class="priceText">-${this.item.price}</div>
                </div>
              </div>
              ${!this.item.exclusiveOptions||this.selectedExclusiveId||this.selected?"":html$1`
                <paper-menu-button @tap="${this._openMenu}" class="editExclusiveMenuButton" horizontal-align="right">
                  <paper-icon-button id="editExclusiveOptions" class="shadow-animation shadow-elevation-2dp  dropdown-trigger  editExclusiveButton" slot="dropdown-trigger" @click="${this._clickedDropDownMenu}" alt="${this.localize("openDetailMenu")}" icon="menu"></paper-icon-button>
                  <paper-listbox class="dropdown-content" slot="dropdown-content" id="listBox" @click="${this.noClick}" @selected-changed="${this.selectedExclusiveChanged}">
                    ${this.item.exclusiveOptions.map(e=>html$1`
                        <paper-item data-id="${e.id}" @click="${this.noClick}">
                          ${e.name.split(": ")[1]}
                        </paper-item>
                      `)}
                  </paper-listbox>
                </paper-menu-button>
              `}
            </div>
            <div class="subCategory" hidden ?inbudget="${this.selected}" ?blockedBy="${this.isBlockedBy}">${this.item.sub_category}</div>
          </div>
        </div>
        <div id="isBlockedByInfo" ?hidden="${!this.isBlockedBy}">
          ${this.isBlockedBy?html$1`
            ${this.localize("blockedBy")} ${this.isBlockedBy.name}
          `:""}
        </div>
      </div>
    `}noClick(e){e.preventDefault()}selectedExclusiveChanged(e){null!==e.detail.value&&(this.selectedExclusiveId=this.item.exclusiveOptions[e.detail.value].id,this.item.id!=this.selectedExclusiveId&&(this.oldElementNeedsSwapping=this.item,this.item=this.ballotElement.getItem(this.selectedExclusiveId),this.item.selectedExclusiveId=this.selectedExclusiveId,this.item.exclusiveOptions=this.oldElementNeedsSwapping.exclusiveOptions),this.oldElementNeedsSwapping&&(this.ballotElement.swapOutItem(this.oldElementNeedsSwapping,this.item),this.oldElementNeedsSwapping=null),this.fire("oap-set-state-of-remaining-items"))}topClick(e){"paper-item"!=e.target.localName&&(this.item.exclusiveOptions&&!this.selectedExclusiveId||this.selected||"ModuleTypeCard"==this.item.module_type||this.fire("oap-open-article-item",this.item))}exclusiveNumberOf(){if(this.item.exclusive_ids){const e=this.item.exclusive_ids.split(",");let t;return e.forEach((e,i)=>{this.item.id==e&&(t=i+1)}),"("+t+"/"+e.length+")"}return""}updated(e){if(super.updated(e),e.has("selected")&&(this.selected?(this.elevation=4,this.$$("#topContainer").classList.add("shadow-elevation-12dp")):(this.elevation=1,this.$$("#topContainer").classList.remove("shadow-elevation-12dp"))),e.has("item")&&this.item&&(this.item.exclusiveOptions&&1==this.item.exclusiveOptions.length&&(this.selectedExclusiveId=this.item.id),this.item.selectedExclusiveId&&(this.selectedExclusiveId=this.item.selectedExclusiveId),this.onlyDisplay||this.resetFromBudget(),"ModuleTypeCard"==this.item.module_type)){const e=this.configFromServer.client_config.moduleTypeColorLookup[this.item.module_content_type];this.$$("#topContainer").style.backgroundColor=e,this.$$("#topContainer").style.color="#FFF"}e.has("small")&&(this.small?(this.mapsHeight="260",this.mapsWidth="146"):(this.mapsHeight="169",this.mapsWidth="300")),e.has("tiny")&&(this.tiny?(this.mapsHeight="220",this.mapsWidth="124"):(this.mapsHeight="169",this.mapsWidth="300"))}constructor(){super(),this.reset(),this.listBoxSelection=null,this.inBudgetSelection=!1}reset(){this.small=!1,this.descriptionTabSelected=!1,this.imageTabSelected=!0,this.isFavorite=!1,this.toExpensive=!1,this.isBookmarked=!1,this.selected=!1,this.isExcluded=!1,this.isBlockedBy=null,this.oldElementNeedsSwapping=null,this.selectedExclusiveId=null}_imageLoadedChanged(e){e.detail.value&&(this.imageLoaded=!0)}_clickedDropDownMenu(e){e.preventDefault(),this.activity("click","exclusiveDropdown")}_costIsOne(e){return!!(e&&1>=e)}_openPdf(){this.activity("click","openPdf"),this.item.descriptionPdfLink&&window.open(this.item.descriptionPdfLink,"_blank")}_showPost(){this.activity("click","showPost"),window.appLastArea="/"+window.location.hash;const e="/post/"+this.item.idea_id;window.history.pushState({},null,e),this.fire("location-changed",e),setTimeout(()=>{this.$$("#listBox").select(0)})}_itemShareUrl(){return this.item?encodeURIComponent("https://"+window.location.host+"/items/"+this.item.id):null}_shareTap(e,t){this.activity("click","shareItem")}resetFromBudget(){const e=this.configFromServer.client_config.moduleTypeColorLookup[this.item.module_content_type];if(this.$$("#leftColor").style.backgroundColor=e,this.isExcluded||this.isBlockedBy||(this.$$("#addToBudgetButton").style.backgroundColor=e,this.$$("#editExclusiveOptions")&&(this.$$("#editExclusiveOptions").style.backgroundColor="#FFF",this.$$("#editExclusiveOptions").style.color=e)),this.budgetElement){if(-1<this.budgetElement.selectedItems.indexOf(this.item))this.setInBudget(),this.setNotTooExpensive(),this.budgetElement.currentBallot.favoriteItem==this.item?this.isFavorite=!0:this.isFavorite=!1;else{var t=this.budgetElement.totalBudget-this.budgetElement.selectedBudget;this.item.cost>t?this.setTooExpensive():this.setNotTooExpensive(),this.removeFromBudget()}if(this.item.exclusive_ids&&0<this.item.exclusive_ids.length){const e=this.budgetElement.selectedItems.map(e=>e.id);this.item.exclusive_ids.split(",").forEach(t=>{-1<e.indexOf(t)?this.setBlockedBy({name:this.item.name,id:this.item.id}):this.setNotBlockedBy()})}}this._setImageMode(!0)}_setImageMode(e){e&&!1!==e||this.activity("select","imageMode"),this.imageTabSelected=!0,this.descriptionTabSelected=!1,this.mapTabSelected=!1}_setMapMode(){this.activity("select","mapMode"),this.imageTabSelected=!1,this.descriptionTabSelected=!1,this.mapTabSelected=!0}_setDescriptionMode(){this.activity("select","descriptionMode"),this.imageTabSelected=!1,this.descriptionTabSelected=!0,this.mapTabSelected=!1}_toggleDescription(){this.activity("toggle","description"),!0===this.descriptionTabSelected?this._setImageMode():this._setDescriptionMode()}_openMenu(){this.activity("open","itemMenu")}setInBudget(){const e=this.configFromServer.client_config.moduleTypeColorLookup[this.item.module_content_type];this.$$("#addToBudgetButton").style.backgroundColor=e,this.$$("#editExclusiveOptions")&&(this.$$("#editExclusiveOptions").style.backgroundColor="#FFF",this.$$("#editExclusiveOptions").style.color=e),this.$$("#opacityLayer").style.backgroundColor=e,this.$$("#opacityLayer").classList.add("cover"),this.$$("#opacityLayer").style.display="block",setTimeout(()=>{this.$$("#opacityLayer").style.display="none",this.selected=!0},600)}removeFromBudget(){this.selected=!1,this.isFavorite=!1}setTooExpensive(){this.toExpensive=!0,this.$$("#addToBudgetButton").style.backgroundColor="#999"}setNotTooExpensive(){if(this.toExpensive=!1,!this.isExcluded&&!this.isBlockedBy){const e=this.configFromServer.client_config.moduleTypeColorLookup[this.item.module_content_type];this.$$("#addToBudgetButton").style.backgroundColor=e,this.$$("#editExclusiveOptions")&&(this.$$("#editExclusiveOptions").style.backgroundColor="#FFF",this.$$("#editExclusiveOptions").style.color=e)}}setBlockedBy(e){if(e.id!=this.item.id){this.$$("#addToBudgetButton").style.display="none",this.$$("#innerContainer").style.opacity=.4;const t=this.configFromServer.client_config.moduleTypeColorLookup[this.item.module_content_type];this.isBlockedBy=e,this.$$("#isBlockedByInfo").style.color=t,this.requestUpdate()}}setNotBlockedBy(){this.isBlockedBy=null,this.$$("#addToBudgetButton").style.display="block",this.$$("#innerContainer").style.opacity=1,this.requestUpdate()}_toggleFavorite(){if(this.budgetElement.currentBallot.favoriteItem&&this.budgetElement.currentBallot.favoriteItem.id==this.item.id)this.fire("oav-set-favorite-item-in-budget",{item:null}),this.isFavorite=!1;else{var e=this.$$("#addFavoriteButton").getBoundingClientRect(),t=e.left,i=e.top;this.isFavorite=!0,this.fire("oav-set-favorite-item-in-budget",{item:this.item,orgAnimPos:{left:t,top:i},budgetAnimPos:this.budgetElement.getItemLeftTop(this.item)}),setTimeout(()=>{this.requestUpdate()})}}_toggleInBudget(e){e.stopPropagation(),this.oldElementNeedsSwapping&&(this.ballotElement.swapOutItem(this.oldElementNeedsSwapping,this.item),this.oldElementNeedsSwapping=null),e.target&&!e.target.attributes.disabled?(this.fire("oav-toggle-item-in-budget",{item:this.item}),this.fire("oap-close-snackbar")):console.warn("Trying to click disabled button")}}window.customElements.define("oap-article-item",OapArticleItem);class OapBallot extends OapPageViewElement{static get properties(){return{area:{type:Object},areaId:{type:String},configFromServer:String,areaIdRoutePath:{type:Object},selectedView:{type:Number},budgetElement:{type:Object},votePublicKey:{type:String},budgetBallotItems:Array,processedBallotItems:Array,wide:Boolean,popupWindow:Object,favoriteItem:{type:Object},country:Object,oldFavoriteItem:Object,showMap:Boolean,usedBonusesAndPenalties:Object,savedVoteId:Number}}static get styles(){return[OapBallotStyles]}render(){return html$1`${this.area?html$1`
        <div class="tabsContainer">
          <div id="selectedTab" ?selected="${1===this.selectedView}" @click="${()=>{this.selectTabAndScroll(1)}}" class="tab selectedTab">${this.localize("finalSelection")} ${this.budgetElement&&this.budgetElement.selectedItems?html$1` (${this.budgetElement.selectedItems.length})`:html$1``}</div>
          <div id="favTab" ?selected="${0===this.selectedView}" @click="${()=>{this.selectTabAndScroll(0)}}" class="tab favTab">${this.localize("favorite")} ${this.processedBallotItems?html$1` (${this.processedBallotItems.length})`:html$1``}</div>
        </div>

        <div class="topContainer">
          ${this.processedBallotItems&&this.budgetElement?html$1`
              <div id="itemContainer" class="itemContainer layout horizontal center-center flex wrap" ?hidden="${1===this.selectedView}">
                ${repeat(this.processedBallotItems,e=>e.id,(e,t)=>html$1`
                    <oap-article-item
                      .name="${e.id}"
                      class="ballotAreaItem"
                      .configFromServer="${this.configFromServer}"
                      .language="${this.language}"
                      .inBudgetSelection="${!0}"
                      @goto-selected-id="${this.gotoSelectedId}"
                      .budgetElement="${this.budgetElement}"
                      .ballotElement="${this}"
                      .item="${e}">
                    </oap-article-item>
                  `)}
              </div>
            `:""}

          ${this.budgetElement&&this.budgetElement.selectedItems?html$1`
              <div id="itemContainerFinal" class="itemContainer layout horizontal center-center flex wrap" ?hidden="${0===this.selectedView}">
                <div class="headerContainer">
                  <div class="constitutionFor">${this.localize("constitutionFor")}</div>
                  <div class="countryHeader">${this.country.name}</div>
                </div>
                <div id="submitButtonContainer" class="layout horizontal center-center">
                   <paper-button  id="submitButton" raised  ?disabled="${this.submitDisabled}" class="buttton" @click="${()=>{this.fire("oap-submit-ballot")}}">${this.localize("submitConstitution")}</paper-button>
                </div>
                <div class="finalItems">

                </div>
                ${repeat(this.budgetElement.selectedItems,e=>e.id,(e,t)=>{let i=html$1``;return 0!==t&&this.budgetElement.selectedItems[t-1].module_type_index==e.module_type_index||(i=html$1`
                        <div style="width: 100%;background-color:${this.getModuleColorForItem(e)}" class="flex finalHeader">${this.getModuleTypeName(e.module_content_type)}</div>
                      `),html$1`
                      ${i}
                      <oap-article-item
                        .name="${e.id}"
                        class="ballotAreaItem"
                        .configFromServer="${this.configFromServer}"
                        .language="${this.language}"
                        .budgetElement="${this.budgetElement}"
                        .item="${e}">
                      </oap-article-item>
                    `})}
               <div id="submitButtonContainerTwo" class="layout horizontal center-center">
                 <paper-button id="submitButton" raised  ?disabled="${this.submitDisabled}" class="buttton" @click="${()=>{this.fire("oap-submit-ballot")}}">${this.localize("submitConstitution")}</paper-button>
               </div>

              </div>
            `:""}
        </div>
      `:""}
    `}getModuleTypeName(e){return this.localize(e.toLowerCase().replace("/",""))}processBallotItems(){this.processedBallotItems=[];let e=[],t=null;this.budgetBallotItems.forEach(i=>{if(t&&i.exclusive_ids!=t)if(0<e.length){const i=e[0],r=e.map(e=>({id:e.id,name:e.name}));i.exclusiveOptions=r,this.processedBallotItems.push(i),e=[],t=null}else console.warn("Unexpected state of lastExclusiveSeries");i.exclusive_ids?(e.push(i),t=i.exclusive_ids):this.processedBallotItems.push(i)})}gotoSelectedId(e){this.selectedView=1,setTimeout(()=>{this._scrollItemIntoView(e.detail,!0)},150)}selectTabAndScroll(e){this.selectedView=e,document.body.scrollTop=0,document.documentElement.scrollTop=0}getModuleColorForItem(e){return this.configFromServer.client_config.moduleTypeColorLookup[e.module_content_type]}choicePointsAtZero(){this.selectTabAndScroll(1)}updated(e){super.updated(e),e.has("areaIdRoutePath")&&this.areaIdRoutePath&&("completePostingOfVoteAfterRedirect"===this.areaIdRoutePath?this.completeIfAuthenticatedVote():this.areaId=this.areaIdRoutePath),e.has("budgetBallotItems")&&this.budgetBallotItems&&this.processBallotItems(),e.has("favoriteItem")&&(this.oldFavoriteItem=e.get("favoriteItem"),!this.favoriteItem&&this.oldFavoriteItem&&this.fire("oav-hide-favorite-item"))}constructor(){super(),this.showMap=!1,this.area={name:"Blah",id:1}}connectedCallback(){super.connectedCallback(),this.reset(),window.appBallot=this,this.fire("oav-set-ballot-element",this)}firstUpdated(){this._setupListeners(),installMediaQueryWatcher$1("(min-width: 1024px)",e=>{this.wide=e}),setTimeout(()=>{this._resetSelected(),setTimeout(()=>{this.setStateOfRemainingItems()},25)},75)}disconnectedCallback(){this._removeListeners()}_setupListeners(){this.addEventListener("oav-toggle-item-in-budget",this._toggleItemInBudget),this.addEventListener("oav-submit-vote",this._postVoteToServer),this.addEventListener("oav-item-selected-in-budget",this._itemSelectedInBudget),this.addEventListener("oav-item-de-selected-from-budget",this._itemDeSelectedFromBudget),this.addEventListener("oap-submit-ballot",this._postVoteToServer),this.addEventListener("oap-set-state-of-remaining-items",()=>{this.setStateOfRemainingItems()})}_removeListeners(){this.removeEventListener("oav-toggle-item-in-budget",this._toggleItemInBudget),this.removeEventListener("oav-submit-vote",this._postVoteToServer),this.removeEventListener("oav-item-selected-in-budget",this._itemSelectedInBudget),this.removeEventListener("oav-item-de-selected-from-budget",this._itemDeSelectedFromBudget),this.removeEventListener("oap-submit-ballot",this._postVoteToServer),this.removeEventListener("oap-set-state-of-remaining-items",()=>{this.setStateOfRemainingItems()})}reset(){console.error("BALLOT reset"),this.budgetElement&&this.budgetElement.reset(),this._resetBallotItems(),this.area={id:1,name:"Hello"},this.favoriteItem=null,this.selectedView=0,this.fire("oav-set-area",{areaName:null,totalChoicePoints:null}),this.usedBonusesAndPenalties||(this.usedBonusesAndPenalties={})}_selectedChanged(e){this.selectedView=parseInt(e.detail.value)}_scrollItemIntoView(e,t){var i=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,r=/Trident.*rv[ :]*11\./.test(navigator.userAgent);let n;n=t?"#itemContainerFinal > oap-article-item":"#itemContainer > oap-article-item",this.shadowRoot.querySelectorAll(n).forEach(function(t){t.name==e&&(i||r?t.scrollIntoView(!1):t.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}),600<window.innerWidth&&t.animate([{transform:"translateX(-3px)",easing:"ease-in"},{transform:"translateX(3px)",easing:"ease-out"},{transform:"translateX(-5px)",easing:"ease-in"},{transform:"translateX(5px)",easing:"ease-out"},{transform:"translateX(-7px)",easing:"ease-in"},{transform:"translateX(7px)",easing:"ease-out"}],{duration:400,iterations:2}))}.bind(this))}_resetBallotItems(){var e=this.$$("#itemContainer");if(e)for(var t,i=0;i<e.children.length;i++)"domRepeat"!=(t=e.children[i]).id&&(t.setNotTooExpensive(),t.removeFromBudget())}_toggleItemInBudget(e){this.budgetElement.toggleBudgetItem(e.detail.item);const t=this.$$("#selectedTab"),i=this.$$("#favTab"),r=this.configFromServer.client_config.moduleTypeColorLookup[e.detail.item.module_content_type],n=window.getComputedStyle?window.getComputedStyle(t,null).getPropertyValue("color"):t.style.color;this.style.setProperty("--oap-active-selection-color",r),this.style.setProperty("--oap-active-selection-original-color",n),t.classList.add("selectedTabAnimation"),setTimeout(()=>{t.classList.remove("selectedTabAnimation")},1400),i.classList.add("favOpacityDown"),setTimeout(()=>{i.classList.remove("favOpacityDown")},770),this.processedBallotItems.find(t=>t.id==e.detail.item.id)||(this.processedBallotItems.unshift(e.detail.item),this.requestUpdate())}getItem(e){let t;for(var i=0;i<this.budgetBallotItems.length;i++)if(this.budgetBallotItems[i].id==e){t=this.budgetBallotItems[i];break}return t}swapOutItem(e,t){for(var i=0;i<this.processedBallotItems.length;i++)if(this.processedBallotItems[i].id==e.id){this.processedBallotItems[i]=t;break}}_itemSelectedInBudget(e){var t=this.$$("#itemContainer");let i;for(var r,n=0;n<t.children.length;n++)if("domRepeat"!=(r=t.children[n]).id&&r.item.id==e.detail.itemId){r.setInBudget();const e=r.item.id;i=r.item,r.classList.add("sendToTop"),setTimeout(()=>{this.removeFromAvailableItems(e),this.requestUpdate()},450);break}setTimeout(()=>{this._checkBonusesAndPenalties(i,"select")},600)}_resetSelected(){for(var e=this.$$("#itemContainer"),t=0;t<e.children.length;t++)e.children[t].selected=null}_resetExclusive(e){setTimeout(()=>{for(var t,i=this.$$("#itemContainer"),r=0;r<i.children.length;r++)t=i.children[r],-1<e.indexOf(t.item.id)&&t.setNotBlockedBy()},50)}addToProcessListIfNeeded(e){this.processedBallotItems.find(t=>t.id==e.id)||(this.processedBallotItems.unshift(e),this.requestUpdate())}removeFromAvailableItems(e){for(var t=0;t<this.processedBallotItems.length;t++)if(this.processedBallotItems[t].id==e){this.processedBallotItems.splice(t,1),console.error("Removed: "+e);break}}_itemDeSelectedFromBudget(e){var t=this.$$("#itemContainerFinal");for(var i,r=0;r<t.children.length;r++)if("DIV"!=(i=t.children[r]).tagName&&i.item.id==e.detail.itemId){i.item.exclusive_ids&&this._resetExclusive(i.item.exclusive_ids.split(",")),i.removeFromBudget(),this.fire("oav-reset-favorite-icon-position");break}this.requestUpdate()}_checkBonusesAndPenalties(e,t){let i=GetBonusesAndPenaltiesForItem(e,this.country).bonusesAndPenalties,r=0,n=[];if(0<i.length){let e="";i.forEach(t=>{const i=t.id+t.type+t.value+t.attitute+t.level;if(this.usedBonusesAndPenalties[i])console.warn("Trying to use bonus again: "+i);else{if(this.usedBonusesAndPenalties[i]=!0,this.fire("oap-usedBonusesAndPenalties-changed",this.usedBonusesAndPenalties),"bonus"===t.type){this.budgetElement.totalChoicePoints+=t.value;let e=GetEmojiFromAttitute(t.attitute);-1<!n.indexOf(e)&&n.push(e),r+=t.value}else if("penalty"===t.type){const e=this.budgetElement.totalChoicePoints-t.value-this.budgetElement.usedChoicePoints;this.budgetElement.totalChoicePoints-=0<=e?t.value:t.value+e,r-=t.value;let i=GetEmojiFromAttitute(t.attitute);-1<!n.indexOf(i)&&n.push(i)}e+='<span style="font-size: 17px;">',e+="<span "+("penalty"==t.type?'style="color: red;"':'style="color: green;"')+"><b>"+this.localize(t.type)+"</b>: "+t.value+" <em>"+this.localize(t.attitute)+'</em> </span><span style="padding-left:1px;padding-bottom:8px;padding-top:8px;">'+GetEmojiFromAttitute(t.attitute)+"</span><br>"}}),0<e.length&&0!=r&&(this.fire("oap-open-snackbar",e),setTimeout(()=>{this.budgetElement.bonusPenalty3dText(r,n[0])}))}}async setStateOfRemainingItems(e,t){await new Promise(t=>setTimeout(t,e||125));var i=this.budgetElement.totalChoicePoints-this.budgetElement.usedChoicePoints,r=this.$$("#itemContainer");if(r){const e=this.budgetElement.selectedItems.map(e=>e.id);for(var n=0;n<r.children.length;n++){await new Promise(e=>setTimeout(e,t||5));var a=r.children[n];a?a.selected||(a.item.exclusive_ids&&0<a.item.exclusive_ids.length&&a.item.exclusive_ids.split(",").forEach(t=>{const i=e.indexOf(t);-1<i&&a.setBlockedBy({name:this.budgetElement.selectedItems[i].name,id:this.budgetElement.selectedItems[i].id})}),a.item.price<=i?a.setNotTooExpensive():a.setTooExpensive()):(console.error("NO LIST ITEM"),this.setStateOfRemainingItems())}}else console.warn("Trying to setStateOfItems with no listItems")}_postVoteToServer(){this.budgetElement.selectedItems&&0<this.budgetElement.selectedItems.length?this.completePostingOfVote(this._createB64Votes()):(this.fire("oav-error",this.localize("error_no_items_selected")),console.error("error_no_items_selected"))}_createB64Votes(){return btoa(encodeURIComponent(JSON.stringify({items:this.budgetElement.selectedItems,country:this.country})).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))}_createEncryptedVotes(){var e=this.budgetElement.selectedItems.map(e=>e.id);return encryptVote(this.votePublicKey,{selectedItemIds:e,favoriteItemId:this.favoriteItem?this.favoriteItem.id:null})}completePostingOfVote(e){if(this.area&&this.area.id){if(e)return fetch("/constitutions/post_constitution",{method:"POST",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({encrypted_vote:e,area_id:this.area.id})}).then(e=>e.json()).then(e=>{e&&!0===e.constitution_ok?(this.savedConstitutionId=e.constitution_id,this.fire("oap-submit-ballot-for-review",this.savedConstitutionId)):this.fire("oav-error",this.localize("error_could_not_post_vote"))});this.fire("oav-error",this.localize("error_encryption")),console.error("No encrypted votes!")}else this.fire("oav-error",this.localize("error_could_not_post_vote")),console.warn("Not sending as no area id")}_setVotingCompleted(){this.reset(),this.areaId=null;const e="/voting-completed";window.history.pushState({},null,e),this.fire("location-changed",e);var t=document.querySelector("oap-app").getDialog("authDialog");t&&t.close()}completeIfAuthenticatedVote(){fetch("/constitutions/is_vote_authenticated",{credentials:"same-origin"}).then(e=>e.json()).then(e=>{e&&!0===e.vote_ok?(this._setVotingCompleted(),this.activity("completed","voting")):this.fire("oav-error",this.localize("error_could_not_post_vote"))})}_getSamlUrlWithLanguage(){var e=this.configFromServer.auth_url;return"en"==this.language?e+="&siteLanguage=en":"pl"==this.language&&(e+="&siteLanguage=pl"),e}shuffle(e){for(let t=e.length-1;0<t;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}}window.customElements.define("oap-ballot",OapBallot);const Oap3DBudgetStyles=css`
  :host {
    width: 100%;
    display: block;
    background-color: #000 !important;
  }

  .topLevel[wide] {
  }

  .budgetContainer {
  }

  .budgetContainer[wide] {
  }

  @media (max-width: 1100px) {
    .budgetContainer {
    }
  }

  .headerContainer {
  }

  .budgetMaterial {
    background-color: var(--app-budget-material-background-color, rgba(249,249,249,1.0));
    height: 200px;
    margin: 0px 0px 0px 0px;
    margin-right: auto;
    margin-left: auto;
  }

  .budgetMaterial[wide] {
    width: 940px;
    height: 200px;
    margin-top: 24px;
  }

  #votes {
    background-color: var(--app-budget-votes-background-color, #f0f0f0);
    height: 81px;
  }

  #votes[wide] {
    width: 940px;
    height: 100px;
  }

  .budgetRuler {
    background-color: var(--app-budget-ruler-background-color, #f0f0f0);
    color: var(--app-budget-ruler-color, #111);
    font-size: 14px;
    padding: 4px;
    padding-right: 8x;
    padding-left: 8px;
  }

  .budgetRuler[wide] {
    font-size: 18px;
    padding: 8px;
    padding-right: 16px;
    padding-left: 16px;
  }

  .budgetHeader {
    background-color: var(--app-budget-header-background-color, #FFF);
    color: var(--app-budget-header-color, #000);
    font-size: 26px;
    padding: 12px;
  }

  .info {
    background-color: var(--app-budget-info-background-color, rgba(249,249,249,1.0));
    color: var(--app-budget-info-color, #111);
    padding: 4px;
    font-size: 12px;
  }

  .info[wide] {
    padding: 8px;
    font-size: 19px;
  }

  paper-button.voteButton {
    background-color: var(--app-accent-color);
    color: var(--app-budget-vote-button-color, #FFF);
    margin: 8px;
    margin-right: 4px;
  }

  paper-button[disabled] {
    background-color: #bbb;
  }

  .selectedInfo {
    font-size: 12px;
  }

  .selectedInfo[wide] {
    font-size: 19px;
  }

  #budgetLeftInfo {
    font-size: 13px;
    font-weight: bold;
    margin-top: 4px;
  }

  #budgetLeftInfo[wide] {
    font-size: 19px;
    font-weight: bold;
    z-index: 100000;
  }

  #budgetLeftInfo[no-selection] {
    padding-top: 28px;
  }

  .noItemsInfo {
    color: var(--app-budget-noitemsinfo-color, #555);
    font-size: 14px;
    padding-left: 8px;
    padding-right: 8px;
    margin-left: auto;
    margin-right: auto;
    padding-top: 32px
  }

  .noItemsInfo[wide] {
    font-size: 24px;
  }

  .itemInBudget {
    border-left: solid 3px;
    border-left-color: var(--app-accent-color);
  }

  .headerLogo {
    width:  90px;
    height: 90px;
    padding: 0;
    margin: 0;
    margin-left: 16px;
    -moz-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: FlipH;
    -ms-filter: "FlipH";
  }

  @media (max-width: 1024px) {
    .headerLogo {
      width: 55px;
      height: 55px;
      margin-left: 16px;
    }
  }

  @media (max-width: 420px) {
    .headerLogo {
      width: 50px;
      height: 50px;
      margin-left: 8px;
    }
  }

  .headerContainer {
    background-color: var(--app-budget-header-container-background-color, #FFF);
    color: var(--app-budget-vote-button-color, #222)
  }

  .demoButton {
    background-color: var(--app-accent-color);
    color: #fff;
    width: 30px;
    height: 30px;
    padding: 5px;
    margin-left: 8px;
    margin-right: 8px;
  }

  .onOfferText {
    color: var(--app-accent-color);
    margin-right: 12px;
    font-weight: bold;
  }

  paper-toast {
    font-size: 17px;
    height: 80px;
    padding-bottom: 8px;
  }

  paper-toast[wide] {
    font-size: 25px;
    height: 108px;
  }

  .mobileActionIcons {
    color: #555;
    width: 42px;
    height: 42px;
    margin: 0;
    padding: 0;
    margin-top: 5px;
    margin-right: 5px;
  }

  [hidden] {
    display: none !important;
  }

  .mobileBudgetText {
    margin-top: 6px;
  }

  .budgetText {
    margin-top: 4px;
  }
`;var oap3dBudgetStyles={Oap3DBudgetStyles:Oap3DBudgetStyles};class Oap3dBudget extends OapBaseElement{static get properties(){return{selectedItems:{type:Array},noSelectedItems:{type:Boolean},areaName:{type:String},usedChoicePoints:{type:Number},totalChoicePoints:{type:Number},choicePointsLeft:{type:Number},usedChoicePointsIsOne:{type:Boolean},votesWidth:{type:Number},wide:{type:Boolean},mediumWide:{type:Boolean},mini:{type:Boolean},orientationPortrait:{type:Boolean},orientationLandscape:{type:Boolean},currentBallot:Object,budgetHeaderImage:{type:String},showExit:Boolean,configFromServer:Object}}setupScene(){const e=this.votesWidth,t=.023*e;this.scene=new Scene,this.camera=new PerspectiveCamera(30,e/200,1,1e4),this.camera.position.set(t,-.7,22),this.defaultCameraPos=JSON.parse(JSON.stringify(this.camera.position)),this.defaultCameraRot=JSON.parse(JSON.stringify(this.camera.rotation)),this.camera.layers.enable(1),this.renderer=new WebGLRenderer({antialias:!0}),this.renderer.setSize(e,200),this.renderer.setClearColor(0),this.renderer.setPixelRatio(window.devicePixelRatio),this.directionalLight=new DirectionalLight(16777215,.65),this.directionalLight.position.setScalar(100),this.scene.add(this.directionalLight),this.ambientLight=new AmbientLight(16777215,.27),this.scene.add(this.ambientLight);const i=new RenderPass(this.scene,this.camera),r=new ShaderPass(FXAAShader);r.uniforms.resolution.value.set(1/e,.005);const n=new UnrealBloomPass(new Vector2(e,200),1.5,.4,.85);n.threshold=.22,n.strength=1.3,n.radius=.5,n.renderToScreen=!0,this.composer=new EffectComposer(this.renderer),this.composer.setSize(e,200),this.composer.addPass(i),this.composer.addPass(r),this.composer.addPass(n),this.renderer.gammaInput=!0,this.renderer.gammaOutput=!0,this.renderer.toneMappingExposure=Math.pow(.9,4),this.$$("#mainMaterial").appendChild(this.renderer.domElement),this.budgetGroup3d=new Object3D,this.scene.add(this.budgetGroup3d),this.defaultGroupPos=JSON.parse(JSON.stringify(this.budgetGroup3d.position)),this.defaultGroupRot=JSON.parse(JSON.stringify(this.budgetGroup3d.rotation));var a=new FontLoader;this.font3d?this.rebuildChoicePoints(!0):a.load("https://open-active-policy-public.s3-eu-west-1.amazonaws.com/helvetiker_regular.typeface.json",function(e){this.font3d=e,this.rebuildChoicePoints(!0)}.bind(this)),this.renderScene()}getLeftOfCamera(){let e;e=450>window.innerWidth?8:950>window.innerWidth?-8:-16;var t=this.camera.fov/180*Math.PI/2,i=this.camera.position.distanceTo(this.scene.position);return-(Math.tan(t)*i*this.camera.aspect+e)}rebuild3dEmoji(e,t,i){let r;r=450>window.innerWidth?-13:950>window.innerWidth?-15:-17,this.bonusPenaltyEmoji2D=Get2DEmoji(e,"120px Arial"),this.bonusPenaltyEmoji2D.position.x=r,this.bonusPenaltyEmoji2D.position.y=1,this.bonusPenaltyEmoji2D.position.z=0}bonusPenalty3dText(e,t){if(0!=e&&(this.rotateAllItemsGroup(),this.font3d)){let i,r=!1,n=!1;0<e?n=!0:0>e&&(r=!0),i=Math.abs(e).toString();let a=GetTextGeometry(i,this.font3d,{large:!1});const o=.07*this.votesWidth;let s;s=0<e?65280:16711680;let l=100,c=10;600>window.innerWidth&&(l=36,c=20);let h=Math.random(),u=Math.random();h=.7,u=.9,this.bonusMaterial=new MeshStandardMaterial({color:s,roughness:h,metalness:u,side:DoubleSide}),this.bonusPenaltyFontTween&&(this.bonusPenaltyFontTween.stop(),this.bonusPenaltyGroup.position.x=this.getLeftOfCamera()),null==this.bonusPenaltyGroup?(this.bonusPenaltyFontMesh=new Mesh(a,this.bonusMaterial),this.bonusPenaltyFontMesh.position.x=0,this.bonusPenaltyFontMesh.position.y=-1.5,this.bonusPenaltyFontMesh.position.z=0,this.bonusPenaltyFontMesh.remove(this.bonusPenaltyEmoji2D),this.rebuild3dEmoji(t,o,l),this.bonusPenaltyFontMesh.add(this.bonusPenaltyEmoji2D),this.bonusPenaltyGroup=new Group,this.bonusPenaltyGroup.add(this.bonusPenaltyFontMesh),this.bonusPenaltyGroup.position.x=this.getLeftOfCamera(),this.bonusPenaltyGroup.position.y=1,this.bonusPenaltyGroup.position.z=-10,this.scene.add(this.bonusPenaltyGroup)):(this.bonusPenaltyFontMesh.material.color.set(s),this.bonusPenaltyFontMesh.geometry=a,this.bonusPenaltyFontMesh.remove(this.bonusPenaltyEmoji2D),this.rebuild3dEmoji(t,o,l),this.bonusPenaltyFontMesh.add(this.bonusPenaltyEmoji2D),this.bonusPenaltyFontMesh.material=this.bonusMaterial);let d=600<window.innerWidth?1:.63;r?(this.minusMesh||(this.minusMesh=new Mesh(GetTextGeometry("-",this.font3d,{large:!1}),this.bonusMaterial),this.minusMesh.position.x=0,this.minusMesh.position.y=-1.5,this.minusMesh.position.z=0,this.bonusPenaltyGroup.add(this.minusMesh)),this.minusMesh.position.x=9<e?-9.5*d:-5.5*d,this.minusMesh.visible=!0,this.minusMesh.material.color.set(16711680)):this.minusMesh&&(this.minusMesh.visible=!1,this.minusMesh.material.color.set(16711680)),n?(this.plusMesh||(this.plusMesh=new Mesh(GetTextGeometry("+",this.font3d,{large:!1}),this.bonusMaterial),this.plusMesh.position.y=-1.5,this.plusMesh.position.z=0,this.bonusPenaltyGroup.add(this.plusMesh)),this.plusMesh.position.x=9<e?-9.5*d:-6.5*d,this.plusMesh.visible=!0,this.plusMesh.material.color.set(65280)):this.plusMesh&&(this.plusMesh.visible=!1,this.plusMesh.material.color.set(65280)),this.bonusPenaltyGroup.visible=!0,this.cameraSpotLight?this.cameraSpotLight.visible=!0:(this.cameraSpotLight=new SpotLight(16777215,.5),this.cameraSpotLight.position.copy(this.camera.position),this.cameraSpotLight.target=this.bonusPenaltyGroup,this.cameraSpotLight.angle=.55,this.cameraSpotLight.penumbra=.52,this.cameraSpotLight.distance=260,this.scene.add(this.cameraSpotLight)),this.bonusPenaltyFontRotation&&(this.bonusPenaltyFontRotation.stop(),this.bonusPenaltyFontMesh.rotation.y=0),this.fontMesh.material.color.set(s),setTimeout(()=>{this.bonusPenaltyFontTween=new Tween(this.bonusPenaltyGroup.position).to({x:o+c,y:this.bonusPenaltyGroup.position.y,z:this.bonusPenaltyGroup.position.z},2500).delay(0).on("complete",()=>{this.bonusPenaltyGroup.position.x=this.getLeftOfCamera(),this.bonusPenaltyGroup.position.z=-10,this.bonusPenaltyFontTween=null,this.fontMesh.material.color.set(this.defaultChoicePointsColor),this.scene.remove(this.cameraSpotLight),this.cameraSpotLight.visible=!1,this.bonusPenaltyGroup.visible=!1,this.plusMesh&&(this.plusMesh.visible=!1),this.minusMesh&&(this.minusMesh.visible=!1)}).start()})}}rebuildChoicePoints(e){if(null!=this.choicePointsLeft&&this.font3d){let t=Math.random(),i=Math.random();if(.8<t&&.8<i&&(t=Math.random(),i=Math.random()),t=.7,i=.7,this.choicePointsMaterial=new MeshStandardMaterial({color:this.defaultChoicePointsColor,roughness:t,metalness:i,side:DoubleSide}),null==this.fontMesh){this.fontMesh=new Mesh(GetTextGeometry(this.choicePointsLeft.toString(),this.font3d,{large:!0}),this.choicePointsMaterial);const e=.076*this.votesWidth;this.fontMesh.position.y=0,this.fontMesh.position.z=-33,600>window.innerWidth?(this.fontMesh.position.x=e-2,this.fontMesh.position.z=-50):1e3>window.innerWidth?this.fontMesh.position.x=e-4.8:this.fontMesh.position.x=e,this.fontMesh.rotation.x=0,this.fontMesh.rotation.y=2*Math.PI,this.fontMesh.add(this.cpMesh),this.scene.add(this.fontMesh)}else this.fontMesh.material=this.choicePointsMaterial,this.fontMesh.geometry=GetTextGeometry(this.choicePointsLeft.toString(),this.font3d,{large:!0});600<window.innerWidth||this.choicePointsLeft;if(99<this.choicePointsLeft||this.choicePointsLeft,75>this.choicePointsLeft||e){let e=750;40>this.choicePointsLeft&&(e=600),20>this.choicePointsLeft&&(e=300),this.fontMeshTweenRotation&&(this.fontMeshTweenRotation.stop(),this.fontMeshTweenRotation=null,this.fontMesh.rotation.y=0),this.fontMeshTweenRotation=new Tween(this.fontMesh.rotation).to({y:"-"+this.fontMesh.rotation.y+2*Math.PI},e).delay(0).on("complete",()=>{this.fontMesh.rotation.y=0}).start()}}}renderScene(){update(),this.renderer.autoClear=!1,this.renderer.clear(),this.camera.layers.set(1),this.composer.render(),this.renderer.clearDepth(),this.camera.layers.set(0),this.renderer.render(this.scene,this.camera),requestAnimationFrame(this.renderScene.bind(this)),this.cameraSpotLight&&this.bonusPenaltyGroup&&(this.cameraSpotLight.target=this.bonusPenaltyGroup)}animateVector3(e,t,i){i=i||{};var r=t||Vector3(),n=i.easing||Easing.Quadratic.In,a=i.duration||2e3;return new Tween(e).to({x:r.x,y:r.y,z:r.z},a).easing(n).on("complete",()=>{i.callback&&i.callback()}).start()}connectedCallback(){super.connectedCallback(),this.fire("oav-set-budget-element",this)}updated(e){if(e.has("usedChoicePoints")&&(this.usedChoicePointsIsOne=this.usedChoicePoints&&1===this.usedChoicePoints,this.fire("oap-selected-budget-updated",this.usedChoicePoints)),e.has("selectedItems")&&(this._selectedItemsChanged(),this.fire("oap-selected-items-changed",this.selectedItems)),e.has("choicePointsLeft")&&(this.rebuildChoicePoints(),0==this.choicePointsLeft&&this.currentBallot.choicePointsAtZero()),e.has("totalChoicePoints")&&(this.fire("oap-total-choice-points-changed",this.totalChoicePoints),0<this.itemsInScene.length&&this.totalChoicePoints!=e.get("totalChoicePoints"))){console.error(this.totalChoicePoints+" "+e.get("totalChoicePoints")),this.resetItemsWidth(),e.get("totalChoicePoints")<this.totalChoicePoints&&this.fire("oap-play-sound-effect","oap_short_win_1")}if(e.has("usedChoicePoints")&&this.fire("oap-used-choice-points-changed",this.usedChoicePoints),e.has("usedChoicePoints")||e.has("totalChoicePoints")){console.error("Used "+this.usedChoicePoints+" of "+this.totalChoicePoints);var t=this.totalChoicePoints-this.usedChoicePoints;this.choicePointsLeft=0<t?t:0,this.currentBallot&&this.currentBallot.currentBudget?this.currentBallot.setStateOfRemainingItems():setTimeout(()=>{this.currentBallot?this.currentBallot.setStateOfRemainingItems():setTimeout(()=>{this.currentBallot.setStateOfRemainingItems()},100)},10)}super.updated(e)}static get styles(){return[Oap3DBudgetStyles,OapShadowStyles,OapFlexLayout]}render(){return html$1`
      <div class="budgetContainer center-center" ?wide="${this.wide}">
        <div id="mainMaterial" class="budgetMaterial shadow-elevation-24dp" ?wide="${this.wide}">
        </div>
      </div>
    `}firstUpdated(){this.reset(),this.resetWidth(),this.setupScene(),this.resetWidthAnd3DItems(),this.rebuildChoicePoints(),installMediaQueryWatcher("(min-width: 1024px)",e=>{this.wide=!!e,this.resetWidthAnd3DItems()}),installMediaQueryWatcher("(orientation: portrait)",e=>{this.orientationPortrait=!!e,this.resetWidthAnd3DItems()}),installMediaQueryWatcher("(orientation: landscape)",e=>{this.orientationLandscape=!!e,this.resetWidthAnd3DItems()}),installMediaQueryWatcher("(min-width: 640px)",e=>{this.mediumWide=!!e,this.resetWidthAnd3DItems()}),installMediaQueryWatcher("(max-width: 340px)",e=>{this.mini=!!e,this.resetWidthAnd3DItems()})}constructor(){super(),this.defaultChoicePointsColor=15395562}_exit(){this.fire("oav-exit")}_help(){this.fire("oap-open-help")}_closeToast(){this.$$("#toast").active=!1}resetWidth(){this.wide?this.votesWidth=940:this.votesWidth=window.innerWidth}resetWidthAnd3DItems(){console.error("resetWidthAnd3DItems"),this.resetWidth(),this.itemsInScene&&0<this.itemsInScene.length&&this.itemsInScene.forEach(e=>{this.scene.remove(e.object)}),this.selectedItems.forEach(function(e){this._addItemToDiv(e)}.bind(this))}_millionWord(){return this.wide?this.localize("million"):this.localize("million_short")}_submitVote(){this.activity("click","submitVote"),this.currentBallot.fire("oav-submit-vote")}_selectedItemsChanged(){this.selectedItems&&0<this.selectedItems.length?(this.noSelectedItems=!1,this.$$("#votingButton")&&(this.$$("#votingButton").disabled=!1)):(this.noSelectedItems=!0,this.$$("#votingButton")&&(this.$$("#votingButton").disabled=!0))}reset(){this.selectedItems||(this.selectedItems=[]),this.fontGeometryCache={},this.itemsInScene=[],this.cameraSpotLight=null,this.budgetGroup3d=null,this.choicePointsLeft=this.totalChoicePoints-this.usedChoicePoints,this.budgetHeaderImage=this.configFromServer.client_config.ballotBudgetLogo}_removeItemFromArray(e){var t=[];this.selectedItems.forEach(function(i){i.id!=e.id&&t.push(i)}),this.selectedItems=t}_addItemToDiv(e){var t=parseInt(this.votesWidth*(e.price/this.totalChoicePoints));this.wide||(t-=1),this.wide;const i=this.configFromServer.client_config.moduleTypeColorLookup[e.module_content_type];let r;r=600<=window.innerWidth?.039:.0315;var n=new Mesh(new BoxGeometry(t*=r,5,5),new MeshBasicMaterial({color:i,transparent:!0,opacity:1,wireframe:!1}));n.layers.enable(1),n.position.x=50,n.position.z=-40,setTimeout(()=>{this.budgetGroup3d.add(n),this.itemsInScene.push({id:e.id,object:n,width:t,item:e}),this.positionItems()},30),10<this.itemsInScene.length&&setTimeout(()=>{},300)}resetItemsWidth(){this.itemsInScene.forEach(e=>{let t,i=parseInt(this.votesWidth*(e.item.price/this.totalChoicePoints));if(i*=t=600<=window.innerWidth?.039:.0315,e.width!=i){var r=new BoxGeometry(i,5,5);e.object.geometry.dispose(),e.object.geometry=r}e.width=i}),this.positionItems()}positionItems(){let e=0;this.itemsInScene.sort((e,t)=>e.item.module_type_index-t.item.module_type_index).forEach((t,i)=>{let r;const n=new Vector3;(new Box3).setFromObject(t.object).getSize(n),r=n.x;const a=e+r/2,o=new Vector3(a,0,0);Math.floor(100*Math.random());t.positionTween&&(t.positionTween.stop(),t.positionTween=null),t.positionTween=new Tween(t.object.position).to(o,500).easing(Easing.Quadratic.InOut).on("complete",()=>{t.positionTween=null}).start(),e=a+r/2})}rotateAllItems(){this.moveBudgetGroupBack(),this.itemsInScene.forEach((e,t)=>{const i=e.object.rotation.x+Math.PI;e.tween=new Tween(e.object.rotation).to({x:"-"+i},650).delay(0).on("complete",()=>{Math.abs(e.object.rotation.y)>=2*Math.PI&&(e.object.rotation.y=e.object.rotation.y%(2*Math.PI)),e.object.rotation.y=0,e.tween.stop(),e.tween=null}).start()})}rotateAllItemsGroup(){this.moveBudgetGroupBack(),setTimeout(()=>{if(!this.budgetGroup3d.runningRotateX){const e=this.budgetGroup3d.rotation.x+Math.PI;this.budgetGroup3d.runningRotateX=new Tween(this.budgetGroup3d.rotation).to({x:"-"+e},650).delay(0).on("complete",()=>{this.budgetGroup3d.rotation.x=0,this.budgetGroup3d.runningRotateX=null}).start()}},1900)}rotateTimeShift(){this.itemsInScene.forEach((e,t)=>{let i;if(i=30<this.itemsInScene.length?Math.floor(5*Math.random()):20<this.itemsInScene.length?Math.floor(4*Math.random()):10<this.itemsInScene.length?Math.floor(3*Math.random()):Math.floor(2*Math.random()),!e.tween&&0==i){const t=e.object.rotation.x+Math.PI;e.tween=new Tween(e.object.rotation).to({x:"-"+t},900).delay(0).on("complete",()=>{e.object.rotation.x=0,Math.abs(e.object.rotation.y)>=2*Math.PI&&(e.object.rotation.y=e.object.rotation.y%(2*Math.PI)),e.tween.stop(),e.tween=null}).start()}})}moveBudgetGroupBack(){this.itemsInScene.length,this.defaultGroupPos.x,this.defaultGroupPos.x;this.budgetGroup3d.runningMoveX&&(this.budgetGroup3d.runningMoveX.stop(),this.budgetGroup3d.runningMoveX=null),this.budgetGroup3d.runningMoveXTwo&&(this.budgetGroup3d.runningMoveXTwo.stop(),this.budgetGroup3d.runningMoveXTwo=null),this.budgetGroup3d.runningMoveX=new Tween(this.budgetGroup3d.position).to({x:this.budgetGroup3d.position.x,y:this.budgetGroup3d.position.y,z:-15},350).delay(0).easing(Easing.Quadratic.InOut).on("complete",()=>{this.budgetGroup3d.runningMoveX=null,this.budgetGroup3d.runningMoveXTwo=new Tween(this.budgetGroup3d.position).to({x:this.defaultGroupPos.x,y:this.defaultGroupPos.y,z:this.defaultGroupPos.z},1150).delay(1200).easing(Easing.Quadratic.InOut).on("complete",()=>{this.budgetGroup3d.runningMoveX=null,this.budgetGroup3d.runningMoveXTwo=null}).start()}).start()}rotateBudgetGroupBack(){const e=this.budgetGroup3d.rotation.z+Math.PI;this.budgetGroup3d.runningRotY||(this.budgetGroup3d.runningRotY=new Tween(this.budgetGroup3d.rotation).to({y:"-"+e},420).delay(0).easing(Easing.Quadratic.InOut).on("complete",()=>{this.budgetGroup3d.rotation.y=0,this.budgetGroup3d.runningRotY=null}).start())}moveCameraCloseAndBack(){const e=10<this.itemsInScene.length?this.defaultCameraPos.x-.1*this.defaultCameraPos.x:this.defaultCameraPos.x-.2*this.defaultCameraPos.x;new Tween(this.camera.position).to({x:e,y:this.camera.position.y,z:18},350).delay(0).easing(Easing.Quadratic.InOut).on("complete",()=>{new Tween(this.camera.position).to({x:this.defaultCameraPos.x,y:this.defaultCameraPos.y,z:this.defaultCameraPos.z},650).delay(1100).easing(Easing.Quadratic.InOut).on("complete",()=>{}).start()}).start()}_removeItemFromDiv(e){this.itemsInScene.forEach((t,i)=>{t.id==e.id&&(this.itemsInScene.splice(i,1),this.budgetGroup3d.remove(t.object),this.positionItems())})}getItemLeftTop(e){var t=this.$$("#item_id_"+e.id);if(t){var i=t.getBoundingClientRect(),r=(i.right-i.left)/2+i.left,n=(i.bottom-i.top)/2+i.top;return this.wide?(r-=24,n-=24):(r-=18,n-=18),{left:r,top:n}}console.error("Trying to get item that is not in the budget")}toggleBudgetItem(e){this.activity("toggle","vote"),-1<this.selectedItems.indexOf(e)?(this.activity("remove","vote"),this._removeItemFromArray(e),this._removeItemFromDiv(e),this.selectedItems=this.selectedItems.sort((e,t)=>e.module_type_index-t.module_type_index),this.selectedItems=[...this.selectedItems],this.usedChoicePoints=this.usedChoicePoints-e.price,this.currentBallot.fire("oav-item-de-selected-from-budget",{itemId:e.id})):this.usedChoicePoints+e.price<=this.totalChoicePoints?(this.activity("add","vote"),this.selectedItems.push(e),this.selectedItems=this.selectedItems.sort((e,t)=>e.module_type_index-t.module_type_index),this.selectedItems=[...this.selectedItems],this._addItemToDiv(e),this.usedChoicePoints=this.usedChoicePoints+e.price,this.currentBallot.fire("oav-item-selected-in-budget",{itemId:e.id})):this.currentBallot.fire("oav-error",this.localize("error_does_not_fit_in_budget"))}toggleFavoriteItem(e){this.activity("toggle","favorite"),this.favoriteItem!=e&&(e?this.activity("add","favorite"):this.activity("remove","favorite"),this.favoriteItem=e)}_removeItem(e){this.selectedItems.forEach(function(t){t.id==e&&this.toggleBudgetItem(t)}.bind(this))}convertDots(e){return e.replace(".",",")}}window.customElements.define("oap-3d-budget",Oap3dBudget);const OapReviewStyles=css`

  :host {
    width: 100%;
    height: 100%;
  }

  .weakItem {
    font-style: italic;
    font-weight: bold;
  }

  .finalItems {
    flex-flow: column wrap; /* Shorthand  you could use flex-direction: column and flex-wrap: wrap instead */
    justify-content: flex-start;
    align-items: flex-start;
    display: flex;
    margin: 0 auto;
  }

  .header {
    font-size: 24px;
    margin-top: 16px;
    margin-bottom: 16px;
    font-weight: bold;
    background-color: var(--app-country-header-background-color, #000);
    color: var(--app-country-header-color, #FFF);
    max-width: 100%;
    margin-left: 0;
    margin-right: 0;
    padding-top: 2px;
    text-align: center;
  }

  .lastHeader {
    margin-top: 0;
    padding-bottom: 8px;
  }

  .finalHeader {
    padding: 8px;
    font-size: 24px;
    margin: 8px;
    text-align: center;
    color: #FFF;
    font-weight: bold;
    margin-bottom: 12px;
    margin-top: 12px;
  }

  .subHeader {
    font-size: 20px;
    margin-top: 16px;
    margin-bottom: 4px;
    font-weight: bold;
  }

  oap-article-item {
    outline: 0px;
    transition: all 1s ease-in-out;
    -webkit-transition: all 750ms ease-in-out;
    -moz-transition: all 750ms ease-in-out;
    -o-transition: all 750ms ease-in-out;
    -ms-transition: all 750ms ease-in-out;
  }

  .countryHeader {
    font-size: 22px;
    font-weight: bold;
    text-align: center;
    margin-bottom: 4px;
    margin-top: 8px;
  }

  #retryButton {
    background-color: #FFF;
    color: #000;
    margin-top: 4px;
  }

  .subHeader.noBottom {
    margin-bottom: 0;
  }

  .mainArea {
    max-width: 600px;
    width: 600px;
  }

  .topContainer {
    background-color: #000;
    color: #FFF;
    padding: 16px;
    padding-bottom: 24px;
    margin-left: auto;
    margin-right: auto;
  }

  .flexRow {
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;

    flex-wrap: wrap;
    -ms-flex-wrap: wrap;
    -webkit-flex-wrap: wrap;

    -ms-flex-direction: row;
    -webkit-flex-direction: row;
    flex-direction: row;

    width: 100%;
    margin-top: 24px;
    margin-bottom: 8px;
  }

  .basicInfo {
    padding-top: 24px;
  }

  .column {
    margin-left: 16px;
    margin-right: 16px;
    padding-left: 8px;
    padding-right: 8px;
  }

  paper-button {
    background-color: #000;
    color: #FFF;
    border: 1px solid #FFF;
    margin-left: auto;
    margin-right: auto;
    margin-top: 24px;
  }

  paper-button[disabled] {
    background-color: #888;
  }

  .sliderHeader {
    margin-top: 12px;
    font-size: 18px;
  }

  .sliderHeader {
    font-size: 18px;
  }

  .rawStats {
    margin-top: 24px;
  }

  .emoji {
    margin-right: 8px;
    margin-left: 0;
    font-size: 42px;
    margin-bottom: 0;
    padding-bottom: 0;
  }

  .attituteHeader {
    font-size: 20px;
  }

  .attituteReview {
    margin-bottom: 24px;
    margin-top: 4px;
  }

  .emojiResources {
    margin-left: 8px;
    margin-right: 8px;
  }

  paper-input {
    padding-left: 16px;
    padding-right: 16px;
    color: #000;
    --paper-input-container-color: #000;
    --paper-input-container-focus-color: #000;
    --paper-input-container-input-color: #000;
  }

  paper-textarea {
    padding-left: 16px;
    padding-right: 16px;
    --paper-input-container-color: #000;
    --paper-input-container-focus-color: #000;
    --paper-input-container-input-color: #000;
    color: #000;
  }

  paper-slider {
    --paper-slider-container-color: #333;
    --paper-slider-active-color: var(--app-create-country-slider-active-color, #333);
    --paper-slider-knob-color: var(--app-create-country-slider-active-color, #333);
    --paper-slider-font-color: var(--app-create-country-slider-active-color, #333);
    color: #333;
    --paper-input-container-color:  var(--app-create-country-slider-active-color, #333);
    --paper-input-container-focus-color: var(--app-create-country-slider-active-color, #333);
    --paper-input-container-input-color: var(--app-create-country-slider-active-color, #333);
    --paper-slider-disabled-active-color:  var(--app-create-country-slider-active-color, #333);
    --paper-input-disabled-color:  var(--app-create-country-slider-active-color, #333);
    --paper-slider-disabled-knob-color: var(--app-create-country-slider-active-color, #333);
    --paper-slider-secondary-color: : var(--app-create-country-slider-active-color, #333);
    --paper-slider-height: 2px;
  }

  .dropDownContainer {
    margin-left: 16px;
    margin-right: 16px;
  }

  paper-dropdown-menu {
    --paper-input-container-color:  var(--app-create-country-slider-active-color, #fff);
    --paper-input-container-focus-color: var(--app-create-country-slider-active-color, #fff);
    --paper-input-container-input-color: var(--app-create-country-slider-active-color, #fff);
    --paper-slider-disabled-active-color:  var(--app-create-country-slider-active-color, #fff);
    --paper-input-disabled-color:  var(--app-create-country-slider-active-color, #fff);
    --paper-input-container-input: {
      font-size: 30px;
    };
    --paper-dropdown-menu-input: {
      --paper-input-container-input: {
        font-size: 30px;
      }
    }
    color: #FFF;
    width: 100%;
  }

  .nextToTop {
    background-color: #fff;
    color: #000;
    padding: 16px;
    padding-bottom: 24px;
    border-radius: 8px;
  }

  .attituteSlider {
    width: 240px;
  }

  .cultural {
    margin-top: 24px;
    margin-bottom: 8px !important;
  }

  .cultRow {
    margin-top: 0;
  }

  .welcomeLogo {
    max-width: 120px;
    max-height: 120px;
    width: 120px;
    height: 120px;
    margin-left: auto;
    margin-right: auto;
    text-align: center;
  }

  @media (max-width: 600px) {
    .topContainer {
      max-width: 100%;
      margin-left: 8px;
      margin-right: 8px;
      width: 100%;
      height: 100%;
      margin-bottom: 32px;
      padding-top: 32px;
    }

  .mainArea {
    max-width: 100%;
    width: 100%;
  }


    paper-input {
      max-width: 300px;
    }

    paper-textarea {
      max-width: 300px;
    }

    .attituteSlider {
      width: 100%;
    }

    paper-slider {
      width: 100%;
    }

    .cultural {
      margin-top: 32px;
    }

    .header {
      font-size: 20px;
    }
  }


  [hidden] {
    display: none !important;
  }
`;var oapReviewStyles={OapReviewStyles:OapReviewStyles};class OapReview extends OapPageViewElement{static get properties(){return{country:Object,customCountry:Boolean,submitDisabled:Boolean,selectedItems:Array,allItems:Array,configFromServer:Object,attituteReviewParagraphs:Object,countryReviewParagraph:String,completionScore:Object,isConstitutionViable:Boolean,debugText:String}}static get styles(){return[OapReviewStyles,OapFlexLayout,OapShadowStyles]}constructor(){super(),this.reset()}reset(){this.customCountry=null,this.submitDisabled=!0,this.isConstitutionViable=!0}getModuleColorForItem(e){return this.configFromServer.client_config.moduleTypeColorLookup[e.module_content_type]}render(){return html$1`
    <div class=" vertical center-center">
      <div class="topContainer shadow-animation shadow-elevation-3dp">
        <div class="welcomeLogoContainer layout center-center">
          <img aria-label="welcome/velkomin" class="welcomeLogo" src="${this.configFromServer.client_config.ballotBudgetLogo}"></img>
        </div>

        <div class="layout-inline vertical center-center">
          <div class="header">${this.localize("reviewOfYourConstitution")}</div>

          ${this.attituteReviewParagraphs?html$1`
            <div class="hiddenDiv nextToTop mainArea" style="margin-left: auto;margin-right:auto;">

              <div class="countryHeader">${this.country.name}</div>
              <div class="basicInformationDescription">${this.country.description}</div>

              ${this.isConstitutionViable?"":html$1`
                <div class="notViable ">
                  <div class="subHeader">${this.localize("yourConstitutionIsNotViableHeader")}</div>
                  <div>${this.localize("yourConstitutionIsNotViable")}</div>
                  <div>
                    ${Object.keys(this.completionScore).map(e=>"weak"==this.completionScore[e].status?html$1`<div class="weakItem">${this.completionScore[e].name}</div>`:html$1``)}
                  </div>

                  <div id="submitButtonContainerTwo" class="layout horizontal center-center">
                   <paper-button id="retryButton" raised class="" @click="${()=>{this.fire("oap-reset-select-articles")}}">${this.localize("retrySelectingArticles")}</paper-button>
                 </div>

                </div>
              `}

              <div class="subHeader" ?hidden="${!this.countryReviewParagraph}">
                ${this.localize("overallCountryReview")}
              </div>

              <div class="countryReview" ?hidden="${!this.countryReviewParagraph}">${this.countryReviewParagraph}</div>

              <div class="subHeader cultural">
                ${this.localize("culturalAttitudeReviews")}
                <paper-icon-button icon="help-outline" @click="${this.culturalHelp}"></paper-icon-button>
              </div>

              <div id="culturalAttitudes" class="flexRow cultRow">
                <div class="attituteHeader"><span class="emoji"></span>${this.localize("science")}</div>
                <div class="attituteReview">${this.attituteReviewParagraphs.science}</div>

                <div class="attituteHeader"><span class="emoji"></span>${this.localize("collective")}</div>
                <div class="attituteReview">${this.attituteReviewParagraphs.collective}</div>

                <div class="attituteHeader"><span class="emoji"></span>${this.localize("privacy")}</div>
                <div class="attituteReview">${this.attituteReviewParagraphs.privacy}</div>

                <div class="attituteHeader"><span class="emoji"></span>${this.localize("progressivism")}</div>
                <div class="attituteReview">${this.attituteReviewParagraphs.progressivism}</div>

                <div class="attituteHeader"><span class="emoji"></span>${this.localize("liberty")}</div>
                <div class="attituteReview">${this.attituteReviewParagraphs.liberty}</div>

                <div class="attituteHeader"><span class="emoji"></span>${this.localize("tradition")}</div>
                <div class="attituteReview">${this.attituteReviewParagraphs.tradition}</div>

                <div class="attituteHeader"><span class="emoji"></span>${this.localize("independence")}</div>
                <div class="attituteReview">${this.attituteReviewParagraphs.independence}</div>

                <div class="attituteHeader"><span class="emoji"></span>${this.localize("lawAndOrder")}</div>
                <div class="attituteReview">${this.attituteReviewParagraphs.lawAndOrder}</div>
              </div>

              <div class="" style="width:100%;text-align: center;">
                <div style="margin-left:auto;margin-right:auto;">
                  <div class="subHeader">
                    ${this.localize("shareOnSocialMedia")}
                  </div>

                  <div>
                    <paper-share-button class="shareIcon" horizontal-align="left" id="shareButton"
                      facebook twitter popup .url="${window.location.href}">
                    </paper-share-button>
                  </div>
                </div>
              </div>
          `:html$1``}
        </div>
      </div>

      ${!0===this.configFromServer.mechDebug?html$1`
        <div class="topContainer">
         <pre>${this.debugText}</pre><br>
         <div>${JSON.stringify(this.completionScore)}</div>
        </div>
      `:html$1``}

      <div class="topContainer">
        <div class="header lastHeader">${this.localize("finalSelection")}</div>
        <div class="finaslItems">
          ${repeat(this.selectedItems,e=>e.id,(e,t)=>{let i=html$1``;return 0!==t&&this.selectedItems[t-1].module_type_index==e.module_type_index||(i=html$1`
                  <div style="width: 100%;background-color:${this.getModuleColorForItem(e)}" class="flex finalHeader">${this.getModuleTypeName(e.module_content_type)}</div>
                `),html$1`
                ${i}
                <oap-article-item
                  .name="${e.id}"
                  class="ballotAreaItem"
                  .selected="${!0}"
                  .hideClose="${!0}"
                  .onlyDisplay="${!0}"
                  .configFromServer="${this.configFromServer}"
                  .language="${this.language}"
                  .budgetElement="${this.budgetElement}"
                  .item="${e}">
                </oap-article-item>
              `})}
        </div>

      </div>
    </div>
   `}getModuleTypeName(e){return this.localize(e.toLowerCase().replace("/",""))}culturalHelp(){let e;e=this.configFromServer.client_config.helpPageLocales[this.language]?this.b64DecodeUnicode(this.configFromServer.client_config.cultureHelpPageLocales[this.language].b64text):this.configFromServer.client_config.helpPageLocales.en?this.b64DecodeUnicode(this.configFromServer.client_config.cultureHelpPageLocales.en.b64text):"No help page found for selected language!",this.fire("oap-open-help",e)}b64DecodeUnicode(e){return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}updated(e){if(super.updated(e),e.has("selectedItems")&&this.selectedItems){const e=this.configFromServer.client_config.languages[this.language].attituteReviews,t=GetResultsForReview(this.selectedItems,this.allItems,this.country,e);this.attituteReviewParagraphs=t.attituteReviewParagraphs,this.countryReviewParagraph=t.countryReviewParagraph,this.completionScore=t.completionScore,this.isConstitutionViable=t.isConstitutionViable,this.debugText=t.debugText,window.history.pushState(null,"",window.location.href),window.onpopstate=function(){window.history.pushState(null,"",window.location.href)}}}}async function cacheDataImages(e){if(e){await new Promise(e=>setTimeout(e,100));for(let t=0;t<e.length;t++){(new Image).src=e[t].image_url,await new Promise(e=>setTimeout(e,750))}}}async function cacheSoundEffects(e){if(e){const t=Object.values(e);for(let e=0;e<t.length;e++)t[e].audio=new Audio(t[e].url),t[e].audio.volume=t[e].volume,await new Promise(e=>setTimeout(e,750))}}window.customElements.define("oap-review",OapReview);class OapApp extends OapBaseElement{static get properties(){return{appTitle:{type:String},_page:{type:String},_drawerOpened:{type:Boolean},_snackbarOpened:{type:Boolean},_offline:{type:Boolean},_subPath:{type:String},favoriteIcon:{type:String,value:"star"},dialogHeading:{type:String,value:""},activityHost:{type:String,value:""},setupDefaults:{type:Boolean,value:!1},votePublicKey:{type:String},configFromServer:{type:Object,value:null},requestInProgress:{type:Boolean,value:!1},title:{type:String},showExit:{type:Boolean,value:!1},hideBudget:{type:Boolean,value:!0},areaName:String,currentBallot:Object,currentBudget:Object,budgetElement:Object,totalBudget:Number,haveSetLanguage:{type:Boolean,value:!1},resizeTimer:Object,postsHost:String,welcomeHeading:String,welcomeText:String,helpContent:String,masterHelpContent:String,wideAndBallot:Boolean,errorText:String,languageOveride:String,filteredItems:Array,selectedItems:Array,quizQuestions:Array,totalChoicePoints:Number,usedChoicePoints:Number,snackBarContent:String,country:Object,debouncedSave:Object,usedBonusesAndPenalties:Object,savedGameDate:String,disableAutoSave:Boolean,font3d:Object,openMasterDialog:String,masterDialogCloseFunction:Function}}static get styles(){return[OapAppStyles,OapFlexLayout]}render(){let e=html$1`
      <paper-dialog id="errorDialog">
        <p id="errorText">${this.errorText}</p>
        <div class="buttons">
          <paper-button class="generalButton" dialog-confirm autofocus @click="${this.resetErrorText}">OK</paper-button>
        </div>
      </paper-dialog>
    `;return html$1`${this.configFromServer?html$1`
        ${e}

        ${!0===this.configFromServer.client_config.insecureEmailLoginEnabled?html$1`
            <oav-insecure-email-login
              .language="${this.language}"
              .configFromServer="${this.configFromServer}"
              id="insecureEmailLogin">
            </oav-insecure-email-login>
          `:html$1``}
        <paper-dialog id="helpDialog" @close="${this.helpClosed}">
          <paper-dialog-scrollable>
            <div id="helpContent">
              ${unsafeHTML(this.helpContent)}
            </div>
          </paper-dialog-scrollable>
          <div class="buttons">
            <paper-button class="closeButton generalButton" dialog-dismiss>${this.localize("close")}</paper-button>
          </div>
        </paper-dialog>

        <paper-dialog id="savedGameDialog" modal>
          <div class="masterLogoContainer center-center">
             <img aria-label="welcome/velkomin" class="welcomeLogo" src="${this.configFromServer.client_config.ballotBudgetLogo}"></img>
          </div>
          <div class="savedGameContent">
            ${this.localize("youHaveAnAutoSavedGameFrom")} ${this.savedGameDate}
          </div>
          <div class="saveButtons">
            <paper-button class="savedGameButton"" @click="${this.restoreGameFromSave}" dialog-dismiss>${this.localize("reloadSavedGame")}</paper-button>
            <paper-button class="savedGameButton"  @click="${this.openNewGame}">${this.localize("newGame")}</paper-button>
          </div>
        </paper-dialog>

        <paper-dialog id="masterDialog" modal @close="${this.masterDialogCloseFunction}">
          <paper-dialog-scrollable>
            ${this.masterDialogContent}
          </paper-dialog-scrollable>
        </paper-dialog>

        <app-header fixed effects="waterfall" ?wide-and-ballot="${this.wideAndBallot}" ?hidden="${"areas-ballot"==this._page}">
          <app-toolbar class="toolbar-top">
            <div ?hidden="${!this.showExit}" class="layout horizontal exitIconInBudget">
              <paper-icon-button class="closeButton" alt="${this.localize("close")}" icon="closeExit" @click="${this._exit}"></paper-icon-button>
            </div>
            <div class="helpIconInBudget">
              <paper-icon-button icon="help-outline" alt="${this.localize("help")}" @click="${this._help}}"></paper-icon-button>
            </div>
            ${"area-ballot"===this._page?html$1`
              <div class="budgetConstainer layout horizontal center-center">
                <oap-3d-budget
                  id="budget"
                  .areaName="${this.areaName}"
                  .language="${this.language}"
                  .selectedItems="${this.selectedItems}"
                  .showExit="${this.showExit}"
                  .font3d="${this.font3d}"
                  .usedChoicePoints="${this.usedChoicePoints}"
                  .totalChoicePoints="${this.totalChoicePoints}"
                  .configFromServer="${this.configFromServer}"
                  .currentBallot="${this.currentBallot}">
                </oap-3d-budget>
              </div>
            `:html$1``}
          </app-toolbar>
          <iron-icon id="favoriteIcon" icon="${this.favoriteIcon}" hidden></iron-icon>
        </app-header>

        <main role="main" class="main-content" ?has-ballot="${"area-ballot"==this._page}">
          ${"create-country"===this._page?html$1`
            <oap-country-creation
              id="createCountry"
              .configFromServer="${this.configFromServer}"
              .nickname="Robert Bjarnason"
              .language="${this.language}"
              class="page"
              ?active="${"create-country"===this._page}">
            </oap-country-creation>
            `:html$1``}
          ${this.quizQuestions&&"quiz"===this._page?html$1`
            <oap-policy-quiz
              id="quiz"
              .questions="${this.quizQuestions}"
              .configFromServer="${this.configFromServer}"
              .nickname="Robert Bjarnason"
              .language="${this.language}"
              .font3d="${this.font3d}"
              .totalChoicePoints="${this.totalChoicePoints}"
              class="page"
              ?active="${this.quizQuestions&&"quiz"===this._page}">
            </oap-policy-quiz>
          `:html$1``}
          ${"filter-articles"===this._page?html$1`
            <oap-filter-articles id="filterArticles"
              .language="${this.language}"
              .configFromServer="${this.configFromServer}"
              class="page"
              .selectedItems="${this.selectedItems}"
              .filteredItems="${this.filteredItems}"
              .country="${this.country}"
              .allItems="${this.allItems}"
              ?active="${"filter-articles"===this._page}">
            </oap-filter-articles>
          `:html$1``}
          ${"area-ballot"===this._page?html$1`
            <oap-ballot id="budgetBallot"
              .budgetBallotItems="${this.filteredItems}"
              .configFromServer="${this.configFromServer}"
              .budgetElement="${this.currentBudget}"
              .language="${this.language}"
              .country="${this.country}"
              .usedBonusesAndPenalties="${this.usedBonusesAndPenalties}"
              class="page"
              ?active="${"area-ballot"===this._page}">
            </oap-ballot>
          `:html$1``}
          ${"article-selection"===this._page?html$1`
            <oap-article-selection
              .configFromServer="${this.configFromServer}"
              class="page"
              .language="${this.language}"
              ?active="${"article-selection"===this._page}">
            </oap-article-selection>
          `:html$1``}
          ${"review"===this._page?html$1`
            <oap-review id="review"
              .budgetBallotItems="${this.filteredItems}"
              .configFromServer="${this.configFromServer}"
              .budgetElement="${this.currentBudget}"
              .language="${this.language}"
              .allItems="${this.allItems}"
              .selectedItems="${this.selectedItems}"
              .country="${this.country}"
              class="page"
              ?active="${"review"===this._page}">
            </oap-review>
          `:html$1``}
          ${"post"===this._page?html$1`
            <yp-post
              .id="post"
              .ballotElement="${this.currentBallot}"
              .language="${this.language}"
              .postId="${this._subPath}"
              .host="${this.postsHost}">
            </yp-post>
          `:html$1``}
          <oap-view404 class="page" ?active="${"view404"===this._page}"></oap-view404>
        </main>

        <snack-bar ?active="${this._snackbarOpened}">
          ${unsafeHTML(this.snackBarContent)}
        </snack-bar>
      `:html$1`${e}<paper-spinner active class="largeSpinner"></paper-spinner>`}
    `}getPathVariable(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?null:decodeURIComponent(t[1].replace(/\+/g," "))}constructor(){super(),setPassiveTouchGestures(!0),window.__localizationCache={messages:{}},this.hideBudget=!0,this.disableAutoSave=!0;const e=this.getPathVariable("locale");e&&(this.language=e,localStorage.setItem("languageOverride",e)),this._boot(),this.filteredItems=[],this.selectedItems=[],this.quizDone=!1,this.setDummyData(),this.GAME_STATE_VERSION="OapGameStateV10",localStorage.getItem("oap-have-seen-cultural-attitutes-tutorial-"+this.GAME_STATE_VERSION)&&(this.hasSeenCulturalAttitutesTutorial=!0)}helpClosed(){this.helpContent=this.masterHelpContent}setDummyData(){this.totalChoicePoints=100,this.usedChoicePoints=0,this.soundEffects={oap_short_win_1:{url:"https://open-active-policy-public.s3-eu-west-1.amazonaws.com/make-your-constitution+/soundsFx/oap_short_win_1.mp3",volume:.4},oap_new_level_1:{url:"https://open-active-policy-public.s3-eu-west-1.amazonaws.com/make-your-constitution+/soundsFx/oap_new_level_1.mp3",volume:.1}},cacheSoundEffects(this.soundEffects),window.debugOn&&(this.country={name:"13 Colonies 1783 (US Constitutional Convention)",description:"A rag-tag band of diverse colonies join together to defeat one of the most powerful maritime Empires in the world at that time; shocked at their own victory, they are determined not to have won the War, only to have lost the Peace. They set out to frame a document that will provide for a future free of the tyranny and injustice they had just endured at the hands of Mad King George II. Can you do as good a job as they did, or perhaps even build a more perfect union?",population:"2.7M",geographicalSize:"9.5M",naturalResourceWealth:2,borderDensity:0,hostilityNeighboringCountries:2,barrieresToCitizenship:0,culturalAttitutes:{authority:9,liberty:9,science:9,tradition:5,collective:2,independence:5,privacy:8,lawAndOrder:5,progressivism:2},reviews:{highNetBonuses:"We asked you to understand the needs of punk rock activists, and it turns out you know all about hard core. Fewer rules, more rights -- its hard for The Man to keep you down if his hands are tied behind his back. The anarcho-syndicalists are happy with you and have invited you to join them in the mosh pit!",breakEven:"Well, true activist types are used to receiving compromise and half-measures in response to their demands, and thats what you have given them once again. You have made many concessions in the direction of personal liberty and human rights, while still leaving the State with too much centralized power for the tastes of these hard core citizens. The shards of this Splinter State remain unsatisfied.",highNetPenalties:"The document you created for this brave Splinter State of anarcho-syndicalists would immediately be spray painted, stomped on, and burned in effigy along with a straw dummy of you. Your traditional legal authority and State Power is seen as classic sell-out of everything your citizens stand for. These imaginary radical activists plan to have sit-in protests in your dreams, in a campaign they call Occupy Your Conscience."}})}playSoundEffect(e){const t=this.soundEffects[e.detail];t&&setTimeout(()=>{let e;t.audio?e=t.audio:(e=new Audio(t.url)).volume=t.volume,e.play()})}processCorrectQuizAnswer(){this.fire("oap-play-sound-effect","oap_short_win_1"),this.fire("oap-overlay",{html:html$1`${this.localize("correctAnswer")}`,soundEffect:"",duration:300}),this.totalChoicePoints+=5,this.activity("correct","quizAnswer")}processBonusPoints(e){this.fire("oap-play-sound-effect","oap_short_win_1"),this.totalChoicePoints+=e.detail?e.detail:5,this.activity("bonus","forManualSwiping")}_setupCustomCss(e){e.cssProperties&&e.cssProperties.forEach(e=>{const t=Object.keys(e)[0],i=Object.keys(e).map(function(t){return e[t]})[0];this.shadowRoot.host.style.setProperty(t,i),window.ShadyCSS&&window.ShadyCSS.styleSubtree(this,e)})}selectLocale(e){this.language!=e.target.dataset.locale&&(this.language=e.target.dataset.locale,localStorage.setItem("languageOverride",this.language),"area-ballot"===this._page&&this.currentBallot&&setTimeout(()=>{this.currentBallot.loadArea()},10))}_boot(){localStorage.getItem("languageOverride")?this.language=localStorage.getItem("languageOverride"):this.language="en",this.mechDebug||(this.mechDebug=this.getPathVariable("mechDebug")),fetch("/constitutions/boot?locale="+this.language,{credentials:"same-origin"}).then(e=>e.json()).then(e=>{if(this.requestInProgress=!1,this.votePublicKey=e.public_key,this._setupCustomCss(e.config.client_config),e.config.client_config.languages[this.language]&&(window.localeResources=e.config.client_config.languages[this.language].locales),this.configFromServer=e.config,this.updateAppMeta(this.configFromServer.client_config.shareMetaData),this.configFromServer.client_config.welcomeLocales&&this.configFromServer.client_config.ballotBudgetLogo){(new Image).src=this.configFromServer.client_config.ballotBudgetLogo}if(ga("create",this.configFromServer.client_config.googleAnalyticsId,"auto"),this.postsHost="https://yrpri.org",this.favoriteIcon="heart",this.oneBallotId=1,this.configFromServer.client_config.defaultLanguage)if(localStorage.getItem("languageOverride"))this.language=localStorage.getItem("languageOverride");else if(this.language!=this.configFromServer.client_config.defaultLanguage)return this.language=this.configFromServer.client_config.defaultLanguage,localStorage.setItem("languageOverride",this.language),void this._boot();this.mechDebug&&(this.configFromServer.mechDebug=!0),this.createQuizQuestions(),this.setupLocaleTexts(),this.configFromServer.client_config.favoriteIcon&&(this.favoriteIcon=this.configFromServer.client_config.favoriteIcon),this.setupAllItems(),this.checkForRestoredGameOrWelcome(),window.language=this.language,window.localize=this.localize,setTimeout(()=>{StartPerformCacheWelcomeTexts(this.configFromServer.client_config.languages[this.language].welcomeTexts,this.font3d)},950)}).catch(e=>{console.error("Error:",e),this.fire("oav-error","unknown_error")})}setupAllItems(){const e=this.parseCSV(this.b64DecodeUnicode(this.configFromServer.client_config.languages[this.language].encodedModules));this.allItems=[],e.forEach((e,t)=>{0!==t&&null!=e[0]&&"#REF!"!=e[0]&&""!=e[0]&&this.allItems.push({id:e[0],sub_category:e[1],branch:e[2],name:e[3],description:e[4],module_type:e[5],exclusive_ids:e[6]?e[6].replace(/ /g,""):"",hybrids:e[7],timePeriod:e[8],module_content_type:e[9],module_type_index:parseInt(e[10]),image_url:e[11],price:parseInt(e[12]),bonus:e[13],penalty:e[14],specialFunctions:e[15],blockIds:e[16],enableIds:e[17],comboBonusIds:e[18],authorshipPercent:e[19]})}),cacheDataImages(this.allItems),window.debugOn&&(this.filteredItems=this.allItems)}getRandom(e,t){var i=Array(t),r=e.length,n=Array(r);if(t>r)throw new RangeError("getRandom: more elements taken than available");for(;t--;){var a=Math.floor(Math.random()*r);i[t]=e[a in n?n[a]:a],n[a]=--r in n?n[r]:r}return i}createQuizQuestions(){const e=[];this.parseCSV(this.b64DecodeUnicode(this.configFromServer.client_config.languages[this.language].quizQuestions.b64text)).forEach((t,i)=>{0!==i&&e.push({question:t[1],answers:[t[2],t[3],t[4],t[5]],correctAnswer:parseInt(t[6])-1})}),this.quizQuestions=this.getRandom(e,10)}parseCSV(e){for(var t=[],i=!1,r=0,n=0,a=0;a<e.length;a++){var o=e[a],s=e[a+1];t[r]=t[r]||[],t[r][n]=t[r][n]||"",'"'==o&&i&&'"'==s?(t[r][n]+=o,++a):'"'!=o?","!=o||i?"\r"!=o||"\n"!=s||i?("\n"!=o||i)&&("\r"!=o||i)?t[r][n]+=o:(++r,n=0):(++r,n=0,++a):++n:i=!i}return t}disconnectedCallback(){this._removeListeners()}b64DecodeUnicode(e){return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}_setupListeners(){this.addEventListener("app-resources-loaded",this._transinsecationLoaded),this.addEventListener("oav-set-title",this._setTitle),this.addEventListener("oav-error",this._errorHandler),this.addEventListener("oav-set-area",this._setArea),this.addEventListener("oav-clear-area",this._clearArea),this.addEventListener("oav-set-favorite-item-in-budget",this._toggleFavoriteItem),this.addEventListener("oav-hide-favorite-item",this._hideFavoriteItem),this.addEventListener("oav-exit",this._exit),this.addEventListener("oap-open-help",this._help),this.addEventListener("oap-open-snackbar",this._openSnackBar),this.addEventListener("oap-close-snackbar",this._closeSnackBar),this.addEventListener("oav-set-ballot-element",this._setBallotElement),this.addEventListener("oav-set-budget-element",this._setBudgetElement),this.addEventListener("oav-scroll-item-into-view",this._scrollItemIntoView),this.addEventListener("oav-insecure-email-login",this._insecureEmailLogin),window.addEventListener("resize",this.resetSizeWithDelay.bind(this)),this.addEventListener("location-changed",this._locationChanged),this.addEventListener("oap-process-correct-quiz-answer",this.processCorrectQuizAnswer),this.addEventListener("oap-quiz-finished",this.quizFinished),this.addEventListener("oap-filtering-finished",this.filteringFinished),this.addEventListener("item-selected",this.addItemToFinalList),this.addEventListener("oap-play-sound-effect",this.playSoundEffect),this.addEventListener("oap-country-created",this.createCountryFinished),this.addEventListener("oap-set-total-budget",this.setTotalBudget),this.addEventListener("oap-submit-ballot-for-review",this.submitBallot),this.addEventListener("oap-bonus-points",this.processBonusPoints),this.addEventListener("oap-set-3d-font",this.set3dFont),this.addEventListener("oap-filtered-items-changed",this.filteredItemsChanged),this.addEventListener("oap-selected-items-changed",this.selectedItemsChanged),this.addEventListener("oap-used-choice-points-changed",this.usedChoicePointsChanged),this.addEventListener("oap-total-choice-points-changed",this.totalChoicePointsChanged),this.addEventListener("oap-usedBonusesAndPenalties-changed",this.usedBonusesAndPenaltiesChanged),this.addEventListener("oap-reset-all-items",this.resetAllItems),this.addEventListener("oap-start-cultural-attitutes-tutorial",this.startCulturalAttitutesTutorial),this.addEventListener("oap-open-filter-info-dialog",this.openFilterInfoDialog),this.addEventListener("oap-open-selection-info-dialog",this.openSelectionInfoDialog),this.addEventListener("oap-open-article-item",this.openArticleItem),this.addEventListener("oap-close-master-dialog",this.closeMasterDialog),this.addEventListener("oap-reset-select-articles",this.resetSelectArticles)}_removeListeners(){this.removeEventListener("app-resources-loaded",this._translationLoaded),this.removeEventListener("oav-set-title",this._setTitle),this.removeEventListener("oav-error",this._errorHandler),this.removeEventListener("oav-set-area",this._setArea),this.removeEventListener("oav-clear-area",this._clearArea),this.removeEventListener("oav-set-area",this._setArea),this.removeEventListener("location-changed",this._locationChanged),this.removeEventListener("oav-set-favorite-item-in-budget",this._toggleFavoriteItem),this.removeEventListener("oav-hide-favorite-item",this._hideFavoriteItem),this.removeEventListener("oav-exit",this._exit),this.removeEventListener("oav-set-ballot-element",this._setBallotElement),this.removeEventListener("oav-set-budget-element",this._setBudgetElement),this.removeEventListener("oap-open-help",this._help),this.removeEventListener("oav-scroll-item-into-view",this._scrollItemIntoView),window.removeEventListener("resize",this.resetSizeWithDelay),this.removeEventListener("oav-insecure-email-login",this._insecureEmailLogin),this.removeEventListener("oap-process-correct-quiz-answer",this.processCorrectQuizAnswer),this.removeEventListener("oap-quiz-finished",this.quizFinished),this.removeEventListener("oap-country-created",this.createCountryFinished),this.removeEventListener("item-selected",this.addItemToFinalList),this.removeEventListener("oap-filtering-finished",this.filteringFinished),this.removeEventListener("oap-play-sound-effect",this.playSoundEffect),this.removeEventListener("oap-open-snackbar",this._openSnackBar),this.removeEventListener("oap-set-total-budget",this.setTotalBudget),this.removeEventListener("oap-close-snackbar",this._closeSnackBar),this.removeEventListener("oap-submit-ballot-for-review",this.submitBallot),this.removeEventListener("oap-bonus-points",this.processBonusPoints),this.removeEventListener("oap-set-3d-font",this.set3dFont),this.removeEventListener("oap-filtered-items-changed",this.filteredItemsChanged),this.removeEventListener("oap-selected-items-changed",this.selectedItemsChanged),this.removeEventListener("oap-used-choice-points-changed",this.usedChoicePointsChanged),this.removeEventListener("oap-total-choice-points-changed",this.totalChoicePointsChanged),this.removeEventListener("oap-usedBonusesAndPenalties-changed",this.usedBonusesAndPenaltiesChanged),this.removeEventListener("oap-reset-all-items",this.resetAllItems),this.removeEventListener("oap-start-cultural-attitutes-tutorial",this.startCulturalAttitutesTutorial),this.removeEventListener("oap-open-filter-info-dialog",this.openFilterInfoDialog),this.removeEventListener("oap-open-selection-info-dialog",this.openSelectionInfoDialog),this.removeEventListener("oap-open-article-item",this.openArticleItem),this.removeEventListener("oap-reset-select-articles",this.resetSelectArticles),this.removeEventListener("oap-close-master-dialog",this.closeMasterDialog)}closeMasterDialog(){this.$$("#masterDialog").close()}resetSelectArticles(){this.selectedItems=[],this.savedChoicePoints&&(this.totalChoicePoints=this.savedChoicePoints,this.usedChoicePoints=0),this.filteredItems=JSON.parse(JSON.stringify(this.filteredItems));const e="/area-ballot/1";window.history.pushState({},null,e),this.fire("location-changed",e),this.requestUpdate(),this.activity("resetSelectArticles","ballot")}usedBonusesAndPenaltiesChanged(e){this.usedBonusesAndPenalties=e.detail,this.saveDebounced()}totalChoicePointsChanged(e){this.totalChoicePoints=e.detail,this.saveDebounced()}usedChoicePointsChanged(e){this.usedChoicePoints=e.detail,console.error("Used choice points:",this.usedChoicePoints),this.saveDebounced()}filteredItemsChanged(e){this.filteredItems=e.detail,this.saveDebounced()}selectedItemsChanged(e){this.selectedItems=e.detail,this.saveDebounced()}set3dFont(e){this.font3d=e.detail}submitBallot(e){this.fire("oap-play-sound-effect","oap_new_level_1");const t="/review/"+e.detail;window.history.pushState({},null,t),this.fire("location-changed",t),this.activity("finished","ballot")}addItemToFinalList(e){e.detail?this.filteredItems.push(e.detail):console.error("Can't find item to add to final list")}resetAllItems(){console.error("resetAllItems"),this.filteredItems=[],this.selectedItems=[]}_setBallotElement(e){this.currentBallot=e.detail}_setBudgetElement(e){setTimeout(()=>{this.currentBudget=e.detail},5)}filteringFinished(){this.fire("oap-play-sound-effect","oap_new_level_1"),this.savedChoicePoints=this.totalChoicePoints,SetForceSlowOnFontCaching();const e="/area-ballot/1";window.history.pushState({},null,e),this.fire("location-changed",e),this.activity("finished","filtering")}quizFinished(){this.quizDone=!0,this.fire("oap-play-sound-effect","oap_new_level_1");const e="/create-country";window.history.pushState({},null,e),this.fire("location-changed",e),this.activity("finished","quiz"),this._startDelayedCaching(),this.openCountrySelectInfoDialog()}createCountryFinished(e){this.fire("oap-play-sound-effect","oap_new_level_1");const t="/filter-articles";window.history.pushState({},null,t),this.fire("location-changed",t),this.activity("finished","createCountry"),this.country=e.detail,this.saveDebounced()}_scrollItemIntoView(e){this.$$("#budgetBallot")._scrollItemIntoView(e.detail)}_help(e){e.detail&&"1"!=e.detail&&(this.helpContent=e.detail),this.$$("#helpDialog").open()}_setArea(e){this.areaName=e.detail.areaName,this.totalBudget=e.detail.totalBudget}_clearArea(){this.areaName=null,this.totalBudget=null}_errorHandler(e){this.errorText=this.localize(e.detail),this.$$("#errorDialog").open()}_exit(){"post"===this._page&&window.appLastArea?(window.history.pushState({},null,window.appLastArea),this.fire("location-changed",window.appLastArea),window.appLastArea=null):(window.history.pushState({},null,"/"),this.fire("location-changed","/"))}_setTitle(e,t){}resetSizeWithDelay(){clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(()=>{},250)}_translationLoaded(){if(!this.haveSetLanguage&&(this.haveSetLanguage=!0,"undefined"!=typeof Storage)){var e=localStorage.getItem("selectedLanguage");e&&this.fire("iron-signal",{name:"set-language",data:e})}}closeWelcome(){this.$$("#masterDialog").close(),localStorage.setItem("haveClosedWelcome",!0),this.afterWelcomeClose()}getDialog(e){return this.$$("#"+e)}firstUpdated(){super.firstUpdated(),this._setupListeners(),installRouter(e=>this._locationChanged(e)),installOfflineWatcher(e=>this._offlineChanged(e)),installMediaQueryWatcher$1("(min-width: 460px)",e=>this._layoutChanged(e)),installMediaQueryWatcher$1("(min-width: 1024px)",e=>{this.wide=e,this.wideAndBallot=this.wide&&"area-ballot"===this._page}),(new FontLoader).load("https://open-active-policy-public.s3-eu-west-1.amazonaws.com/helvetiker_regular.typeface.json",function(e){this.font3d=e}.bind(this)),this.shadowRoot.setAttribute("--iron-overlay-backdrop-opacity",1)}afterWelcomeClose(){setTimeout(()=>{"quiz"===this._page&&this.$$("#quiz")&&this.$$("#quiz").startIntro()})}getHelpContent(){return this.configFromServer.client_config.languages[this.language]&&this.configFromServer.client_config.languages[this.language].helpPageLocales?this.b64DecodeUnicode(this.configFromServer.client_config.languages[this.language].helpPageLocales.b64text):"No help page found for selected language!"}getWelcomeHeading(){return this.configFromServer.client_config.languages[this.language]&&this.configFromServer.client_config.languages[this.language].welcomeLocales?this.configFromServer.client_config.languages[this.language].welcomeLocales.heading:"No heading found"}getWelcomeText(){return this.configFromServer.client_config.languages[this.language].welcomeLocales?this.configFromServer.client_config.languages[this.language].welcomeLocales.text:this.configFromServer.client_config.welcomeLocales.en?this.configFromServer.client_config.welcomeLocales.en.text:"No heading found"}setupLocaleTexts(){this.welcomeHeading=this.getWelcomeHeading(),this.welcomeText=this.getWelcomeText(),this.masterHelpContent=this.helpContent=this.getHelpContent()}updateAppMeta(e){document.title=e.title,updateMetadata({title:e.title,description:e.description,image:e.shareImageUrl});var t=document.querySelector("link[rel*='icon']")||document.createElement("link");t.type="image/x-icon",t.rel="shortcut icon",t.href=e.faviconUrl,document.getElementsByTagName("head")[0].appendChild(t)}saveDebounced(){this.debouncedSave||this.disableAutoSave?this.disableAutoSave&&console.warn("Autosaved is disabled"):this.debouncedSave=setTimeout(()=>{localStorage.setItem(this.GAME_STATE_VERSION,JSON.stringify({path:window.decodeURIComponent(location.pathname),page:this._page,totalChoicePoints:this.totalChoicePoints,usedChoicePoints:this.usedChoicePoints,selectedItems:this.selectedItems,filteredItems:this.filteredItems,savedChoicePoints:this.savedChoicePoints,quizDone:this.quizDone,dateSaved:new Date,country:this.country,usedBonusesAndPenalties:this.usedBonusesAndPenalties})),this.debouncedSave=null,console.info("Have autosaved game")},5e3)}checkForRestoredGameOrWelcome(){setTimeout(()=>{let e=localStorage.getItem(this.GAME_STATE_VERSION);if(null!=e){e=JSON.parse(e),this.$$("#savedGameDialog").open();const t=new Date(e.dateSaved);this.savedGameDate=t.toISOString().slice(0,10)}else this.disableAutoSave=!1,window.debugOn||this.openWelcomeDialog()})}openArticleItem(e){const t=e.detail;this.masterDialogCloseFunction=null,this.masterDialogContent=html$1`
    <div style="margin-bottom: 24px;" @click="${()=>{this.$$("#masterDialog").close()}}" >
      <oap-article-item .item="${t}" .onlyDisplay="${!0}" .selected="${!0}"></oap-article-item>
    </div>
   `,this.openAndUpdateDialog(!0)}_startDelayedCaching(e){setTimeout(()=>{CacheEmojisInBackground([""],"120px Arial",e),CacheEmojisInBackground(["","","","","","","","","","","","",""],"120px Arial",e)},500),setTimeout(()=>{StartDelayedFontCaching(this.font3d,e)},1100)}openNewGame(){this.$$("#savedGameDialog").close(),this.disableAutoSave=!1,localStorage.removeItem(this.GAME_STATE_VERSION),1==!window.debugOn&&(this.totalChoicePoints=100,this.usedChoicePoints=0,this.selectedItems=[],this.quizDone=!1,this.country=null,this.filteredItems=[],this.usedBonusesAndPenalties=[]),this.afterWelcomeClose()}restoreGameFromSave(){let e=localStorage.getItem(this.GAME_STATE_VERSION);null!=e?(e=JSON.parse(e),this.totalChoicePoints=e.totalChoicePoints,this.usedChoicePoints=e.usedChoicePoints,this.selectedItems=e.selectedItems,this.country=e.country,this.savedChoicePoints=e.savedChoicePoints,this.quizDone=e.quizDone,this.filteredItems=e.filteredItems,this.usedBonusesAndPenalties=e.usedBonusesAndPenalties,setTimeout(()=>{this.disableAutoSave=!1,this._gotoLocation(e.path)}),"quiz"!=e.page&&("area-ballot"==e.page?this._startDelayedCaching({slow:!0}):this._startDelayedCaching())):console.error("Trying to restore game state, not valid state")}updated(e){if(super.updated(e),e.has("language")&&this.setupLocaleTexts(),(e.has("totalChoicePoints")||e.has("usedChoicePoints")||e.has("selectedItems")||e.has("country")||e.has("usedBonusesAndPenalties")||e.has("_page"))&&this.saveDebounced(),e.has("budgetElement"),e.has("_page")){document.body.scrollTop=0,document.documentElement.scrollTop=0,console.info("Current page: "+this._page);this.appTitle,this._page;const t=this._page,i=e.get("_page");this.configFromServer&&this.configFromServer.client_config.landingPageData&&t&&"select-voting-area"!=t?this.showExit=!0:this.showExit=!1,this.hideBudget=!t||"area-ballot"!=t,"post"==i&&this.$$("#post")&&this.$$("#post").reset(),"voting-completed"==t&&"area-ballot"!=i&&(window.location="/"),"quiz"===t||this.quizDone||window.debugOn?window.debugOn||("area-ballot"===t&&0===this.filteredItems.length&&null==this.country?(window.history.pushState({},null,"/create-country"),this.fire("location-changed","/create-country")):"area-ballot"===t&&0===this.filteredItems.length&&(window.history.pushState({},null,"/filter-articles"),this.fire("location-changed","/filter-articles")),"filter-articles"===t&&null==this.country&&(window.history.pushState({},null,"/create-country"),this.fire("location-changed","/create-country")),"review"===t&&0===this.selectedItems.length&&0===this.filteredItems.length&&null==this.country?(window.history.pushState({},null,"/create-country"),this.fire("location-changed","/create-country")):"area-ballot"===t&&0===this.selectedItems.length&&0===this.filteredItems.length?(window.history.pushState({},null,"/filter-articles"),this.fire("location-changed","/filter-articles")):"area-ballot"===t&&0===this.selectedItems.length&&(window.history.pushState({},null,"/area-ballot/1"),this.fire("location-changed","/area-ballot/1")),"review"===t&&null==this.country&&(window.history.pushState({},null,"/create-country"),this.fire("location-changed","/create-country"))):(window.history.pushState({},null,"/quiz"),this.fire("location-changed","/quiz")),t&&"function"==typeof ga&&ga("send","pageview",{page:location.pathname+location.search+location.hash}),this.wideAndBallot=this.wide&&"area-ballot"===t}}_layoutChanged(e){}_offlineChanged(e){this._offline;this._offline=e}_openSnackBar(e){setTimeout(()=>{clearTimeout(this.__snackbarTimer),this._snackbarOpened=!0,this.snackBarContent=e.detail,this.__snackbarTimer=setTimeout(()=>{this._snackbarOpened=!1,this.snackBarContent=null},5e3)})}_closeSnackBar(e){clearTimeout(this.__snackbarTimer),this._snackbarOpened=!1}_gotoLocation(e){window.history.pushState({},null,e),this.fire("location-changed",e)}_locationChanged(e){e instanceof CustomEvent&&(e={pathname:e.detail}),"/"===e.pathname&&this._gotoLocation("/quiz");const t=window.decodeURIComponent(e.pathname),i="/"===t?"/":t.slice(1).split("/")[0];this._loadPage(i),t.slice(1).split("/")[1]&&(this._subPath=t.slice(1).split("/")[1])}_loadPage(e){switch(e){case"post":import("./yp-post/yp-post.js").then(e=>e&&e.$ypPost||{});break;case"area-ballot":case"voting-completed":case"filter-articles":case"create-country":case"quiz":case"review":case"/":break;default:e="view404",import("./oap-view404.js").then(e=>e&&e.$oapView404||{})}this._page=e}_menuButtonClicked(){this._updateDrawerState(!0)}_drawerOpenedChanged(e){this._updateDrawerState(e.target.opened)}openWelcomeDialog(){this.masterDialogCloseFunction=this.openChoicePointsDialog,this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center">
        <img aria-label="welcome/velkomin" width="200" height="200" class="welcomeLogo" src="${this.configFromServer.client_config.ballotBudgetLogo}"></img>
      </div>
      <div class="vertical center-center masterDialog">
        <div class="heading">${this.welcomeHeading}</div>
          <div class="horizontal welcomeText">
            ${this.welcomeText}
          </div>
          <div class="langSelectionText">
            ${1<Object.keys(this.configFromServer.client_config.localeSetup).length?html$1`
                  ${this.configFromServer.client_config.localeSetup.map(e=>html$1`
                      <span class="langSelect" data-locale="${e.locale}" ?is-selected="${e.locale===this.language}"
                        @click="${this.selectLocale}">${e.language}</span>
                    `)}
              `:html$1``}
        </div>
        <div class="center-center buttons">
          <paper-button raised class="continueButton" @click="${this.openChoicePointsDialog}" autofocus>${this.localize("next")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}openChoicePointsDialog(){this.masterDialogCloseFunction=this.openQuizDialog;let e=null;"en"==this.language?e=html$1`
        <div class="heading headingNoImage">Choice Points</div>
        <div class="horizontal welcomeText">
          Choice Points are the game term for your political capital, the juice you have to get this constitution written. You will need to spend your points wisely as you choose articles and civil rights in your constitution; you will get bonuses and penalties to your Choice Points for how well the constitution you write fits the desires of your citizens.
        </div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading headingNoImage">Valstig</div>
        <div class="horizontal welcomeText">
          Valstig er nafni  plitsku aumagni  sjnum sem  hefur til a koma stjrnarskrnni inni saman.  arft a verja stigunum num skynsamlega egar  velur stjnarskrrkvi og au rttindi sem stjrnarskrin  a innihalda.  fr verlauna- og refsistig sem btast vi ea dragast fr valstigunum num eftir v hversu vel r tekst a lta stjrnarskrna falla a skum flksins  landinu sem  hefur vali ea bi til.
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" @click="${this.openQuizDialog}" autofocus>${this.localize("next")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}openQuizDialog(){this.masterDialogCloseFunction=this.closeWelcome;let e=null;"en"==this.language?e=html$1`
        <div class="heading headingNoImage">Quiz</div>
        <div class="horizontal welcomeText">
          First lets start with a general quiz about constitutions in history and around the world. The more questions you get right, the more choice points you will have to frame your constitution!        </div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading headingNoImage">Spurningaleikur</div>
        <div class="horizontal welcomeText">
          Vi skulum byrja  almennum spurningum um stjrnarskrr  sgunni og vsvegar um heiminn. v fleiri spurningum sem  svarar rtt, eim mun fleiri valstig fru  sarpinn til a setja saman stjrnarskrna na!
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" @click="${this.closeWelcome}" autofocus>${this.localize("start")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}startCulturalAttitutesTutorial(){this.masterDialogCloseFunction=null;let e=null;"en"==this.language?e=html$1`
        <div class="heading">Cultural Values</div>
        <div class="horizontal welcomeText">
         These are the values of your society. Pay attention to these as you frame your constitution - you need to match your constitution to the Values of your citizens in your electorate.
        </div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading">Menningarleg gildi</div>
        <div class="horizontal welcomeText">
         etta eru helstu gildi samflagsins ns.  skalt taka mi af eim egar  leggur drg a stjrnarskr.  arft a gera hana annig r gari a hn s  samrmi vi gildismat flksins ns  kjsenda.
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center">
        <img aria-label="image" style="width: 400px;height:216px;margin-bottom:8px;" src="https://open-active-policy-public.s3-eu-west-1.amazonaws.com/make-your-constitution+/clientAssets/culturalValues12.jpg"></img>
      </div>
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" ?hidden="${!this.hasSeenCulturalAttitutesTutorial}" dialog-dismiss autofocus>${this.localize("skip")}</paper-button>
          <paper-button raised class="continueButton"  @click="${this.culturalAttitutesTutorialAuthority}"   autofocus>${this.localize("next")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}culturalAttitutesTutorialAuthority(){this.masterDialogCloseFunction=null;let e=null;"en"==this.language?e=html$1`
        <div class="heading">Authority</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>I will be your father figure, put your tiny hand in mine</em></span><br></span>
          High Authority cultures have citizens that country crave strong structure and clear lines of command in their lives, wanting the government to dictate as much as possible clear rules for living. Medium Authority means wanting some guidelines, with less government involvement. Low Authority means the culture values a hands-off attitude from its government.
        </div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading">Vald</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>g skal vera pabbi inn, rttu mr litlu hndina na...</em></span><br></span>
          ar sem almenningur skar eftir sterku rkisvaldi og telja borgararnir eftirsknarvert a lfum eirra s strt me skrum fyrirmlum hins opinbera. eir vilja a reglum samflagsins s framfylgt af fyllstu hrku. egar aeins er krafa um milungssterkt rkisvaldi skar almenningur eftir skrum leibeiningum en minni afskiptum rkisvaldsins. Ltill hugi  rkisvaldi ir a borgararnir kunna a meta a rkisvaldi lti flk almennt sem mest  frii.
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center" style="font-size: 110px;padding: 52px;margin-bottom: 16px;">
      
      </div>
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" ?hidden="${!this.hasSeenCulturalAttitutesTutorial}" dialog-dismiss autofocus>${this.localize("skip")}</paper-button>
          <paper-button raised class="continueButton" @click="${this.culturalAttitutesTutorialLiberty}" dialog-dismiss autofocus>${this.localize("next")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}culturalAttitutesTutorialLiberty(){this.masterDialogCloseFunction=null;let e=null;"en"==this.language?e=html$1`
        <div class="heading">Liberty</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>A man willing to sacrifice Liberty for Security deserves neither</em><br></span>
          This measures the societys embrace of the idea that a person should be allowed to do whatever the hell they want as long as it doesnt hurt other people.
        </div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading">Frelsi</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>S sem er tilbinn til a frna frelsi snu til a tryggja ryggi sitt  hvorki frelsi n ryggi skili...</em><br></span>
          S sannfring er rkjandi  samflaginu a hver manneskja eigi a f a gera hva a sem henni kemur  hug ef hn aeins gtir ess a valda ekki rum tjni.
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center" style="font-size: 110px;padding: 52px;margin-bottom: 16px;">
      
      </div>
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" ?hidden="${!this.hasSeenCulturalAttitutesTutorial}" dialog-dismiss autofocus>${this.localize("skip")}</paper-button>
          <paper-button raised class="continueButton" @click="${this.culturalAttitutesTutorialScience}" dialog-dismiss autofocus>${this.localize("next")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}culturalAttitutesTutorialScience(){this.masterDialogCloseFunction=null;let e=null;"en"==this.language?e=html$1`
        <div class="heading">Science</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>Science is true whether you believe in it or not</em><br></span>
          This score represents the extent to which this society values facts, truth, demonstrable evidence, the scientific method, modern consensus on sexual and racial equality, evolution, etc.
        </div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading">Vsindi</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>Vsindin birta sannleikann hvort sem  trir ea ekki...</em><br></span>
          Samflagi leggur miki upp r stareyndum, sannindum, rkum og ggnum, vsindalegri afer og hefur ntmalega afstu til jfnuar kynja og kyntta, almenningur trir  run osfrv..
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center" style="font-size: 110px;padding: 52px;margin-bottom: 16px;">
      
      </div>
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" ?hidden="${!this.hasSeenCulturalAttitutesTutorial}" dialog-dismiss autofocus>${this.localize("skip")}</paper-button>
          <paper-button raised class="continueButton" @click="${this.culturalAttitutesTutorialTradition}" dialog-dismiss autofocus>${this.localize("next")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}culturalAttitutesTutorialTradition(){this.masterDialogCloseFunction=null;let e=null;"en"==this.language?e=html$1`
        <div class="heading">Tradition</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>Study the past, if you wish to divine the future</em><br>
          <em>- Confucius</em><br></span>
          Measures how attached the citizens of your country are to age old beliefs of their culture, including religion, dress, legal practice, attitudes about sex and marriage and gender, ethnic heritage, food, and art/music. These committed beliefs deeply influence the sort of government they wish to be ruled by.
        </div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading">Hef</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>Til a sp fyrir um framtina, verur a ekkja sguna</em><br>
          <em>- Konfsus</em><br></span>
          Flki  landinu nu tengir sig sterkt vi jtr og gamlar hefir. etta birtist  trarbrgum og trrkni, klaburi afstu til laga, hugmynda um kyn og kynlf, hjnaband, kyngervi, menningararf, matarhefir og listir. jmenningin hefur djp hrif  vihorf ess til stjrnvalda og stjrnmlaskoanir.
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center" style="font-size: 110px;padding: 52px;margin-bottom: 16px;">
      
      </div>
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" ?hidden="${!this.hasSeenCulturalAttitutesTutorial}" dialog-dismiss autofocus>${this.localize("skip")}</paper-button>
          <paper-button raised class="continueButton" @click="${this.culturalAttitutesTutorialCollective}" dialog-dismiss autofocus>${this.localize("next")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}culturalAttitutesTutorialCollective(){this.masterDialogCloseFunction=null;let e=null;"en"==this.language?e=html$1`
        <div class="heading">Collectivism</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>The good of the many outweighs the good of the few</em><br></span>
          Defines the extent to which the culture understands communal sacrifice and shared purpose in the name of the common good.
        </div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading">Flagshyggja</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>
          Gi fyrir alla eru mikilvgari en gi sem falla fum  hendur...</em><br></span>
          Samflagi metur mikils frnfsi og eigingjarnt starf  gu samflagsins og leggur herslu  sameiginleg gi.
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center" style="font-size: 110px;padding: 52px;margin-bottom: 16px;">
      
      </div>
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" ?hidden="${!this.hasSeenCulturalAttitutesTutorial}" dialog-dismiss autofocus>${this.localize("skip")}</paper-button>
          <paper-button raised class="continueButton" @click="${this.culturalAttitutesTutorialIndependence}" dialog-dismiss autofocus>${this.localize("next")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}culturalAttitutesTutorialIndependence(){this.masterDialogCloseFunction=null;let e=null;"en"==this.language?e=html$1`
        <div class="heading">Independence</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>Swear allegiance to no other flag, serve no nation but thine own</em><br></span>
          This measures the extent the culture of the country dictates that it maintain complete autonomy from other nation states. High Independence indicates the citizens supports almost no international coalition building or globalist thinking. Low Independence indicates they welcome partnerships with friendly foriegn powers all over the globe.
        </div>
      `:"is"==this.language&&(e=html$1`
       <div class="heading">Sjlfsti</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>Ekki hylla ara fna , jnau engri j nema inni eigin...</em><br></span>
          Hr miasta stigagjf vi hversu mjg menning landsins krefst ess a algjru sjlfsti s haldi gagnvart rum rkjum. Htt sjlfsti bendir til a borgararnir viurkenni helst enga samstu me rum jum ea hnattrnan hugsunarhtt. Lgt sjlfsti bendir til a hugi s fyrir a ganga  margvsleg bandalg me vinveittum rkjum um allan heim.
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center" style="font-size: 110px;padding: 52px;margin-bottom: 16px;">
      
      </div>
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" ?hidden="${!this.hasSeenCulturalAttitutesTutorial}" dialog-dismiss autofocus>${this.localize("skip")}</paper-button>
          <paper-button raised class="continueButton" @click="${this.culturalAttitutesTutorialPrivacy}" dialog-dismiss autofocus>${this.localize("next")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}culturalAttitutesTutorialPrivacy(){let e;this.masterDialogCloseFunction=null,"en"==this.language?e=html$1`
        <div class="heading">Privacy</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>Asking a government to protect your privacy is like asking a Peeping Tom to install your window blinds.</em><br></span>
          Defines how much the citizens of the country value their personal information being kept safe from the public sphere, and how much they expect their government to behave with regard to that boundary.
        </div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading">Einkalf</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>A bija stjrnvld um a tryggja rtt sinn til einkalfs er eins og a f gluggaggi til a koma fyrir gluggatjldunum hj sr</em><br></span>
          Hr er skrt hvaa gildi a hefur fyrir borgarana a persnuupplsingar eirra su utan seilingar almannaumrunnar og a hve miklu leyti eir gera r fyrir v a eirra eigin stjrnvld viri mrk einkalfsins.
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center" style="font-size: 110px;padding: 52px;margin-bottom: 16px;">
      
      </div>
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" ?hidden="${!this.hasSeenCulturalAttitutesTutorial}" dialog-dismiss autofocus>${this.localize("skip")}</paper-button>
          <paper-button raised class="continueButton" @click="${this.culturalAttitutesTutorialLawAndOrder}" dialog-dismiss autofocus>${this.localize("next")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}culturalAttitutesTutorialLawAndOrder(){this.masterDialogCloseFunction=null;let e=null;"en"==this.language?e=html$1`
        <div class="heading">Law and Order</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>The more Law and Order is made prominent, the more thieves and robbers there will be </em><br>
          <em>- Lao Tze</em><br></span>
          This sets the appetite of the countrys citizenship for law enforcement in their lives and communities; High means that this makes them feel safe; Low means that it makes them angry and want to revolt.
        </div>
      `:"is"==this.language&&(e=html$1`
       <div class="heading">Lg og regla</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>egar lg og regla er snileg,  fjlgar jfum og rningjum </em><br>
          <em>- Lao Tze</em><br></span>
          Hr r borgarar landsins a lgum s framfylgt  lfum eirra og samflgum. egar essi ttur er hr,  upplifa eir ryggi. egar hann er lgur eru eir fullir reii og biturleika og   skir lngun til a gera uppreisn.
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center" style="font-size: 110px;padding: 52px;margin-bottom: 16px;">
      
      </div>
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" ?hidden="${!this.hasSeenCulturalAttitutesTutorial}" dialog-dismiss autofocus>${this.localize("skip")}</paper-button>
          <paper-button raised class="continueButton" @click="${this.culturalAttitutesTutorialProgressivism}" dialog-dismiss autofocus>${this.localize("next")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}culturalAttitutesTutorialProgressivism(){this.masterDialogCloseFunction=null;let e=null;"en"==this.language?e=html$1`
        <div class="heading">Social Progress</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>...the arc of the moral universe is long, but it bends toward justice.</em><br>
          <em>- Martin Luther King, Jr.</em><br></span>
          This score measures the countrys urge towards social justice, equal treatment for all people, level playing field free of corruption, kleptocracy, cronyism and prejudice, and their belief in every citizens right to clean air, food, water, housing, education, medical attention.
        </div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading">Flagslegar framfarir</div>
        <div class="horizontal welcomeText">
          <span class="smallQuotes"><em>...verld siferisins fer  stran sveig, en hann bendir  rttlti.</em><br>
          <em>- Martin Luther King, Jr.</em><br></span>
          Hr miast stigagjfin vi hve miki landi itt skist eftir flagslegu rttlti, jfnui gagnvart llum, jafnri samkeppnisastu sem er laus vi spillingu, klkuskap og fordma og trir  rtt allra til ess a hafa agang a hreinu lfoti, fu, vatni, hsni, menntun og heilbrigisjnustu.
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center" style="font-size: 110px;padding: 52px;margin-bottom: 16px;">
      
      </div>
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton"
            @click="${()=>{localStorage.setItem("oap-have-seen-cultural-attitutes-tutorial-"+this.GAME_STATE_VERSION,!0)}}"
            dialog-dismiss autofocus>${this.localize("continue")}
          </paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}openCountrySelectInfoDialog(){this.masterDialogCloseFunction=null;let e=null;"en"==this.language?e=html$1`
        <div class="heading">Select a Country</div>
        <div class="horizontal welcomeText">
         Pick the country and time in history that you want to write a constitution for! We have 10 countries in different time periods to choose from, each with different cultural values. Matching your constitution to these cultural values gives you bonuses and penalties to your Choice Points!
        </div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading">Land vali</div>
        <div class="horizontal welcomeText">
         Veldu land og tmabil  sgunni sem  vilt a stjrnarskrin n eigi vi! Vi hfum 10 lnd fr lkum tmabilum sem m velja r, og hvert eirra hefur sn menningarlegu gildi. Me v a lta stjrnarskrna ina passa vi eitthvert eirra geturu spila r verlauna og refsistigum sem  fr egar  velur!
       </div>
        `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center">
        <img aria-label="choice points image" style="width: 340px;height: 226px;" src="https://open-active-policy-public.s3-eu-west-1.amazonaws.com/make-your-constitution+/clientAssets/earth1.jpg"></img>
      </div>
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" dialog-dismiss autofocus>${this.localize("continue")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}openAndUpdateDialog(e){this.$$("#masterDialog").modal=!e,this.$$("#masterDialog").open(),this.requestUpdate(),this.$$("#masterDialog").fire("iron-resize")}openFilterInfoDialog(){this.masterDialogCloseFunction=null;let e=null;"en"==this.language?e=html$1`
        <div class="heading">Filter Articles</div>
        <div class="horizontal welcomeText">
        Welcome to the wide world of constitutional articles! We have presented these as modules; you have a chance now to go through all of the articles and pick the ones you know you would like to use in the game.</div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading">Forvelja kvi</div>
        <div class="horizontal welcomeText">
          Velkomin/n  verld stjrnarskrrkva!  fr n tkifri til a renna  gegnum ll kvi boi og forvelja au sem  vilt nota  leiknum.</div>
        `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center">
        <img aria-label="choice points image" style="width: 250px;height: 167px" src="https://open-active-policy-public.s3-eu-west-1.amazonaws.com/make-your-constitution+/clientAssets/filter1.jpg"></img>
      </div>
      <div class="vertical center-center masterDialog">
        ${e}
        <div class="buttons center-center">
          <paper-button raised class="continueButton" dialog-dismiss autofocus>${this.localize("continue")}</paper-button>
        </div>
      </div>
    </div>
   `,this.openAndUpdateDialog()}openSelectionInfoDialog(){this.masterDialogCloseFunction=null;let e=null;"en"==this.language?e=html$1`
        <div class="heading">Select Articles</div>
        <div class="horizontal welcomeText">
          Now you are ready to actually frame a constitution for your citizens! Each module you have available from the previous screen is now available for you to spend Choice Points on; if you choose modules that match your citizens Cultural Values you will get bonus Choice Points; if they do not match the Cultural Values of your electorate, you will pay a Choice Point penalty. You must have enough modules from each of the four Branches to complete a constitution before you run out of Choice Points. Good Luck!!
          <paper-button raised class="continueButton" @click="${()=>{window.scrollTop=0}}" dialog-dismiss autofocus>${this.localize("start")}</paper-button>
        </div>
      `:"is"==this.language&&(e=html$1`
        <div class="heading">Velja kvi</div>
        <div class="horizontal welcomeText">
      	  N geturu byrja a hanna stjrnarskr fyrir na rkisborgara! Hver ttur r stjrnarskr sem  valdir  fyrra stigi leiksins er n meal eirra sem  getur vali og eytt valstigum . Ef  velur tti sem passa vi menningarleg gildi inna rkisborgara fru verlaunapunkta. Ef eir passa ekki vi menningarleg gildi eirra taparu valstigum.  verur a hafa ngu marga tti r hverri greinanna fjgurra til a geta loki vi stjrnarskr ur en  eyir llum valstigunum num. Gangi r vel!
          <paper-button raised class="continueButton" @click="${()=>{window.scrollTop=0}}" dialog-dismiss autofocus>${this.localize("start")}</paper-button>
        </div>
      `),this.masterDialogContent=html$1`
      <div class="vertical center-center">
      <div class="masterLogoContainer center-center">
        <img aria-label="choice points image" style="width:250px;height:143px" src="https://open-active-policy-public.s3-eu-west-1.amazonaws.com/make-your-constitution+/clientAssets/select1.jpg"></img>
      </div>
      <div class="vertical center-center masterDialog">
       ${e}
      </div>
    </div>
   `,this.openAndUpdateDialog()}}window.customElements.define("oap-app",OapApp);export{CopyShader$1 as $CopyShader,Easing$1 as $Easing,Easing as $EasingDefault,EffectComposer$1 as $EffectComposer,FXAAShader$1 as $FXAAShader,Interpolation$1 as $Interpolation,Interpolation as $InterpolationDefault,Interpolator$1 as $Interpolator,Interpolator as $InterpolatorDefault,LightningStorm$1 as $LightningStorm,LightningStrike$1 as $LightningStrike,LuminosityHighPassShader$1 as $LuminosityHighPassShader,MaskPass$1 as $MaskPass,NodeCache$1 as $NodeCache,NodeCache as $NodeCacheDefault,OrbitControls$1 as $OrbitControls,OutlinePass$1 as $OutlinePass,Pass$1 as $Pass,PlaybackPosition$1 as $PlaybackPosition,PlaybackPosition as $PlaybackPositionDefault,RenderPass$1 as $RenderPass,ShaderPass$1 as $ShaderPass,SimplexNoise$1 as $SimplexNoise,Timeline$1 as $Timeline,Timeline as $TimelineDefault,Tween$1 as $Tween,Tween as $TweenDefault,UnrealBloomPass$1 as $UnrealBloomPass,appLayoutBehavior as $appLayoutBehavior,appScrollEffectsBehavior as $appScrollEffectsBehavior,applyShim as $applyShim$1,ApplyShim as $applyShimDefault,applyShimUtils as $applyShimUtils,arraySelector as $arraySelector,arraySplice as $arraySplice,async as $async,ballotEncryptionBehavior as $ballotEncryptionBehavior,caseMap$1 as $caseMap,_class as $class,commonRegex as $commonRegex,commonUtils as $commonUtils,compiler as $compiler,Compiler as $compilerDefault,constants as $constants,core as $core,core$1 as $core$1,MessageFormat as $coreDefault,cssParse as $cssParse,cssTag as $cssTag,customStyle as $customStyle,customStyleInterface as $customStyleInterface$1,CustomStyleInterface as $customStyleInterfaceDefault,debounce as $debounce,decorators as $decorators,defaultTemplateProcessor$1 as $defaultTemplateProcessor,dirMixin as $dirMixin,directive$1 as $directive,documentWait$1 as $documentWait,documentWait as $documentWaitDefault,dom$1 as $dom,domBind as $domBind,domIf as $domIf,domModule as $domModule,domRepeat as $domRepeat,elementMixin as $elementMixin,en as $en,defaultLocale as $enDefault,es5 as $es5,fetch$2 as $fetch,flattenedNodesObserver as $flattenedNodesObserver,flush$2 as $flush,gestureEventListeners as $gestureEventListeners,gestures$1 as $gestures,helpers as $helpers,htmlTag as $htmlTag,index as $index,ironA11yAnnouncer as $ironA11yAnnouncer,ironA11yKeysBehavior as $ironA11yKeysBehavior,ironButtonState as $ironButtonState,ironCheckedElementBehavior as $ironCheckedElementBehavior,ironControlState as $ironControlState,ironFitBehavior as $ironFitBehavior,ironFocusablesHelper as $ironFocusablesHelper,ironFormElementBehavior as $ironFormElementBehavior,ironMenuBehavior as $ironMenuBehavior,ironMenubarBehavior as $ironMenubarBehavior,ironMeta as $ironMeta,ironMultiSelectable as $ironMultiSelectable,ironOverlayBehavior as $ironOverlayBehavior,ironOverlayManager as $ironOverlayManager,ironRangeBehavior as $ironRangeBehavior,ironResizableBehavior as $ironResizableBehavior,ironScrollManager as $ironScrollManager,ironScrollTargetBehavior as $ironScrollTargetBehavior,ironSelectable as $ironSelectable,ironSelection as $ironSelection,ironValidatableBehavior as $ironValidatableBehavior,legacyElementMixin as $legacyElementMixin,litElement as $litElement,litHtml as $litHtml,main as $main,MessageFormat as $mainDefault,mediaQuery as $mediaQuery,metadata as $metadata,mixin as $mixin,modifyTemplate as $modifyTemplate,mutableData as $mutableData,mutableDataBehavior as $mutableDataBehavior,neonAnimatableBehavior as $neonAnimatableBehavior,neonAnimationBehavior as $neonAnimationBehavior,neonAnimationRunnerBehavior as $neonAnimationRunnerBehavior,network as $network,oap2dEmojis as $oap$2dEmojis,oap3dBudgetStyles as $oap$3dBudgetStyles,oapAppStyles as $oapAppStyles,oapArticleItemStyles as $oapArticleItemStyles,oapBallotStyles as $oapBallotStyles,oapBaseElement as $oapBaseElement,oapBonusesAndPenalties as $oapBonusesAndPenalties,oapCachedTextGeometry as $oapCachedTextGeometry,oapCountdownTimer3d as $oapCountdownTimer$3d,oapCountryCreationStyles as $oapCountryCreationStyles,oapFilterArticlesStyles as $oapFilterArticlesStyles,oapFireworks3d as $oapFireworks$3d,oapFlexLayout as $oapFlexLayout,oapLightning3d as $oapLightning$3d,oapLightshaft3d as $oapLightshaft$3d,oapPageViewElement as $oapPageViewElement,oapPolicyQuizStyles as $oapPolicyQuizStyles,oapReviewStyles as $oapReviewStyles,oapShadowStyles as $oapShadowStyles,oapSwipableCardsStyles as $oapSwipableCardsStyles,paperButtonBehavior as $paperButtonBehavior,paperCheckedElementBehavior as $paperCheckedElementBehavior,paperDialogBehavior as $paperDialogBehavior,paperInkyFocusBehavior as $paperInkyFocusBehavior,paperInputAddonBehavior as $paperInputAddonBehavior,paperInputBehavior as $paperInputBehavior,paperItemBehavior as $paperItemBehavior,paperMenuButton as $paperMenuButton,paperRippleBehavior as $paperRippleBehavior,paperSpinnerBehavior as $paperSpinnerBehavior,parser$1 as $parser,parser as $parserDefault,part as $part,parts as $parts,path as $path,polymer_dom as $polymerDom,polymerElement as $polymerElement,polymerFn as $polymerFn,polymerLegacy as $polymerLegacy,propertiesChanged as $propertiesChanged,propertiesMixin as $propertiesMixin,propertyAccessors as $propertyAccessors,propertyEffects as $propertyEffects,render$1 as $render,renderStatus as $renderStatus,repeat$1 as $repeat,resolveUrl$1 as $resolveUrl,router as $router,selector as $selector,Selector as $selectorDefault,settings as $settings,shadyRender as $shadyRender,shim as $shim,styleGather as $styleGather,styleSettings as $styleSettings,styleUtil as $styleUtil,telemetry as $telemetry,template$d as $template,templateFactory$1 as $templateFactory,templateInstance as $templateInstance,templateMap$1 as $templateMap,templateMap as $templateMapDefault,templateResult as $templateResult,templateStamp as $templateStamp,templatize$1 as $templatize,templatizerBehavior as $templatizerBehavior,three_module as $threeModule,unsafeHtml as $unsafeHtml,unscopedStyleHandler as $unscopedStyleHandler,updatingElement as $updatingElement,utils as $utils,wrap$2 as $wrap,ACESFilmicToneMapping,ANIMATION_MATCH,AddEquation,AddOperation,AdditiveBlending,AlphaFormat,AlwaysDepth,AmbientLight,AmbientLightProbe,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,AppLayoutBehavior,AppScrollEffectsBehavior,ArcCurve,ArrayCamera,ArraySelector,ArraySelectorMixin,ArrowHelper,AttributeCommitter,AttributeCommitter as AttributeCommitter$1,AttributePart,AttributePart as AttributePart$1,Audio$1 as Audio,AudioAnalyser,AudioContext,AudioListener,AudioLoader,AxesHelper,AxisHelper,BRACKETED,BackSide,Base,BasicDepthPacking,BasicShadowMap,BinaryTextureLoader,Bone,BooleanAttributePart,BooleanAttributePart as BooleanAttributePart$1,BooleanKeyframeTrack,BoundingBoxHelper,Box2,Box3,Box3Helper,BoxBufferGeometry,BoxGeometry,BoxHelper,BufferAttribute,BufferGeometry,BufferGeometryLoader,ByteType,CHAINED_TWEENS,CSSResult,CSSResult as CSSResult$1,Cache,CacheEmojisInBackground,Camera,CameraHelper,CanvasRenderer,CanvasTexture,CatmullRomCurve3,CineonToneMapping,CircleBufferGeometry,CircleGeometry,ClampToEdgeWrapping,Class,ClearMaskPass,Clock,ClosedSplineCurve3,Color,ColorKeyframeTrack,CompressedTexture,CompressedTextureLoader,ConeBufferGeometry,ConeGeometry,CopyShader,CreateCountDownTimer3D,CreateGPUFireworks3D,CreateLightShaft3D,CreateLightning3D,CubeCamera,BoxGeometry as CubeGeometry,CubeReflectionMapping,CubeRefractionMapping,CubeTexture,CubeTextureLoader,CubeUVReflectionMapping,CubeUVRefractionMapping,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceBack,CullFaceFront,CullFaceFrontBack,CullFaceNone,Curve,CurvePath,CustomBlending,CustomStyle,CustomStyleInterfaceInterface,CustomStyleProvider,CylinderBufferGeometry,CylinderGeometry,Cylindrical,DOMException,DataTexture,DataTexture2DArray,DataTexture3D,DataTextureLoader,Debouncer,DefaultLoadingManager,DefaultTemplateProcessor,DefaultTemplateProcessor as DefaultTemplateProcessor$1,DepthFormat,DepthStencilFormat,DepthTexture,DirMixin,DirectionalLight,DirectionalLightHelper,DirectionalLightShadow,DiscreteInterpolant,DodecahedronBufferGeometry,DodecahedronGeometry,DomApi,DomBind,DomIf,DomModule,DomRepeat,DoubleSide,DstAlphaFactor,DstColorFactor,DynamicBufferAttribute,EVENT_CALLBACK,EVENT_COMPLETE,EVENT_PAUSE,EVENT_PLAY,EVENT_REPEAT,EVENT_RESTART,EVENT_REVERSE,EVENT_SEEK,EVENT_START,EVENT_STOP,EVENT_UPDATE,Easing,EdgesGeometry,EdgesHelper,EffectComposer,ElementMixin,EllipseCurve,EqualDepth,EquirectangularReflectionMapping,EquirectangularRefractionMapping,Euler,EventApi,EventDispatcher,EventPart,EventPart as EventPart$1,ExtrudeBufferGeometry,ExtrudeGeometry,FRAME_MS,FXAAShader,Face3,Face4,FaceColors,FaceNormalsHelper,FileLoader,FlatShading,FlattenedNodesObserver,Float32Attribute,Float32BufferAttribute,Float64Attribute,Float64BufferAttribute,FloatType,Fog,FogExp2,Font,FontLoader,FrameThrottle,FrameThrottle as FrameThrottle$1,FrontFaceDirectionCCW,FrontFaceDirectionCW,FrontSide,Frustum,GammaEncoding,Geometry,GeometryUtils,GestureEventListeners,Get2DEmoji,GetBonusesAndPenaltiesForItem,GetCompletionScoreByModuleType,GetEmojiFromAttitute,GetResultsForReview,GetTextGeometry,GetTextMesh,GreaterDepth,GreaterEqualDepth,GridHelper,Group,HOST_PREFIX,HOST_SUFFIX,HalfFloatType,Headers,HemisphereLight,HemisphereLightHelper,HemisphereLightProbe,IS_VAR,IcosahedronBufferGeometry,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,ImmediateRenderObject,InstancedBufferAttribute,InstancedBufferGeometry,InstancedInterleavedBuffer,Int16Attribute,Int16BufferAttribute,Int32Attribute,Int32BufferAttribute,Int8Attribute,Int8BufferAttribute,IntType,InterleavedBuffer,InterleavedBufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,Interpolation,Interpolator,IronA11yAnnouncer,IronA11yKeysBehavior,IronButtonState,IronButtonStateImpl,IronCheckedElementBehavior,IronCheckedElementBehaviorImpl,IronControlState,IronFitBehavior,IronFocusablesHelper,IronFormElementBehavior,IronMenuBehavior,IronMenuBehaviorImpl,IronMenubarBehavior,IronMenubarBehaviorImpl,IronMeta,IronMultiSelectableBehavior,IronMultiSelectableBehaviorImpl,IronOverlayBehavior,IronOverlayBehaviorImpl,IronOverlayManager,IronOverlayManagerClass,IronRangeBehavior,IronResizableBehavior,IronScrollTargetBehavior,IronSelectableBehavior,IronSelection,IronValidatableBehavior,IronValidatableBehaviorMeta,JSONLoader,KeyframeTrack,LOD,LatheBufferGeometry,LatheGeometry,Layers,LegacyElementMixin,LensFlare,LessDepth,LessEqualDepth,Light,LightProbe,LightProbeHelper,LightShadow,LightningStorm,LightningStrike,Line,Line3,LineBasicMaterial,LineCurve,LineCurve3,LineDashedMaterial,LineLoop,LinePieces,LineSegments,LineStrip,LinearEncoding,LinearFilter,LinearInterpolant,LinearMipMapLinearFilter,LinearMipMapNearestFilter,LinearToneMapping,LitElement,Loader,LoaderUtils,LoadingManager,LogLuvEncoding,LoopOnce,LoopPingPong,LoopRepeat,LuminanceAlphaFormat,LuminanceFormat,LuminosityHighPassShader,MEDIA_MATCH,MIXIN_MATCH,MOUSE,MaskPass,Material,MaterialLoader,_Math as Math,Matrix3,Matrix4,MaxEquation,Mesh,MeshBasicMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshFaceMaterial,MeshLambertMaterial,MeshMatcapMaterial,MeshNormalMaterial,MeshPhongMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshToonMaterial,MinEquation,MirroredRepeatWrapping,MixOperation,MultiMaterial,MultiplyBlending,MultiplyOperation,MutableData,MutableDataBehavior,NUM_REGEX,NearestFilter,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NeonAnimatableBehavior,NeonAnimationBehavior,NeonAnimationRunnerBehavior,NeonAnimationRunnerBehaviorImpl,NeverDepth,NoBlending,NoColors,NoToneMapping,NodePart,NodePart as NodePart$1,NormalBlending,NotEqualDepth,NumberKeyframeTrack,Oap3DBudgetStyles,OapAppStyles,OapArticleItemStyles,OapBallotStyles,OapBaseElement,OapCountryCreationStyles,OapFilterArticlesStyles,OapFlexLayout,OapPageViewElement,OapPolicyQuizStyles,OapReviewStyles,OapShadowStyles,OapSwipableCardsStyles,Object3D,ObjectLoader,ObjectSpaceNormalMap,OctahedronBufferGeometry,OctahedronGeometry,OneFactor,OneMinusDstAlphaFactor,OneMinusDstColorFactor,OneMinusSrcAlphaFactor,OneMinusSrcColorFactor,OptionalMutableData,OptionalMutableDataBehavior,OrbitControls,OrthographicCamera,OutlinePass,PCFShadowMap,PCFSoftShadowMap,PaperButtonBehavior,PaperButtonBehaviorImpl,PaperCheckedElementBehavior,PaperCheckedElementBehaviorImpl,PaperDialogBehavior,PaperDialogBehaviorImpl,PaperInkyFocusBehavior,PaperInkyFocusBehaviorImpl,PaperInputAddonBehavior,PaperInputBehavior,PaperInputBehaviorImpl,PaperInputHelper,PaperItemBehavior,PaperItemBehaviorImpl,PaperMenuButton,PaperRippleBehavior,PaperSpinnerBehavior,ParametricBufferGeometry,ParametricGeometry,Particle,ParticleBasicMaterial,ParticleSystem,ParticleSystemMaterial,Pass$2 as Pass,Pass as Pass$1,Path,PerspectiveCamera,Plane,PlaneBufferGeometry,PlaneGeometry,PlaneHelper,Plugins,Plugins as Plugins$1,PointCloud,PointCloudMaterial,PointLight,PointLightHelper,Points,PointsMaterial,PolarGridHelper,PolyhedronBufferGeometry,PolyhedronGeometry,Polymer,Polymer as Polymer$1,PolymerElement,PositionalAudio,PositionalAudioHelper,PropertiesChanged,PropertiesMixin,PropertyAccessors,PropertyBinding,PropertyCommitter,PropertyCommitter as PropertyCommitter$1,PropertyEffects,PropertyMixer,PropertyPart,PropertyPart as PropertyPart$1,QuadraticBezierCurve,QuadraticBezierCurve3,Quaternion,QuaternionKeyframeTrack,QuaternionLinearInterpolant,REVISION,RGB,RGBA,RGBADepthPacking,RGBAFormat,RGBA_ASTC_10x10_Format,RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format,RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format,RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format,RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format,RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT5_Format,RGBDEncoding,RGBEEncoding,RGBEFormat,RGBFormat,RGBM16Encoding,RGBM7Encoding,RGB_ETC1_Format,RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format,RawShaderMaterial,Ray,Raycaster,RectAreaLight,RectAreaLightHelper,RedFormat,ReinhardToneMapping,RenderPass,RepeatWrapping,Request,Response,ReverseSubtractEquation,RingBufferGeometry,RingGeometry,SET_NESTED,STRING_PROP,SVGTemplateResult,SVGTemplateResult as SVGTemplateResult$1,SVGTemplateResult as SVGTemplateResult$2,Scene,SceneUtils,Selector,SetForceSlowOnFontCaching,ShaderChunk,ShaderLib,ShaderMaterial,ShaderPass,ShadowMaterial,Shape,ShapeBufferGeometry,ShapeGeometry,ShapePath,ShapeUtils,ShortType,SimplexNoise,Skeleton,SkeletonHelper,SkinnedMesh,SmoothShading,Sphere,SphereBufferGeometry,SphereGeometry,Spherical,SphericalHarmonics3,SphericalReflectionMapping,Spline,SplineCurve,SplineCurve3,SpotLight,SpotLightHelper,SpotLightShadow,Sprite,SpriteMaterial,SrcAlphaFactor,SrcAlphaSaturateFactor,SrcColorFactor,StartDelayedFontCaching,StartEarlyDelayedFontCaching,StartPerformCacheWelcomeTexts,StereoCamera,Store,StringKeyframeTrack,StyleNode,SubtractEquation,SubtractiveBlending,TOO_LONG_FRAME_MS,TangentSpaceNormalMap,Template,Template as Template$1,TemplateInstance,TemplateInstance as TemplateInstance$1,TemplateInstanceBase,TemplateResult,TemplateResult as TemplateResult$1,TemplateResult as TemplateResult$2,TemplateResult as TemplateResult$3,TemplateStamp,Templatizer,TetrahedronBufferGeometry,TetrahedronGeometry,TextBufferGeometry,TextGeometry,Texture,TextureLoader,Timeline,ToggleLagSmoothing,ToggleLagSmoothing as ToggleLagSmoothing$1,TorusBufferGeometry,TorusGeometry,TorusKnotBufferGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeBufferGeometry,TubeGeometry,Tween,UVMapping,Uint16Attribute,Uint16BufferAttribute,Uint32Attribute,Uint32BufferAttribute,Uint8Attribute,Uint8BufferAttribute,Uint8ClampedAttribute,Uint8ClampedBufferAttribute,Uncharted2ToneMapping,Uniform,UniformsLib,UniformsUtils,UnrealBloomPass,UnsignedByteType,UnsignedInt248Type,UnsignedIntType,UnsignedShort4444Type,UnsignedShort5551Type,UnsignedShort565Type,UnsignedShortType,UpdatingElement,UpdatingElement as UpdatingElement$1,VAR_ASSIGN,VAR_CONSUMED,Vector2,Vector3,Vector4,VectorKeyframeTrack,Vertex,VertexColors,VertexNormalsHelper,VideoTexture,WebGLMultisampleRenderTarget,WebGLRenderTarget,WebGLRenderTargetCube,WebGLRenderer,WebGLUtils,WireframeGeometry,WireframeHelper,WrapAroundEnding,XHRLoader,ZeroCurvatureEnding,ZeroFactor,ZeroSlopeEnding,_boundScrollHandler,_composedTreeContains,_getScrollInfo,_getScrollableNodes,_getScrollingNode,_hasCachedLockedElement,_hasCachedUnlockedElement,_lockScrollInteractions,_lockedElementCache,_lockingElements,_scrollEffects,_scrollInteractionHandler,_scrollTimer,_shouldPreventScrolling,_unlockScrollInteractions,_unlockedElementCache,add,add$1,add$1 as add$2,enqueueDebouncer as addDebouncer,addListener,afterNextRender,allowTemplateFromDomModule,animationFrame,applyCss,applyStyle,applyStylePlaceHolder,autoPlay,autoPlay as autoPlay$1,beforeNextRender,boundAttributeSuffix,calculateSplices,camelToDashCase,cancelAnimationFrame$1 as cancelAnimationFrame,createMarker,createMarker as createMarker$1,createScopeStyle,css,css as css$1,cssBuild,cssFromModule,cssFromModuleImports,cssFromModules,cssFromTemplate,currentLockingElement,customElement,customElement as customElement$1,dashToCamelCase,decompose,decomposeString,dedupingMixin,deepCopy,deepTargetFind,defaultConverter,defaultConverter as defaultConverter$1,defaultTemplateProcessor,defaultTemplateProcessor as defaultTemplateProcessor$1,defineProperty,detectMixin,directive,directive as directive$1,disableRuntime,dom,dumpRegistrations,elementHasBuiltCss,elementIsScrollLocked,elementsAreInvalid,encryptVote,enqueueDebouncer,enqueueDebouncer as enqueueDebouncer$1,eventOptions,eventOptions as eventOptions$1,extend,fetch$1 as fetch,findMatchingParen,findOriginalTarget,fixupRules,flush$1 as flush,flush$1,flush as flush$2,flushDebouncers,forEachRule,gatherStyleText,gestures,get,get$1,get$1 as get$2,getAll,getAll as getAll$1,getBuildComment,getComputedStyleValue,getCssBuild,getIsExtends,has,has as has$1,hop,html,html$1,html as html$2,html as html$3,html$1 as html$4,html$1 as html$5,htmlLiteral,idlePeriod,incrementInstanceCount,insertNodeIntoTemplate,installMediaQueryWatcher$1 as installMediaQueryWatcher,installOfflineWatcher,installRouter,instanceCount,invalidate,invalidateTemplate,isAncestor,isCEPolyfill,isDeep,isDescendant,isDirective,isDirective as isDirective$1,isKeyframesSelector,isLagSmoothing,isOptimalCssBuild,isPath,isPrimitive,isPrimitive as isPrimitive$1,isRGBColor,isRunning,isRunning as isRunning$1,isTargetedBuild,isTemplatePartActive,isTemplatePartActive as isTemplatePartActive$1,isUnscopedStyle,isValid,isValidating,lastAttributeNameRegex,legacyOptimizations,marker,markerRegex,matches,matchesSelector,microTask,mixinBehaviors,modelForElement,nativeCssVariables,nativeShadow,noChange,noChange as noChange$1,nodeMarker,normalize,notEqual,notEqual as notEqual$1,nothing,nothing as nothing$1,now,now as now$1,objCreate,onRequestTick,onRequestTick as onRequestTick$1,onTick,onTick as onTick$1,parse,parts$1 as parts,parts$1,passiveTouchGestures,pathFromUrl,prevent,processUnscopedStyle,processVariableAndFallback,property,property as property$1,pushScrollLock,query,query as query$1,queryAll,queryAll as queryAll$1,queryAllRoot,recognizers,recompose,register$1 as register,register as register$1,registerEffect,registrations,remove,remove$1,remove$1 as remove$2,removeAll,removeAll as removeAll$1,removeCustomPropAssignment,removeListener,removeNodes,removeNodes as removeNodes$1,removeNodesFromTemplate,removeScrollLock,render,render$2 as render$1,render as render$2,reparentNodes,reparentNodes as reparentNodes$1,repeat,requestAnimationFrame$1 as requestAnimationFrame,resetMouseCanceller,resolveCss,resolveUrl,root,root$1,rootPath,rulesForStyle,sRGBEncoding,sanitizeDOMValue,scopingAttribute,scroll,scrollTimingFunction,set,setAllowTemplateFromDomModule,setElementClassRaw,setLegacyOptimizations,setMetaTag,setPassiveTouchGestures,setRootPath,setSanitizeDOMValue,setStrictTemplatePolicy,setSyncInitialRender,setTouchAction,shuffle,split,splitSelectorList,startValidating,startValidatingTemplate,strictTemplatePolicy,stringify,stylesFromModule,stylesFromModuleImports,stylesFromModules,stylesFromTemplate,supportsAdoptingStyleSheets,supportsAdoptingStyleSheets as supportsAdoptingStyleSheets$1,svg,svg as svg$1,svg as svg$2,syncInitialRender,templateCaches,templateCaches as templateCaches$1,templateFactory,templateFactory as templateFactory$1,templateIsValid,templateIsValidating,templatize,timeOut,toCssText,translate,types,unsafeCSS,unsafeCSS as unsafeCSS$1,unsafeHTML,update,update as update$1,updateMetadata,updateNativeProperties,updateStyles,useNativeCSSProperties,useNativeCustomElements,useShadow,constants as utils,version,version as version$1,wrap$1 as wrap,wrap as wrap$1};
